---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Screen Distance Calculator - Optimal Viewing";
const description = "Calculate the optimal viewing distance for your TV or monitor based on screen size and resolution.";
const relatedCalcs = [
  { name: "Screen Size", url: "/screen-size-calculator", description: "Screen size." },
  { name: "Pixel Calculator", url: "/pixel-calculator", description: "Pixels." },
  { name: "Aspect Ratio", url: "/aspect-ratio-calculator", description: "Aspect ratio." },
  { name: "Length Converter", url: "/length-converter", description: "Length." },
  { name: "Square Footage", url: "/square-footage-calculator", description: "Sq ft." },
  { name: "Internet Speed", url: "/internet-speed-calculator", description: "Internet." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Screen Distance Calculator" keywords="TV viewing distance, monitor distance, optimal screen distance, 4K viewing distance, screen size" breadcrumbs={[{ name: "Screen Distance", url: "/screen-distance-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Screen Distance Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Find the optimal viewing distance for your screen.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Screen Size (inches diagonal)</label><input type="number" id="sd-size" class="sd-in w-full px-4 py-3 border border-border rounded-xl text-2xl font-bold" value="55" min="10" max="120" step="1"></div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Resolution</label>
            <select id="sd-res" class="sd-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
              <option value="720">720p (HD)</option>
              <option value="1080">1080p (Full HD)</option>
              <option value="1440">1440p (QHD)</option>
              <option value="2160" selected>4K (UHD)</option>
              <option value="4320">8K</option>
            </select>
          </div>
        </div>
        <div class="flex flex-wrap gap-2">
          <button class="sd-preset px-3 py-1 rounded-lg bg-surface-alt text-xs font-bold" data-size="27">27" Monitor</button>
          <button class="sd-preset px-3 py-1 rounded-lg bg-surface-alt text-xs font-bold" data-size="32">32" Monitor</button>
          <button class="sd-preset px-3 py-1 rounded-lg bg-surface-alt text-xs font-bold" data-size="43">43" TV</button>
          <button class="sd-preset px-3 py-1 rounded-lg bg-surface-alt text-xs font-bold" data-size="55">55" TV</button>
          <button class="sd-preset px-3 py-1 rounded-lg bg-surface-alt text-xs font-bold" data-size="65">65" TV</button>
          <button class="sd-preset px-3 py-1 rounded-lg bg-surface-alt text-xs font-bold" data-size="75">75" TV</button>
          <button class="sd-preset px-3 py-1 rounded-lg bg-surface-alt text-xs font-bold" data-size="85">85" TV</button>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Optimal Viewing Distance</div>
          <div class="text-5xl font-extrabold font-mono" id="sd-result">0 ft</div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Min Distance</div><div class="text-xl font-bold font-mono" id="sd-min">0 ft</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Max Distance</div><div class="text-xl font-bold font-mono" id="sd-max">0 ft</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Meters</div><div class="text-xl font-bold font-mono" id="sd-meters">0 m</div></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Viewing Angle</div><div class="text-xl font-bold font-mono" id="sd-angle">0°</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">PPI at Distance</div><div class="text-xl font-bold font-mono" id="sd-ppi">0</div></div>
        </div>
      </div>
      <ShareButton calculatorId="screen-distance" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcSD() {
      const size = parseFloat((document.getElementById('sd-size') as HTMLInputElement).value) || 55;
      const res = parseInt((document.getElementById('sd-res') as HTMLSelectElement).value) || 2160;
      const heightIn = size * Math.sin(Math.atan(9/16));
      const widthIn = size * Math.cos(Math.atan(9/16));
      const pixelAngle = res === 720 ? 1/30 : res === 1080 ? 1/60 : res === 1440 ? 1/80 : res === 2160 ? 1/120 : 1/240;
      const minDist = heightIn * 1.2;
      const optDist = heightIn * (res >= 2160 ? 1.5 : res >= 1080 ? 2.0 : 2.5);
      const maxDist = heightIn * 3.5;
      const optFt = optDist / 12;
      const minFt = minDist / 12;
      const maxFt = maxDist / 12;
      const viewAngle = 2 * Math.atan(widthIn / (2 * optDist)) * 180 / Math.PI;
      const ppi = Math.sqrt(res*res + (res*16/9)*(res*16/9)) / size;
      document.getElementById('sd-result')!.textContent = optFt.toFixed(1) + ' ft';
      document.getElementById('sd-min')!.textContent = minFt.toFixed(1) + ' ft';
      document.getElementById('sd-max')!.textContent = maxFt.toFixed(1) + ' ft';
      document.getElementById('sd-meters')!.textContent = (optFt * 0.3048).toFixed(1) + ' m';
      document.getElementById('sd-angle')!.textContent = viewAngle.toFixed(1) + '°';
      document.getElementById('sd-ppi')!.textContent = ppi.toFixed(0);
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.sd-in').forEach(el => { el.addEventListener('input', calcSD); el.addEventListener('change', calcSD); });
      document.querySelectorAll('.sd-preset').forEach(b => b.addEventListener('click', () => {
        (document.getElementById('sd-size') as HTMLInputElement).value = (b as HTMLButtonElement).dataset.size!;
        calcSD();
      }));
      calcSD();
    }, 50);
  </script>
</CalculatorLayout>
