---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Personality Trait Calculator - Big Five (OCEAN) Assessment";
const description = "Score your Big Five personality traits: Openness, Conscientiousness, Extraversion, Agreeableness, and Neuroticism. Get percentiles and profile summary.";
const relatedCalcs = [
  { name: "Age Calculator", url: "/age-calculator", description: "Calculate exact age." },
  { name: "BMI Calculator", url: "/bmi-calculator", description: "Body mass index." },
  { name: "Productivity Calculator", url: "/productivity-calculator", description: "Productivity metrics." },
  { name: "Sleep Calculator", url: "/sleep-calculator", description: "Optimize sleep cycles." },
  { name: "Calorie Calculator", url: "/calorie-calculator", description: "Daily calorie needs." },
  { name: "GPA Calculator", url: "/grade-point-average-calculator", description: "Grade point average." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Personality Trait Calculator" keywords="Big Five, OCEAN, personality traits, openness, conscientiousness, extraversion, agreeableness, neuroticism, personality test" breadcrumbs={[{ name: "Personality Trait", url: "/personality-trait-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Personality Trait Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Rate each statement (1 = Strongly Disagree, 7 = Strongly Agree) for a Big Five personality profile.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <h3 class="font-semibold text-text">Openness to Experience</h3>
        <div>
          <label class="block text-sm text-text mb-1">I enjoy exploring new ideas and concepts.</label>
          <input type="range" id="pt3-o1" class="pt3-in w-full" min="1" max="7" step="1">
          <div class="flex justify-between text-xs text-text-secondary"><span>Disagree (1)</span><span>Agree (7)</span></div>
        </div>
        <div>
          <label class="block text-sm text-text mb-1">I have a vivid imagination and appreciate art.</label>
          <input type="range" id="pt3-o2" class="pt3-in w-full" min="1" max="7" step="1">
          <div class="flex justify-between text-xs text-text-secondary"><span>Disagree (1)</span><span>Agree (7)</span></div>
        </div>

        <h3 class="font-semibold text-text mt-2">Conscientiousness</h3>
        <div>
          <label class="block text-sm text-text mb-1">I am organized and pay attention to details.</label>
          <input type="range" id="pt3-c1" class="pt3-in w-full" min="1" max="7" step="1">
          <div class="flex justify-between text-xs text-text-secondary"><span>Disagree (1)</span><span>Agree (7)</span></div>
        </div>
        <div>
          <label class="block text-sm text-text mb-1">I follow through on tasks and responsibilities.</label>
          <input type="range" id="pt3-c2" class="pt3-in w-full" min="1" max="7" step="1">
          <div class="flex justify-between text-xs text-text-secondary"><span>Disagree (1)</span><span>Agree (7)</span></div>
        </div>

        <h3 class="font-semibold text-text mt-2">Extraversion</h3>
        <div>
          <label class="block text-sm text-text mb-1">I am energized by social interactions and group activities.</label>
          <input type="range" id="pt3-e1" class="pt3-in w-full" min="1" max="7" step="1">
          <div class="flex justify-between text-xs text-text-secondary"><span>Disagree (1)</span><span>Agree (7)</span></div>
        </div>
        <div>
          <label class="block text-sm text-text mb-1">I am talkative and assertive in conversations.</label>
          <input type="range" id="pt3-e2" class="pt3-in w-full" min="1" max="7" step="1">
          <div class="flex justify-between text-xs text-text-secondary"><span>Disagree (1)</span><span>Agree (7)</span></div>
        </div>

        <h3 class="font-semibold text-text mt-2">Agreeableness</h3>
        <div>
          <label class="block text-sm text-text mb-1">I trust others and assume the best in people.</label>
          <input type="range" id="pt3-a1" class="pt3-in w-full" min="1" max="7" step="1">
          <div class="flex justify-between text-xs text-text-secondary"><span>Disagree (1)</span><span>Agree (7)</span></div>
        </div>
        <div>
          <label class="block text-sm text-text mb-1">I am cooperative, helpful, and forgiving.</label>
          <input type="range" id="pt3-a2" class="pt3-in w-full" min="1" max="7" step="1">
          <div class="flex justify-between text-xs text-text-secondary"><span>Disagree (1)</span><span>Agree (7)</span></div>
        </div>

        <h3 class="font-semibold text-text mt-2">Neuroticism (Emotional Stability)</h3>
        <div>
          <label class="block text-sm text-text mb-1">I often feel anxious, worried, or stressed.</label>
          <input type="range" id="pt3-n1" class="pt3-in w-full" min="1" max="7" step="1">
          <div class="flex justify-between text-xs text-text-secondary"><span>Disagree (1)</span><span>Agree (7)</span></div>
        </div>
        <div>
          <label class="block text-sm text-text mb-1">I am easily upset or moody.</label>
          <input type="range" id="pt3-n2" class="pt3-in w-full" min="1" max="7" step="1">
          <div class="flex justify-between text-xs text-text-secondary"><span>Disagree (1)</span><span>Agree (7)</span></div>
        </div>
      </div>

      <div class="mt-6 space-y-3">
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm opacity-80">Personality Profile</div>
          <div class="text-2xl font-extrabold mt-1" id="pt3-profile">--</div>
        </div>

        <div class="space-y-2" id="pt3-bars">
          <div class="flex items-center gap-2">
            <span class="w-8 text-xs font-bold text-right">O</span>
            <div class="flex-1 bg-gray-200 rounded-full h-5 overflow-hidden"><div id="pt3-bar-o" class="h-full bg-blue-500 rounded-full transition-all" style="width:50%"></div></div>
            <span class="w-16 text-xs text-right" id="pt3-pct-o">--</span>
          </div>
          <div class="flex items-center gap-2">
            <span class="w-8 text-xs font-bold text-right">C</span>
            <div class="flex-1 bg-gray-200 rounded-full h-5 overflow-hidden"><div id="pt3-bar-c" class="h-full bg-green-500 rounded-full transition-all" style="width:50%"></div></div>
            <span class="w-16 text-xs text-right" id="pt3-pct-c">--</span>
          </div>
          <div class="flex items-center gap-2">
            <span class="w-8 text-xs font-bold text-right">E</span>
            <div class="flex-1 bg-gray-200 rounded-full h-5 overflow-hidden"><div id="pt3-bar-e" class="h-full bg-yellow-500 rounded-full transition-all" style="width:50%"></div></div>
            <span class="w-16 text-xs text-right" id="pt3-pct-e">--</span>
          </div>
          <div class="flex items-center gap-2">
            <span class="w-8 text-xs font-bold text-right">A</span>
            <div class="flex-1 bg-gray-200 rounded-full h-5 overflow-hidden"><div id="pt3-bar-a" class="h-full bg-pink-500 rounded-full transition-all" style="width:50%"></div></div>
            <span class="w-16 text-xs text-right" id="pt3-pct-a">--</span>
          </div>
          <div class="flex items-center gap-2">
            <span class="w-8 text-xs font-bold text-right">N</span>
            <div class="flex-1 bg-gray-200 rounded-full h-5 overflow-hidden"><div id="pt3-bar-n" class="h-full bg-red-500 rounded-full transition-all" style="width:50%"></div></div>
            <span class="w-16 text-xs text-right" id="pt3-pct-n">--</span>
          </div>
        </div>

        <div class="p-4 bg-surface-alt rounded-xl">
          <div class="text-xs text-text-secondary mb-2">Profile Summary</div>
          <div class="text-sm text-text" id="pt3-summary">--</div>
        </div>
      </div>

      <ShareButton calculatorId="personality-trait" />
      <FeedbackWidget />
    </div>

    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    function calcPT3() {
      const o = (parseInt((document.getElementById('pt3-o1') as HTMLInputElement).value) || 4) + (parseInt((document.getElementById('pt3-o2') as HTMLInputElement).value) || 4);
      const c = (parseInt((document.getElementById('pt3-c1') as HTMLInputElement).value) || 4) + (parseInt((document.getElementById('pt3-c2') as HTMLInputElement).value) || 4);
      const e = (parseInt((document.getElementById('pt3-e1') as HTMLInputElement).value) || 4) + (parseInt((document.getElementById('pt3-e2') as HTMLInputElement).value) || 4);
      const a = (parseInt((document.getElementById('pt3-a1') as HTMLInputElement).value) || 4) + (parseInt((document.getElementById('pt3-a2') as HTMLInputElement).value) || 4);
      const n = (parseInt((document.getElementById('pt3-n1') as HTMLInputElement).value) || 4) + (parseInt((document.getElementById('pt3-n2') as HTMLInputElement).value) || 4);

      // Convert to percentile (2-14 scale, mean ~8, sd ~2.5)
      function toPct(score: number): number {
        const z = (score - 8) / 2.5;
        const p = 50 + z * 34;
        return Math.min(99, Math.max(1, Math.round(p)));
      }

      const pctO = toPct(o), pctC = toPct(c), pctE = toPct(e), pctA = toPct(a), pctN = toPct(n);

      // Update bars
      (document.getElementById('pt3-bar-o') as HTMLElement).style.width = pctO + '%';
      (document.getElementById('pt3-bar-c') as HTMLElement).style.width = pctC + '%';
      (document.getElementById('pt3-bar-e') as HTMLElement).style.width = pctE + '%';
      (document.getElementById('pt3-bar-a') as HTMLElement).style.width = pctA + '%';
      (document.getElementById('pt3-bar-n') as HTMLElement).style.width = pctN + '%';

      document.getElementById('pt3-pct-o')!.textContent = pctO + 'th %ile';
      document.getElementById('pt3-pct-c')!.textContent = pctC + 'th %ile';
      document.getElementById('pt3-pct-e')!.textContent = pctE + 'th %ile';
      document.getElementById('pt3-pct-a')!.textContent = pctA + 'th %ile';
      document.getElementById('pt3-pct-n')!.textContent = pctN + 'th %ile';

      // Determine dominant trait
      const traits = [
        { name: 'Openness', pct: pctO },
        { name: 'Conscientiousness', pct: pctC },
        { name: 'Extraversion', pct: pctE },
        { name: 'Agreeableness', pct: pctA },
        { name: 'Neuroticism', pct: pctN },
      ];
      traits.sort((a, b) => b.pct - a.pct);
      const top = traits[0].name;
      const low = traits[4].name;

      document.getElementById('pt3-profile')!.textContent = 'Highest: ' + top;

      let summary = 'Your strongest trait is ' + top + ' (high scorers tend to ';
      const traitDescs: Record<string, string> = {
        Openness: 'be creative, curious, and open to new experiences',
        Conscientiousness: 'be organized, reliable, and goal-oriented',
        Extraversion: 'be sociable, energetic, and assertive',
        Agreeableness: 'be compassionate, cooperative, and trusting',
        Neuroticism: 'experience more emotional variability and stress sensitivity',
      };
      summary += traitDescs[top] + '). Your lowest trait is ' + low + '. ';

      if (pctC > 70 && pctN < 40) summary += 'This combination (high C, low N) is associated with strong job performance and life satisfaction. ';
      if (pctO > 70 && pctE > 70) summary += 'High Openness combined with Extraversion often characterizes creative leaders and entrepreneurs. ';
      if (pctN > 70) summary += 'Higher neuroticism may benefit from stress-management practices and mindfulness. ';
      summary += 'Note: All trait levels are normal and have adaptive advantages in different contexts.';

      document.getElementById('pt3-summary')!.textContent = summary;

      document.dispatchEvent(new CustomEvent('calc-update'));
    }

    setTimeout(() => {
      const ids = ['pt3-o1','pt3-o2','pt3-c1','pt3-c2','pt3-e1','pt3-e2','pt3-a1','pt3-a2','pt3-n1','pt3-n2'];
      ids.forEach(id => { (document.getElementById(id) as HTMLInputElement).value = '4'; });
      document.querySelectorAll('.pt3-in').forEach(el => {
        el.addEventListener('input', calcPT3);
        el.addEventListener('change', calcPT3);
      });
      calcPT3();
    }, 50);
  </script>
</CalculatorLayout>
