---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Paper Weight Calculator - GSM, Bond, Cover, Text & Index Converter";
const description = "Convert between paper weight systems: GSM (g/m2), US Bond, Cover, Text, and Index weights. Understand paper thickness and equivalent weights.";
const relatedCalcs = [
  { name: "Spine Width Calculator", url: "/spine-width-calculator", description: "Book spine from paper weight." },
  { name: "Print Cost Calculator", url: "/print-cost-calculator", description: "Print job cost estimator." },
  { name: "Envelope Calculator", url: "/envelope-calculator", description: "Envelope sizing and weight." },
  { name: "Book Binding Calculator", url: "/book-binding-calculator", description: "Binding method costs." },
  { name: "Bleed Margin Calculator", url: "/bleed-margin-calculator", description: "Print bleed calculations." },
  { name: "Paper Fold Calculator", url: "/paper-fold-calculator", description: "Fold types and panel sizes." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Paper Weight Calculator" keywords="paper weight converter, GSM, bond weight, cover weight, text weight, index weight, paper thickness, grams per square meter" breadcrumbs={[{ name: "Paper Weight Calculator", url: "/paper-weight-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Paper Weight Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Convert between paper weight systems including GSM, US Bond, Cover, Text, and Index. Understand equivalent weights across systems.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Weight Value</label><input type="number" id="pw2-value" class="pw2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="0" step="1"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Weight System</label>
            <select id="pw2-system" class="pw2-in w-full px-4 py-3 border border-border rounded-xl text-lg">
              <option value="gsm">GSM (g/m2)</option>
              <option value="bond">US Bond (lb)</option>
              <option value="text">US Text (lb)</option>
              <option value="cover">US Cover (lb)</option>
              <option value="index">US Index (lb)</option>
            </select>
          </div>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">GSM Equivalent</div>
          <div class="text-5xl font-extrabold font-mono" id="pw2-result">0</div>
          <div class="text-sm text-blue-200 mt-1">grams per square meter</div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Bond (lb)</div><div class="text-xl font-bold" id="pw2-bond">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Text (lb)</div><div class="text-xl font-bold" id="pw2-text">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Cover (lb)</div><div class="text-xl font-bold" id="pw2-cover">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Index (lb)</div><div class="text-xl font-bold" id="pw2-index">--</div></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Approx. Thickness (mm per sheet)</div><div class="text-xl font-bold" id="pw2-thickness">--</div></div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-2">Common Equivalents</h3>
          <div class="font-mono text-sm space-y-1" id="pw2-steps"></div>
        </div>
      </div>
      <ShareButton calculatorId="paper-weight" />
      <FeedbackWidget />
    </div>
    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">Paper Weight Conversion Factors</h2>
      <div class="bg-surface-alt rounded-xl p-4 my-4 font-mono text-sm space-y-1">
        <p>Bond basis: 17 x 22 in (1 lb bond = 3.76 GSM)</p>
        <p>Text basis: 25 x 38 in (1 lb text = 1.48 GSM)</p>
        <p>Cover basis: 20 x 26 in (1 lb cover = 2.70 GSM)</p>
        <p>Index basis: 25.5 x 30.5 in (1 lb index = 1.81 GSM)</p>
        <p>Thickness: approx GSM x 0.001 mm (varies by paper type)</p>
      </div>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcPw2() {
      const value = parseFloat((document.getElementById('pw2-value') as HTMLInputElement).value) || 0;
      const system = (document.getElementById('pw2-system') as HTMLSelectElement).value;
      const bondFactor = 3.7603;
      const textFactor = 1.4802;
      const coverFactor = 2.7044;
      const indexFactor = 1.8103;
      let gsm = 0;
      if (system === 'gsm') gsm = value;
      else if (system === 'bond') gsm = value * bondFactor;
      else if (system === 'text') gsm = value * textFactor;
      else if (system === 'cover') gsm = value * coverFactor;
      else if (system === 'index') gsm = value * indexFactor;
      const bond = gsm / bondFactor;
      const text = gsm / textFactor;
      const cover = gsm / coverFactor;
      const index = gsm / indexFactor;
      const thickness = gsm * 0.001;
      const steps: string[] = [];
      steps.push('20 lb Bond = 75 GSM = 50 lb Text (copy paper)');
      steps.push('24 lb Bond = 90 GSM = 60 lb Text (letterhead)');
      steps.push('28 lb Bond = 105 GSM = 70 lb Text (resume)');
      steps.push('65 lb Cover = 176 GSM (light card stock)');
      steps.push('80 lb Cover = 216 GSM (business card)');
      steps.push('100 lb Cover = 270 GSM (heavy card stock)');
      steps.push('110 lb Index = 199 GSM (index card)');
      document.getElementById('pw2-result')!.textContent = gsm.toFixed(1);
      document.getElementById('pw2-bond')!.textContent = bond.toFixed(1) + ' lb';
      document.getElementById('pw2-text')!.textContent = text.toFixed(1) + ' lb';
      document.getElementById('pw2-cover')!.textContent = cover.toFixed(1) + ' lb';
      document.getElementById('pw2-index')!.textContent = index.toFixed(1) + ' lb';
      document.getElementById('pw2-thickness')!.textContent = thickness.toFixed(3) + ' mm';
      document.getElementById('pw2-steps')!.innerHTML = steps.map(s => '<div>' + s + '</div>').join('');
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      (document.getElementById('pw2-value') as HTMLInputElement).value = '80';
      document.querySelectorAll('.pw2-in').forEach(el => { el.addEventListener('input', calcPw2); el.addEventListener('change', calcPw2); });
      calcPw2();
    }, 50);
  </script>
</CalculatorLayout>
