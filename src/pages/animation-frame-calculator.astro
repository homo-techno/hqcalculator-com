---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Animation Frame Calculator - Frames, Timing & Drawing Count";
const description = "Calculate total animation frames from duration and FPS. Plan ones, twos, and threes timing, scene breakdowns, and total drawing counts for animation projects.";
const relatedCalcs = [
  { name: "Video Frame Rate", url: "/video-frame-rate-calculator", description: "Frame rate conversions." },
  { name: "Video Bitrate", url: "/video-bitrate-calculator", description: "File size from bitrate." },
  { name: "Timelapse", url: "/timelapse-calculator", description: "Timelapse frame planning." },
  { name: "Reading Time", url: "/reading-time-calculator", description: "Duration estimates." },
  { name: "Video Storage", url: "/video-storage-calculator", description: "Storage for animation." },
  { name: "Aspect Ratio", url: "/aspect-ratio-calculator", description: "Frame aspect ratios." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Animation Frame Calculator" keywords="animation frame calculator, animation timing, ones twos threes, drawing count, animation fps, scene breakdown, frame count" breadcrumbs={[{ name: "Animation Frames", url: "/animation-frame-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Animation Frame Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate total frames, unique drawings, and timing for animation projects on ones, twos, or threes.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-text mb-1">Output Frame Rate (fps)</label>
          <select id="an-fps" class="an-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="12">12 fps (Web animation)</option>
            <option value="24" selected>24 fps (Film standard)</option>
            <option value="25">25 fps (PAL)</option>
            <option value="30">30 fps (NTSC)</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Duration</label>
          <div class="grid grid-cols-3 gap-2">
            <div>
              <label class="block text-xs text-text-secondary">Minutes</label>
              <input type="number" id="an-mins" class="an-in w-full px-4 py-3 border border-border rounded-xl text-lg" value="1" min="0" step="1">
            </div>
            <div>
              <label class="block text-xs text-text-secondary">Seconds</label>
              <input type="number" id="an-secs" class="an-in w-full px-4 py-3 border border-border rounded-xl text-lg" value="30" min="0" step="1">
            </div>
            <div>
              <label class="block text-xs text-text-secondary">Frames</label>
              <input type="number" id="an-frames" class="an-in w-full px-4 py-3 border border-border rounded-xl text-lg" value="0" min="0" step="1">
            </div>
          </div>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Animation Timing</label>
          <select id="an-timing" class="an-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="1">On Ones (every frame unique)</option>
            <option value="2" selected>On Twos (1 drawing per 2 frames)</option>
            <option value="3">On Threes (1 drawing per 3 frames)</option>
            <option value="4">On Fours (limited animation)</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Held Frames (% of total)</label>
          <input type="number" id="an-held" class="an-in w-full px-4 py-3 border border-border rounded-xl text-lg" value="15" min="0" max="90" step="5">
          <p class="text-xs text-text-secondary mt-1">Static frames with no movement (dialogue pauses, still shots)</p>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Number of Scenes</label>
          <input type="number" id="an-scenes" class="an-in w-full px-4 py-3 border border-border rounded-xl text-lg" value="12" min="1" step="1">
        </div>

        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Unique Drawings Needed</div>
          <div class="text-4xl font-extrabold" id="an-drawings"></div>
        </div>

        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-secondary uppercase tracking-wide">Total Frames</div>
            <div class="text-xl font-bold text-text" id="an-total"></div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-secondary uppercase tracking-wide">Effective FPS (drawings)</div>
            <div class="text-xl font-bold text-text" id="an-eff-fps"></div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-secondary uppercase tracking-wide">Drawings per Scene (avg)</div>
            <div class="text-xl font-bold text-text" id="an-per-scene"></div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-secondary uppercase tracking-wide">Avg Scene Duration</div>
            <div class="text-xl font-bold text-text" id="an-scene-dur"></div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-secondary uppercase tracking-wide">Held Frames</div>
            <div class="text-xl font-bold text-text" id="an-held-count"></div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-secondary uppercase tracking-wide">Animated Frames</div>
            <div class="text-xl font-bold text-text" id="an-animated"></div>
          </div>
        </div>

        <div class="p-4 bg-surface-alt rounded-xl">
          <h4 class="font-semibold text-sm text-text mb-2">Timing Comparison</h4>
          <div class="text-sm text-text-secondary space-y-1" id="an-compare"></div>
        </div>
      </div>
      <ShareButton calculatorId="animation-frame" />
      <FeedbackWidget />
    </div>

    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">Animation Timing Explained</h2>
      <p><strong>On Ones:</strong> Every frame is a unique drawing (24 drawings per second at 24fps). Used for fast action and fluid Disney-style animation.</p>
      <p><strong>On Twos:</strong> Each drawing is held for 2 frames (12 unique drawings per second at 24fps). The standard for most anime and traditional animation.</p>
      <p><strong>On Threes:</strong> Each drawing held for 3 frames (8 unique per second). Used for slow movements, background characters, or limited animation styles.</p>
    </article>

    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    function calcAN() {
      const fps = parseInt((document.getElementById('an-fps') as HTMLSelectElement).value);
      const mins = parseInt((document.getElementById('an-mins') as HTMLInputElement).value) || 0;
      const secs = parseInt((document.getElementById('an-secs') as HTMLInputElement).value) || 0;
      const extraFrames = parseInt((document.getElementById('an-frames') as HTMLInputElement).value) || 0;
      const timing = parseInt((document.getElementById('an-timing') as HTMLSelectElement).value);
      const heldPct = parseFloat((document.getElementById('an-held') as HTMLInputElement).value) || 0;
      const scenes = parseInt((document.getElementById('an-scenes') as HTMLInputElement).value) || 1;

      const totalFrames = (mins * 60 + secs) * fps + extraFrames;
      const heldFrames = Math.round(totalFrames * heldPct / 100);
      const animatedFrames = totalFrames - heldFrames;
      const uniqueDrawings = Math.ceil(animatedFrames / timing) + (heldFrames > 0 ? Math.ceil(scenes * 0.5) : 0);

      document.getElementById('an-drawings')!.textContent = uniqueDrawings.toLocaleString() + ' drawings';
      document.getElementById('an-total')!.textContent = totalFrames.toLocaleString();
      document.getElementById('an-eff-fps')!.textContent = (fps / timing).toFixed(1) + ' fps';
      document.getElementById('an-per-scene')!.textContent = Math.round(uniqueDrawings / scenes).toString();

      const sceneDurSec = (totalFrames / fps) / scenes;
      document.getElementById('an-scene-dur')!.textContent = sceneDurSec.toFixed(1) + 's';
      document.getElementById('an-held-count')!.textContent = heldFrames.toLocaleString();
      document.getElementById('an-animated')!.textContent = animatedFrames.toLocaleString();

      // Comparison
      const timings = [
        { name: 'On Ones', t: 1 },
        { name: 'On Twos', t: 2 },
        { name: 'On Threes', t: 3 },
        { name: 'On Fours', t: 4 },
      ];

      let html = '';
      timings.forEach(tm => {
        const dr = Math.ceil(animatedFrames / tm.t) + (heldFrames > 0 ? Math.ceil(scenes * 0.5) : 0);
        const marker = tm.t === timing ? ' \u2190 selected' : '';
        html += '<div class="flex justify-between"><span>' + tm.name + ' (' + (fps / tm.t).toFixed(0) + ' drawings/sec)</span><span class="font-bold">' + dr.toLocaleString() + ' drawings' + marker + '</span></div>';
      });
      document.getElementById('an-compare')!.innerHTML = html;

      document.dispatchEvent(new CustomEvent('calc-update'));
    }

    setTimeout(() => {
      document.querySelectorAll('.an-in').forEach(el => {
        el.addEventListener('input', calcAN);
        el.addEventListener('change', calcAN);
      });
      calcAN();
    }, 50);
  </script>
</CalculatorLayout>
