---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Mohs Hardness Calculator - Scale Comparison & Mineral ID";
const description = "Compare Mohs hardness scale values, absolute hardness, scratch test guide, and identify minerals by hardness for geology studies.";
const relatedCalcs = [
  { name: "Density Calculator", url: "/density-calculator", description: "Material density." },
  { name: "Force Calculator", url: "/force-calculator", description: "Force calculations." },
  { name: "Friction Calculator", url: "/friction-calculator", description: "Friction forces." },
  { name: "Weight Converter", url: "/weight-converter", description: "Weight units." },
  { name: "Pressure Converter", url: "/pressure-converter", description: "Pressure units." },
  { name: "Percentage Calculator", url: "/percentage-calculator", description: "Percentage math." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Mohs Hardness Calculator" keywords="Mohs hardness, mineral hardness, scratch test, absolute hardness, mineral identification, geology" breadcrumbs={[{ name: "Mohs Hardness", url: "/mohs-hardness-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Mohs Hardness Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Explore the Mohs hardness scale, compare absolute hardness values, and use scratch test guides for mineral identification.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-text mb-1">Select Mineral or Enter Hardness</label>
          <select id="mh2-mineral" class="mh2-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="1">1 - Talc</option>
            <option value="2">2 - Gypsum</option>
            <option value="3">3 - Calcite</option>
            <option value="4">4 - Fluorite</option>
            <option value="5">5 - Apatite</option>
            <option value="6">6 - Orthoclase (Feldspar)</option>
            <option value="7" selected>7 - Quartz</option>
            <option value="8">8 - Topaz</option>
            <option value="9">9 - Corundum (Sapphire/Ruby)</option>
            <option value="10">10 - Diamond</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Custom Hardness (1-10)</label>
          <input type="number" id="mh2-custom" class="mh2-in w-full px-4 py-3 border border-border rounded-xl text-lg" value="7" min="1" max="10" step="0.5">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Compare With</label>
          <select id="mh2-compare" class="mh2-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="2.5">Fingernail (2.5)</option>
            <option value="3.5">Copper Penny (3.5)</option>
            <option value="4.5">Iron Nail (4.5)</option>
            <option value="5.5" selected>Glass Plate (5.5)</option>
            <option value="6.5">Steel File (6.5)</option>
            <option value="7">Quartz (7)</option>
          </select>
        </div>
      </div>

      <div class="mt-6 space-y-3">
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Mohs Hardness</div>
          <div class="text-4xl font-extrabold" id="mh2-mohs">7</div>
          <div class="text-sm text-blue-200 mt-1" id="mh2-name">Quartz</div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Absolute Hardness</div>
            <div class="text-xl font-bold" id="mh2-absolute">100</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Vickers (approx HV)</div>
            <div class="text-xl font-bold" id="mh2-vickers">0</div>
          </div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Scratch Test Result</div>
          <div class="text-xl font-bold" id="mh2-scratch">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Common Uses</div>
          <div class="text-sm" id="mh2-uses">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <div class="text-xs text-text-muted uppercase mb-2">Mohs Scale Reference</div>
          <div class="space-y-1 text-xs" id="mh2-scale"></div>
        </div>
      </div>

      <ShareButton calculatorId="mohs-hardness" />
      <FeedbackWidget />
    </div>

    <article class="mt-12 max-w-4xl prose prose-slate">
      <h2 class="text-2xl font-bold text-text">Understanding Mohs Hardness Scale</h2>
      <p>The Mohs scale of mineral hardness is a qualitative ordinal scale from 1 to 10 that characterizes the scratch resistance of minerals. A mineral can scratch any mineral with a lower number but cannot scratch one with a higher number.</p>
      <div class="bg-surface-alt rounded-xl p-4 my-4 font-mono text-sm space-y-1">
        <p><strong>Absolute Hardness</strong> is measured with a sclerometer and shows exponential increase</p>
        <p><strong>Diamond (10)</strong> has absolute hardness of 1500, while Talc (1) is only 1</p>
      </div>
    </article>

    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    function calcMH2() {
      const mineralData: Record<string, { name: string; abs: number; vickers: number; uses: string }> = {
        '1': { name: 'Talc', abs: 1, vickers: 30, uses: 'Talcum powder, ceramics, paint filler' },
        '2': { name: 'Gypsum', abs: 3, vickers: 36, uses: 'Drywall, plaster, fertilizer' },
        '3': { name: 'Calcite', abs: 9, vickers: 100, uses: 'Cement, limestone, optical instruments' },
        '4': { name: 'Fluorite', abs: 21, vickers: 200, uses: 'Flux in steelmaking, optics, ornamental' },
        '5': { name: 'Apatite', abs: 48, vickers: 540, uses: 'Fertilizer, gemstones, bone implants' },
        '6': { name: 'Orthoclase', abs: 72, vickers: 800, uses: 'Ceramics, glass, abrasives' },
        '7': { name: 'Quartz', abs: 100, vickers: 1120, uses: 'Glass, electronics, watches, countertops' },
        '8': { name: 'Topaz', abs: 200, vickers: 1430, uses: 'Gemstones, abrasives, refractory materials' },
        '9': { name: 'Corundum', abs: 400, vickers: 2060, uses: 'Sapphires/rubies, emery, watch bearings' },
        '10': { name: 'Diamond', abs: 1500, vickers: 10000, uses: 'Cutting tools, jewelry, drill bits, abrasives' }
      };

      const mohs = (document.getElementById('mh2-mineral') as HTMLSelectElement).value;
      const custom = parseFloat((document.getElementById('mh2-custom') as HTMLInputElement).value) || 7;
      const compareH = parseFloat((document.getElementById('mh2-compare') as HTMLSelectElement).value) || 5.5;

      const effectiveHardness = custom;
      const nearestInt = Math.round(effectiveHardness).toString();
      const data = mineralData[nearestInt] || mineralData['7'];

      const lowerInt = Math.floor(effectiveHardness);
      const upperInt = Math.ceil(effectiveHardness);
      const lowerData = mineralData[lowerInt.toString()] || mineralData['1'];
      const upperData = mineralData[upperInt.toString()] || mineralData['10'];
      const frac = effectiveHardness - lowerInt;
      const interpAbs = lowerInt === upperInt ? lowerData.abs : lowerData.abs + frac * (upperData.abs - lowerData.abs);
      const interpVickers = lowerInt === upperInt ? lowerData.vickers : lowerData.vickers + frac * (upperData.vickers - lowerData.vickers);

      let scratchResult = '';
      if (effectiveHardness > compareH) {
        scratchResult = 'Your mineral SCRATCHES the test object (harder)';
      } else if (effectiveHardness < compareH) {
        scratchResult = 'The test object scratches YOUR mineral (softer)';
      } else {
        scratchResult = 'Equal hardness - may leave faint marks on each other';
      }

      document.getElementById('mh2-mohs')!.textContent = effectiveHardness.toString();
      document.getElementById('mh2-name')!.textContent = data.name;
      document.getElementById('mh2-absolute')!.textContent = Math.round(interpAbs).toString();
      document.getElementById('mh2-vickers')!.textContent = Math.round(interpVickers).toString() + ' HV';
      document.getElementById('mh2-scratch')!.textContent = scratchResult;
      document.getElementById('mh2-uses')!.textContent = data.uses;

      const scaleEl = document.getElementById('mh2-scale')!;
      let scaleHtml = '';
      for (let i = 1; i <= 10; i++) {
        const d = mineralData[i.toString()];
        const isActive = Math.round(effectiveHardness) === i;
        const barWidth = (d.abs / 1500 * 100).toFixed(1);
        scaleHtml += '<div class="flex items-center gap-2' + (isActive ? ' font-bold text-primary' : '') + '">';
        scaleHtml += '<span class="w-4 text-right">' + i + '</span>';
        scaleHtml += '<div class="flex-1 bg-gray-200 rounded-full h-2"><div class="h-2 rounded-full ' + (isActive ? 'bg-primary' : 'bg-gray-400') + '" style="width:' + barWidth + '%"></div></div>';
        scaleHtml += '<span class="w-20 truncate">' + d.name + '</span>';
        scaleHtml += '</div>';
      }
      scaleEl.innerHTML = scaleHtml;

      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.mh2-in').forEach(el => { el.addEventListener('input', calcMH2); el.addEventListener('change', calcMH2); });
      calcMH2();
    }, 50);
  </script>
</CalculatorLayout>
