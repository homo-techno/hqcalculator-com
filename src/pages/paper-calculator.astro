---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';

const title = "Paper Calculator - Usage, Cost & Environmental Impact 2026";
const description = "Calculate your paper usage, cost per month and year, and see how many trees you could save by going digital. Plan your office paper budget.";

const relatedCalcs = [
  { name: "Electricity Usage Calculator", url: "/electricity-usage-calculator", description: "Appliance electricity cost." },
  { name: "Water Usage Calculator", url: "/water-usage-calculator", description: "Track water usage." },
  { name: "Budget Calculator", url: "/budget-calculator", description: "Monthly budget planner." },
  { name: "Electricity Bill Calculator", url: "/electricity-bill-calculator", description: "Monthly electricity bill." },
  { name: "Screen Time Calculator", url: "/screen-time-calculator", description: "Track screen time." },
  { name: "Noise Reduction Calculator", url: "/noise-reduction-calculator", description: "Noise level reduction." },
];
---

<CalculatorLayout
  title={title}
  description={description}
  calculatorName="Paper Calculator"
  keywords="paper calculator, paper usage, cost per ream, office paper, trees saved, environmental impact, paper budget"
  breadcrumbs={[{ name: "Paper Calculator", url: "/paper-calculator" }]}
>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Paper Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Track paper usage, estimate costs, and see the environmental impact of going paperless.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div>
          <label for="pp2-pages" class="block text-sm font-medium text-text mb-1">Pages Printed Per Day</label>
          <input type="number" id="pp2-pages" class="pp2-in w-full border border-border rounded-lg px-3 py-2" value="25" min="0" step="1" />
        </div>
        <div>
          <label for="pp2-days" class="block text-sm font-medium text-text mb-1">Printing Days Per Week</label>
          <input type="number" id="pp2-days" class="pp2-in w-full border border-border rounded-lg px-3 py-2" value="5" min="1" max="7" step="1" />
        </div>
        <div>
          <label for="pp2-cost" class="block text-sm font-medium text-text mb-1">Cost Per Ream (500 sheets, $)</label>
          <input type="number" id="pp2-cost" class="pp2-in w-full border border-border rounded-lg px-3 py-2" value="8.00" min="0" step="0.50" />
        </div>
        <div>
          <label for="pp2-ink" class="block text-sm font-medium text-text mb-1">Ink/Toner Cost Per Page ($)</label>
          <input type="number" id="pp2-ink" class="pp2-in w-full border border-border rounded-lg px-3 py-2" value="0.05" min="0" step="0.01" />
          <p class="text-xs text-text-muted mt-1">Typical: $0.03-0.08 for laser, $0.05-0.20 for inkjet</p>
        </div>
        <div>
          <label for="pp2-duplex" class="block text-sm font-medium text-text mb-1">Double-sided Printing?</label>
          <select id="pp2-duplex" class="pp2-in w-full border border-border rounded-lg px-3 py-2">
            <option value="1">No (single-sided)</option>
            <option value="2">Yes (double-sided)</option>
          </select>
        </div>

        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Monthly Paper Cost</div>
          <div class="text-5xl font-extrabold font-mono" id="pp2-result">$0.00</div>
        </div>

        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Monthly Sheets</div>
            <div class="text-xl font-bold" id="pp2-monthly-sheets">0</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Monthly Reams</div>
            <div class="text-xl font-bold" id="pp2-monthly-reams">0</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Annual Cost (Paper + Ink)</div>
            <div class="text-xl font-bold" id="pp2-annual-cost">$0</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Annual Reams</div>
            <div class="text-xl font-bold" id="pp2-annual-reams">0</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Trees Saved if Digital</div>
            <div class="text-xl font-bold text-green-600" id="pp2-trees">0</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">CO2 Saved (lbs/yr)</div>
            <div class="text-xl font-bold text-green-600" id="pp2-co2">0</div>
          </div>
        </div>
      </div>

      <ShareButton calculatorId="paper" />
      <FeedbackWidget />
    </div>

    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    function calcPP2() {
      const pagesPerDay = parseInt((document.getElementById('pp2-pages') as HTMLInputElement).value) || 0;
      const daysPerWeek = parseInt((document.getElementById('pp2-days') as HTMLInputElement).value) || 5;
      const costPerReam = parseFloat((document.getElementById('pp2-cost') as HTMLInputElement).value) || 0;
      const inkPerPage = parseFloat((document.getElementById('pp2-ink') as HTMLInputElement).value) || 0;
      const duplex = parseInt((document.getElementById('pp2-duplex') as HTMLSelectElement).value) || 1;

      // Sheets used: if duplex, 2 pages per sheet
      const sheetsPerDay = Math.ceil(pagesPerDay / duplex);
      const weeksPerMonth = 4.35;
      const monthlySheets = Math.round(sheetsPerDay * daysPerWeek * weeksPerMonth);
      const annualSheets = sheetsPerDay * daysPerWeek * 52;

      const monthlyReams = monthlySheets / 500;
      const annualReams = annualSheets / 500;

      const monthlyPaperCost = monthlyReams * costPerReam;
      const monthlyInkCost = pagesPerDay * daysPerWeek * weeksPerMonth * inkPerPage;
      const monthlyTotalCost = monthlyPaperCost + monthlyInkCost;
      const annualTotalCost = monthlyTotalCost * 12;

      // Environmental impact: 1 tree makes ~8,333 sheets of paper, 1 ream ~ 6 lbs CO2
      const treesSaved = annualSheets / 8333;
      const co2Saved = annualReams * 6;

      const fmt = (n: number) => '$' + n.toFixed(2);

      (document.getElementById('pp2-result') as HTMLElement).textContent = fmt(monthlyTotalCost);
      (document.getElementById('pp2-monthly-sheets') as HTMLElement).textContent = monthlySheets.toLocaleString('en-US');
      (document.getElementById('pp2-monthly-reams') as HTMLElement).textContent = monthlyReams.toFixed(1);
      (document.getElementById('pp2-annual-cost') as HTMLElement).textContent = '$' + Math.round(annualTotalCost).toLocaleString('en-US');
      (document.getElementById('pp2-annual-reams') as HTMLElement).textContent = annualReams.toFixed(1);
      (document.getElementById('pp2-trees') as HTMLElement).textContent = treesSaved.toFixed(2);
      (document.getElementById('pp2-co2') as HTMLElement).textContent = Math.round(co2Saved).toLocaleString('en-US');

      document.dispatchEvent(new CustomEvent('calc-update'));
    }

    setTimeout(() => {
      document.querySelectorAll('.pp2-in').forEach(el => {
        el.addEventListener('input', calcPP2);
        el.addEventListener('change', calcPP2);
      });
      calcPP2();
    }, 50);
  </script>
</CalculatorLayout>
