---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Stress Level Calculator - Perceived Stress Scale (PSS-10)";
const description = "Calculate your stress level using the Perceived Stress Scale (PSS-10). Get your stress category, cortisol impact estimate, and coping recommendations.";
const relatedCalcs = [
  { name: "Sleep Calculator", url: "/sleep-calculator", description: "Optimize sleep cycles." },
  { name: "Blood Pressure", url: "/blood-pressure-calculator", description: "BP classification." },
  { name: "Heart Rate Calculator", url: "/heart-rate-calculator", description: "Heart rate zones." },
  { name: "BMI Calculator", url: "/bmi-calculator", description: "Body mass index." },
  { name: "Calorie Calculator", url: "/calorie-calculator", description: "Daily calorie needs." },
  { name: "Water Intake", url: "/water-intake-calculator", description: "Daily hydration." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Stress Level Calculator" keywords="stress level, PSS-10, perceived stress scale, stress score, cortisol, stress management, coping" breadcrumbs={[{ name: "Stress Level", url: "/stress-level-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Stress Level Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Answer the PSS-10 questions to assess your perceived stress level over the past month.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <p class="text-sm text-text-secondary mb-4">Rate each item from 0 (Never) to 4 (Very Often) based on the last month.</p>
      <div class="space-y-4" id="sl3-questions">
        <div>
          <label class="block text-sm font-medium text-text mb-1">1. How often have you been upset because of something unexpected?</label>
          <input type="range" id="sl3-q1" class="sl3-in w-full" min="0" max="4" step="1">
          <div class="flex justify-between text-xs text-text-secondary"><span>Never (0)</span><span>Very Often (4)</span></div>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">2. How often have you felt unable to control important things?</label>
          <input type="range" id="sl3-q2" class="sl3-in w-full" min="0" max="4" step="1">
          <div class="flex justify-between text-xs text-text-secondary"><span>Never (0)</span><span>Very Often (4)</span></div>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">3. How often have you felt nervous and stressed?</label>
          <input type="range" id="sl3-q3" class="sl3-in w-full" min="0" max="4" step="1">
          <div class="flex justify-between text-xs text-text-secondary"><span>Never (0)</span><span>Very Often (4)</span></div>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">4. How often have you felt confident about handling personal problems? (reverse)</label>
          <input type="range" id="sl3-q4" class="sl3-in w-full" min="0" max="4" step="1">
          <div class="flex justify-between text-xs text-text-secondary"><span>Never (0)</span><span>Very Often (4)</span></div>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">5. How often have you felt things were going your way? (reverse)</label>
          <input type="range" id="sl3-q5" class="sl3-in w-full" min="0" max="4" step="1">
          <div class="flex justify-between text-xs text-text-secondary"><span>Never (0)</span><span>Very Often (4)</span></div>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">6. How often have you found you could not cope with all the things you had to do?</label>
          <input type="range" id="sl3-q6" class="sl3-in w-full" min="0" max="4" step="1">
          <div class="flex justify-between text-xs text-text-secondary"><span>Never (0)</span><span>Very Often (4)</span></div>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">7. How often have you been able to control irritations in your life? (reverse)</label>
          <input type="range" id="sl3-q7" class="sl3-in w-full" min="0" max="4" step="1">
          <div class="flex justify-between text-xs text-text-secondary"><span>Never (0)</span><span>Very Often (4)</span></div>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">8. How often have you felt you were on top of things? (reverse)</label>
          <input type="range" id="sl3-q8" class="sl3-in w-full" min="0" max="4" step="1">
          <div class="flex justify-between text-xs text-text-secondary"><span>Never (0)</span><span>Very Often (4)</span></div>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">9. How often have you been angered by things outside your control?</label>
          <input type="range" id="sl3-q9" class="sl3-in w-full" min="0" max="4" step="1">
          <div class="flex justify-between text-xs text-text-secondary"><span>Never (0)</span><span>Very Often (4)</span></div>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">10. How often have you felt difficulties were piling up so high you could not overcome them?</label>
          <input type="range" id="sl3-q10" class="sl3-in w-full" min="0" max="4" step="1">
          <div class="flex justify-between text-xs text-text-secondary"><span>Never (0)</span><span>Very Often (4)</span></div>
        </div>
      </div>

      <div class="mt-6 space-y-3">
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm opacity-80">Stress Category</div>
          <div class="text-2xl font-extrabold mt-1" id="sl3-cat">--</div>
        </div>

        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-secondary">PSS-10 Score</div>
            <div class="text-xl font-bold text-text mt-1" id="sl3-score">--</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-secondary">Cortisol Impact</div>
            <div class="text-xl font-bold text-text mt-1" id="sl3-cortisol">--</div>
          </div>
        </div>

        <div class="p-4 bg-surface-alt rounded-xl">
          <div class="text-xs text-text-secondary mb-2">Coping Recommendations</div>
          <div class="text-sm text-text" id="sl3-recs">--</div>
        </div>
      </div>

      <ShareButton calculatorId="stress-level" />
      <FeedbackWidget />
    </div>

    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    function calcSL3() {
      const reverseItems = [4, 5, 7, 8];
      let total = 0;
      for (let i = 1; i <= 10; i++) {
        let val = parseInt((document.getElementById('sl3-q' + i) as HTMLInputElement).value) || 0;
        if (reverseItems.includes(i)) {
          val = 4 - val;
        }
        total += val;
      }

      let category = 'Low Stress';
      let cortisol = 'Normal baseline';
      let recs = '';

      if (total <= 13) {
        category = 'Low Stress';
        cortisol = 'Normal baseline levels';
        recs = 'Your stress is well-managed. Continue current habits: regular exercise, good sleep, and social connection. Consider mindfulness practice to maintain resilience.';
      } else if (total <= 26) {
        category = 'Moderate Stress';
        cortisol = 'Mildly elevated (~15-25% above baseline)';
        recs = 'Implement daily stress-reduction: 10+ min exercise, deep breathing exercises, limit caffeine, ensure 7-9 hours sleep. Consider journaling or talking to a trusted friend.';
      } else {
        category = 'High Perceived Stress';
        cortisol = 'Likely elevated (~30-50% above baseline)';
        recs = 'Your stress level is significant. Prioritize: professional support (therapist/counselor), daily relaxation techniques, physical activity, social support, and boundary-setting. Chronic high stress impacts immune function and cardiovascular health.';
      }

      document.getElementById('sl3-score')!.textContent = total + ' / 40';
      document.getElementById('sl3-cat')!.textContent = category;
      document.getElementById('sl3-cortisol')!.textContent = cortisol;
      document.getElementById('sl3-recs')!.textContent = recs;

      document.dispatchEvent(new CustomEvent('calc-update'));
    }

    setTimeout(() => {
      for (let i = 1; i <= 10; i++) {
        (document.getElementById('sl3-q' + i) as HTMLInputElement).value = '2';
      }
      document.querySelectorAll('.sl3-in').forEach(el => {
        el.addEventListener('input', calcSL3);
        el.addEventListener('change', calcSL3);
      });
      calcSL3();
    }, 50);
  </script>
</CalculatorLayout>
