---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Party Supplies Calculator - Plates, Cups, Napkins & Utensils";
const description = "Calculate exactly how many plates, cups, napkins, utensils, and tablecloths you need for your event based on guest count and meal style.";
const relatedCalcs = [
  { name: "Catering Quantity Calculator", url: "/catering-quantity-calculator", description: "Food quantities per guest." },
  { name: "Event Budget Calculator", url: "/event-budget-calculator", description: "Total event cost breakdown." },
  { name: "Seating Chart Calculator", url: "/seating-chart-calculator", description: "Table layout planner." },
  { name: "Bartender Calculator", url: "/bartender-calculator", description: "Bar service quantities." },
  { name: "Cake Serving Calculator", url: "/cake-serving-calculator", description: "Cake size for guests." },
  { name: "Banquet Room Calculator", url: "/banquet-room-calculator", description: "Room size for events." },
];
---

<CalculatorLayout
  title={title}
  description={description}
  calculatorName="Party Supplies Calculator"
  keywords="party supplies calculator, plates per guest, cups needed, napkins, utensils, tablecloths, event supplies"
  breadcrumbs={[{ name: "Party Supplies", url: "/party-supplies-calculator" }]}
>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Party Supplies Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Never run out of plates, cups, or napkins at your event.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4 mb-6">
        <div>
          <label class="block text-sm font-medium text-text mb-1">Number of Guests</label>
          <input type="number" id="psu-guests" class="psu-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="80" min="1" step="1">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Meal Style</label>
          <select id="psu-meal" class="psu-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="full">Full Meal (appetizer + dinner + dessert)</option>
            <option value="dinner">Dinner Only</option>
            <option value="cocktail">Cocktail / Appetizers Only</option>
            <option value="bbq">BBQ / Casual Cookout</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Number of Tables</label>
          <input type="number" id="psu-tables" class="psu-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="10" min="1" step="1">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Supply Type</label>
          <select id="psu-supplytype" class="psu-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="disposable">Disposable</option>
            <option value="reusable">Reusable / Rental</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Extra Buffer (%)</label>
          <input type="number" id="psu-buffer" class="psu-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="15" min="0" max="50" step="5">
        </div>
      </div>

      <div class="p-6 bg-primary rounded-2xl text-white text-center mb-4">
        <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Total Plates Needed</div>
        <div class="text-5xl font-extrabold" id="psu-plates">--</div>
        <div class="text-sm mt-1" id="psu-platetype">--</div>
      </div>

      <div class="grid grid-cols-2 gap-4 mb-4">
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Cups / Glasses</div>
          <div class="text-xl font-bold" id="psu-cups">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Napkins</div>
          <div class="text-xl font-bold" id="psu-napkins">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Utensil Sets</div>
          <div class="text-xl font-bold" id="psu-utensils">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Tablecloths</div>
          <div class="text-xl font-bold" id="psu-cloths">--</div>
        </div>
      </div>

      <div class="p-4 bg-surface-alt rounded-xl mb-4" id="psu-details"></div>

      <ShareButton calculatorId="party-supplies" />
      <FeedbackWidget />
    </div>

    <article class="mt-12 max-w-4xl prose prose-slate">
      <h2 class="text-2xl font-bold text-text">Party Supplies Checklist</h2>
      <p>Always order 10-20% more supplies than your guest count. Guests tend to use multiple cups and napkins throughout an event. For a full meal, plan 2-3 plates per guest (appetizer, dinner, dessert).</p>
    </article>

    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    function calcPSU() {
      const guests = parseInt((document.getElementById('psu-guests') as HTMLInputElement).value) || 1;
      const meal = (document.getElementById('psu-meal') as HTMLSelectElement).value;
      const tables = parseInt((document.getElementById('psu-tables') as HTMLInputElement).value) || 1;
      const supplyType = (document.getElementById('psu-supplytype') as HTMLSelectElement).value;
      const bufferPct = parseFloat((document.getElementById('psu-buffer') as HTMLInputElement).value) || 0;
      const mult = 1 + bufferPct / 100;

      let platesPerGuest = 2;
      let cupsPerGuest = 3;
      let napkinsPerGuest = 3;
      let utensilSetsPerGuest = 1;

      if (meal === 'full') { platesPerGuest = 3; cupsPerGuest = 4; napkinsPerGuest = 4; utensilSetsPerGuest = 2; }
      else if (meal === 'dinner') { platesPerGuest = 2; cupsPerGuest = 3; napkinsPerGuest = 3; utensilSetsPerGuest = 1; }
      else if (meal === 'cocktail') { platesPerGuest = 2; cupsPerGuest = 4; napkinsPerGuest = 5; utensilSetsPerGuest = 1; }
      else if (meal === 'bbq') { platesPerGuest = 2; cupsPerGuest = 3; napkinsPerGuest = 4; utensilSetsPerGuest = 1; }

      const totalPlates = Math.ceil(guests * platesPerGuest * mult);
      const totalCups = Math.ceil(guests * cupsPerGuest * mult);
      const totalNapkins = Math.ceil(guests * napkinsPerGuest * mult);
      const totalUtensils = Math.ceil(guests * utensilSetsPerGuest * mult);
      const totalCloths = tables + Math.ceil(tables * 0.1);

      const plateLabel = platesPerGuest > 2 ? 'appetizer + dinner + dessert plates' : (meal === 'cocktail' ? 'appetizer + cocktail plates' : 'dinner + dessert plates');

      document.getElementById('psu-plates')!.textContent = totalPlates.toLocaleString();
      document.getElementById('psu-platetype')!.textContent = plateLabel;
      document.getElementById('psu-cups')!.textContent = totalCups.toLocaleString();
      document.getElementById('psu-napkins')!.textContent = totalNapkins.toLocaleString();
      document.getElementById('psu-utensils')!.textContent = totalUtensils.toLocaleString();
      document.getElementById('psu-cloths')!.textContent = totalCloths.toLocaleString();

      let details = '<h3 class="font-semibold text-sm text-text mb-2">Full Supply List</h3><ul class="text-sm text-text-secondary space-y-1">';
      details += '<li>Dinner plates (10"): ' + Math.ceil(guests * mult) + '</li>';
      if (platesPerGuest >= 2) details += '<li>Small plates (7"): ' + Math.ceil(guests * mult) + '</li>';
      if (platesPerGuest >= 3) details += '<li>Dessert plates: ' + Math.ceil(guests * mult) + '</li>';
      details += '<li>Drinking cups/glasses: ' + totalCups + '</li>';
      details += '<li>Cocktail napkins: ' + Math.ceil(totalNapkins * 0.6) + '</li>';
      details += '<li>Dinner napkins: ' + Math.ceil(totalNapkins * 0.4) + '</li>';
      details += '<li>Forks: ' + Math.ceil(guests * utensilSetsPerGuest * mult) + (utensilSetsPerGuest > 1 ? ' (dinner + salad)' : '') + '</li>';
      details += '<li>Knives: ' + Math.ceil(guests * mult) + '</li>';
      details += '<li>Spoons: ' + Math.ceil(guests * mult) + '</li>';
      details += '<li>Tablecloths: ' + totalCloths + ' (includes spares)</li>';
      if (supplyType === 'disposable') {
        details += '<li>Trash bags (large): ' + Math.ceil(guests / 10) + '</li>';
      }
      details += '<li>Serving utensils: ' + Math.ceil(tables * 0.5 + 5) + ' pieces</li>';
      details += '</ul>';
      document.getElementById('psu-details')!.innerHTML = details;

      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.psu-in').forEach(el => { el.addEventListener('input', calcPSU); el.addEventListener('change', calcPSU); });
      calcPSU();
    }, 50);
  </script>
</CalculatorLayout>
