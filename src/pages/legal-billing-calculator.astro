---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Legal Billing Calculator - Track Hours & Multi-Tier Rates";
const description = "Calculate legal billing totals with different rate tiers for partners, associates, and paralegals. Track hours and estimate total costs with markups.";
const relatedCalcs = [
  { name: "Legal Fee Calculator", url: "/legal-fee-calculator", description: "Lawyer fee estimates." },
  { name: "Litigation Cost Calculator", url: "/litigation-cost-calculator", description: "Total litigation costs." },
  { name: "Court Fee Calculator", url: "/court-fee-calculator", description: "Court filing fees." },
  { name: "Arbitration Cost Calculator", url: "/arbitration-cost-calculator", description: "ADR cost comparison." },
  { name: "Contract Value Calculator", url: "/contract-value-calculator", description: "Contract valuation." },
  { name: "Small Claims Calculator", url: "/small-claims-calculator", description: "Small claims costs." },
];
---

<CalculatorLayout title={title} description={description} calculatorName="Legal Billing Calculator" keywords="legal billing calculator, billable hours, attorney rate, partner rate, associate rate, paralegal rate, legal costs, time tracking" breadcrumbs={[{ name: "Legal Billing", url: "/legal-billing-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Legal Billing Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Track legal billing hours across different rate tiers and calculate total costs.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <h3 class="text-lg font-bold text-text">Partner Time</h3>
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="block text-sm font-medium text-text mb-1">Partner Rate ($/hr)</label>
            <input type="number" id="lbi-partner-rate" class="lbi-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="550" min="0" step="25">
          </div>
          <div>
            <label class="block text-sm font-medium text-text mb-1">Partner Hours</label>
            <input type="number" id="lbi-partner-hrs" class="lbi-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="10" min="0" max="2000" step="0.5">
          </div>
        </div>
        <h3 class="text-lg font-bold text-text">Senior Associate Time</h3>
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="block text-sm font-medium text-text mb-1">Sr. Associate Rate ($/hr)</label>
            <input type="number" id="lbi-senior-rate" class="lbi-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="375" min="0" step="25">
          </div>
          <div>
            <label class="block text-sm font-medium text-text mb-1">Sr. Associate Hours</label>
            <input type="number" id="lbi-senior-hrs" class="lbi-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="25" min="0" max="2000" step="0.5">
          </div>
        </div>
        <h3 class="text-lg font-bold text-text">Junior Associate Time</h3>
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="block text-sm font-medium text-text mb-1">Jr. Associate Rate ($/hr)</label>
            <input type="number" id="lbi-junior-rate" class="lbi-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="250" min="0" step="25">
          </div>
          <div>
            <label class="block text-sm font-medium text-text mb-1">Jr. Associate Hours</label>
            <input type="number" id="lbi-junior-hrs" class="lbi-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="40" min="0" max="2000" step="0.5">
          </div>
        </div>
        <h3 class="text-lg font-bold text-text">Paralegal Time</h3>
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="block text-sm font-medium text-text mb-1">Paralegal Rate ($/hr)</label>
            <input type="number" id="lbi-para-rate" class="lbi-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="150" min="0" step="10">
          </div>
          <div>
            <label class="block text-sm font-medium text-text mb-1">Paralegal Hours</label>
            <input type="number" id="lbi-para-hrs" class="lbi-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="30" min="0" max="2000" step="0.5">
          </div>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Expenses & Disbursements ($)</label>
          <input type="number" id="lbi-expenses" class="lbi-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="2500" min="0" step="100">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Administrative Markup (%)</label>
          <input type="number" id="lbi-markup" class="lbi-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="0" min="0" max="50" step="1">
        </div>
      </div>

      <div class="mt-6 space-y-3">
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Total Legal Bill</div>
          <div class="text-5xl font-extrabold font-mono" id="lbi-total"></div>
        </div>
        <div class="grid grid-cols-2 gap-4">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Total Hours</div>
            <div class="text-xl font-bold text-secondary" id="lbi-hours"></div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Blended Rate</div>
            <div class="text-xl font-bold" id="lbi-blended"></div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Fees Only</div>
            <div class="text-xl font-bold text-orange-600" id="lbi-fees"></div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Expenses + Markup</div>
            <div class="text-xl font-bold" id="lbi-extra"></div>
          </div>
        </div>
      </div>
      <ShareButton calculatorId="legal-billing" />
      <FeedbackWidget />
    </div>

    <article class="mt-12 max-w-4xl prose prose-slate">
      <h2 class="text-2xl font-bold text-text">Understanding Legal Billing</h2>
      <p>Law firms typically bill with multiple rate tiers. Partners charge $400-$1,000+/hour, senior associates $250-$500/hour, junior associates $150-$350/hour, and paralegals $100-$250/hour. Understanding the blended rate helps compare quotes between firms. Always request detailed billing statements showing who worked on your matter and for how long.</p>
      <h3 class="text-xl font-semibold text-text mt-8">Controlling Legal Costs</h3>
      <p>Negotiate billing guidelines upfront. Request that routine tasks be handled by lower-rate professionals. Set monthly budget caps with advance notice before exceeding them. Review bills carefully for block billing, vague descriptions, or excessive staffing.</p>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    const fmt = (n: number) => '$' + Math.round(n).toLocaleString();

    function calcLBI() {
      const pRate = parseFloat((document.getElementById('lbi-partner-rate') as HTMLInputElement).value) || 0;
      const pHrs = parseFloat((document.getElementById('lbi-partner-hrs') as HTMLInputElement).value) || 0;
      const sRate = parseFloat((document.getElementById('lbi-senior-rate') as HTMLInputElement).value) || 0;
      const sHrs = parseFloat((document.getElementById('lbi-senior-hrs') as HTMLInputElement).value) || 0;
      const jRate = parseFloat((document.getElementById('lbi-junior-rate') as HTMLInputElement).value) || 0;
      const jHrs = parseFloat((document.getElementById('lbi-junior-hrs') as HTMLInputElement).value) || 0;
      const paraRate = parseFloat((document.getElementById('lbi-para-rate') as HTMLInputElement).value) || 0;
      const paraHrs = parseFloat((document.getElementById('lbi-para-hrs') as HTMLInputElement).value) || 0;
      const expenses = parseFloat((document.getElementById('lbi-expenses') as HTMLInputElement).value) || 0;
      const markup = parseFloat((document.getElementById('lbi-markup') as HTMLInputElement).value) / 100 || 0;

      const fees = (pRate * pHrs) + (sRate * sHrs) + (jRate * jHrs) + (paraRate * paraHrs);
      const totalHours = pHrs + sHrs + jHrs + paraHrs;
      const blendedRate = totalHours > 0 ? fees / totalHours : 0;
      const markupAmt = fees * markup;
      const extraCost = expenses + markupAmt;
      const total = fees + extraCost;

      document.getElementById('lbi-total')!.textContent = fmt(total);
      document.getElementById('lbi-hours')!.textContent = totalHours.toFixed(1);
      document.getElementById('lbi-blended')!.textContent = fmt(blendedRate) + '/hr';
      document.getElementById('lbi-fees')!.textContent = fmt(fees);
      document.getElementById('lbi-extra')!.textContent = fmt(extraCost);

      document.dispatchEvent(new CustomEvent('calc-update'));
    }

    setTimeout(() => {
      document.querySelectorAll('.lbi-in').forEach(el => {
        el.addEventListener('input', calcLBI);
        el.addEventListener('change', calcLBI);
      });
      calcLBI();
    }, 50);
  </script>
</CalculatorLayout>
