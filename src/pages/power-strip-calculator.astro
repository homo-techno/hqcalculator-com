---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Power Strip Calculator - Amp Draw, Rating Check & Phantom Load";
const description = "Calculate total amp draw from all devices on a power strip, verify the strip rating is not exceeded, estimate phantom (standby) load, and annual waste cost.";
const relatedCalcs = [
  { name: "Electricity Cost", url: "/electricity-cost-calculator", description: "Energy costs." },
  { name: "Electrical Load", url: "/electrical-load-calculator", description: "Panel loads." },
  { name: "Ohm's Law", url: "/ohms-law-calculator", description: "Voltage, current, resistance." },
  { name: "Electricity Usage", url: "/electricity-usage-calculator", description: "Usage tracking." },
  { name: "Wire Gauge", url: "/wire-gauge-calculator", description: "Wire sizing." },
  { name: "Electricity Bill", url: "/electricity-bill-calculator", description: "Bill estimates." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Power Strip Calculator" keywords="power strip calculator, amp draw, overload check, phantom load, standby power waste, power strip rating" breadcrumbs={[{ name: "Power Strip", url: "/power-strip-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Power Strip Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Check if your power strip can handle all connected devices and estimate phantom load costs.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="block text-xs font-medium text-text mb-1">Power Strip Rating (Amps)</label>
            <select id="ps3-rating" class="ps3-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
              <option value="10">10A (basic)</option>
              <option value="12">12A (standard)</option>
              <option value="15" selected>15A (heavy duty)</option>
              <option value="20">20A (commercial)</option>
            </select>
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Electricity Rate ($/kWh)</label>
            <input type="number" id="ps3-rate" class="ps3-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="0.14" min="0.01" step="0.01">
          </div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-2">Connected Devices (Watts when ON)</h3>
          <div class="grid grid-cols-2 gap-2">
            <div><label class="block text-xs text-text-muted">Desktop PC</label><input type="number" id="ps3-d1" class="ps3-in w-full px-2 py-2 border border-border rounded-xl text-lg font-bold text-center" value="300" min="0"></div>
            <div><label class="block text-xs text-text-muted">Monitor</label><input type="number" id="ps3-d2" class="ps3-in w-full px-2 py-2 border border-border rounded-xl text-lg font-bold text-center" value="40" min="0"></div>
            <div><label class="block text-xs text-text-muted">Speakers</label><input type="number" id="ps3-d3" class="ps3-in w-full px-2 py-2 border border-border rounded-xl text-lg font-bold text-center" value="30" min="0"></div>
            <div><label class="block text-xs text-text-muted">Desk Lamp</label><input type="number" id="ps3-d4" class="ps3-in w-full px-2 py-2 border border-border rounded-xl text-lg font-bold text-center" value="10" min="0"></div>
            <div><label class="block text-xs text-text-muted">Phone Charger</label><input type="number" id="ps3-d5" class="ps3-in w-full px-2 py-2 border border-border rounded-xl text-lg font-bold text-center" value="20" min="0"></div>
            <div><label class="block text-xs text-text-muted">Printer</label><input type="number" id="ps3-d6" class="ps3-in w-full px-2 py-2 border border-border rounded-xl text-lg font-bold text-center" value="50" min="0"></div>
            <div><label class="block text-xs text-text-muted">Router/Modem</label><input type="number" id="ps3-d7" class="ps3-in w-full px-2 py-2 border border-border rounded-xl text-lg font-bold text-center" value="30" min="0"></div>
            <div><label class="block text-xs text-text-muted">Other Device</label><input type="number" id="ps3-d8" class="ps3-in w-full px-2 py-2 border border-border rounded-xl text-lg font-bold text-center" value="0" min="0"></div>
          </div>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Hours Devices Are ON Per Day</label>
          <input type="number" id="ps3-hrs" class="ps3-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="8" min="0" max="24" step="1">
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Total Amp Draw</div>
          <div class="text-5xl font-extrabold font-mono" id="ps3-result">0 A</div>
          <div class="text-sm text-blue-200 mt-1" id="ps3-note">-</div>
        </div>
        <div class="p-4 rounded-xl text-center" id="ps3-status-box">
          <div class="font-bold text-sm" id="ps3-status">-</div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Total Watts</div>
            <div class="text-xl font-bold font-mono" id="ps3-watts">0 W</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Strip Capacity</div>
            <div class="text-xl font-bold font-mono" id="ps3-cap">0 W</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Utilization</div>
            <div class="text-xl font-bold font-mono" id="ps3-util">0%</div>
          </div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Phantom Load</div>
            <div class="text-xl font-bold font-mono" id="ps3-phantom">0 W</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Annual Active Cost</div>
            <div class="text-xl font-bold font-mono" id="ps3-active">$0</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Annual Phantom Waste</div>
            <div class="text-xl font-bold font-mono" id="ps3-waste">$0</div>
          </div>
        </div>
      </div>
      <ShareButton calculatorId="power-strip" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    // Phantom/standby power estimates (watts) for common devices
    const PS3_PHANTOM: Record<string, number> = {
      'd1': 5,  // PC in sleep
      'd2': 1,  // Monitor standby
      'd3': 2,  // Speakers standby
      'd4': 0,  // Lamp (LED, no standby)
      'd5': 0.5, // Phone charger (no phone)
      'd6': 3,  // Printer standby
      'd7': 30, // Router always on (not really phantom, but counted)
      'd8': 2,  // Generic standby
    };

    function calcPS3() {
      const stripRating = parseFloat((document.getElementById('ps3-rating') as HTMLSelectElement).value) || 15;
      const rate = parseFloat((document.getElementById('ps3-rate') as HTMLInputElement).value) || 0.14;
      const hrs = parseFloat((document.getElementById('ps3-hrs') as HTMLInputElement).value) || 8;

      let totalWatts = 0;
      let totalPhantom = 0;
      const deviceIds = ['d1', 'd2', 'd3', 'd4', 'd5', 'd6', 'd7', 'd8'];

      deviceIds.forEach(id => {
        const w = parseFloat((document.getElementById('ps3-' + id) as HTMLInputElement).value) || 0;
        totalWatts += w;
        if (w > 0) {
          totalPhantom += PS3_PHANTOM[id] || 0;
        }
      });

      const voltage = 120;
      const totalAmps = totalWatts / voltage;
      const stripCapacity = stripRating * voltage;
      const utilization = stripCapacity > 0 ? (totalWatts / stripCapacity) * 100 : 0;

      // Active cost (when devices are ON)
      const activeKwhYear = (totalWatts * hrs * 365) / 1000;
      const activeCostYear = activeKwhYear * rate;

      // Phantom cost (remaining hours of day, devices in standby)
      const standbyHrs = 24 - hrs;
      const phantomKwhYear = (totalPhantom * standbyHrs * 365) / 1000;
      const phantomCostYear = phantomKwhYear * rate;

      document.getElementById('ps3-result')!.textContent = totalAmps.toFixed(1) + ' A';
      document.getElementById('ps3-note')!.textContent = totalWatts + 'W on ' + stripRating + 'A strip (' + stripCapacity + 'W max)';
      document.getElementById('ps3-watts')!.textContent = totalWatts + ' W';
      document.getElementById('ps3-cap')!.textContent = stripCapacity + ' W';
      document.getElementById('ps3-util')!.textContent = utilization.toFixed(0) + '%';
      document.getElementById('ps3-phantom')!.textContent = totalPhantom.toFixed(1) + ' W';
      document.getElementById('ps3-active')!.textContent = '$' + activeCostYear.toFixed(2);
      document.getElementById('ps3-waste')!.textContent = '$' + phantomCostYear.toFixed(2);

      let status: string, color: string;
      if (totalAmps > stripRating) {
        status = 'OVERLOADED — total draw (' + totalAmps.toFixed(1) + 'A) exceeds strip rating (' + stripRating + 'A). Risk of tripping or fire!';
        color = 'bg-red-50 text-red-800';
      } else if (utilization > 80) {
        status = 'Near capacity (' + utilization.toFixed(0) + '%) — avoid adding more devices';
        color = 'bg-orange-50 text-orange-800';
      } else {
        status = 'Safe — ' + (100 - utilization).toFixed(0) + '% capacity remaining on strip';
        color = 'bg-green-50 text-green-800';
      }
      document.getElementById('ps3-status')!.textContent = status;
      document.getElementById('ps3-status-box')!.className = 'p-4 rounded-xl text-center ' + color;
      document.dispatchEvent(new CustomEvent('calc-update'));
    }

    setTimeout(() => {
      document.querySelectorAll('.ps3-in').forEach(el => {
        el.addEventListener('input', calcPS3);
        el.addEventListener('change', calcPS3);
      });
      calcPS3();
    }, 50);
  </script>
</CalculatorLayout>
