---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Event Budget Calculator - Total Event Cost Breakdown";
const description = "Plan your event budget with a detailed breakdown across venue, catering, entertainment, decor, staffing, and more. Get per-guest costs and allocation percentages.";
const relatedCalcs = [
  { name: "Catering Quantity Calculator", url: "/catering-quantity-calculator", description: "Food & drink per guest." },
  { name: "Event Staffing Calculator", url: "/event-staffing-calculator", description: "Staff needed by guest count." },
  { name: "Event Timeline Calculator", url: "/event-timeline-calculator", description: "Event schedule planner." },
  { name: "Tent Size Calculator", url: "/tent-size-calculator", description: "Tent size for events." },
  { name: "Floral Budget Calculator", url: "/floral-budget-calculator", description: "Flower arrangement costs." },
  { name: "Sound System Calculator", url: "/sound-system-calculator", description: "Speaker wattage needed." },
];
---

<CalculatorLayout
  title={title}
  description={description}
  calculatorName="Event Budget Calculator"
  keywords="event budget calculator, event cost breakdown, event planning budget, party budget planner, event expenses"
  breadcrumbs={[{ name: "Event Budget", url: "/event-budget-calculator" }]}
>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Event Budget Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Plan your total event budget with a breakdown across all major categories.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4 mb-6">
        <div>
          <label class="block text-sm font-medium text-text mb-1">Number of Guests</label>
          <input type="number" id="eb2-guests" class="eb2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="100" min="1" step="1">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Event Type</label>
          <select id="eb2-type" class="eb2-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="corporate">Corporate Event</option>
            <option value="wedding">Wedding Reception</option>
            <option value="birthday">Birthday Party</option>
            <option value="gala">Gala / Fundraiser</option>
            <option value="conference">Conference</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Venue Cost ($)</label>
          <input type="number" id="eb2-venue" class="eb2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="3000" min="0" step="100">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Catering Per Person ($)</label>
          <input type="number" id="eb2-catering" class="eb2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="75" min="0" step="5">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Entertainment / DJ / Band ($)</label>
          <input type="number" id="eb2-entertain" class="eb2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="1500" min="0" step="100">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Decor & Floral ($)</label>
          <input type="number" id="eb2-decor" class="eb2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="2000" min="0" step="100">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Staffing Budget ($)</label>
          <input type="number" id="eb2-staff" class="eb2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="1200" min="0" step="100">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Photography / Videography ($)</label>
          <input type="number" id="eb2-photo" class="eb2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="1500" min="0" step="100">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Miscellaneous / Contingency (%)</label>
          <input type="number" id="eb2-misc" class="eb2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="10" min="0" max="50" step="1">
        </div>
      </div>

      <div class="p-6 bg-primary rounded-2xl text-white text-center mb-4">
        <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Total Event Budget</div>
        <div class="text-5xl font-extrabold" id="eb2-total">--</div>
        <div class="text-sm mt-1" id="eb2-perguest">--</div>
      </div>

      <div class="grid grid-cols-2 gap-4 mb-4">
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Catering Total</div>
          <div class="text-xl font-bold" id="eb2-cattotal">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Contingency</div>
          <div class="text-xl font-bold" id="eb2-contamt">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Fixed Costs</div>
          <div class="text-xl font-bold" id="eb2-fixed">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Largest Category</div>
          <div class="text-xl font-bold" id="eb2-largest">--</div>
        </div>
      </div>

      <div class="p-4 bg-surface-alt rounded-xl mb-4" id="eb2-breakdown"></div>

      <ShareButton calculatorId="event-budget" />
      <FeedbackWidget />
    </div>

    <article class="mt-12 max-w-4xl prose prose-slate">
      <h2 class="text-2xl font-bold text-text">How to Plan an Event Budget</h2>
      <p>A well-planned budget ensures your event stays on track financially. Common allocations include 40-50% for venue and catering, 10-15% for entertainment, 8-10% for decor, and 5-10% as a contingency buffer.</p>
      <h3 class="text-xl font-semibold text-text mt-6">Tips for Staying on Budget</h3>
      <ul>
        <li>Get quotes from at least 3 vendors per category</li>
        <li>Always include a 10-15% contingency for unexpected costs</li>
        <li>Track actual spending vs. budget throughout the planning process</li>
        <li>Consider off-peak days and seasons for lower venue rates</li>
      </ul>
    </article>

    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    function calcEB2() {
      const guests = parseInt((document.getElementById('eb2-guests') as HTMLInputElement).value) || 1;
      const venue = parseFloat((document.getElementById('eb2-venue') as HTMLInputElement).value) || 0;
      const cateringPP = parseFloat((document.getElementById('eb2-catering') as HTMLInputElement).value) || 0;
      const entertain = parseFloat((document.getElementById('eb2-entertain') as HTMLInputElement).value) || 0;
      const decor = parseFloat((document.getElementById('eb2-decor') as HTMLInputElement).value) || 0;
      const staff = parseFloat((document.getElementById('eb2-staff') as HTMLInputElement).value) || 0;
      const photo = parseFloat((document.getElementById('eb2-photo') as HTMLInputElement).value) || 0;
      const miscPct = parseFloat((document.getElementById('eb2-misc') as HTMLInputElement).value) || 0;

      const cateringTotal = cateringPP * guests;
      const subtotal = venue + cateringTotal + entertain + decor + staff + photo;
      const contingency = subtotal * (miscPct / 100);
      const total = subtotal + contingency;
      const perGuest = total / guests;
      const fixed = venue + entertain + decor + staff + photo;

      const cats = [
        { name: 'Venue', val: venue },
        { name: 'Catering', val: cateringTotal },
        { name: 'Entertainment', val: entertain },
        { name: 'Decor & Floral', val: decor },
        { name: 'Staffing', val: staff },
        { name: 'Photography', val: photo },
        { name: 'Contingency', val: contingency },
      ];
      const largest = cats.reduce((a, b) => a.val > b.val ? a : b);

      const fmt = (n: number) => '$' + Math.round(n).toLocaleString();
      document.getElementById('eb2-total')!.textContent = fmt(total);
      document.getElementById('eb2-perguest')!.textContent = fmt(perGuest) + ' per guest';
      document.getElementById('eb2-cattotal')!.textContent = fmt(cateringTotal);
      document.getElementById('eb2-contamt')!.textContent = fmt(contingency);
      document.getElementById('eb2-fixed')!.textContent = fmt(fixed);
      document.getElementById('eb2-largest')!.textContent = largest.name;

      document.getElementById('eb2-breakdown')!.innerHTML = '<h3 class="font-semibold text-sm text-text mb-3">Budget Breakdown</h3>' +
        cats.filter(c => c.val > 0).sort((a, b) => b.val - a.val).map(c => {
          const pct = total > 0 ? (c.val / total * 100) : 0;
          return '<div class="text-xs mb-1"><div class="flex justify-between mb-0.5"><span class="text-text-secondary">' + c.name + '</span><span class="font-semibold">' + fmt(c.val) + ' (' + pct.toFixed(1) + '%)</span></div><div class="w-full h-2 bg-gray-200 rounded-full"><div class="h-full bg-primary rounded-full" style="width:' + Math.min(100, pct) + '%"></div></div></div>';
        }).join('');

      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.eb2-in').forEach(el => { el.addEventListener('input', calcEB2); el.addEventListener('change', calcEB2); });
      calcEB2();
    }, 50);
  </script>
</CalculatorLayout>
