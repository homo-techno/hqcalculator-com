---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Linear Equation Calculator";
const description = "Solve linear equations (ax + b = c), systems of two equations, and find slope-intercept form.";
const relatedCalcs = [
  { name: "Quadratic Equation", url: "/quadratic-equation-calculator", description: "Quadratic." },
  { name: "Slope Calculator", url: "/slope-calculator", description: "Slope." },
  { name: "Matrix Calculator", url: "/matrix-calculator", description: "Matrix." },
  { name: "Midpoint Calculator", url: "/midpoint-calculator", description: "Midpoint." },
  { name: "Fraction Calculator", url: "/fraction-calculator", description: "Fractions." },
  { name: "Proportions", url: "/proportions-calculator", description: "Proportions." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Linear Equation Calculator" keywords="linear equation solver, solve for x, system of equations, slope intercept, simultaneous equations" breadcrumbs={[{ name: "Linear Equation", url: "/linear-equation-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Linear Equation Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Solve linear equations and systems of equations.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="flex gap-2">
          <button class="le-mode flex-1 py-2 rounded-xl font-bold text-sm border-2 border-primary bg-blue-50 text-primary" data-mode="single">Single (ax+b=c)</button>
          <button class="le-mode flex-1 py-2 rounded-xl font-bold text-sm border-2 border-border text-text-muted" data-mode="system">System (2 equations)</button>
        </div>
        <div id="le-single-section">
          <div class="p-4 bg-surface-alt rounded-xl">
            <h3 class="font-semibold text-sm text-text mb-2">ax + b = c</h3>
            <div class="flex gap-2 items-center">
              <input type="number" id="le-a" class="le-in w-20 px-3 py-2 border border-border rounded-xl text-lg font-bold text-center" value="3" step="0.1">
              <span class="font-bold">x +</span>
              <input type="number" id="le-b" class="le-in w-20 px-3 py-2 border border-border rounded-xl text-lg font-bold text-center" value="5" step="0.1">
              <span class="font-bold">=</span>
              <input type="number" id="le-c" class="le-in w-20 px-3 py-2 border border-border rounded-xl text-lg font-bold text-center" value="14" step="0.1">
            </div>
          </div>
        </div>
        <div id="le-system-section" class="hidden space-y-2">
          <div class="p-4 bg-surface-alt rounded-xl">
            <h3 class="font-semibold text-sm text-text mb-2">Equation 1: a₁x + b₁y = c₁</h3>
            <div class="flex gap-2 items-center">
              <input type="number" id="le-a1" class="le-in w-16 px-2 py-2 border border-border rounded-xl text-lg font-bold text-center" value="2" step="1">
              <span class="font-bold text-sm">x +</span>
              <input type="number" id="le-b1" class="le-in w-16 px-2 py-2 border border-border rounded-xl text-lg font-bold text-center" value="3" step="1">
              <span class="font-bold text-sm">y =</span>
              <input type="number" id="le-c1" class="le-in w-16 px-2 py-2 border border-border rounded-xl text-lg font-bold text-center" value="8" step="1">
            </div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl">
            <h3 class="font-semibold text-sm text-text mb-2">Equation 2: a₂x + b₂y = c₂</h3>
            <div class="flex gap-2 items-center">
              <input type="number" id="le-a2" class="le-in w-16 px-2 py-2 border border-border rounded-xl text-lg font-bold text-center" value="4" step="1">
              <span class="font-bold text-sm">x +</span>
              <input type="number" id="le-b2" class="le-in w-16 px-2 py-2 border border-border rounded-xl text-lg font-bold text-center" value="-1" step="1">
              <span class="font-bold text-sm">y =</span>
              <input type="number" id="le-c2" class="le-in w-16 px-2 py-2 border border-border rounded-xl text-lg font-bold text-center" value="2" step="1">
            </div>
          </div>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Solution</div>
          <div class="text-4xl font-extrabold font-mono" id="le-result">x = 0</div>
        </div>
        <div class="grid grid-cols-2 gap-3" id="le-details">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase" id="le-d1-label">Slope</div><div class="text-xl font-bold font-mono" id="le-d1">0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase" id="le-d2-label">Y-Intercept</div><div class="text-xl font-bold font-mono" id="le-d2">0</div></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-2">Steps</h3>
          <div class="text-xs space-y-1" id="le-steps"></div>
        </div>
      </div>
      <ShareButton calculatorId="linear-equation" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    let leMode = 'single';
    function calcLE() {
      if (leMode === 'single') {
        const a = parseFloat((document.getElementById('le-a') as HTMLInputElement).value) || 0;
        const b = parseFloat((document.getElementById('le-b') as HTMLInputElement).value) || 0;
        const c = parseFloat((document.getElementById('le-c') as HTMLInputElement).value) || 0;
        if (a === 0) {
          document.getElementById('le-result')!.textContent = b === c ? 'All x' : 'No solution';
          document.getElementById('le-d1')!.textContent = '-';
          document.getElementById('le-d2')!.textContent = '-';
          document.getElementById('le-steps')!.innerHTML = '<div>a = 0, cannot solve for x</div>';
        } else {
          const x = (c - b) / a;
          const slope = -a / 1;
          document.getElementById('le-result')!.textContent = `x = ${x.toFixed(4)}`;
          document.getElementById('le-d1-label')!.textContent = 'Slope (y = mx+b form)';
          document.getElementById('le-d1')!.textContent = (-1 / a).toFixed(4);
          document.getElementById('le-d2-label')!.textContent = 'Y-Intercept';
          document.getElementById('le-d2')!.textContent = (c / 1).toFixed(4);
          const steps = [
            `<div>${a}x + ${b} = ${c}</div>`,
            `<div>${a}x = ${c} - ${b} = ${c - b}</div>`,
            `<div>x = ${c - b} / ${a} = ${x.toFixed(4)}</div>`,
            `<div class="font-bold text-primary">Verify: ${a}(${x.toFixed(4)}) + ${b} = ${(a * x + b).toFixed(4)} ✓</div>`,
          ];
          document.getElementById('le-steps')!.innerHTML = steps.join('');
        }
      } else {
        const a1 = parseFloat((document.getElementById('le-a1') as HTMLInputElement).value) || 0;
        const b1 = parseFloat((document.getElementById('le-b1') as HTMLInputElement).value) || 0;
        const c1 = parseFloat((document.getElementById('le-c1') as HTMLInputElement).value) || 0;
        const a2 = parseFloat((document.getElementById('le-a2') as HTMLInputElement).value) || 0;
        const b2 = parseFloat((document.getElementById('le-b2') as HTMLInputElement).value) || 0;
        const c2 = parseFloat((document.getElementById('le-c2') as HTMLInputElement).value) || 0;
        const det = a1 * b2 - a2 * b1;
        if (det === 0) {
          document.getElementById('le-result')!.textContent = 'No unique solution';
          document.getElementById('le-d1')!.textContent = '-';
          document.getElementById('le-d2')!.textContent = '-';
          document.getElementById('le-steps')!.innerHTML = '<div>Determinant = 0 (parallel or coincident lines)</div>';
        } else {
          const x = (c1 * b2 - c2 * b1) / det;
          const y = (a1 * c2 - a2 * c1) / det;
          document.getElementById('le-result')!.textContent = `x = ${x.toFixed(4)}, y = ${y.toFixed(4)}`;
          document.getElementById('le-d1-label')!.textContent = 'Determinant';
          document.getElementById('le-d1')!.textContent = det.toFixed(2);
          document.getElementById('le-d2-label')!.textContent = 'Intersection';
          document.getElementById('le-d2')!.textContent = `(${x.toFixed(2)}, ${y.toFixed(2)})`;
          const steps = [
            `<div>Using Cramer's rule: det = ${a1}×${b2} - ${a2}×${b1} = ${det}</div>`,
            `<div>x = (${c1}×${b2} - ${c2}×${b1}) / ${det} = ${x.toFixed(4)}</div>`,
            `<div>y = (${a1}×${c2} - ${a2}×${c1}) / ${det} = ${y.toFixed(4)}</div>`,
            `<div class="font-bold text-primary">Verify Eq1: ${a1}(${x.toFixed(2)}) + ${b1}(${y.toFixed(2)}) = ${(a1 * x + b1 * y).toFixed(2)} ✓</div>`,
          ];
          document.getElementById('le-steps')!.innerHTML = steps.join('');
        }
      }
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.le-mode').forEach(b => b.addEventListener('click', () => {
        leMode = (b as HTMLButtonElement).dataset.mode!;
        document.querySelectorAll('.le-mode').forEach(btn => {
          const active = (btn as HTMLButtonElement).dataset.mode === leMode;
          (btn as HTMLButtonElement).className = `le-mode flex-1 py-2 rounded-xl font-bold text-sm border-2 ${active ? 'border-primary bg-blue-50 text-primary' : 'border-border text-text-muted'}`;
        });
        document.getElementById('le-single-section')!.classList.toggle('hidden', leMode !== 'single');
        document.getElementById('le-system-section')!.classList.toggle('hidden', leMode !== 'system');
        calcLE();
      }));
      document.querySelectorAll('.le-in').forEach(el => { el.addEventListener('input', calcLE); el.addEventListener('change', calcLE); });
      calcLE();
    }, 50);
  </script>
</CalculatorLayout>
