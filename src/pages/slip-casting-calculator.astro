---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Slip Casting Calculator - Volume, Specific Gravity & Water Content";
const description = "Calculate slip casting volume, specific gravity, water content, and deflocculant amounts for plaster mold casting.";
const relatedCalcs = [
  { name: "Ceramic Mold Calculator", url: "/ceramic-mold-calculator", description: "Plaster mold mixing ratios." },
  { name: "Clay Weight Calculator", url: "/clay-weight-calculator", description: "Clay weight for forms." },
  { name: "Clay Shrinkage Calculator", url: "/clay-shrinkage-calculator", description: "Clay shrinkage rates." },
  { name: "Glaze Recipe Calculator", url: "/glaze-recipe-calculator", description: "Scale glaze recipes." },
  { name: "Kiln Temperature Calculator", url: "/kiln-temperature-calculator", description: "Firing schedules." },
  { name: "Pottery Pricing Calculator", url: "/pottery-pricing-calculator", description: "Price your pottery." },
];
---
<CalculatorLayout
  title={title}
  description={description}
  calculatorName="Slip Casting Calculator"
  keywords="slip casting, casting slip, specific gravity, deflocculant, plaster mold, casting volume, slip recipe, ceramic casting"
  breadcrumbs={[{ name: "Slip Casting Calculator", url: "/slip-casting-calculator" }]}
>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Slip Casting Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate slip batch quantities, specific gravity, and water-to-clay ratios for casting slip preparation.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="mb-5">
        <label class="block text-sm font-medium text-text mb-2">Dry Clay Weight (lbs)</label>
        <input type="number" id="slc-clay" class="slc-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="50" min="1" step="1">
      </div>

      <div class="mb-5">
        <label class="block text-sm font-medium text-text mb-2">Water (% of clay weight)</label>
        <input type="number" id="slc-water-pct" class="slc-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="45" min="30" max="70" step="1">
        <p class="text-xs text-text-muted mt-1">Typical casting slip: 40-50% water by weight of dry clay</p>
      </div>

      <div class="mb-5">
        <label class="block text-sm font-medium text-text mb-2">Deflocculant Type</label>
        <select id="slc-defloc" class="slc-in w-full px-4 py-3 border border-border rounded-xl text-lg">
          <option value="sodium_silicate" selected>Sodium Silicate</option>
          <option value="darvan">Darvan 7 / 811</option>
          <option value="both">Sodium Silicate + Soda Ash (combo)</option>
        </select>
      </div>

      <div class="mb-5">
        <label class="block text-sm font-medium text-text mb-2">Deflocculant (% of clay weight)</label>
        <input type="number" id="slc-defloc-pct" class="slc-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="0.3" min="0.1" max="1.0" step="0.05">
        <p class="text-xs text-text-muted mt-1">Typical: 0.2-0.5% for sodium silicate, 0.1-0.3% for Darvan</p>
      </div>

      <div class="mb-5">
        <label class="block text-sm font-medium text-text mb-2">Target Specific Gravity</label>
        <input type="number" id="slc-sg" class="slc-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="1.75" min="1.5" max="2.0" step="0.01">
        <p class="text-xs text-text-muted mt-1">Typical casting slip: 1.70-1.80</p>
      </div>

      <!-- Primary Result -->
      <div class="p-6 bg-primary rounded-2xl text-white text-center mb-4">
        <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Total Slip Volume</div>
        <div class="text-4xl font-extrabold" id="slc-volume">--</div>
        <div class="text-sm text-blue-200 mt-1">gallons</div>
      </div>

      <div class="grid grid-cols-2 gap-4 mb-4">
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Water Needed</div>
          <div class="text-xl font-bold" id="slc-water">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Deflocculant</div>
          <div class="text-xl font-bold" id="slc-defloc-amt">--</div>
        </div>
      </div>

      <div class="grid grid-cols-2 gap-4 mb-4">
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Actual Sp. Gravity</div>
          <div class="text-xl font-bold" id="slc-actual-sg">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Total Batch Weight</div>
          <div class="text-xl font-bold" id="slc-total-wt">--</div>
        </div>
      </div>

      <div class="p-4 bg-surface-alt rounded-xl mb-4">
        <h3 class="font-semibold text-sm text-text mb-2">Mixing Notes</h3>
        <p class="text-xs text-text-muted" id="slc-notes">--</p>
      </div>

      <ShareButton calculatorId="slip-casting" />
      <FeedbackWidget />
    </div>

    <article class="mt-12 max-w-4xl prose prose-slate">
      <h2 class="text-2xl font-bold text-text">Slip Casting Basics</h2>
      <p>Casting slip is a liquid clay mixture that is poured into plaster molds. The plaster absorbs water from the slip, building up a wall of clay. The key is getting the right balance of water, clay, and deflocculant for proper flow and casting properties.</p>
      <h3 class="text-xl font-semibold text-text mt-8">Tips for Good Casting Slip</h3>
      <ul>
        <li>Add deflocculant to water first, then slowly add dry clay</li>
        <li>Mix thoroughly with a drill mixer for at least 15 minutes</li>
        <li>Let slip age 24 hours before use for best results</li>
        <li>Screen through 60-80 mesh sieve to remove lumps</li>
        <li>Check specific gravity with a hydrometer regularly</li>
      </ul>
    </article>

    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    function calcSLC() {
      const clayLbs = parseFloat((document.getElementById('slc-clay') as HTMLInputElement).value) || 50;
      const waterPct = parseFloat((document.getElementById('slc-water-pct') as HTMLInputElement).value) || 45;
      const deflocType = (document.getElementById('slc-defloc') as HTMLSelectElement).value;
      const deflocPct = parseFloat((document.getElementById('slc-defloc-pct') as HTMLInputElement).value) || 0.3;
      const targetSG = parseFloat((document.getElementById('slc-sg') as HTMLInputElement).value) || 1.75;

      const waterLbs = clayLbs * (waterPct / 100);
      const deflocLbs = clayLbs * (deflocPct / 100);
      const totalWeight = clayLbs + waterLbs + deflocLbs;

      // Clay specific gravity ~2.6, water = 1.0
      const clayVolGal = clayLbs / (2.6 * 8.34); // 8.34 lbs per gallon of water
      const waterVolGal = waterLbs / 8.34;
      const totalVolGal = clayVolGal + waterVolGal;

      // Actual specific gravity
      const actualSG = totalWeight / (totalVolGal * 8.34);

      document.getElementById('slc-volume')!.textContent = totalVolGal.toFixed(2) + ' gal';
      document.getElementById('slc-water')!.textContent = waterLbs.toFixed(1) + ' lbs (' + (waterLbs / 8.34).toFixed(2) + ' gal)';

      // Deflocculant display
      const deflocOz = deflocLbs * 16;
      let deflocDisplay = deflocOz.toFixed(1) + ' oz';
      if (deflocType === 'both') {
        deflocDisplay = (deflocOz * 0.67).toFixed(1) + ' oz SS + ' + (deflocOz * 0.33).toFixed(1) + ' oz SA';
      }
      document.getElementById('slc-defloc-amt')!.textContent = deflocDisplay;

      document.getElementById('slc-actual-sg')!.textContent = actualSG.toFixed(3);
      document.getElementById('slc-total-wt')!.textContent = totalWeight.toFixed(1) + ' lbs';

      // Notes
      let notes = '';
      if (actualSG < 1.65) notes = 'Slip is thin. Reduce water or add more clay for better casting walls.';
      else if (actualSG > 1.85) notes = 'Slip is thick. May have trouble pouring. Add water or deflocculant.';
      else notes = 'Specific gravity is in good casting range.';

      if (Math.abs(actualSG - targetSG) > 0.05) {
        const adjustment = targetSG > actualSG ? 'Reduce water by ~' + Math.round((actualSG - targetSG) * -10 * waterLbs / 100) + ' lbs to reach target SG.' :
          'Add ~' + Math.round((actualSG - targetSG) * 10 * waterLbs / 100) + ' lbs water to reach target SG.';
        notes += ' ' + adjustment;
      }

      document.getElementById('slc-notes')!.textContent = notes;

      document.dispatchEvent(new CustomEvent('calc-update'));
    }

    setTimeout(() => {
      document.querySelectorAll('.slc-in').forEach(el => {
        el.addEventListener('input', calcSLC);
        el.addEventListener('change', calcSLC);
      });
      calcSLC();
    }, 50);
  </script>
</CalculatorLayout>
