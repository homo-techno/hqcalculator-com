---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Textbook Cost Calculator - Compare Buy, Rent & Digital";
const description = "Calculate textbook costs per semester, compare buying vs renting vs digital, and estimate 4-year total spending.";
const relatedCalcs = [
  { name: "Scholarship", url: "/scholarship-calculator", description: "Scholarships." },
  { name: "Student Loan", url: "/student-loan-calculator", description: "Loans." },
  { name: "Budget Calculator", url: "/budget-calculator", description: "Budgeting." },
  { name: "Savings Calculator", url: "/savings-calculator", description: "Savings." },
  { name: "Percentage Calculator", url: "/percentage-calculator", description: "Percentages." },
  { name: "Discount Calculator", url: "/discount-calculator", description: "Discounts." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Textbook Cost Calculator" keywords="textbook cost, college textbooks, rent vs buy textbooks, digital textbooks, textbook savings" breadcrumbs={[{ name: "Textbook Cost", url: "/textbook-cost-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Textbook Cost Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Compare textbook costs across formats and plan your budget.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Courses per Semester</label><input type="number" id="tb-courses" class="tb-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="5" min="1" max="10" step="1"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Avg Textbook Price ($)</label><input type="number" id="tb-price" class="tb-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="120" min="10" step="5"></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Semesters per Year</label><input type="number" id="tb-sems" class="tb-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="2" min="1" max="4" step="1"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Years of Study</label><input type="number" id="tb-years" class="tb-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="4" min="1" max="8" step="1"></div>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Format</label>
          <select id="tb-format" class="tb-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="buy">Buy New</option>
            <option value="used">Buy Used (avg 60% of new)</option>
            <option value="rent">Rent (avg 40% of new)</option>
            <option value="digital">Digital/eBook (avg 50% of new)</option>
          </select>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Semester Cost</div>
          <div class="text-5xl font-extrabold font-mono" id="tb-sem-cost">$0</div>
          <div class="text-sm text-blue-200 mt-1" id="tb-format-label">Buy New</div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Annual Cost</div><div class="text-xl font-bold" id="tb-annual">$0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Total (All Years)</div><div class="text-xl font-bold" id="tb-total">$0</div></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-3">Savings by Format vs Buy New</h3>
          <div class="space-y-2" id="tb-compare"></div>
        </div>
      </div>
      <ShareButton calculatorId="textbook-cost" />
      <FeedbackWidget />
    </div>
    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">Textbook Cost Strategies</h2>
      <p>The average student spends $1,200+ per year on textbooks. Renting, buying used, or going digital can save 40-60%. Check your library, open educational resources (OER), and older editions for additional savings.</p>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcTB() {
      const courses = parseFloat((document.getElementById('tb-courses') as HTMLInputElement).value) || 5;
      const price = parseFloat((document.getElementById('tb-price') as HTMLInputElement).value) || 120;
      const sems = parseFloat((document.getElementById('tb-sems') as HTMLInputElement).value) || 2;
      const years = parseFloat((document.getElementById('tb-years') as HTMLInputElement).value) || 4;
      const format = (document.getElementById('tb-format') as HTMLSelectElement).value;
      const multipliers: Record<string, number> = { buy: 1.0, used: 0.60, rent: 0.40, digital: 0.50 };
      const labels: Record<string, string> = { buy: 'Buy New', used: 'Buy Used', rent: 'Rent', digital: 'Digital/eBook' };
      const mult = multipliers[format];
      const semCost = Math.round(courses * price * mult);
      const annualCost = semCost * sems;
      const totalCost = annualCost * years;
      const buyNewSem = courses * price;
      const buyNewTotal = buyNewSem * sems * years;
      document.getElementById('tb-sem-cost')!.textContent = '$' + semCost.toLocaleString();
      document.getElementById('tb-format-label')!.textContent = labels[format];
      document.getElementById('tb-annual')!.textContent = '$' + annualCost.toLocaleString();
      document.getElementById('tb-total')!.textContent = '$' + totalCost.toLocaleString();
      const formats = ['used', 'rent', 'digital'];
      const compareHTML = formats.map(f => {
        const fTotal = Math.round(buyNewSem * multipliers[f]) * sems * years;
        const saved = buyNewTotal - fTotal;
        const pct = Math.round(saved / buyNewTotal * 100);
        return `<div class="flex justify-between items-center py-1 border-b border-border last:border-0"><span class="text-sm">${labels[f]}</span><span class="text-sm font-bold text-green-600">Save $${saved.toLocaleString()} (${pct}%)</span></div>`;
      }).join('');
      document.getElementById('tb-compare')!.innerHTML = compareHTML;
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => { document.querySelectorAll('.tb-in').forEach(el => { el.addEventListener('input', calcTB); el.addEventListener('change', calcTB); }); calcTB(); }, 50);
  </script>
</CalculatorLayout>
