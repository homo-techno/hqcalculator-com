---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Cognitive Load Calculator - Intrinsic, Extraneous & Germane";
const description = "Estimate your total cognitive load across intrinsic, extraneous, and germane dimensions. Identify overload risks and simplification strategies.";
const relatedCalcs = [
  { name: "Productivity Calculator", url: "/productivity-calculator", description: "Productivity metrics." },
  { name: "Study Time", url: "/study-time-calculator", description: "Study planning." },
  { name: "Pomodoro Calculator", url: "/pomodoro-calculator", description: "Pomodoro timer." },
  { name: "Reading Time", url: "/reading-time-calculator", description: "Reading duration." },
  { name: "Spaced Repetition", url: "/spaced-repetition-calculator", description: "Review scheduling." },
  { name: "Average Calculator", url: "/average-calculator", description: "Compute averages." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Cognitive Load Calculator" keywords="cognitive load, intrinsic load, extraneous load, germane load, cognitive overload, working memory, instructional design" breadcrumbs={[{ name: "Cognitive Load", url: "/cognitive-load-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Cognitive Load Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Estimate your total cognitive load and whether you are approaching overload based on Sweller's Cognitive Load Theory.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <h3 class="font-semibold text-text">Intrinsic Load (task complexity)</h3>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Number of interacting elements to process simultaneously</label>
          <input type="number" id="cl4-elements" class="cl4-in w-full px-4 py-3 border border-border rounded-xl text-lg text-center" min="1" max="20" step="1">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Your expertise level with this material (1-10)</label>
          <input type="range" id="cl4-expertise" class="cl4-in w-full" min="1" max="10" step="1">
          <div class="flex justify-between text-xs text-text-secondary"><span>Novice (1)</span><span>Expert (10)</span></div>
        </div>

        <h3 class="font-semibold text-text mt-4">Extraneous Load (poor design / distractions)</h3>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Quality of instruction/interface (1-10)</label>
          <input type="range" id="cl4-design" class="cl4-in w-full" min="1" max="10" step="1">
          <div class="flex justify-between text-xs text-text-secondary"><span>Very poor (1)</span><span>Excellent (10)</span></div>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Environmental distractions (1-10)</label>
          <input type="range" id="cl4-distract" class="cl4-in w-full" min="1" max="10" step="1">
          <div class="flex justify-between text-xs text-text-secondary"><span>Quiet/focused (1)</span><span>Very distracting (10)</span></div>
        </div>

        <h3 class="font-semibold text-text mt-4">Germane Load (learning effort)</h3>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Active learning engagement (1-10)</label>
          <input type="range" id="cl4-engage" class="cl4-in w-full" min="1" max="10" step="1">
          <div class="flex justify-between text-xs text-text-secondary"><span>Passive (1)</span><span>Deeply engaged (10)</span></div>
        </div>

        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm opacity-80">Total Cognitive Load</div>
          <div class="text-2xl font-extrabold mt-1" id="cl4-total">--</div>
        </div>

        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-secondary">Intrinsic</div>
            <div class="text-xl font-bold text-text mt-1" id="cl4-intr">--</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-secondary">Extraneous</div>
            <div class="text-xl font-bold text-text mt-1" id="cl4-extr">--</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-secondary">Germane</div>
            <div class="text-xl font-bold text-text mt-1" id="cl4-germ">--</div>
          </div>
        </div>

        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-secondary">Overload Threshold</div>
          <div class="text-xl font-bold text-text mt-1" id="cl4-threshold">--</div>
        </div>

        <div class="p-4 bg-surface-alt rounded-xl">
          <div class="text-xs text-text-secondary mb-2">Simplification Strategies</div>
          <div class="text-sm text-text" id="cl4-strat">--</div>
        </div>
      </div>

      <ShareButton calculatorId="cognitive-load" />
      <FeedbackWidget />
    </div>

    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    function calcCL4() {
      const elements = parseInt((document.getElementById('cl4-elements') as HTMLInputElement).value) || 5;
      const expertise = parseInt((document.getElementById('cl4-expertise') as HTMLInputElement).value) || 3;
      const design = parseInt((document.getElementById('cl4-design') as HTMLInputElement).value) || 5;
      const distract = parseInt((document.getElementById('cl4-distract') as HTMLInputElement).value) || 3;
      const engage = parseInt((document.getElementById('cl4-engage') as HTMLInputElement).value) || 5;

      // Intrinsic load: element interactivity reduced by expertise (schemas)
      const expertiseFactor = 1 - (expertise - 1) * 0.08; // 1.0 down to 0.28
      const intrinsic = Math.min(10, elements * expertiseFactor);

      // Extraneous load: poor design + distractions
      const extraneous = ((11 - design) + distract) / 2;

      // Germane load: beneficial cognitive effort for schema construction
      const germane = engage * 0.6;

      const total = intrinsic + extraneous + germane;
      const capacity = 10; // Working memory capacity in arbitrary units
      const overloadPct = (total / capacity) * 100;

      let status = '';
      if (overloadPct <= 70) status = total.toFixed(1) + ' / 10 - Within capacity';
      else if (overloadPct <= 100) status = total.toFixed(1) + ' / 10 - Near capacity';
      else status = total.toFixed(1) + ' / 10 - OVERLOADED';

      document.getElementById('cl4-total')!.textContent = status;
      document.getElementById('cl4-intr')!.textContent = intrinsic.toFixed(1) + ' / 10';
      document.getElementById('cl4-extr')!.textContent = extraneous.toFixed(1) + ' / 10';
      document.getElementById('cl4-germ')!.textContent = germane.toFixed(1) + ' / 10';
      document.getElementById('cl4-threshold')!.textContent = overloadPct.toFixed(0) + '% of capacity used';

      let strategies: string[] = [];
      if (intrinsic > 5) {
        strategies.push('Break the task into smaller sub-tasks with fewer interacting elements.');
        if (expertise < 5) strategies.push('Build prerequisite knowledge first (schemas reduce intrinsic load).');
      }
      if (extraneous > 4) {
        if (design < 5) strategies.push('Improve instructional design: use worked examples, reduce split attention, integrate text with diagrams.');
        if (distract > 5) strategies.push('Reduce distractions: find a quiet space, silence notifications, use noise-canceling headphones.');
      }
      if (germane < 3) {
        strategies.push('Increase active engagement: self-explain, practice retrieval, create concept maps.');
      }
      if (overloadPct > 100) {
        strategies.push('CRITICAL: You are cognitively overloaded. Reduce extraneous load first, then simplify the task.');
      }
      if (strategies.length === 0) {
        strategies.push('Your cognitive load is well-balanced. Good conditions for effective learning.');
      }

      document.getElementById('cl4-strat')!.textContent = strategies.join(' ');

      document.dispatchEvent(new CustomEvent('calc-update'));
    }

    setTimeout(() => {
      (document.getElementById('cl4-elements') as HTMLInputElement).value = '5';
      (document.getElementById('cl4-expertise') as HTMLInputElement).value = '3';
      (document.getElementById('cl4-design') as HTMLInputElement).value = '5';
      (document.getElementById('cl4-distract') as HTMLInputElement).value = '3';
      (document.getElementById('cl4-engage') as HTMLInputElement).value = '5';
      document.querySelectorAll('.cl4-in').forEach(el => {
        el.addEventListener('input', calcCL4);
        el.addEventListener('change', calcCL4);
      });
      calcCL4();
    }, 50);
  </script>
</CalculatorLayout>
