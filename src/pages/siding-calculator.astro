---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';

const title = "Siding Calculator - Squares, Waste Factor & Trim Pieces";
const description = "Calculate siding material for your home. Enter wall dimensions and openings to get net square feet, squares, waste factor, starter strip, J-channel, and corners.";

const relatedCalcs = [
  { name: "Soffit Calculator", url: "/soffit-calculator", description: "Soffit and fascia." },
  { name: "Mortar Calculator", url: "/mortar-calculator", description: "Mortar for brick." },
  { name: "Patio Calculator", url: "/patio-calculator", description: "Patio material." },
  { name: "Garage Door Calculator", url: "/garage-door-calculator", description: "Garage door sizing." },
  { name: "Pergola Calculator", url: "/pergola-calculator", description: "Pergola lumber." },
  { name: "Fire Pit Calculator", url: "/fire-pit-calculator", description: "Fire pit materials." },
];
---

<CalculatorLayout
  title={title}
  description={description}
  calculatorName="Siding Calculator"
  keywords="siding calculator, vinyl siding, siding squares, J-channel, starter strip, siding waste, house siding"
  breadcrumbs={[{ name: "Siding Calculator", url: "/siding-calculator" }]}
>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Siding Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Estimate siding material, trim, and accessories for exterior cladding projects.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8">
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
        <div>
          <div class="grid grid-cols-2 gap-3 mb-5">
            <div>
              <label class="block text-xs font-medium text-text mb-1">Wall Height (ft)</label>
              <input type="number" id="sd2-height" class="w-full px-3 py-3 border border-border rounded-xl text-lg" value="9" min="1" step="0.5">
            </div>
            <div>
              <label class="block text-xs font-medium text-text mb-1">House Perimeter (ft)</label>
              <input type="number" id="sd2-perim" class="w-full px-3 py-3 border border-border rounded-xl text-lg" value="160" min="10" step="1">
            </div>
          </div>

          <h3 class="text-sm font-semibold text-text mb-3">Openings to Deduct</h3>
          <div class="grid grid-cols-2 gap-3 mb-3">
            <div>
              <label class="block text-xs font-medium text-text mb-1">Windows (count)</label>
              <input type="number" id="sd2-windows" class="w-full px-3 py-3 border border-border rounded-xl text-lg" value="10" min="0" step="1">
            </div>
            <div>
              <label class="block text-xs font-medium text-text mb-1">Avg Window Area (sq ft)</label>
              <input type="number" id="sd2-winarea" class="w-full px-3 py-3 border border-border rounded-xl text-lg" value="15" min="0" step="1">
            </div>
          </div>
          <div class="grid grid-cols-2 gap-3 mb-5">
            <div>
              <label class="block text-xs font-medium text-text mb-1">Doors (count)</label>
              <input type="number" id="sd2-doors" class="w-full px-3 py-3 border border-border rounded-xl text-lg" value="2" min="0" step="1">
            </div>
            <div>
              <label class="block text-xs font-medium text-text mb-1">Avg Door Area (sq ft)</label>
              <input type="number" id="sd2-doorarea" class="w-full px-3 py-3 border border-border rounded-xl text-lg" value="21" min="0" step="1">
            </div>
          </div>

          <div class="p-4 bg-surface-alt rounded-xl">
            <div class="grid grid-cols-2 gap-3">
              <div>
                <label class="block text-xs font-medium text-text mb-1">Waste Factor (%)</label>
                <input type="number" id="sd2-waste" class="w-full px-3 py-2 border border-border rounded-lg" value="10" min="5" max="25" step="1">
              </div>
              <div>
                <label class="block text-xs font-medium text-text mb-1">Outside Corners</label>
                <input type="number" id="sd2-corners" class="w-full px-3 py-2 border border-border rounded-lg" value="4" min="0" step="1">
              </div>
            </div>
          </div>
        </div>

        <div class="space-y-3">
          <div class="p-6 bg-primary rounded-2xl text-white text-center">
            <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Net Siding Area</div>
            <div class="text-5xl font-extrabold font-mono" id="sd2-netsf">0</div>
            <div class="text-sm text-blue-200 mt-1">square feet (after openings)</div>
          </div>
          <div class="grid grid-cols-2 gap-3">
            <div class="p-4 bg-surface-alt rounded-xl text-center">
              <div class="text-xs text-text-muted uppercase">Squares (100 sf)</div>
              <div class="text-xl font-bold" id="sd2-squares">0</div>
              <div class="text-xs text-text-muted">with waste</div>
            </div>
            <div class="p-4 bg-surface-alt rounded-xl text-center">
              <div class="text-xs text-text-muted uppercase">Gross Wall Area</div>
              <div class="text-xl font-bold" id="sd2-gross">0 sq ft</div>
            </div>
          </div>
          <div class="grid grid-cols-2 gap-3">
            <div class="p-4 bg-surface-alt rounded-xl text-center">
              <div class="text-xs text-text-muted uppercase">Starter Strip</div>
              <div class="text-xl font-bold" id="sd2-starter">0 pcs</div>
              <div class="text-xs text-text-muted">12.5 ft pieces</div>
            </div>
            <div class="p-4 bg-surface-alt rounded-xl text-center">
              <div class="text-xs text-text-muted uppercase">J-Channel</div>
              <div class="text-xl font-bold" id="sd2-jchannel">0 pcs</div>
              <div class="text-xs text-text-muted">12.5 ft pieces</div>
            </div>
          </div>
          <div class="grid grid-cols-2 gap-3">
            <div class="p-4 bg-surface-alt rounded-xl text-center">
              <div class="text-xs text-text-muted uppercase">Corner Posts</div>
              <div class="text-xl font-bold" id="sd2-cornerposts">0 pcs</div>
            </div>
            <div class="p-4 bg-surface-alt rounded-xl text-center">
              <div class="text-xs text-text-muted uppercase">Openings Deducted</div>
              <div class="text-xl font-bold" id="sd2-openings">0 sq ft</div>
            </div>
          </div>
        </div>
      </div>

      <ShareButton calculatorId="siding" />
      <FeedbackWidget />
    </div>

    <article class="mt-12 max-w-4xl prose prose-slate">
      <h2 class="text-2xl font-bold text-text">How to Calculate Siding</h2>
      <div class="bg-surface-alt rounded-xl p-4 my-4 font-mono text-sm space-y-1">
        <p><strong>Gross area:</strong> Perimeter x Wall height</p>
        <p><strong>Net area:</strong> Gross - Window area - Door area</p>
        <p><strong>Squares:</strong> Net area x (1 + Waste) / 100</p>
      </div>

      <h3 class="text-xl font-semibold text-text mt-8">Siding Accessories</h3>
      <ul>
        <li><strong>Starter strip:</strong> Goes at the bottom - total house perimeter</li>
        <li><strong>J-channel:</strong> Around all windows, doors, and under soffits</li>
        <li><strong>Corner posts:</strong> Each outside corner needs one post per story</li>
        <li><strong>Utility trim:</strong> Used where siding meets soffit and at top of walls</li>
      </ul>
    </article>

    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    function calcSiding() {
      const height = parseFloat((document.getElementById('sd2-height') as HTMLInputElement).value) || 0;
      const perim = parseFloat((document.getElementById('sd2-perim') as HTMLInputElement).value) || 0;
      const windows = parseInt((document.getElementById('sd2-windows') as HTMLInputElement).value) || 0;
      const winArea = parseFloat((document.getElementById('sd2-winarea') as HTMLInputElement).value) || 0;
      const doors = parseInt((document.getElementById('sd2-doors') as HTMLInputElement).value) || 0;
      const doorArea = parseFloat((document.getElementById('sd2-doorarea') as HTMLInputElement).value) || 0;
      const waste = (parseFloat((document.getElementById('sd2-waste') as HTMLInputElement).value) || 10) / 100;
      const corners = parseInt((document.getElementById('sd2-corners') as HTMLInputElement).value) || 0;

      const grossArea = perim * height;
      const openingArea = (windows * winArea) + (doors * doorArea);
      const netArea = Math.max(0, grossArea - openingArea);
      const areaWithWaste = netArea * (1 + waste);
      const squares = areaWithWaste / 100;

      // Starter strip: perimeter / 12.5 ft per piece
      const starterPcs = Math.ceil(perim / 12.5);

      // J-channel: around each window (perimeter) + each door (perimeter) + under soffit (perimeter)
      // Average window perimeter ~14 ft, door perimeter ~17 ft
      const jChannelFt = (windows * 14) + (doors * 17) + perim;
      const jChannelPcs = Math.ceil(jChannelFt / 12.5);

      // Corner posts: one per corner
      const cornerPosts = corners;

      document.getElementById('sd2-netsf')!.textContent = Math.ceil(netArea).toLocaleString();
      document.getElementById('sd2-squares')!.textContent = squares.toFixed(1);
      document.getElementById('sd2-gross')!.textContent = grossArea.toLocaleString() + ' sq ft';
      document.getElementById('sd2-starter')!.textContent = starterPcs + ' pcs';
      document.getElementById('sd2-jchannel')!.textContent = jChannelPcs + ' pcs';
      document.getElementById('sd2-cornerposts')!.textContent = cornerPosts + ' pcs';
      document.getElementById('sd2-openings')!.textContent = openingArea.toLocaleString() + ' sq ft';

      document.dispatchEvent(new CustomEvent('calc-update'));
    }

    setTimeout(() => {
      document.querySelectorAll('#sd2-height, #sd2-perim, #sd2-windows, #sd2-winarea, #sd2-doors, #sd2-doorarea, #sd2-waste, #sd2-corners').forEach(el => {
        el.addEventListener('input', calcSiding);
        el.addEventListener('change', calcSiding);
      });
      calcSiding();
    }, 50);
  </script>
</CalculatorLayout>
