---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Resistor Color Code Calculator";
const description = "Decode resistor color bands to find resistance value, or find color bands from resistance.";
const relatedCalcs = [
  { name: "Ohm's Law", url: "/ohms-law-calculator", description: "Ohm's law." },
  { name: "Electricity Cost", url: "/electricity-cost-calculator", description: "Electricity." },
  { name: "Hex Calculator", url: "/hex-calculator", description: "Hex." },
  { name: "Color Converter", url: "/color-converter", description: "Colors." },
  { name: "Scientific Notation", url: "/scientific-notation-calculator", description: "Sci notation." },
  { name: "Number Base Converter", url: "/number-base-converter", description: "Base converter." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Resistor Color Code Calculator" keywords="resistor color code, resistance calculator, 4 band resistor, 5 band resistor, electronic components" breadcrumbs={[{ name: "Resistor Color Code", url: "/resistor-color-code-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Resistor Color Code Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Decode resistor color bands to find resistance value.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="flex gap-2 mb-2">
          <button id="rc-m1" class="rc-mode flex-1 py-2 rounded-xl border-2 border-primary bg-blue-50 text-primary font-bold text-sm" data-mode="4">4-Band</button>
          <button id="rc-m2" class="rc-mode flex-1 py-2 rounded-xl border-2 border-border text-text-muted font-bold text-sm" data-mode="5">5-Band</button>
        </div>
        <div class="grid gap-3" id="rc-bands">
          <div><label class="block text-xs font-medium text-text mb-1">Band 1</label><select id="rc-b1" class="rc-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold"><option value="1">Brown (1)</option><option value="2" selected>Red (2)</option><option value="3">Orange (3)</option><option value="4">Yellow (4)</option><option value="5">Green (5)</option><option value="6">Blue (6)</option><option value="7">Violet (7)</option><option value="8">Grey (8)</option><option value="9">White (9)</option></select></div>
          <div><label class="block text-xs font-medium text-text mb-1">Band 2</label><select id="rc-b2" class="rc-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold"><option value="0">Black (0)</option><option value="1">Brown (1)</option><option value="2" selected>Red (2)</option><option value="3">Orange (3)</option><option value="4">Yellow (4)</option><option value="5">Green (5)</option><option value="6">Blue (6)</option><option value="7">Violet (7)</option><option value="8">Grey (8)</option><option value="9">White (9)</option></select></div>
          <div id="rc-b3-wrap" class="hidden"><label class="block text-xs font-medium text-text mb-1">Band 3</label><select id="rc-b3" class="rc-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold"><option value="0" selected>Black (0)</option><option value="1">Brown (1)</option><option value="2">Red (2)</option><option value="3">Orange (3)</option><option value="4">Yellow (4)</option><option value="5">Green (5)</option><option value="6">Blue (6)</option><option value="7">Violet (7)</option><option value="8">Grey (8)</option><option value="9">White (9)</option></select></div>
          <div><label class="block text-xs font-medium text-text mb-1">Multiplier</label><select id="rc-mult" class="rc-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold"><option value="1">Black (×1)</option><option value="10">Brown (×10)</option><option value="100" selected>Red (×100)</option><option value="1000">Orange (×1K)</option><option value="10000">Yellow (×10K)</option><option value="100000">Green (×100K)</option><option value="1000000">Blue (×1M)</option><option value="10000000">Violet (×10M)</option><option value="0.1">Gold (×0.1)</option><option value="0.01">Silver (×0.01)</option></select></div>
          <div><label class="block text-xs font-medium text-text mb-1">Tolerance</label><select id="rc-tol" class="rc-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold"><option value="1">Brown (±1%)</option><option value="2">Red (±2%)</option><option value="0.5">Green (±0.5%)</option><option value="0.25">Blue (±0.25%)</option><option value="0.1">Violet (±0.1%)</option><option value="5" selected>Gold (±5%)</option><option value="10">Silver (±10%)</option><option value="20">None (±20%)</option></select></div>
        </div>
        <div class="flex justify-center gap-2 py-4" id="rc-visual"></div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Resistance</div>
          <div class="text-5xl font-extrabold font-mono" id="rc-result">0 Ω</div>
          <div class="text-sm text-blue-200 mt-1" id="rc-tol-text">±5%</div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Min Value</div><div class="text-xl font-bold font-mono" id="rc-min">0 Ω</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Max Value</div><div class="text-xl font-bold font-mono" id="rc-max">0 Ω</div></div>
        </div>
      </div>
      <ShareButton calculatorId="resistor-color-code" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    let rcBands = 4;
    const BAND_COLORS: Record<string, string> = { '0': '#000', '1': '#8B4513', '2': '#FF0000', '3': '#FFA500', '4': '#FFD700', '5': '#228B22', '6': '#0000FF', '7': '#8B008B', '8': '#808080', '9': '#FFF' };
    const MULT_COLORS: Record<string, string> = { '1': '#000', '10': '#8B4513', '100': '#FF0000', '1000': '#FFA500', '10000': '#FFD700', '100000': '#228B22', '1000000': '#0000FF', '10000000': '#8B008B', '0.1': '#DAA520', '0.01': '#C0C0C0' };
    const TOL_COLORS: Record<string, string> = { '1': '#8B4513', '2': '#FF0000', '0.5': '#228B22', '0.25': '#0000FF', '0.1': '#8B008B', '5': '#DAA520', '10': '#C0C0C0', '20': '#F5F5DC' };
    function fmtR(v: number): string {
      if (v >= 1e6) return (v/1e6).toFixed(v%1e6===0?0:2) + ' MΩ';
      if (v >= 1e3) return (v/1e3).toFixed(v%1e3===0?0:2) + ' kΩ';
      return v.toFixed(v<1?2:v<10?1:0) + ' Ω';
    }
    function setRcMode(m: number) {
      rcBands = m;
      document.getElementById('rc-b3-wrap')!.classList.toggle('hidden', m !== 5);
      document.querySelectorAll('.rc-mode').forEach(b => {
        const btn = b as HTMLButtonElement;
        const active = parseInt(btn.dataset.mode!) === m;
        btn.className = `rc-mode flex-1 py-2 rounded-xl border-2 font-bold text-sm ${active ? 'border-primary bg-blue-50 text-primary' : 'border-border text-text-muted'}`;
      });
      calcRC();
    }
    function calcRC() {
      const b1 = parseInt((document.getElementById('rc-b1') as HTMLSelectElement).value);
      const b2 = parseInt((document.getElementById('rc-b2') as HTMLSelectElement).value);
      const b3 = parseInt((document.getElementById('rc-b3') as HTMLSelectElement).value);
      const mult = parseFloat((document.getElementById('rc-mult') as HTMLSelectElement).value);
      const tol = parseFloat((document.getElementById('rc-tol') as HTMLSelectElement).value);
      let base = rcBands === 5 ? b1*100+b2*10+b3 : b1*10+b2;
      const resistance = base * mult;
      const min = resistance * (1 - tol/100);
      const max = resistance * (1 + tol/100);
      document.getElementById('rc-result')!.textContent = fmtR(resistance);
      document.getElementById('rc-tol-text')!.textContent = `±${tol}%`;
      document.getElementById('rc-min')!.textContent = fmtR(min);
      document.getElementById('rc-max')!.textContent = fmtR(max);
      const colors = [BAND_COLORS[String(b1)], BAND_COLORS[String(b2)]];
      if (rcBands === 5) colors.push(BAND_COLORS[String(b3)]);
      colors.push(MULT_COLORS[String(mult)] || '#000');
      colors.push(TOL_COLORS[String(tol)] || '#DAA520');
      const vis = document.getElementById('rc-visual')!;
      vis.innerHTML = `<div class="flex items-center gap-1 p-3 bg-yellow-100 rounded-xl">${colors.map((c,i) => `<div class="w-6 h-16 rounded" style="background:${c};border:1px solid #ccc" title="Band ${i+1}"></div>`).join('')}</div>`;
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.rc-mode').forEach(b => b.addEventListener('click', () => setRcMode(parseInt((b as HTMLButtonElement).dataset.mode!))));
      document.querySelectorAll('.rc-in').forEach(el => { el.addEventListener('input', calcRC); el.addEventListener('change', calcRC); });
      calcRC();
    }, 50);
  </script>
</CalculatorLayout>
