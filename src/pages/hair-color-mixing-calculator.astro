---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Hair Color Mixing Calculator - Developer Ratio & Processing Time";
const description = "Calculate hair dye mixing ratios, developer volume, color amount, and processing time for perfect hair color results every time.";
const relatedCalcs = [
  { name: "Hair Developer Calculator", url: "/hair-developer-calculator", description: "Developer volume selection for lift levels." },
  { name: "Hair Lightening Calculator", url: "/hair-lightening-calculator", description: "Bleach mixing ratio and processing time." },
  { name: "Hair Growth Calculator", url: "/hair-growth-calculator", description: "Hair growth rate and length projection." },
  { name: "Hair Porosity Calculator", url: "/hair-porosity-calculator", description: "Hair porosity assessment and product tips." },
  { name: "Hair Extension Calculator", url: "/hair-extension-calculator", description: "Extension bundle count by method." },
  { name: "Chemical Peel Calculator", url: "/chemical-peel-calculator", description: "Peel depth and recovery time." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Hair Color Mixing Calculator" keywords="hair color mixing, developer ratio, hair dye, processing time, color formula, salon color" breadcrumbs={[{ name: "Hair Color Mixing", url: "/hair-color-mixing-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Hair Color Mixing Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate the perfect hair dye mixing ratios, developer volume, and processing time.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div>
          <label class="block text-xs font-medium text-text mb-1">Color Service Type</label>
          <select id="hcm-service" class="hcm-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="permanent">Permanent Color</option>
            <option value="demi">Demi-Permanent</option>
            <option value="semi">Semi-Permanent</option>
            <option value="highLift">High Lift Color</option>
          </select>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Developer Volume</label>
          <select id="hcm-developer" class="hcm-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="10">10 Volume (1 level lift)</option>
            <option value="20" selected>20 Volume (2 levels lift)</option>
            <option value="30">30 Volume (3 levels lift)</option>
            <option value="40">40 Volume (4 levels lift)</option>
          </select>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Mixing Ratio</label>
          <select id="hcm-ratio" class="hcm-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="1">1:1 (Standard)</option>
            <option value="1.5">1:1.5 (Extra Coverage)</option>
            <option value="2">1:2 (High Lift / Lighteners)</option>
          </select>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Color Tubes Needed</label><input type="number" id="hcm-tubes" class="hcm-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="1" min="0.5" max="5" step="0.5"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Tube Size (g)</label><input type="number" id="hcm-tubesize" class="hcm-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="60" min="30" max="120" step="10"></div>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Hair Length</label>
          <select id="hcm-length" class="hcm-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="short">Short (above shoulders)</option>
            <option value="medium" selected>Medium (shoulder length)</option>
            <option value="long">Long (past shoulders)</option>
            <option value="vlong">Very Long (mid-back+)</option>
          </select>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Total Mix Volume</div>
          <div class="text-5xl font-extrabold font-mono" id="hcm-total">0 g</div>
          <div class="text-sm text-blue-200 mt-1">color + developer combined</div>
        </div>
        <div class="grid grid-cols-2 gap-4">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Color Amount</div><div class="text-xl font-bold" id="hcm-color">0 g</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Developer Amount</div><div class="text-xl font-bold" id="hcm-dev">0 g</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Processing Time</div><div class="text-xl font-bold" id="hcm-time">0 min</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Lift Levels</div><div class="text-xl font-bold" id="hcm-lift">0</div></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-3">Mixing Tips</h3>
          <div class="text-sm space-y-1" id="hcm-tips"></div>
        </div>
      </div>
      <ShareButton calculatorId="hair-color-mixing" />
      <FeedbackWidget />
    </div>
    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">Hair Color Mixing Guide</h2>
      <p>Proper hair color mixing is essential for consistent, professional results. The mixing ratio determines how much developer to use relative to color. Standard permanent color uses a 1:1 ratio with 20 volume developer for up to 2 levels of lift. High lift colors and lighteners typically use a 1:2 ratio with 30 or 40 volume developer. Always measure precisely using a scale for best results.</p>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcHCM() {
      const service = (document.getElementById('hcm-service') as HTMLSelectElement).value;
      const developer = parseInt((document.getElementById('hcm-developer') as HTMLSelectElement).value);
      const ratio = parseFloat((document.getElementById('hcm-ratio') as HTMLSelectElement).value);
      const tubes = parseFloat((document.getElementById('hcm-tubes') as HTMLInputElement).value) || 1;
      const tubeSize = parseFloat((document.getElementById('hcm-tubesize') as HTMLInputElement).value) || 60;
      const length = (document.getElementById('hcm-length') as HTMLSelectElement).value;

      const colorAmount = tubes * tubeSize;
      const devAmount = colorAmount * ratio;
      const totalMix = colorAmount + devAmount;

      let liftLevels = 0;
      if (developer === 10) liftLevels = 1;
      else if (developer === 20) liftLevels = 2;
      else if (developer === 30) liftLevels = 3;
      else if (developer === 40) liftLevels = 4;

      let processTime = 35;
      if (service === 'permanent') processTime = 35;
      else if (service === 'demi') processTime = 20;
      else if (service === 'semi') processTime = 20;
      else if (service === 'highLift') processTime = 50;

      if (developer >= 30) processTime += 5;
      if (developer >= 40) processTime += 5;

      let lengthMultiplier = 1;
      if (length === 'short') lengthMultiplier = 0.5;
      else if (length === 'medium') lengthMultiplier = 1;
      else if (length === 'long') lengthMultiplier = 1.5;
      else if (length === 'vlong') lengthMultiplier = 2;

      const tips: string[] = [];
      if (service === 'permanent') tips.push('Apply to roots first, then pull through to ends in last 10 minutes.');
      if (service === 'demi') tips.push('No ammonia - great for blending grays or toning.');
      if (service === 'semi') tips.push('No developer needed for most semi-permanent colors.');
      if (service === 'highLift') tips.push('Works best on natural, uncolored hair levels 7+.');
      if (developer >= 30) tips.push('Monitor closely - higher volume developer can cause damage.');
      tips.push('Suggested tubes for this length: ' + Math.ceil(lengthMultiplier) + '-' + Math.ceil(lengthMultiplier * 1.5));
      tips.push('Mix in a non-metallic bowl with a tint brush.');

      document.getElementById('hcm-total')!.textContent = Math.round(totalMix) + ' g';
      document.getElementById('hcm-color')!.textContent = Math.round(colorAmount) + ' g';
      document.getElementById('hcm-dev')!.textContent = Math.round(devAmount) + ' g';
      document.getElementById('hcm-time')!.textContent = processTime + ' min';
      document.getElementById('hcm-lift')!.textContent = liftLevels.toString();
      document.getElementById('hcm-tips')!.innerHTML = tips.map(t => '<p>' + t + '</p>').join('');
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.hcm-in').forEach(el => { el.addEventListener('input', calcHCM); el.addEventListener('change', calcHCM); });
      calcHCM();
    }, 50);
  </script>
</CalculatorLayout>
