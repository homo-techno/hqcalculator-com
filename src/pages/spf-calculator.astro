---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "SPF Calculator - Sun Protection Time by Skin Type & UV Index";
const description = "Calculate SPF protection time based on your skin type and UV index. Know when to reapply sunscreen and your effective protection duration.";
const relatedCalcs = [
  { name: "Tanning Time Calculator", url: "/tanning-time-calculator", description: "Safe tanning time by skin type." },
  { name: "Skincare Routine Calculator", url: "/skincare-routine-calculator", description: "Product layering order." },
  { name: "Skin Type Calculator", url: "/skin-type-calculator", description: "Determine your skin type." },
  { name: "Sunscreen Calculator", url: "/sunscreen-calculator", description: "SPF and safe exposure time." },
  { name: "Beauty Budget Calculator", url: "/beauty-budget-calculator", description: "Beauty spending breakdown." },
  { name: "Chemical Peel Calculator", url: "/chemical-peel-calculator", description: "Peel depth and recovery time." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="SPF Calculator" keywords="SPF calculator, sun protection factor, UV index, skin type, sun exposure time, sunscreen protection, reapply sunscreen" breadcrumbs={[{ name: "SPF", url: "/spf-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">SPF Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate your SPF protection time and reapplication schedule based on skin type and UV index.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div>
          <label class="block text-xs font-medium text-text mb-1">Skin Type (Fitzpatrick Scale)</label>
          <select id="spf-skin" class="spf-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="5">Type I - Very fair, always burns, never tans</option>
            <option value="8">Type II - Fair, usually burns, tans minimally</option>
            <option value="13" selected>Type III - Medium, sometimes burns, tans gradually</option>
            <option value="20">Type IV - Olive, rarely burns, tans easily</option>
            <option value="30">Type V - Brown, very rarely burns</option>
            <option value="45">Type VI - Dark brown/black, never burns</option>
          </select>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">UV Index</label><input type="number" id="spf-uv" class="spf-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="7" min="1" max="15" step="1"></div>
          <div><label class="block text-xs font-medium text-text mb-1">SPF Level</label><input type="number" id="spf-spf" class="spf-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="30" min="1" max="100" step="1"></div>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Activity Level</label>
          <select id="spf-activity" class="spf-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="1.0">Sedentary (sitting, shade nearby)</option>
            <option value="0.8" selected>Light activity (walking, casual)</option>
            <option value="0.6">Moderate (sports, gardening)</option>
            <option value="0.4">Heavy (swimming, heavy sweating)</option>
          </select>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Altitude</label>
          <select id="spf-alt" class="spf-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="1.0" selected>Sea level</option>
            <option value="0.9">Moderate (3,000-6,000 ft)</option>
            <option value="0.8">High (6,000-10,000 ft)</option>
            <option value="0.7">Very high (10,000+ ft)</option>
          </select>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Protected Exposure Time</div>
          <div class="text-5xl font-extrabold font-mono" id="spf-protected">0</div>
          <div class="text-sm text-blue-200 mt-1">minutes with SPF</div>
        </div>
        <div class="grid grid-cols-2 gap-4">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Burn Time (No SPF)</div><div class="text-xl font-bold" id="spf-burn">0 min</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Reapply Every</div><div class="text-xl font-bold" id="spf-reapply">0 min</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">UVB Blocked</div><div class="text-xl font-bold" id="spf-block">0%</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">UV Risk Level</div><div class="text-xl font-bold" id="spf-risk">--</div></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-3">SPF Protection Guide</h3>
          <div class="grid grid-cols-2 gap-2 text-sm">
            <div class="flex justify-between"><span>SPF 15</span><span class="font-bold">93.3% UVB blocked</span></div>
            <div class="flex justify-between"><span>SPF 30</span><span class="font-bold">96.7% UVB blocked</span></div>
            <div class="flex justify-between"><span>SPF 50</span><span class="font-bold">98.0% UVB blocked</span></div>
            <div class="flex justify-between"><span>SPF 100</span><span class="font-bold">99.0% UVB blocked</span></div>
          </div>
        </div>
      </div>
      <ShareButton calculatorId="spf" />
      <FeedbackWidget />
    </div>
    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">Understanding SPF Protection</h2>
      <p>SPF (Sun Protection Factor) measures how long sunscreen protects against UVB radiation compared to unprotected skin. SPF 30 means you can stay in the sun 30 times longer before burning. However, real-world protection depends on proper application (1 oz for full body), reapplication every 2 hours, and factors like sweating, swimming, and altitude. Higher altitudes increase UV exposure by about 10% per 1,000 meters.</p>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcSPF() {
      const skinMED = parseFloat((document.getElementById('spf-skin') as HTMLSelectElement).value);
      const uv = parseFloat((document.getElementById('spf-uv') as HTMLInputElement).value) || 1;
      const spf = parseFloat((document.getElementById('spf-spf') as HTMLInputElement).value) || 1;
      const activity = parseFloat((document.getElementById('spf-activity') as HTMLSelectElement).value);
      const alt = parseFloat((document.getElementById('spf-alt') as HTMLSelectElement).value);

      const burnTime = (skinMED / uv) * alt;
      const protectedTime = burnTime * spf * activity;
      const reapply = Math.min(120, protectedTime * 0.6);
      const blockPct = ((spf - 1) / spf) * 100;

      let risk = 'Low';
      if (uv >= 3 && uv <= 5) risk = 'Moderate';
      else if (uv >= 6 && uv <= 7) risk = 'High';
      else if (uv >= 8 && uv <= 10) risk = 'Very High';
      else if (uv >= 11) risk = 'Extreme';

      document.getElementById('spf-protected')!.textContent = Math.round(protectedTime).toString();
      document.getElementById('spf-burn')!.textContent = Math.round(burnTime) + ' min';
      document.getElementById('spf-reapply')!.textContent = Math.round(reapply) + ' min';
      document.getElementById('spf-block')!.textContent = blockPct.toFixed(1) + '%';
      document.getElementById('spf-risk')!.textContent = risk;
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.spf-in').forEach(el => { el.addEventListener('input', calcSPF); el.addEventListener('change', calcSPF); });
      calcSPF();
    }, 50);
  </script>
</CalculatorLayout>
