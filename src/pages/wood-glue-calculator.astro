---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';

const title = "Wood Glue Calculator - Coverage, Clamp Time & Open Time";
const description = "Calculate wood glue coverage area, amount needed, clamp time, and open time by glue type. Supports PVA, polyurethane, epoxy, hide glue, and CA glue.";

const relatedCalcs = [
  { name: "Mortise & Tenon Calculator", url: "/mortise-tenon-calculator", description: "M&T joint dimensions." },
  { name: "Dovetail Joint Calculator", url: "/dovetail-joint-calculator", description: "Dovetail layout." },
  { name: "Dowel Joint Calculator", url: "/dowel-joint-calculator", description: "Dowel joint spacing." },
  { name: "Wood Finish Calculator", url: "/wood-finish-calculator", description: "Finish coverage." },
  { name: "Board Foot Calculator", url: "/board-foot-calculator", description: "Board feet calculator." },
  { name: "Wood Veneer Calculator", url: "/wood-veneer-calculator", description: "Veneer adhesive needs." },
];
---

<CalculatorLayout
  title={title}
  description={description}
  calculatorName="Wood Glue Calculator"
  keywords="wood glue calculator, glue coverage, clamp time, open time, PVA glue, epoxy, polyurethane glue, hide glue"
  breadcrumbs={[{ name: "Wood Glue Calculator", url: "/wood-glue-calculator" }]}
>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Wood Glue Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Estimate glue quantity, coverage, clamp time, and open time for your woodworking project.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="mb-5">
        <label class="block text-sm font-medium text-text mb-2">Glue Type</label>
        <select id="wgl-type" class="wgl-in w-full px-4 py-3 border border-border rounded-xl text-lg">
          <option value="pva" selected>PVA (Yellow / White Glue)</option>
          <option value="poly">Polyurethane (Gorilla Glue)</option>
          <option value="epoxy">Epoxy (2-part)</option>
          <option value="hide">Hide Glue (liquid)</option>
          <option value="ca">CA Glue (Super Glue)</option>
        </select>
      </div>

      <div class="grid grid-cols-2 gap-4 mb-5">
        <div>
          <label class="block text-sm font-medium text-text mb-2">Surface Length (inches)</label>
          <input type="number" id="wgl-length" class="wgl-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="24" min="0" step="0.5">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-2">Surface Width (inches)</label>
          <input type="number" id="wgl-width" class="wgl-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="3" min="0" step="0.5">
        </div>
      </div>

      <div class="grid grid-cols-2 gap-4 mb-5">
        <div>
          <label class="block text-sm font-medium text-text mb-2">Number of Joints</label>
          <input type="number" id="wgl-joints" class="wgl-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="4" min="1" step="1">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-2">Temperature (&deg;F)</label>
          <input type="number" id="wgl-temp" class="wgl-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="70" min="40" max="110" step="1">
        </div>
      </div>

      <!-- Primary Result -->
      <div class="p-6 bg-primary rounded-2xl text-white text-center mb-4">
        <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Glue Needed</div>
        <div class="text-4xl font-extrabold" id="wgl-amount">--</div>
        <div class="text-sm text-blue-200 mt-1" id="wgl-amount-ml">--</div>
      </div>

      <div class="grid grid-cols-2 gap-4 mb-4">
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Total Glue Area</div>
          <div class="text-xl font-bold" id="wgl-area">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Coverage Rate</div>
          <div class="text-xl font-bold" id="wgl-rate">--</div>
        </div>
      </div>

      <div class="grid grid-cols-2 gap-4 mb-4">
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Open Time</div>
          <div class="text-xl font-bold" id="wgl-open">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Clamp Time</div>
          <div class="text-xl font-bold" id="wgl-clamp">--</div>
        </div>
      </div>

      <div class="p-4 bg-surface-alt rounded-xl text-center mb-6">
        <div class="text-xs text-text-muted uppercase">Full Cure Time</div>
        <div class="text-xl font-bold" id="wgl-cure">--</div>
      </div>

      <ShareButton calculatorId="wood-glue" />
      <FeedbackWidget />
    </div>

    <article class="mt-12 max-w-4xl prose prose-slate">
      <h2 class="text-2xl font-bold text-text">Glue Type Comparison</h2>
      <ul>
        <li><strong>PVA (Yellow/White):</strong> Most common, easy cleanup, good for most joints. Not waterproof (Type I is).</li>
        <li><strong>Polyurethane:</strong> Waterproof, gap-filling, expands as it cures. Dampening surfaces helps.</li>
        <li><strong>Epoxy:</strong> Strongest, fills gaps, waterproof. Longer open time for complex assemblies.</li>
        <li><strong>Hide Glue:</strong> Reversible, no creep, ideal for instruments and antique repair.</li>
        <li><strong>CA (Super Glue):</strong> Instant bond, best for small repairs and turnings.</li>
      </ul>
      <h3 class="text-xl font-semibold text-text mt-8">Tips</h3>
      <ul>
        <li>Apply a thin, even coat to both surfaces for strongest bonds</li>
        <li>Cold temperatures dramatically increase clamp and cure times</li>
        <li>Ideal shop temperature for gluing is 65-75 degrees F</li>
      </ul>
    </article>

    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    function calcWGL() {
      const glueType = (document.getElementById('wgl-type') as HTMLSelectElement).value;
      const length = parseFloat((document.getElementById('wgl-length') as HTMLInputElement).value) || 0;
      const width = parseFloat((document.getElementById('wgl-width') as HTMLInputElement).value) || 0;
      const joints = parseInt((document.getElementById('wgl-joints') as HTMLInputElement).value) || 1;
      const temp = parseFloat((document.getElementById('wgl-temp') as HTMLInputElement).value) || 70;

      // Glue data: [coverage sq.in per oz, open time min, clamp time min, cure hours]
      const glueData: Record<string, [number, number, number, number]> = {
        'pva':   [42, 10, 30, 24],
        'poly':  [35, 15, 60, 24],
        'epoxy': [28, 30, 240, 72],
        'hide':  [38, 5, 60, 24],
        'ca':    [100, 0.5, 1, 2],
      };

      const data = glueData[glueType] || glueData['pva'];
      const coveragePerOz = data[0]; // sq inches per oz
      let openTime = data[1];
      let clampTime = data[2];
      let cureTime = data[3];

      // Both surfaces get glue
      const areaPerJoint = length * width * 2;
      const totalArea = areaPerJoint * joints;
      const glueOz = totalArea / coveragePerOz;
      const glueMl = glueOz * 29.5735;

      // Temperature adjustment
      const tempFactor = temp < 60 ? 1.5 : temp < 70 ? 1.2 : temp > 85 ? 0.8 : 1.0;
      openTime = Math.round(openTime / tempFactor);
      clampTime = Math.round(clampTime * tempFactor);
      cureTime = Math.round(cureTime * tempFactor);

      document.getElementById('wgl-amount')!.textContent = glueOz.toFixed(1) + ' oz';
      document.getElementById('wgl-amount-ml')!.textContent = glueMl.toFixed(0) + ' ml (' + (glueOz / 8).toFixed(2) + ' cups)';
      document.getElementById('wgl-area')!.textContent = totalArea.toFixed(0) + ' sq in';
      document.getElementById('wgl-rate')!.textContent = coveragePerOz + ' sq in/oz';

      if (openTime < 1) {
        document.getElementById('wgl-open')!.textContent = (openTime * 60).toFixed(0) + ' seconds';
      } else {
        document.getElementById('wgl-open')!.textContent = openTime + ' min';
      }
      if (clampTime < 60) {
        document.getElementById('wgl-clamp')!.textContent = clampTime + ' min';
      } else {
        document.getElementById('wgl-clamp')!.textContent = (clampTime / 60).toFixed(1) + ' hours';
      }
      document.getElementById('wgl-cure')!.textContent = cureTime + ' hours';

      document.dispatchEvent(new CustomEvent('calc-update'));
    }

    setTimeout(() => {
      document.querySelectorAll('.wgl-in').forEach(el => {
        el.addEventListener('input', calcWGL);
        el.addEventListener('change', calcWGL);
      });
      calcWGL();
    }, 50);
  </script>
</CalculatorLayout>
