---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Business Card Calculator - Printing Cost & Quantity Estimator";
const description = "Calculate business card printing costs based on quantity, paper stock, finish type, and single or double-sided printing.";
const relatedCalcs = [
  { name: "Print Cost Calculator", url: "/print-cost-calculator", description: "General print job costs." },
  { name: "Label Calculator", url: "/label-calculator", description: "Label printing costs." },
  { name: "Paper Weight Calculator", url: "/paper-weight-calculator", description: "Paper weight converter." },
  { name: "Bleed Margin Calculator", url: "/bleed-margin-calculator", description: "Print bleed calculations." },
  { name: "Color Separation Calculator", url: "/color-separation-calculator", description: "CMYK color separation." },
  { name: "Envelope Calculator", url: "/envelope-calculator", description: "Envelope sizes and printing." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Business Card Calculator" keywords="business card cost, business card printing, card quantity, paper stock, card finish, printing estimate" breadcrumbs={[{ name: "Business Card Calculator", url: "/business-card-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Business Card Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Estimate the cost of business card printing based on quantity, paper stock, finish, and print options. Compare different configurations.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Quantity</label>
            <select id="bc2-qty" class="bc2-in w-full px-4 py-3 border border-border rounded-xl text-lg">
              <option value="100">100</option>
              <option value="250">250</option>
              <option value="500">500</option>
              <option value="1000">1,000</option>
              <option value="2500">2,500</option>
              <option value="5000">5,000</option>
              <option value="10000">10,000</option>
            </select>
          </div>
          <div><label class="block text-xs font-medium text-text mb-1">Card Size</label>
            <select id="bc2-size" class="bc2-in w-full px-4 py-3 border border-border rounded-xl text-lg">
              <option value="3.5x2">Standard US (3.5 x 2 in)</option>
              <option value="3.346x2.165">European (85 x 55 mm)</option>
              <option value="3.582x2.165">Japanese (91 x 55 mm)</option>
              <option value="3.5x2.5">Square-ish (3.5 x 2.5 in)</option>
            </select>
          </div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Paper Stock</label>
            <select id="bc2-stock" class="bc2-in w-full px-4 py-3 border border-border rounded-xl text-lg">
              <option value="standard">14pt Cardstock (standard)</option>
              <option value="thick">16pt Cardstock (thick)</option>
              <option value="premium">18pt Cardstock (premium)</option>
              <option value="ultra">32pt Ultra Thick</option>
              <option value="cotton">Cotton Paper</option>
            </select>
          </div>
          <div><label class="block text-xs font-medium text-text mb-1">Finish</label>
            <select id="bc2-finish" class="bc2-in w-full px-4 py-3 border border-border rounded-xl text-lg">
              <option value="matte">Matte</option>
              <option value="gloss">Glossy UV</option>
              <option value="silk">Silk / Satin</option>
              <option value="uncoated">Uncoated</option>
              <option value="spotUV">Spot UV</option>
              <option value="foil">Foil Stamped</option>
            </select>
          </div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Sides</label>
            <select id="bc2-sides" class="bc2-in w-full px-4 py-3 border border-border rounded-xl text-lg">
              <option value="1">Single-sided</option>
              <option value="2">Double-sided</option>
            </select>
          </div>
          <div><label class="block text-xs font-medium text-text mb-1">Color</label>
            <select id="bc2-color" class="bc2-in w-full px-4 py-3 border border-border rounded-xl text-lg">
              <option value="full">Full Color (CMYK)</option>
              <option value="bw">Black & White</option>
              <option value="spot2">2 Spot Colors</option>
            </select>
          </div>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Estimated Total Cost</div>
          <div class="text-5xl font-extrabold font-mono" id="bc2-result">$0.00</div>
          <div class="text-sm text-blue-200 mt-1" id="bc2-percard"></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Cost per Card</div><div class="text-xl font-bold" id="bc2-unit">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Cards per Sheet</div><div class="text-xl font-bold" id="bc2-persheet">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Sheets Needed</div><div class="text-xl font-bold" id="bc2-sheets">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Print Resolution</div><div class="text-xl font-bold" id="bc2-res">--</div></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-2">Quantity Price Comparison</h3>
          <div class="font-mono text-sm space-y-1" id="bc2-steps"></div>
        </div>
      </div>
      <ShareButton calculatorId="business-card" />
      <FeedbackWidget />
    </div>
    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">Business Card Printing Guide</h2>
      <div class="bg-surface-alt rounded-xl p-4 my-4 font-mono text-sm space-y-1">
        <p>Standard US size: 3.5 x 2 inches with 0.125" bleed</p>
        <p>Document size with bleed: 3.75 x 2.25 inches</p>
        <p>Safe area (keep text inside): 3.25 x 1.75 inches</p>
        <p>Resolution: 300 DPI minimum (1125 x 675 px with bleed)</p>
      </div>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcBc2() {
      const qty = parseFloat((document.getElementById('bc2-qty') as HTMLSelectElement).value) || 0;
      const sizeStr = (document.getElementById('bc2-size') as HTMLSelectElement).value;
      const stock = (document.getElementById('bc2-stock') as HTMLSelectElement).value;
      const finish = (document.getElementById('bc2-finish') as HTMLSelectElement).value;
      const sides = parseFloat((document.getElementById('bc2-sides') as HTMLSelectElement).value) || 1;
      const color = (document.getElementById('bc2-color') as HTMLSelectElement).value;
      const dims = sizeStr.split('x').map(Number);
      const cardW = dims[0] || 3.5;
      const cardH = dims[1] || 2;
      const stockCost: Record<string, number> = { standard: 0.02, thick: 0.03, premium: 0.04, ultra: 0.07, cotton: 0.06 };
      const finishCost: Record<string, number> = { matte: 0.005, gloss: 0.008, silk: 0.007, uncoated: 0.003, spotUV: 0.025, foil: 0.05 };
      const colorMult: Record<string, number> = { full: 1, bw: 0.4, spot2: 0.7 };
      const sideMult = sides === 2 ? 1.6 : 1;
      const baseCost = (stockCost[stock] || 0.02) + (finishCost[finish] || 0.005);
      const perCard = baseCost * (colorMult[color] || 1) * sideMult;
      let discount = 1;
      if (qty >= 5000) discount = 0.6;
      else if (qty >= 2500) discount = 0.7;
      else if (qty >= 1000) discount = 0.8;
      else if (qty >= 500) discount = 0.9;
      const finalPerCard = perCard * discount;
      const setupFee = 15;
      const total = setupFee + finalPerCard * qty;
      const cardsPerSheet = Math.floor(8.5 / (cardW + 0.125)) * Math.floor(11 / (cardH + 0.125));
      const sheetsNeeded = cardsPerSheet > 0 ? Math.ceil(qty / cardsPerSheet) : 0;
      const resW = Math.ceil((cardW + 0.25) * 300);
      const resH = Math.ceil((cardH + 0.25) * 300);
      const steps: string[] = [];
      const qtys = [100, 250, 500, 1000, 2500, 5000, 10000];
      for (const q of qtys) {
        let d = 1;
        if (q >= 5000) d = 0.6;
        else if (q >= 2500) d = 0.7;
        else if (q >= 1000) d = 0.8;
        else if (q >= 500) d = 0.9;
        const t = setupFee + perCard * d * q;
        const pc = t / q;
        const mark = q === qty ? ' <-- selected' : '';
        steps.push(q + ' cards: $' + t.toFixed(2) + ' ($' + pc.toFixed(4) + '/card)' + mark);
      }
      document.getElementById('bc2-result')!.textContent = '$' + total.toFixed(2);
      document.getElementById('bc2-percard')!.textContent = '$' + (total / qty).toFixed(4) + ' per card';
      document.getElementById('bc2-unit')!.textContent = '$' + (total / qty).toFixed(4);
      document.getElementById('bc2-persheet')!.textContent = cardsPerSheet.toString();
      document.getElementById('bc2-sheets')!.textContent = sheetsNeeded.toString();
      document.getElementById('bc2-res')!.textContent = resW + ' x ' + resH + ' px';
      document.getElementById('bc2-steps')!.innerHTML = steps.map(s => '<div>' + s + '</div>').join('');
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.bc2-in').forEach(el => { el.addEventListener('input', calcBc2); el.addEventListener('change', calcBc2); });
      calcBc2();
    }, 50);
  </script>
</CalculatorLayout>
