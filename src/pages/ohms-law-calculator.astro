---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Ohm's Law Calculator - Voltage, Current, Resistance, Power";
const description = "Calculate voltage, current, resistance, and power using Ohm's Law. Enter any two values to find the rest.";
const relatedCalcs = [
  { name: "Wavelength Calculator", url: "/wavelength-calculator", description: "Wavelengths." },
  { name: "Scientific Calculator", url: "/scientific-calculator", description: "Scientific math." },
  { name: "Unit Converter", url: "/length-converter", description: "Unit conversion." },
  { name: "Percentage Calculator", url: "/percentage-calculator", description: "Percentages." },
  { name: "Exponent Calculator", url: "/exponent-calculator", description: "Exponents." },
  { name: "BTU Calculator", url: "/btu-calculator", description: "BTU." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Ohm's Law Calculator" keywords="ohms law, voltage calculator, resistance calculator, current calculator, power calculator, V=IR" breadcrumbs={[{ name: "Ohm's Law", url: "/ohms-law-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Ohm's Law Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Enter any two known values to calculate the remaining electrical properties.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="block text-xs font-medium text-text mb-1">Voltage (V) — Volts</label>
            <input type="number" id="oh-v" class="oh-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="12" min="0" step="0.1">
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Current (I) — Amps</label>
            <input type="number" id="oh-i" class="oh-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="2" min="0" step="0.1">
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Resistance (R) — Ohms</label>
            <input type="number" id="oh-r" class="oh-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" placeholder="Auto" min="0" step="0.1">
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Power (P) — Watts</label>
            <input type="number" id="oh-p" class="oh-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" placeholder="Auto" min="0" step="0.1">
          </div>
        </div>
        <button id="oh-calc" class="w-full py-3 bg-primary text-white font-semibold rounded-xl hover:bg-blue-700 transition">Calculate</button>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-5 bg-primary rounded-2xl text-white text-center">
            <div class="text-xs uppercase tracking-wide mb-1 opacity-80">Voltage</div>
            <div class="text-2xl font-extrabold" id="oh-rv">0 V</div>
          </div>
          <div class="p-5 bg-secondary rounded-2xl text-white text-center">
            <div class="text-xs uppercase tracking-wide mb-1 opacity-80">Current</div>
            <div class="text-2xl font-extrabold" id="oh-ri">0 A</div>
          </div>
          <div class="p-5 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Resistance</div>
            <div class="text-2xl font-bold" id="oh-rr">0 Ω</div>
          </div>
          <div class="p-5 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Power</div>
            <div class="text-2xl font-bold" id="oh-rp">0 W</div>
          </div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-2">Formulas Used</h3>
          <div class="font-mono text-sm space-y-1" id="oh-formulas"></div>
        </div>
      </div>
      <ShareButton calculatorId="ohms-law" />
      <FeedbackWidget />
    </div>
    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">Ohm's Law</h2>
      <div class="bg-surface-alt rounded-xl p-4 my-4 font-mono text-sm space-y-1">
        <p>V = I × R</p>
        <p>P = V × I = I²R = V²/R</p>
      </div>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcOhm() {
      const vIn = (document.getElementById('oh-v') as HTMLInputElement).value;
      const iIn = (document.getElementById('oh-i') as HTMLInputElement).value;
      const rIn = (document.getElementById('oh-r') as HTMLInputElement).value;
      const pIn = (document.getElementById('oh-p') as HTMLInputElement).value;
      const vals: { v?: number; i?: number; r?: number; p?: number } = {};
      if (vIn) vals.v = parseFloat(vIn);
      if (iIn) vals.i = parseFloat(iIn);
      if (rIn) vals.r = parseFloat(rIn);
      if (pIn) vals.p = parseFloat(pIn);
      const known = Object.keys(vals).length;
      const formulas: string[] = [];
      let V = 0, I = 0, R = 0, P = 0;
      if (vals.v !== undefined && vals.i !== undefined) {
        V = vals.v; I = vals.i; R = I > 0 ? V / I : 0; P = V * I;
        formulas.push('R = V / I = ' + V + ' / ' + I + ' = ' + R.toFixed(4));
        formulas.push('P = V × I = ' + V + ' × ' + I + ' = ' + P.toFixed(4));
      } else if (vals.v !== undefined && vals.r !== undefined) {
        V = vals.v; R = vals.r; I = R > 0 ? V / R : 0; P = V * I;
        formulas.push('I = V / R = ' + V + ' / ' + R + ' = ' + I.toFixed(4));
        formulas.push('P = V × I = ' + V + ' × ' + I.toFixed(4) + ' = ' + P.toFixed(4));
      } else if (vals.v !== undefined && vals.p !== undefined) {
        V = vals.v; P = vals.p; I = V > 0 ? P / V : 0; R = I > 0 ? V / I : 0;
        formulas.push('I = P / V = ' + P + ' / ' + V + ' = ' + I.toFixed(4));
        formulas.push('R = V / I = ' + V + ' / ' + I.toFixed(4) + ' = ' + R.toFixed(4));
      } else if (vals.i !== undefined && vals.r !== undefined) {
        I = vals.i; R = vals.r; V = I * R; P = I * I * R;
        formulas.push('V = I × R = ' + I + ' × ' + R + ' = ' + V.toFixed(4));
        formulas.push('P = I²R = ' + I + '² × ' + R + ' = ' + P.toFixed(4));
      } else if (vals.i !== undefined && vals.p !== undefined) {
        I = vals.i; P = vals.p; V = I > 0 ? P / I : 0; R = I > 0 ? V / I : 0;
        formulas.push('V = P / I = ' + P + ' / ' + I + ' = ' + V.toFixed(4));
        formulas.push('R = V / I = ' + V.toFixed(4) + ' / ' + I + ' = ' + R.toFixed(4));
      } else if (vals.r !== undefined && vals.p !== undefined) {
        R = vals.r; P = vals.p; V = Math.sqrt(P * R); I = R > 0 ? V / R : 0;
        formulas.push('V = √(P×R) = √(' + P + '×' + R + ') = ' + V.toFixed(4));
        formulas.push('I = V / R = ' + V.toFixed(4) + ' / ' + R + ' = ' + I.toFixed(4));
      }
      document.getElementById('oh-rv')!.textContent = V.toFixed(4) + ' V';
      document.getElementById('oh-ri')!.textContent = I.toFixed(4) + ' A';
      document.getElementById('oh-rr')!.textContent = R.toFixed(4) + ' Ω';
      document.getElementById('oh-rp')!.textContent = P.toFixed(4) + ' W';
      document.getElementById('oh-formulas')!.innerHTML = formulas.map(f => `<div>${f}</div>`).join('');
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => { document.getElementById('oh-calc')!.addEventListener('click', calcOhm); calcOhm(); }, 50);
  </script>
</CalculatorLayout>
