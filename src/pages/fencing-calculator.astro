---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Fencing Calculator - Material & Cost Estimator";
const description = "Calculate how much fencing material you need and estimate total cost for your fence project.";
const relatedCalcs = [
  { name: "Square Footage", url: "/square-footage-calculator", description: "Square footage." },
  { name: "Flooring Calculator", url: "/flooring-calculator", description: "Flooring." },
  { name: "Paint Calculator", url: "/paint-calculator", description: "Paint." },
  { name: "Area Calculator", url: "/area-calculator", description: "2D areas." },
  { name: "Length Converter", url: "/length-converter", description: "Length units." },
  { name: "Concrete Calculator", url: "/concrete-calculator", description: "Concrete." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Fencing Calculator" keywords="fencing calculator, fence cost estimator, fence posts, fence materials, fence length" breadcrumbs={[{ name: "Fencing Calculator", url: "/fencing-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Fencing Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Estimate materials and cost for your fencing project.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div>
          <label class="block text-xs font-medium text-text mb-1">Fence Type</label>
          <select id="fe-type" class="fe-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="wood" selected>Wood Privacy ($15-25/ft)</option>
            <option value="chainlink">Chain Link ($10-18/ft)</option>
            <option value="vinyl">Vinyl ($20-35/ft)</option>
            <option value="aluminum">Aluminum ($25-40/ft)</option>
            <option value="wrought">Wrought Iron ($30-50/ft)</option>
          </select>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Total Length (ft)</label><input type="number" id="fe-length" class="fe-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="150" min="1" step="1"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Fence Height (ft)</label><input type="number" id="fe-height" class="fe-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="6" min="3" max="10" step="1"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Gates</label><input type="number" id="fe-gates" class="fe-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="1" min="0" max="10" step="1"></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Post Spacing (ft)</label><input type="number" id="fe-spacing" class="fe-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="8" min="4" max="12" step="1"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Cost per Linear Ft ($)</label><input type="number" id="fe-cost" class="fe-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="20" min="0" step="1"></div>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Estimated Total Cost</div>
          <div class="text-4xl font-extrabold" id="fe-total">$0</div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Posts Needed</div><div class="text-xl font-bold" id="fe-posts">0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Panels/Sections</div><div class="text-xl font-bold" id="fe-panels">0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Rails Needed</div><div class="text-xl font-bold" id="fe-rails">0</div></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Fence Material</div><div class="text-xl font-bold" id="fe-matcost">$0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Gate Cost (est.)</div><div class="text-xl font-bold" id="fe-gatecost">$0</div></div>
        </div>
      </div>
      <ShareButton calculatorId="fencing" />
      <FeedbackWidget />
    </div>
    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">Fencing Tips</h2>
      <p>Posts are typically spaced 6-8 feet apart. Each section requires 2-3 horizontal rails. Always check local codes for height restrictions and setback requirements.</p>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    const typeCosts: Record<string, [number, number]> = { wood: [20, 200], chainlink: [14, 150], vinyl: [28, 250], aluminum: [32, 300], wrought: [40, 350] };
    function calcFence() {
      const type = (document.getElementById('fe-type') as HTMLSelectElement).value;
      const length = parseFloat((document.getElementById('fe-length') as HTMLInputElement).value) || 0;
      const height = parseFloat((document.getElementById('fe-height') as HTMLInputElement).value) || 6;
      const gates = parseInt((document.getElementById('fe-gates') as HTMLInputElement).value) || 0;
      const spacing = parseFloat((document.getElementById('fe-spacing') as HTMLInputElement).value) || 8;
      const costFt = parseFloat((document.getElementById('fe-cost') as HTMLInputElement).value) || 0;
      const posts = Math.ceil(length / spacing) + 1;
      const panels = posts - 1;
      const railsPerSection = height > 5 ? 3 : 2;
      const rails = panels * railsPerSection;
      const gateCostEach = typeCosts[type][1];
      const matCost = length * costFt;
      const gateTotal = gates * gateCostEach;
      const total = matCost + gateTotal;
      document.getElementById('fe-total')!.textContent = '$' + total.toLocaleString();
      document.getElementById('fe-posts')!.textContent = String(posts);
      document.getElementById('fe-panels')!.textContent = String(panels);
      document.getElementById('fe-rails')!.textContent = String(rails);
      document.getElementById('fe-matcost')!.textContent = '$' + matCost.toLocaleString();
      document.getElementById('fe-gatecost')!.textContent = '$' + gateTotal.toLocaleString();
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    function setTypeCost() {
      const type = (document.getElementById('fe-type') as HTMLSelectElement).value;
      (document.getElementById('fe-cost') as HTMLInputElement).value = String(typeCosts[type][0]);
      calcFence();
    }
    setTimeout(() => {
      document.querySelectorAll('.fe-in').forEach(el => el.addEventListener('input', calcFence));
      document.getElementById('fe-type')!.addEventListener('change', setTypeCost);
      calcFence();
    }, 50);
  </script>
</CalculatorLayout>
