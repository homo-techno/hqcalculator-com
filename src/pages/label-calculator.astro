---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Label Calculator - Labels Per Sheet, Sheets Needed & Cost";
const description = "Calculate labels per sheet, total sheets needed, and cost per label for custom label printing jobs based on label and sheet dimensions.";
const relatedCalcs = [
  { name: "Print Cost Calculator", url: "/print-cost-calculator", description: "Print job cost estimator." },
  { name: "Business Card Calculator", url: "/business-card-calculator", description: "Business card printing." },
  { name: "Envelope Calculator", url: "/envelope-calculator", description: "Envelope sizes and costs." },
  { name: "Bleed Margin Calculator", url: "/bleed-margin-calculator", description: "Print bleed calculations." },
  { name: "Ink Coverage Calculator", url: "/ink-coverage-calculator", description: "Ink usage estimator." },
  { name: "Paper Weight Calculator", url: "/paper-weight-calculator", description: "Paper weight converter." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Label Calculator" keywords="labels per sheet, label printing, cost per label, label layout, sheet labels, custom labels, label calculator" breadcrumbs={[{ name: "Label Calculator", url: "/label-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Label Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate how many labels fit on a sheet, total sheets needed for your job, and cost per label based on dimensions and margins.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Sheet Width (inches)</label><input type="number" id="lb2-sheetw" class="lb2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="0" step="0.25"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Sheet Height (inches)</label><input type="number" id="lb2-sheeth" class="lb2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="0" step="0.25"></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Label Width (inches)</label><input type="number" id="lb2-labelw" class="lb2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="0" step="0.125"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Label Height (inches)</label><input type="number" id="lb2-labelh" class="lb2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="0" step="0.125"></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Horizontal Gap (inches)</label><input type="number" id="lb2-hgap" class="lb2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="0" step="0.0625"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Vertical Gap (inches)</label><input type="number" id="lb2-vgap" class="lb2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="0" step="0.0625"></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Sheet Margins (inches)</label><input type="number" id="lb2-margin" class="lb2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="0" step="0.0625"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Total Labels Needed</label><input type="number" id="lb2-total" class="lb2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="1" step="1"></div>
        </div>
        <div><label class="block text-xs font-medium text-text mb-1">Cost per Sheet ($)</label><input type="number" id="lb2-sheetcost" class="lb2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="0" step="0.01"></div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Labels Per Sheet</div>
          <div class="text-5xl font-extrabold font-mono" id="lb2-result">0</div>
          <div class="text-sm text-blue-200 mt-1" id="lb2-subtitle"></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Columns x Rows</div><div class="text-xl font-bold" id="lb2-grid">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Sheets Needed</div><div class="text-xl font-bold" id="lb2-sheets">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Cost per Label</div><div class="text-xl font-bold" id="lb2-cpl">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Total Cost</div><div class="text-xl font-bold" id="lb2-totalcost">--</div></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-2">Layout Details</h3>
          <div class="font-mono text-sm space-y-1" id="lb2-steps"></div>
        </div>
      </div>
      <ShareButton calculatorId="label" />
      <FeedbackWidget />
    </div>
    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">Label Layout Formulas</h2>
      <div class="bg-surface-alt rounded-xl p-4 my-4 font-mono text-sm space-y-1">
        <p>Printable Width = Sheet Width - 2 x Margin</p>
        <p>Columns = floor((Printable Width + H Gap) / (Label Width + H Gap))</p>
        <p>Rows = floor((Printable Height + V Gap) / (Label Height + V Gap))</p>
        <p>Labels/Sheet = Columns x Rows</p>
        <p>Sheets = ceil(Total Labels / Labels per Sheet)</p>
      </div>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcLb2() {
      const sheetW = parseFloat((document.getElementById('lb2-sheetw') as HTMLInputElement).value) || 0;
      const sheetH = parseFloat((document.getElementById('lb2-sheeth') as HTMLInputElement).value) || 0;
      const labelW = parseFloat((document.getElementById('lb2-labelw') as HTMLInputElement).value) || 0;
      const labelH = parseFloat((document.getElementById('lb2-labelh') as HTMLInputElement).value) || 0;
      const hGap = parseFloat((document.getElementById('lb2-hgap') as HTMLInputElement).value) || 0;
      const vGap = parseFloat((document.getElementById('lb2-vgap') as HTMLInputElement).value) || 0;
      const margin = parseFloat((document.getElementById('lb2-margin') as HTMLInputElement).value) || 0;
      const totalNeeded = parseFloat((document.getElementById('lb2-total') as HTMLInputElement).value) || 0;
      const sheetCost = parseFloat((document.getElementById('lb2-sheetcost') as HTMLInputElement).value) || 0;
      const printW = sheetW - 2 * margin;
      const printH = sheetH - 2 * margin;
      const cols = labelW > 0 ? Math.floor((printW + hGap) / (labelW + hGap)) : 0;
      const rows = labelH > 0 ? Math.floor((printH + vGap) / (labelH + vGap)) : 0;
      const labelsPerSheet = cols * rows;
      const sheetsNeeded = labelsPerSheet > 0 ? Math.ceil(totalNeeded / labelsPerSheet) : 0;
      const totalCost = sheetsNeeded * sheetCost;
      const costPerLabel = labelsPerSheet > 0 && sheetCost > 0 ? sheetCost / labelsPerSheet : 0;
      const waste = labelsPerSheet > 0 ? (sheetsNeeded * labelsPerSheet) - totalNeeded : 0;
      const steps: string[] = [];
      steps.push('Printable area: ' + printW.toFixed(3) + ' x ' + printH.toFixed(3) + ' in');
      steps.push('Columns: (' + printW.toFixed(3) + ' + ' + hGap + ') / (' + labelW + ' + ' + hGap + ') = ' + cols);
      steps.push('Rows: (' + printH.toFixed(3) + ' + ' + vGap + ') / (' + labelH + ' + ' + vGap + ') = ' + rows);
      steps.push('Labels/sheet: ' + cols + ' x ' + rows + ' = ' + labelsPerSheet);
      steps.push('Sheets needed: ceil(' + totalNeeded + ' / ' + labelsPerSheet + ') = ' + sheetsNeeded);
      steps.push('Waste labels: ' + waste);
      steps.push('Total cost: ' + sheetsNeeded + ' x $' + sheetCost.toFixed(2) + ' = $' + totalCost.toFixed(2));
      document.getElementById('lb2-result')!.textContent = labelsPerSheet.toString();
      document.getElementById('lb2-subtitle')!.textContent = cols + ' columns x ' + rows + ' rows';
      document.getElementById('lb2-grid')!.textContent = cols + ' x ' + rows;
      document.getElementById('lb2-sheets')!.textContent = sheetsNeeded.toString();
      document.getElementById('lb2-cpl')!.textContent = '$' + costPerLabel.toFixed(4);
      document.getElementById('lb2-totalcost')!.textContent = '$' + totalCost.toFixed(2);
      document.getElementById('lb2-steps')!.innerHTML = steps.map(s => '<div>' + s + '</div>').join('');
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      (document.getElementById('lb2-sheetw') as HTMLInputElement).value = '8.5';
      (document.getElementById('lb2-sheeth') as HTMLInputElement).value = '11';
      (document.getElementById('lb2-labelw') as HTMLInputElement).value = '2.625';
      (document.getElementById('lb2-labelh') as HTMLInputElement).value = '1';
      (document.getElementById('lb2-hgap') as HTMLInputElement).value = '0.125';
      (document.getElementById('lb2-vgap') as HTMLInputElement).value = '0';
      (document.getElementById('lb2-margin') as HTMLInputElement).value = '0.19';
      (document.getElementById('lb2-total') as HTMLInputElement).value = '300';
      (document.getElementById('lb2-sheetcost') as HTMLInputElement).value = '0.15';
      document.querySelectorAll('.lb2-in').forEach(el => { el.addEventListener('input', calcLb2); el.addEventListener('change', calcLb2); });
      calcLb2();
    }, 50);
  </script>
</CalculatorLayout>
