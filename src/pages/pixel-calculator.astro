---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Pixel Calculator - PPI, DPI & Resolution";
const description = "Calculate pixels per inch, screen resolution, print size, and convert between px, pt, em, and rem.";
const relatedCalcs = [
  { name: "Data Storage", url: "/data-storage-converter", description: "Data units." },
  { name: "Area Calculator", url: "/area-calculator", description: "2D areas." },
  { name: "Percentage Calculator", url: "/percentage-calculator", description: "Percentages." },
  { name: "Scientific Calculator", url: "/scientific-calculator", description: "Scientific." },
  { name: "Length Converter", url: "/length-converter", description: "Length units." },
  { name: "Internet Speed", url: "/internet-speed-calculator", description: "Speed." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Pixel Calculator" keywords="pixel calculator, ppi calculator, dpi calculator, px to inches, resolution calculator" breadcrumbs={[{ name: "Pixel Calculator", url: "/pixel-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Pixel Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate PPI, DPI, and convert between pixel units.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="flex gap-2 mb-2">
          <button id="px-ppi" class="px-mode px-4 py-2 rounded-lg text-sm font-semibold border-2 border-primary bg-blue-50 text-primary" data-mode="ppi">PPI/DPI</button>
          <button id="px-conv" class="px-mode px-4 py-2 rounded-lg text-sm font-semibold border-2 border-border text-text-muted" data-mode="convert">px/pt/em</button>
          <button id="px-res" class="px-mode px-4 py-2 rounded-lg text-sm font-semibold border-2 border-border text-text-muted" data-mode="res">Resolution</button>
        </div>
        <div id="px-ppi-panel">
          <div class="grid grid-cols-3 gap-3">
            <div><label class="block text-xs font-medium text-text mb-1">Width (px)</label><input type="number" id="px-w" class="px-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="2560" min="1" step="1"></div>
            <div><label class="block text-xs font-medium text-text mb-1">Height (px)</label><input type="number" id="px-h" class="px-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="1440" min="1" step="1"></div>
            <div><label class="block text-xs font-medium text-text mb-1">Diagonal (in)</label><input type="number" id="px-diag" class="px-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="27" min="1" step="0.1"></div>
          </div>
        </div>
        <div id="px-conv-panel" class="hidden">
          <div class="grid grid-cols-3 gap-3">
            <div><label class="block text-xs font-medium text-text mb-1">Pixels (px)</label><input type="number" id="px-px" class="px-cin w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="16" min="0" step="1"></div>
            <div><label class="block text-xs font-medium text-text mb-1">Base Size (px)</label><input type="number" id="px-base" class="px-cin w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="16" min="1" step="1"></div>
            <div><label class="block text-xs font-medium text-text mb-1">DPI</label><input type="number" id="px-dpi" class="px-cin w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="96" min="1" step="1"></div>
          </div>
        </div>
        <div id="px-res-panel" class="hidden">
          <div class="grid grid-cols-2 gap-3">
            <div><label class="block text-xs font-medium text-text mb-1">Print Width (in)</label><input type="number" id="px-pw" class="px-rin w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="8" min="0.1" step="0.5"></div>
            <div><label class="block text-xs font-medium text-text mb-1">Print Height (in)</label><input type="number" id="px-ph" class="px-rin w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="10" min="0.1" step="0.5"></div>
          </div>
          <div class="mt-2"><label class="block text-xs font-medium text-text mb-1">Print DPI</label><input type="number" id="px-pdpi" class="px-rin w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="300" min="1" step="50"></div>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1" id="px-label">PPI (Pixels Per Inch)</div>
          <div class="text-5xl font-extrabold font-mono" id="px-result">0</div>
        </div>
        <div class="grid grid-cols-2 gap-3" id="px-details"></div>
      </div>
      <ShareButton calculatorId="pixel" />
      <FeedbackWidget />
    </div>
    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">Pixel Density</h2>
      <p>PPI = √(w² + h²) / diagonal. Standard web DPI is 96. Print quality requires 300 DPI. 1pt = 1/72 inch. 1em = base font size in px.</p>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    let mode = 'ppi';
    function setMode(m: string) {
      mode = m;
      document.querySelectorAll('.px-mode').forEach(b => {
        const bm = (b as HTMLElement).dataset.mode;
        b.className = `px-mode px-4 py-2 rounded-lg text-sm font-semibold border-2 ${bm === m ? 'border-primary bg-blue-50 text-primary' : 'border-border text-text-muted'}`;
      });
      document.getElementById('px-ppi-panel')!.classList.toggle('hidden', m !== 'ppi');
      document.getElementById('px-conv-panel')!.classList.toggle('hidden', m !== 'convert');
      document.getElementById('px-res-panel')!.classList.toggle('hidden', m !== 'res');
      calc();
    }
    function card(label: string, val: string) { return `<div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">${label}</div><div class="text-xl font-bold">${val}</div></div>`; }
    function calc() {
      const det = document.getElementById('px-details')!;
      if (mode === 'ppi') {
        const w = parseFloat((document.getElementById('px-w') as HTMLInputElement).value) || 0;
        const h = parseFloat((document.getElementById('px-h') as HTMLInputElement).value) || 0;
        const d = parseFloat((document.getElementById('px-diag') as HTMLInputElement).value) || 1;
        const ppi = Math.sqrt(w*w + h*h) / d;
        const totalPx = w * h;
        const mp = totalPx / 1e6;
        const ratio = w > 0 && h > 0 ? (w / h).toFixed(2) : '-';
        document.getElementById('px-label')!.textContent = 'PPI (Pixels Per Inch)';
        document.getElementById('px-result')!.textContent = ppi.toFixed(1);
        det.innerHTML = [
          card('Total Pixels', totalPx.toLocaleString()),
          card('Megapixels', mp.toFixed(1) + ' MP'),
          card('Aspect Ratio', ratio),
          card('Dot Pitch', (25.4 / ppi).toFixed(3) + ' mm'),
        ].join('');
      } else if (mode === 'convert') {
        const px = parseFloat((document.getElementById('px-px') as HTMLInputElement).value) || 0;
        const base = parseFloat((document.getElementById('px-base') as HTMLInputElement).value) || 16;
        const dpi = parseFloat((document.getElementById('px-dpi') as HTMLInputElement).value) || 96;
        const pt = px * 72 / dpi;
        const em = px / base;
        const inches = px / dpi;
        const cm = inches * 2.54;
        document.getElementById('px-label')!.textContent = 'Conversions';
        document.getElementById('px-result')!.textContent = px + 'px';
        det.innerHTML = [
          card('Points (pt)', pt.toFixed(2)),
          card('em / rem', em.toFixed(4)),
          card('Inches', inches.toFixed(4)),
          card('Centimeters', cm.toFixed(4)),
        ].join('');
      } else {
        const pw = parseFloat((document.getElementById('px-pw') as HTMLInputElement).value) || 0;
        const ph = parseFloat((document.getElementById('px-ph') as HTMLInputElement).value) || 0;
        const pdpi = parseFloat((document.getElementById('px-pdpi') as HTMLInputElement).value) || 300;
        const pixW = Math.round(pw * pdpi);
        const pixH = Math.round(ph * pdpi);
        const mp = (pixW * pixH) / 1e6;
        document.getElementById('px-label')!.textContent = 'Required Resolution';
        document.getElementById('px-result')!.textContent = pixW + ' × ' + pixH;
        det.innerHTML = [
          card('Width (px)', pixW.toLocaleString()),
          card('Height (px)', pixH.toLocaleString()),
          card('Megapixels', mp.toFixed(1) + ' MP'),
          card('File Size (est.)', (mp * 3).toFixed(1) + ' MB'),
        ].join('');
      }
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.px-mode').forEach(b => b.addEventListener('click', () => setMode((b as HTMLElement).dataset.mode!)));
      document.querySelectorAll('.px-in').forEach(el => el.addEventListener('input', calc));
      document.querySelectorAll('.px-cin').forEach(el => el.addEventListener('input', calc));
      document.querySelectorAll('.px-rin').forEach(el => el.addEventListener('input', calc));
      calc();
    }, 50);
  </script>
</CalculatorLayout>
