---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Seating Chart Calculator - Tables & Room Layout Planner";
const description = "Calculate the number of tables, seats per table, and room layout for your event. Plan seating arrangements for round, rectangular, and banquet-style setups.";
const relatedCalcs = [
  { name: "Banquet Room Calculator", url: "/banquet-room-calculator", description: "Room size for events." },
  { name: "Tent Size Calculator", url: "/tent-size-calculator", description: "Tent dimensions needed." },
  { name: "Event Budget Calculator", url: "/event-budget-calculator", description: "Total event cost breakdown." },
  { name: "Catering Quantity Calculator", url: "/catering-quantity-calculator", description: "Food quantities per guest." },
  { name: "Event Staffing Calculator", url: "/event-staffing-calculator", description: "Staff needed for events." },
  { name: "Party Supplies Calculator", url: "/party-supplies-calculator", description: "Plates, cups, napkins." },
];
---

<CalculatorLayout
  title={title}
  description={description}
  calculatorName="Seating Chart Calculator"
  keywords="seating chart calculator, table layout, event seating, wedding seating plan, table arrangement"
  breadcrumbs={[{ name: "Seating Chart", url: "/seating-chart-calculator" }]}
>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Seating Chart Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Determine tables, seats per table, and total room space for your event layout.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4 mb-6">
        <div>
          <label class="block text-sm font-medium text-text mb-1">Total Guests</label>
          <input type="number" id="sc2-guests" class="sc2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="120" min="1" step="1">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Table Shape</label>
          <select id="sc2-shape" class="sc2-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="round60">Round (60" / 5ft) - 8 seats</option>
            <option value="round72">Round (72" / 6ft) - 10 seats</option>
            <option value="rect6">Rectangular (6ft) - 6 seats</option>
            <option value="rect8">Rectangular (8ft) - 8 seats</option>
            <option value="banquet">Long Banquet Table - 10 seats</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Include Head Table?</label>
          <select id="sc2-head" class="sc2-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="0">No head table</option>
            <option value="8">Yes - 8 seats</option>
            <option value="10">Yes - 10 seats</option>
            <option value="12">Yes - 12 seats</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Include Dance Floor?</label>
          <select id="sc2-dance" class="sc2-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="0">No dance floor</option>
            <option value="small">Small (12x12 ft)</option>
            <option value="medium">Medium (16x16 ft)</option>
            <option value="large">Large (20x20 ft)</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Aisle / Walkway Width (ft)</label>
          <input type="number" id="sc2-aisle" class="sc2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="4" min="3" max="8" step="0.5">
        </div>
      </div>

      <div class="p-6 bg-primary rounded-2xl text-white text-center mb-4">
        <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Tables Needed</div>
        <div class="text-5xl font-extrabold" id="sc2-tables">--</div>
        <div class="text-sm mt-1" id="sc2-seatsper">--</div>
      </div>

      <div class="grid grid-cols-2 gap-4 mb-4">
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Total Seats</div>
          <div class="text-xl font-bold" id="sc2-totalseats">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Empty Seats</div>
          <div class="text-xl font-bold" id="sc2-empty">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Table Area (sq ft)</div>
          <div class="text-xl font-bold" id="sc2-tablearea">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Min Room Size (sq ft)</div>
          <div class="text-xl font-bold" id="sc2-roomsize">--</div>
        </div>
      </div>

      <div class="p-4 bg-surface-alt rounded-xl mb-4" id="sc2-details"></div>

      <ShareButton calculatorId="seating-chart" />
      <FeedbackWidget />
    </div>

    <article class="mt-12 max-w-4xl prose prose-slate">
      <h2 class="text-2xl font-bold text-text">Seating Chart Planning Guide</h2>
      <p>Allow 10-12 sq ft per guest for seated dinner with round tables, and additional space for dance floors, bars, and walkways. A 60" round table seats 8 comfortably, while a 72" round seats 10.</p>
    </article>

    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    function calcSC2() {
      const guests = parseInt((document.getElementById('sc2-guests') as HTMLInputElement).value) || 1;
      const shape = (document.getElementById('sc2-shape') as HTMLSelectElement).value;
      const headSeats = parseInt((document.getElementById('sc2-head') as HTMLSelectElement).value) || 0;
      const dance = (document.getElementById('sc2-dance') as HTMLSelectElement).value;
      const aisle = parseFloat((document.getElementById('sc2-aisle') as HTMLInputElement).value) || 4;

      let seatsPerTable = 8;
      let sqftPerTable = 80; // includes chair space
      if (shape === 'round60') { seatsPerTable = 8; sqftPerTable = 80; }
      else if (shape === 'round72') { seatsPerTable = 10; sqftPerTable = 100; }
      else if (shape === 'rect6') { seatsPerTable = 6; sqftPerTable = 54; }
      else if (shape === 'rect8') { seatsPerTable = 8; sqftPerTable = 72; }
      else if (shape === 'banquet') { seatsPerTable = 10; sqftPerTable = 90; }

      const remainingGuests = guests - headSeats;
      const tablesNeeded = Math.ceil(Math.max(0, remainingGuests) / seatsPerTable) + (headSeats > 0 ? 1 : 0);
      const totalSeats = (headSeats > 0 ? headSeats : 0) + Math.ceil(Math.max(0, remainingGuests) / seatsPerTable) * seatsPerTable;
      const emptySeats = totalSeats - guests;

      const tableArea = tablesNeeded * sqftPerTable;
      let danceArea = 0;
      if (dance === 'small') danceArea = 144;
      else if (dance === 'medium') danceArea = 256;
      else if (dance === 'large') danceArea = 400;

      const aisleArea = tablesNeeded * aisle * 6;
      const roomSize = Math.ceil(tableArea + danceArea + aisleArea);

      document.getElementById('sc2-tables')!.textContent = tablesNeeded.toString();
      document.getElementById('sc2-seatsper')!.textContent = seatsPerTable + ' seats per guest table';
      document.getElementById('sc2-totalseats')!.textContent = totalSeats.toString();
      document.getElementById('sc2-empty')!.textContent = emptySeats.toString();
      document.getElementById('sc2-tablearea')!.textContent = tableArea.toLocaleString();
      document.getElementById('sc2-roomsize')!.textContent = roomSize.toLocaleString();

      let details = '<h3 class="font-semibold text-sm text-text mb-2">Layout Details</h3><ul class="text-sm text-text-secondary space-y-1">';
      if (headSeats > 0) details += '<li>Head table: 1 table with ' + headSeats + ' seats</li>';
      details += '<li>Guest tables: ' + (tablesNeeded - (headSeats > 0 ? 1 : 0)) + ' tables x ' + seatsPerTable + ' seats each</li>';
      details += '<li>Table space: ' + tableArea + ' sq ft</li>';
      if (danceArea > 0) details += '<li>Dance floor: ' + danceArea + ' sq ft</li>';
      details += '<li>Aisle/walkway allowance: ~' + Math.round(aisleArea) + ' sq ft</li>';
      details += '<li>Recommended room: ' + roomSize + '+ sq ft</li>';
      const dimSide = Math.ceil(Math.sqrt(roomSize));
      details += '<li>Approx. dimensions: ' + dimSide + ' x ' + dimSide + ' ft (square) or ' + Math.ceil(dimSide * 0.8) + ' x ' + Math.ceil(dimSide * 1.25) + ' ft (rectangular)</li>';
      details += '</ul>';
      document.getElementById('sc2-details')!.innerHTML = details;

      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.sc2-in').forEach(el => { el.addEventListener('input', calcSC2); el.addEventListener('change', calcSC2); });
      calcSC2();
    }, 50);
  </script>
</CalculatorLayout>
