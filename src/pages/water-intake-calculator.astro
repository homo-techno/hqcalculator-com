---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';

const title = "Water Intake Calculator - Daily Water Needs 2026";
const description = "Calculate how much water you should drink daily based on weight, activity level, and climate. Personalized hydration recommendations.";

const relatedCalcs = [
  { name: "Calorie Calculator", url: "/calorie-calculator", description: "Daily calorie needs." },
  { name: "BMI Calculator", url: "/bmi-calculator", description: "Body Mass Index." },
  { name: "TDEE Calculator", url: "/tdee-calculator", description: "Total daily energy." },
  { name: "BMR Calculator", url: "/bmr-calculator", description: "Basal metabolic rate." },
  { name: "Weight Loss Calculator", url: "/weight-loss-calculator", description: "Weight loss plan." },
  { name: "Macro Calculator", url: "/macro-calculator", description: "Macros." },
];
---

<CalculatorLayout
  title={title}
  description={description}
  calculatorName="Water Intake Calculator"
  keywords="water intake calculator, how much water to drink, daily water needs, hydration calculator, water consumption"
  breadcrumbs={[{ name: "Water Intake", url: "/water-intake-calculator" }]}
>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Water Intake Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Find out how much water you should drink each day based on your body and lifestyle.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="mb-5">
        <label class="block text-sm font-medium text-text mb-1">Body Weight</label>
        <div class="flex gap-2">
          <input type="number" id="wi-weight" class="flex-1 px-4 py-3 border border-border rounded-xl text-lg" value="154" min="50" max="500">
          <select id="wi-unit" class="px-3 py-3 border border-border rounded-xl">
            <option value="lbs">lbs</option>
            <option value="kg">kg</option>
          </select>
        </div>
      </div>

      <div class="mb-5">
        <label class="block text-sm font-medium text-text mb-2">Activity Level</label>
        <div class="grid grid-cols-1 gap-2">
          <label class="wi-activity flex items-center gap-3 px-4 py-3 border border-border rounded-xl cursor-pointer hover:bg-surface-alt">
            <input type="radio" name="wi-act" value="sedentary" class="accent-primary">
            <div><span class="font-semibold text-sm">Sedentary</span><span class="text-xs text-text-muted ml-2">Little or no exercise</span></div>
          </label>
          <label class="wi-activity flex items-center gap-3 px-4 py-3 border border-primary rounded-xl cursor-pointer bg-blue-50">
            <input type="radio" name="wi-act" value="moderate" checked class="accent-primary">
            <div><span class="font-semibold text-sm">Moderate</span><span class="text-xs text-text-muted ml-2">Exercise 3-5x/week</span></div>
          </label>
          <label class="wi-activity flex items-center gap-3 px-4 py-3 border border-border rounded-xl cursor-pointer hover:bg-surface-alt">
            <input type="radio" name="wi-act" value="active" class="accent-primary">
            <div><span class="font-semibold text-sm">Active</span><span class="text-xs text-text-muted ml-2">Daily exercise or physical job</span></div>
          </label>
          <label class="wi-activity flex items-center gap-3 px-4 py-3 border border-border rounded-xl cursor-pointer hover:bg-surface-alt">
            <input type="radio" name="wi-act" value="athlete" class="accent-primary">
            <div><span class="font-semibold text-sm">Athlete</span><span class="text-xs text-text-muted ml-2">Intense training 2+ hrs/day</span></div>
          </label>
        </div>
      </div>

      <div class="mb-5">
        <label class="block text-sm font-medium text-text mb-2">Climate</label>
        <div class="flex gap-2">
          <button class="wi-climate-btn flex-1 py-2 rounded-lg text-sm font-semibold bg-surface-alt text-text-secondary" data-climate="cold">Cold</button>
          <button class="wi-climate-btn flex-1 py-2 rounded-lg text-sm font-semibold bg-primary text-white" data-climate="temperate">Temperate</button>
          <button class="wi-climate-btn flex-1 py-2 rounded-lg text-sm font-semibold bg-surface-alt text-text-secondary" data-climate="hot">Hot</button>
        </div>
      </div>

      <!-- Results -->
      <div class="p-6 bg-primary rounded-2xl text-white text-center mb-4">
        <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Daily Water Intake</div>
        <div class="text-4xl font-extrabold" id="wi-result">0</div>
      </div>

      <div class="grid grid-cols-3 gap-3 mb-4">
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Liters</div>
          <div class="text-xl font-bold" id="wi-liters">0</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Fluid Oz</div>
          <div class="text-xl font-bold" id="wi-oz">0</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Cups</div>
          <div class="text-xl font-bold" id="wi-cups">0</div>
        </div>
      </div>

      <div class="grid grid-cols-2 gap-3 mb-6">
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Water Bottles (500ml)</div>
          <div class="text-2xl font-bold" id="wi-bottles">0</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Glasses (250ml)</div>
          <div class="text-2xl font-bold" id="wi-glasses">0</div>
        </div>
      </div>

      <!-- Schedule -->
      <div class="p-4 bg-surface-alt rounded-xl mb-6">
        <h3 class="font-semibold text-sm text-text mb-3">Suggested Drinking Schedule</h3>
        <div class="space-y-2 text-sm" id="wi-schedule"></div>
      </div>

      <ShareButton calculatorId="water-intake" />
      <FeedbackWidget />
    </div>

    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">How Much Water Do You Need?</h2>
      <p>Water needs vary based on body weight, activity level, climate, and health. A common baseline is to drink half your body weight (in pounds) in ounces of water per day, then adjust for activity and environment.</p>

      <div class="bg-surface-alt rounded-xl p-4 my-4 text-center font-mono">Base (oz) = Weight (lbs) × 0.5 → Adjust for activity & climate</div>

      <h3 class="text-xl font-semibold text-text mt-8">Signs of Dehydration</h3>
      <ul>
        <li>Dark yellow urine (should be pale yellow)</li>
        <li>Thirst, dry mouth, headache</li>
        <li>Fatigue and decreased concentration</li>
        <li>Dizziness or lightheadedness</li>
      </ul>

      <h3 class="text-xl font-semibold text-text mt-8">Tips for Staying Hydrated</h3>
      <ul>
        <li>Carry a reusable water bottle and sip throughout the day</li>
        <li>Drink a glass of water before each meal</li>
        <li>Eat water-rich foods: cucumbers, watermelon, oranges, lettuce</li>
        <li>Set reminders if you often forget to drink</li>
        <li>About 20% of daily water comes from food</li>
      </ul>

      <h3 class="text-xl font-semibold text-text mt-8">Frequently Asked Questions</h3>
      <p><strong>Is the "8 glasses a day" rule accurate?</strong> It's a reasonable starting point, but individual needs vary. Active people in hot climates may need 2-3× more.</p>
      <p><strong>Can you drink too much water?</strong> Yes — overhydration (hyponatremia) is rare but serious. Follow your thirst and the guidelines here.</p>
      <p><strong>Do coffee and tea count?</strong> Yes. Caffeinated beverages do contribute to hydration despite mild diuretic effects. However, pure water is ideal.</p>
    </article>

    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    let wiClimate = 'temperate';

    function calcWater() {
      let weightKg = parseFloat((document.getElementById('wi-weight') as HTMLInputElement).value) || 70;
      const unit = (document.getElementById('wi-unit') as HTMLSelectElement).value;
      if (unit === 'lbs') weightKg = weightKg / 2.2046;

      const activity = (document.querySelector('input[name="wi-act"]:checked') as HTMLInputElement)?.value || 'moderate';

      // Base: 30-35 ml per kg
      let baseMl = weightKg * 33;

      // Activity multiplier
      const actMultiplier: Record<string, number> = { sedentary: 0.85, moderate: 1.0, active: 1.2, athlete: 1.4 };
      baseMl *= actMultiplier[activity] || 1.0;

      // Climate adjustment
      const climateAdj: Record<string, number> = { cold: 0.9, temperate: 1.0, hot: 1.15 };
      baseMl *= climateAdj[wiClimate] || 1.0;

      const liters = baseMl / 1000;
      const oz = baseMl * 0.033814;
      const cups = oz / 8;
      const bottles = liters / 0.5;
      const glasses = liters / 0.25;

      document.getElementById('wi-result')!.textContent = liters.toFixed(1) + ' L / ' + Math.round(oz) + ' oz';
      document.getElementById('wi-liters')!.textContent = liters.toFixed(1) + ' L';
      document.getElementById('wi-oz')!.textContent = Math.round(oz) + ' oz';
      document.getElementById('wi-cups')!.textContent = cups.toFixed(1);
      document.getElementById('wi-bottles')!.textContent = Math.ceil(bottles).toString();
      document.getElementById('wi-glasses')!.textContent = Math.ceil(glasses).toString();

      // Schedule
      const perGlass = Math.round(baseMl / Math.ceil(glasses));
      const schedule = [
        { time: '7:00 AM', note: 'Wake up — 1 glass', ml: perGlass },
        { time: '9:00 AM', note: 'Mid-morning', ml: perGlass },
        { time: '11:00 AM', note: 'Before lunch', ml: perGlass },
        { time: '1:00 PM', note: 'After lunch', ml: perGlass },
        { time: '3:00 PM', note: 'Afternoon', ml: perGlass },
        { time: '5:00 PM', note: 'Before dinner', ml: perGlass },
        { time: '7:00 PM', note: 'Evening', ml: perGlass },
        { time: '9:00 PM', note: 'Before bed', ml: Math.max(0, Math.round(baseMl - perGlass * 7)) },
      ].filter(s => s.ml > 0);

      document.getElementById('wi-schedule')!.innerHTML = schedule.map(s =>
        `<div class="flex items-center gap-3">
          <span class="w-20 text-text-muted font-mono text-xs">${s.time}</span>
          <div class="flex-1 h-2 bg-border/30 rounded-full overflow-hidden"><div class="h-full bg-primary rounded-full" style="width:${(s.ml / perGlass * 100)}%"></div></div>
          <span class="text-text-secondary text-xs">${s.note}</span>
          <span class="font-bold text-xs">${s.ml}ml</span>
        </div>`
      ).join('');

      document.dispatchEvent(new CustomEvent('calc-update'));
    }

    setTimeout(() => {
      document.querySelectorAll('.wi-activity').forEach(label => {
        label.addEventListener('click', () => {
          document.querySelectorAll('.wi-activity').forEach(l => { l.classList.remove('border-primary', 'bg-blue-50'); l.classList.add('border-border'); });
          label.classList.remove('border-border'); label.classList.add('border-primary', 'bg-blue-50');
          setTimeout(calcWater, 10);
        });
      });

      document.querySelectorAll('.wi-climate-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          document.querySelectorAll('.wi-climate-btn').forEach(b => { b.classList.remove('bg-primary', 'text-white'); b.classList.add('bg-surface-alt', 'text-text-secondary'); });
          btn.classList.remove('bg-surface-alt', 'text-text-secondary'); btn.classList.add('bg-primary', 'text-white');
          wiClimate = (btn as HTMLElement).dataset.climate || 'temperate';
          calcWater();
        });
      });

      ['wi-weight'].forEach(id => document.getElementById(id)!.addEventListener('input', calcWater));
      document.getElementById('wi-unit')!.addEventListener('change', calcWater);

      calcWater();
    }, 50);
  </script>
</CalculatorLayout>
