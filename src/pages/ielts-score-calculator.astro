---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "IELTS Score Calculator - Overall Band & CEFR Level";
const description = "Calculate your IELTS overall band score from individual section scores, find your CEFR level, and check university requirements.";
const relatedCalcs = [
  { name: "Language Learning", url: "/language-learning-calculator", description: "Study hours." },
  { name: "SAT Score", url: "/sat-score-calculator", description: "SAT scoring." },
  { name: "ACT Score", url: "/act-score-calculator", description: "ACT scoring." },
  { name: "Spaced Repetition", url: "/spaced-repetition-calculator", description: "Study planning." },
  { name: "Scholarship", url: "/scholarship-calculator", description: "Scholarships." },
  { name: "Percentage Calculator", url: "/percentage-calculator", description: "Percentages." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="IELTS Score Calculator" keywords="IELTS calculator, IELTS band score, IELTS overall, CEFR level, IELTS university requirement" breadcrumbs={[{ name: "IELTS Score", url: "/ielts-score-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">IELTS Score Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate your overall IELTS band and check if you meet university requirements.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Listening Band</label><input type="number" id="ie-listen" class="ie-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="7.0" min="0" max="9" step="0.5"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Reading Band</label><input type="number" id="ie-read" class="ie-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="6.5" min="0" max="9" step="0.5"></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Writing Band</label><input type="number" id="ie-write" class="ie-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="6.0" min="0" max="9" step="0.5"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Speaking Band</label><input type="number" id="ie-speak" class="ie-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="6.5" min="0" max="9" step="0.5"></div>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Overall Band Score</div>
          <div class="text-5xl font-extrabold font-mono" id="ie-overall">0</div>
          <div class="text-sm text-blue-200 mt-1">out of 9.0</div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">CEFR Level</div><div class="text-xl font-bold" id="ie-cefr">-</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Skill Level</div><div class="text-xl font-bold" id="ie-skill">-</div></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-3">University Requirement Check</h3>
          <div class="space-y-2" id="ie-reqs"></div>
        </div>
      </div>
      <ShareButton calculatorId="ielts-score" />
      <FeedbackWidget />
    </div>
    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">IELTS Scoring Guide</h2>
      <p>IELTS scores range from 0-9 in half-band increments. The overall band is the average of four sections, rounded to the nearest 0.5. Most universities require 6.0-7.5 overall with minimum section scores.</p>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcIELTS() {
      const listen = parseFloat((document.getElementById('ie-listen') as HTMLInputElement).value) || 0;
      const read = parseFloat((document.getElementById('ie-read') as HTMLInputElement).value) || 0;
      const write = parseFloat((document.getElementById('ie-write') as HTMLInputElement).value) || 0;
      const speak = parseFloat((document.getElementById('ie-speak') as HTMLInputElement).value) || 0;
      const avg = (listen + read + write + speak) / 4;
      // Round to nearest 0.5
      const overall = Math.round(avg * 2) / 2;
      // CEFR mapping
      let cefr: string;
      let skill: string;
      if (overall >= 8.5) { cefr = 'C2'; skill = 'Expert'; }
      else if (overall >= 7.0) { cefr = 'C1'; skill = 'Very Good'; }
      else if (overall >= 5.5) { cefr = 'B2'; skill = 'Competent'; }
      else if (overall >= 4.0) { cefr = 'B1'; skill = 'Modest'; }
      else if (overall >= 3.0) { cefr = 'A2'; skill = 'Limited'; }
      else { cefr = 'A1'; skill = 'Beginner'; }
      document.getElementById('ie-overall')!.textContent = overall.toFixed(1);
      document.getElementById('ie-cefr')!.textContent = cefr;
      document.getElementById('ie-skill')!.textContent = skill;
      const minSection = Math.min(listen, read, write, speak);
      const reqs = [
        { name: 'Top Universities (Oxford, MIT)', overall: 7.5, section: 7.0 },
        { name: 'Most US/UK Universities', overall: 6.5, section: 6.0 },
        { name: 'Foundation Programs', overall: 5.5, section: 5.0 },
        { name: 'Immigration (Canada/Australia)', overall: 6.0, section: 6.0 },
      ];
      const reqsHTML = reqs.map(r => {
        const meetsOverall = overall >= r.overall;
        const meetsSection = minSection >= r.section;
        const pass = meetsOverall && meetsSection;
        const status = pass ? 'text-green-600' : 'text-red-500';
        const label = pass ? 'Meets Requirement' : 'Below Requirement';
        return `<div class="flex justify-between items-center py-1 border-b border-border last:border-0"><span class="text-sm">${r.name} (${r.overall}+)</span><span class="text-sm font-bold ${status}">${label}</span></div>`;
      }).join('');
      document.getElementById('ie-reqs')!.innerHTML = reqsHTML;
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => { document.querySelectorAll('.ie-in').forEach(el => { el.addEventListener('input', calcIELTS); el.addEventListener('change', calcIELTS); }); calcIELTS(); }, 50);
  </script>
</CalculatorLayout>
