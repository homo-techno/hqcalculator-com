---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Canal Lock Calculator - Water Volume & Transit Time";
const description = "Calculate water volume per lock cycle, rise/fall, transit time, and vessel clearance for canal lock navigation.";
const relatedCalcs = [
  { name: "Pool Volume", url: "/pool-volume-calculator", description: "Water volume calculations." },
  { name: "Nautical Mile", url: "/nautical-mile-calculator", description: "Nautical distance conversion." },
  { name: "Tide Calculator", url: "/tide-calculator", description: "Tidal predictions." },
  { name: "Water Usage", url: "/water-usage-calculator", description: "Water usage tracking." },
  { name: "Great Circle", url: "/great-circle-calculator", description: "Great circle navigation." },
  { name: "Boat Loan", url: "/boat-loan-calculator", description: "Marine financing costs." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Canal Lock Calculator" keywords="canal lock calculator, lock water volume, lock transit time, vessel clearance, lock cycle, canal navigation" breadcrumbs={[{ name: "Canal Lock", url: "/canal-lock-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Canal Lock Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate water volume per lock cycle, transit times, and vessel clearance for canal lock operations.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Lock Length (ft)</label><input type="number" id="ck2-len" class="ck2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="1" step="10"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Lock Width (ft)</label><input type="number" id="ck2-wid" class="ck2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="1" step="5"></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Rise / Fall (ft)</label><input type="number" id="ck2-rise" class="ck2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="1" step="1"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Fill Time (minutes)</label><input type="number" id="ck2-fill" class="ck2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="1" step="1"></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Vessel LOA (ft)</label><input type="number" id="ck2-loa" class="ck2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="1" step="1"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Vessel Beam (ft)</label><input type="number" id="ck2-vbeam" class="ck2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="1" step="1"></div>
        </div>
        <div><label class="block text-xs font-medium text-text mb-1">Number of Locks</label><input type="number" id="ck2-num" class="ck2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="1" max="50" step="1"></div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Water Per Lock Cycle</div>
          <div class="text-5xl font-extrabold font-mono" id="ck2-vol">--</div>
          <div class="text-sm text-blue-200 mt-1">gallons</div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Volume (cu ft)</div><div class="text-xl font-bold" id="ck2-cuft">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Total Transit</div><div class="text-xl font-bold" id="ck2-transit">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Total Rise</div><div class="text-xl font-bold" id="ck2-trise">--</div></div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Length Clearance</div><div class="text-xl font-bold" id="ck2-lclear">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Beam Clearance</div><div class="text-xl font-bold" id="ck2-bclear">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Fit Status</div><div class="text-xl font-bold" id="ck2-fit">--</div></div>
        </div>
      </div>
      <ShareButton calculatorId="canal-lock" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcCK2() {
      const lockLen = parseFloat((document.getElementById('ck2-len') as HTMLInputElement).value) || 0;
      const lockWid = parseFloat((document.getElementById('ck2-wid') as HTMLInputElement).value) || 0;
      const rise = parseFloat((document.getElementById('ck2-rise') as HTMLInputElement).value) || 0;
      const fillTime = parseFloat((document.getElementById('ck2-fill') as HTMLInputElement).value) || 0;
      const vesselLOA = parseFloat((document.getElementById('ck2-loa') as HTMLInputElement).value) || 0;
      const vesselBeam = parseFloat((document.getElementById('ck2-vbeam') as HTMLInputElement).value) || 0;
      const numLocks = parseInt((document.getElementById('ck2-num') as HTMLInputElement).value) || 1;

      const volumeCuFt = lockLen * lockWid * rise;
      const volumeGal = volumeCuFt * 7.48052;
      const totalTransitMin = numLocks * (fillTime + 5); // 5 min for entry/exit per lock
      const totalRise = rise * numLocks;
      const lengthClear = lockLen - vesselLOA;
      const beamClear = lockWid - vesselBeam;

      let fitStatus = 'Fits';
      if (lengthClear < 0 || beamClear < 0) fitStatus = 'TOO LARGE';
      else if (lengthClear < 5 || beamClear < 2) fitStatus = 'Tight Fit';
      else fitStatus = 'Good Fit';

      document.getElementById('ck2-vol')!.textContent = volumeGal > 0 ? Math.round(volumeGal).toLocaleString() : '--';
      document.getElementById('ck2-cuft')!.textContent = volumeCuFt > 0 ? Math.round(volumeCuFt).toLocaleString() : '--';
      document.getElementById('ck2-transit')!.textContent = totalTransitMin > 0 ? Math.round(totalTransitMin) + ' min' : '--';
      document.getElementById('ck2-trise')!.textContent = totalRise > 0 ? totalRise.toFixed(1) + ' ft' : '--';
      document.getElementById('ck2-lclear')!.textContent = lengthClear > 0 ? lengthClear.toFixed(1) + ' ft' : lengthClear < 0 ? 'NONE' : '--';
      document.getElementById('ck2-bclear')!.textContent = beamClear > 0 ? beamClear.toFixed(1) + ' ft' : beamClear < 0 ? 'NONE' : '--';
      document.getElementById('ck2-fit')!.textContent = fitStatus;
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      (document.getElementById('ck2-len') as HTMLInputElement).value = '600';
      (document.getElementById('ck2-wid') as HTMLInputElement).value = '110';
      (document.getElementById('ck2-rise') as HTMLInputElement).value = '28';
      (document.getElementById('ck2-fill') as HTMLInputElement).value = '8';
      (document.getElementById('ck2-loa') as HTMLInputElement).value = '40';
      (document.getElementById('ck2-vbeam') as HTMLInputElement).value = '14';
      (document.getElementById('ck2-num') as HTMLInputElement).value = '3';
      document.querySelectorAll('.ck2-in').forEach(el => { el.addEventListener('input', calcCK2); el.addEventListener('change', calcCK2); });
      calcCK2();
    }, 50);
  </script>
</CalculatorLayout>
