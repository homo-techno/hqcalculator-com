---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Coulomb's Law Calculator";
const description = "Calculate the electrostatic force between two charges using Coulomb's law: F = kq₁q₂/r².";
const relatedCalcs = [
  { name: "Ohm's Law", url: "/ohms-law-calculator", description: "Ohm's law." },
  { name: "Capacitor", url: "/capacitor-calculator", description: "Capacitors." },
  { name: "Force Calculator", url: "/force-calculator", description: "Force." },
  { name: "Voltage Divider", url: "/voltage-divider-calculator", description: "Voltage." },
  { name: "Scientific Notation", url: "/scientific-notation-calculator", description: "Notation." },
  { name: "Unit Converter", url: "/unit-converter", description: "Units." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Coulomb's Law Calculator" keywords="Coulomb's law, electrostatic force, electric charge, charge force, Coulomb constant" breadcrumbs={[{ name: "Coulomb's Law", url: "/coulombs-law-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Coulomb's Law Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">F = k × q₁ × q₂ / r² — electrostatic force.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Charge q₁ (C)</label><input type="text" id="cl-q1" class="cl-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="1e-6"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Charge q₂ (C)</label><input type="text" id="cl-q2" class="cl-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="1e-6"></div>
        </div>
        <div><label class="block text-xs font-medium text-text mb-1">Distance (m)</label><input type="number" id="cl-r" class="cl-in w-full px-4 py-3 border border-border rounded-xl text-2xl font-bold" value="0.1" min="0.001" step="0.01"></div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Electrostatic Force</div>
          <div class="text-5xl font-extrabold font-mono" id="cl-result">0 N</div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Direction</div><div class="text-xl font-bold font-mono" id="cl-dir">Repulsive</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Electric Field (q₁)</div><div class="text-xl font-bold font-mono" id="cl-field">0</div></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-2">Formula</h3>
          <div class="text-xs font-mono" id="cl-formula">F = k × q₁ × q₂ / r², k = 8.988 × 10⁹ N·m²/C²</div>
        </div>
      </div>
      <ShareButton calculatorId="coulombs-law" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    const K_CL = 8.9875e9;
    function calcCL() {
      const q1 = parseFloat((document.getElementById('cl-q1') as HTMLInputElement).value) || 0;
      const q2 = parseFloat((document.getElementById('cl-q2') as HTMLInputElement).value) || 0;
      const r = parseFloat((document.getElementById('cl-r') as HTMLInputElement).value) || 0.001;
      const force = K_CL * Math.abs(q1 * q2) / (r * r);
      const sameSign = (q1 >= 0 && q2 >= 0) || (q1 < 0 && q2 < 0);
      const eField = K_CL * Math.abs(q1) / (r * r);
      let forceLabel: string;
      if (force >= 1e6) forceLabel = (force / 1e6).toFixed(3) + ' MN';
      else if (force >= 1e3) forceLabel = (force / 1e3).toFixed(3) + ' kN';
      else if (force >= 1) forceLabel = force.toFixed(4) + ' N';
      else if (force >= 1e-3) forceLabel = (force * 1e3).toFixed(3) + ' mN';
      else forceLabel = force.toExponential(3) + ' N';
      document.getElementById('cl-result')!.textContent = forceLabel;
      document.getElementById('cl-dir')!.textContent = sameSign ? 'Repulsive' : 'Attractive';
      document.getElementById('cl-field')!.textContent = eField.toExponential(2) + ' N/C';
      document.getElementById('cl-formula')!.textContent = `F = 8.988×10⁹ × ${Math.abs(q1).toExponential(1)} × ${Math.abs(q2).toExponential(1)} / ${r}² = ${forceLabel}`;
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.cl-in').forEach(el => { el.addEventListener('input', calcCL); el.addEventListener('change', calcCL); });
      calcCL();
    }, 50);
  </script>
</CalculatorLayout>
