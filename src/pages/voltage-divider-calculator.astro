---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Voltage Divider Calculator";
const description = "Calculate output voltage for a resistive voltage divider circuit. Find resistor values for desired output.";
const relatedCalcs = [
  { name: "Ohm's Law", url: "/ohms-law-calculator", description: "Ohm's law." },
  { name: "Resistor Color Code", url: "/resistor-color-code-calculator", description: "Resistor." },
  { name: "Power Calculator", url: "/power-calculator", description: "Power." },
  { name: "LED Resistor", url: "/led-resistor-calculator", description: "LED." },
  { name: "Wire Gauge", url: "/wire-gauge-calculator", description: "Wire gauge." },
  { name: "Capacitor Calculator", url: "/capacitor-calculator", description: "Capacitor." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Voltage Divider Calculator" keywords="voltage divider calculator, resistor divider, Vout, voltage regulation, potential divider" breadcrumbs={[{ name: "Voltage Divider", url: "/voltage-divider-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Voltage Divider Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate output voltage for a resistive voltage divider.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="grid grid-cols-3 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Vin (V)</label><input type="number" id="vd-vin" class="vd-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="12" min="0" step="0.1"></div>
          <div><label class="block text-xs font-medium text-text mb-1">R1 (Ω)</label><input type="number" id="vd-r1" class="vd-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="10000" min="0" step="1"></div>
          <div><label class="block text-xs font-medium text-text mb-1">R2 (Ω)</label><input type="number" id="vd-r2" class="vd-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="10000" min="0" step="1"></div>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Output Voltage (Vout)</div>
          <div class="text-5xl font-extrabold font-mono" id="vd-result">0 V</div>
          <div class="text-sm text-blue-200 mt-1" id="vd-formula">Vout = Vin × R2 / (R1 + R2)</div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Current</div><div class="text-xl font-bold font-mono" id="vd-i">0 mA</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Power (R1)</div><div class="text-xl font-bold font-mono" id="vd-p1">0 mW</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Power (R2)</div><div class="text-xl font-bold font-mono" id="vd-p2">0 mW</div></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Ratio (R2/R1)</div><div class="text-xl font-bold font-mono" id="vd-ratio">0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Total Power</div><div class="text-xl font-bold font-mono" id="vd-ptot">0 mW</div></div>
        </div>
      </div>
      <ShareButton calculatorId="voltage-divider" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function fmtR(v: number): string {
      if (v >= 1e6) return (v/1e6).toFixed(1) + 'MΩ';
      if (v >= 1e3) return (v/1e3).toFixed(1) + 'kΩ';
      return v + 'Ω';
    }
    function calcVD() {
      const vin = parseFloat((document.getElementById('vd-vin') as HTMLInputElement).value) || 0;
      const r1 = parseFloat((document.getElementById('vd-r1') as HTMLInputElement).value) || 0;
      const r2 = parseFloat((document.getElementById('vd-r2') as HTMLInputElement).value) || 0;
      const total = r1 + r2;
      const vout = total > 0 ? vin * r2 / total : 0;
      const current = total > 0 ? vin / total : 0;
      const p1 = current * current * r1;
      const p2 = current * current * r2;
      document.getElementById('vd-result')!.textContent = vout.toFixed(4) + ' V';
      document.getElementById('vd-i')!.textContent = (current * 1000).toFixed(3) + ' mA';
      document.getElementById('vd-p1')!.textContent = (p1 * 1000).toFixed(3) + ' mW';
      document.getElementById('vd-p2')!.textContent = (p2 * 1000).toFixed(3) + ' mW';
      document.getElementById('vd-ptot')!.textContent = ((p1+p2) * 1000).toFixed(3) + ' mW';
      document.getElementById('vd-ratio')!.textContent = r1 > 0 ? (r2/r1).toFixed(4) : '-';
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.vd-in').forEach(el => { el.addEventListener('input', calcVD); el.addEventListener('change', calcVD); });
      calcVD();
    }, 50);
  </script>
</CalculatorLayout>
