---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Baking Altitude Calculator - High Altitude Adjustments";
const description = "Adjust baking recipes for high altitude. Get corrections for temperature, leavening, sugar, liquid, and baking time based on your elevation.";
const relatedCalcs = [
  { name: "Baker's Percentage Calculator", url: "/baker-percentage-calculator", description: "Calculate baker's percentages." },
  { name: "Cake Pan Converter", url: "/cake-pan-converter-calculator", description: "Convert between pan sizes." },
  { name: "Cookie Batch Calculator", url: "/cookie-batch-calculator", description: "Scale cookie recipes." },
  { name: "Bread Flour Calculator", url: "/bread-flour-calculator", description: "Flour protein and substitutions." },
  { name: "Baking Conversion Calculator", url: "/baking-conversion-calculator", description: "Convert between baking units." },
  { name: "Dough Hydration Calculator", url: "/dough-hydration-calculator", description: "Calculate dough hydration." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Baking Altitude Calculator" keywords="high altitude baking, altitude adjustment, elevation baking, mountain baking, high altitude recipe, altitude correction" breadcrumbs={[{ name: "Baking Altitude", url: "/baking-altitude-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Baking Altitude Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Adjust your sea-level baking recipes for high altitude. Get specific corrections for temperature, leavening, sugar, and liquid amounts.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div>
          <label class="block text-xs font-medium text-text mb-1">Your Altitude (feet)</label>
          <input type="number" id="ba2-alt" class="ba2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="5000" min="0" max="15000" step="100">
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Baking Type</label>
          <select id="ba2-type" class="ba2-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="cake">Cakes</option>
            <option value="cookies">Cookies</option>
            <option value="bread">Yeast Breads</option>
            <option value="quickbread">Quick Breads / Muffins</option>
            <option value="pie">Pies</option>
          </select>
        </div>
        <h3 class="font-bold text-text text-sm uppercase tracking-wide">Your Sea-Level Recipe Values</h3>
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="block text-xs font-medium text-text mb-1">Oven Temp (&deg;F)</label>
            <input type="number" id="ba2-temp" class="ba2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="350" min="200" max="500" step="5">
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Baking Powder (tsp)</label>
            <input type="number" id="ba2-bp" class="ba2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="1" min="0" max="10" step="0.25">
          </div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="block text-xs font-medium text-text mb-1">Sugar (cups)</label>
            <input type="number" id="ba2-sugar" class="ba2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="1" min="0" max="10" step="0.125">
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Liquid (cups)</label>
            <input type="number" id="ba2-liquid" class="ba2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="1" min="0" max="10" step="0.125">
          </div>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Adjusted Oven Temperature</div>
          <div class="text-5xl font-extrabold font-mono" id="ba2-result">--</div>
        </div>
        <div class="grid grid-cols-2 gap-4">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Baking Powder</div>
            <div class="text-xl font-bold font-mono" id="ba2-bp-adj">--</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Sugar</div>
            <div class="text-xl font-bold font-mono" id="ba2-sugar-adj">--</div>
          </div>
        </div>
        <div class="grid grid-cols-2 gap-4">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Liquid</div>
            <div class="text-xl font-bold font-mono" id="ba2-liquid-adj">--</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Boiling Point</div>
            <div class="text-xl font-bold font-mono" id="ba2-boil">--</div>
          </div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <div class="text-xs text-text-muted uppercase mb-2">Additional Tips</div>
          <div class="text-sm text-text-secondary" id="ba2-tips">--</div>
        </div>
      </div>
      <ShareButton calculatorId="baking-altitude" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcBA2() {
      const alt = parseFloat((document.getElementById('ba2-alt') as HTMLInputElement).value) || 0;
      const type = (document.getElementById('ba2-type') as HTMLSelectElement).value;
      const temp = parseFloat((document.getElementById('ba2-temp') as HTMLInputElement).value) || 350;
      const bp = parseFloat((document.getElementById('ba2-bp') as HTMLInputElement).value) || 0;
      const sugar = parseFloat((document.getElementById('ba2-sugar') as HTMLInputElement).value) || 0;
      const liquid = parseFloat((document.getElementById('ba2-liquid') as HTMLInputElement).value) || 0;

      // Adjustments based on altitude ranges
      let tempAdd = 0, bpReduce = 0, sugarReduce = 0, liquidAdd = 0;

      if (alt >= 3000 && alt < 5000) {
        tempAdd = 15;
        bpReduce = 0.125; // 1/8 tsp per tsp
        sugarReduce = 0.0625; // 1 tbsp per cup
        liquidAdd = 0.083; // ~1.5 tbsp per cup
      } else if (alt >= 5000 && alt < 7000) {
        tempAdd = 25;
        bpReduce = 0.25; // 1/4 tsp per tsp
        sugarReduce = 0.125; // 2 tbsp per cup
        liquidAdd = 0.125; // 2 tbsp per cup
      } else if (alt >= 7000 && alt < 10000) {
        tempAdd = 25;
        bpReduce = 0.375;
        sugarReduce = 0.1875; // 3 tbsp per cup
        liquidAdd = 0.1875;
      } else if (alt >= 10000) {
        tempAdd = 25;
        bpReduce = 0.5;
        sugarReduce = 0.25;
        liquidAdd = 0.25;
      }

      const adjTemp = temp + tempAdd;
      const adjBp = Math.max(0, bp * (1 - bpReduce));
      const adjSugar = sugar * (1 - sugarReduce);
      const adjLiquid = liquid * (1 + liquidAdd);

      // Boiling point drops ~1.8F per 1000ft
      const boilF = 212 - (alt / 1000 * 1.8);
      const boilC = (boilF - 32) * 5 / 9;

      document.getElementById('ba2-result')!.textContent = adjTemp + '\u00B0F (+' + tempAdd + '\u00B0)';
      document.getElementById('ba2-bp-adj')!.textContent = adjBp.toFixed(2) + ' tsp';
      document.getElementById('ba2-sugar-adj')!.textContent = adjSugar.toFixed(2) + ' cups';
      document.getElementById('ba2-liquid-adj')!.textContent = adjLiquid.toFixed(2) + ' cups';
      document.getElementById('ba2-boil')!.textContent = boilF.toFixed(0) + '\u00B0F / ' + boilC.toFixed(0) + '\u00B0C';

      let tips = '';
      if (alt < 3000) {
        tips = 'Below 3,000 ft: No altitude adjustments typically needed.';
      } else if (type === 'cake') {
        tips = 'For cakes: increase oven temp, decrease sugar and leavening, increase liquid. Use extra egg for structure. Grease pans more generously.';
      } else if (type === 'cookies') {
        tips = 'For cookies: slightly increase flour (1-2 tbsp per cup), decrease sugar slightly, increase liquid. Reduce baking time.';
      } else if (type === 'bread') {
        tips = 'For yeast breads: reduce rise time (dough rises faster at altitude). Decrease yeast by ~25%. May need slightly more flour.';
      } else if (type === 'quickbread') {
        tips = 'For quick breads: reduce baking powder, increase liquid, and increase oven temp. Add 2-4 tbsp flour per cup for structure.';
      } else {
        tips = 'For pies: increase oven temp. Filling may need more thickener as liquids boil at lower temperature.';
      }
      document.getElementById('ba2-tips')!.textContent = tips;

      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.ba2-in').forEach(el => { el.addEventListener('input', calcBA2); el.addEventListener('change', calcBA2); });
      calcBA2();
    }, 50);
  </script>
</CalculatorLayout>
