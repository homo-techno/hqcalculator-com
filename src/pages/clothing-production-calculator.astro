---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Clothing Production Calculator - Timeline & Cost";
const description = "Calculate clothing production timeline, cut/sew/finish time per unit, labor cost, and daily output capacity for garment manufacturing.";
const relatedCalcs = [
  { name: "Profit Margin Calculator", url: "/profit-margin-calculator", description: "Profit margin analysis." },
  { name: "Break Even Calculator", url: "/break-even-calculator", description: "Break-even point." },
  { name: "Salary Calculator", url: "/salary-calculator", description: "Salary calculations." },
  { name: "Fabric Calculator", url: "/fabric-calculator", description: "Fabric yardage needs." },
  { name: "Budget Calculator", url: "/budget-calculator", description: "Budget planning." },
  { name: "Time Calculator", url: "/time-calculator", description: "Time calculations." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Clothing Production Calculator" keywords="clothing production calculator, garment manufacturing, production timeline, labor cost, daily output, cut sew finish" breadcrumbs={[{ name: "Clothing Production", url: "/clothing-production-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Clothing Production Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Plan production timelines, calculate labor costs, and estimate daily output for garment manufacturing.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div>
          <label class="block text-xs font-medium text-text mb-1">Garment Complexity</label>
          <select id="cp2-complex" class="cp2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
            <option value="simple">Simple (T-shirt, Tank Top)</option>
            <option value="moderate" selected>Moderate (Dress, Pants)</option>
            <option value="complex">Complex (Jacket, Blazer)</option>
            <option value="couture">Couture / Tailored</option>
          </select>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Cutting Time / Unit (min)</label><input type="number" id="cp2-cut" class="cp2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="8" min="1" max="120" step="1"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Sewing Time / Unit (min)</label><input type="number" id="cp2-sew" class="cp2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="30" min="1" max="600" step="1"></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Finishing Time / Unit (min)</label><input type="number" id="cp2-finish" class="cp2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="10" min="1" max="120" step="1"></div>
          <div><label class="block text-xs font-medium text-text mb-1">QC / Packing (min)</label><input type="number" id="cp2-qc" class="cp2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="5" min="1" max="30" step="1"></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Labor Rate ($/hour)</label><input type="number" id="cp2-rate" class="cp2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="18" min="5" max="100" step="0.5"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Workers</label><input type="number" id="cp2-workers" class="cp2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="3" min="1" max="100" step="1"></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Order Quantity</label><input type="number" id="cp2-qty" class="cp2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="100" min="1" step="1"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Work Hours / Day</label><input type="number" id="cp2-hours" class="cp2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="8" min="4" max="12" step="0.5"></div>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Total Production Time</div>
          <div class="text-4xl font-extrabold font-mono" id="cp2-result">--</div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Time / Unit</div><div class="text-xl font-bold font-mono" id="cp2-perunit">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Daily Output</div><div class="text-xl font-bold font-mono" id="cp2-daily">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Days Needed</div><div class="text-xl font-bold font-mono" id="cp2-days">--</div></div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Labor / Unit</div><div class="text-xl font-bold font-mono" id="cp2-laborcost">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Total Labor</div><div class="text-xl font-bold font-mono" id="cp2-totallabor">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Efficiency</div><div class="text-xl font-bold font-mono" id="cp2-eff">--</div></div>
        </div>
      </div>
      <ShareButton calculatorId="clothing-production" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcCP2() {
      const complex = (document.getElementById('cp2-complex') as HTMLSelectElement).value;
      let cutMin = parseFloat((document.getElementById('cp2-cut') as HTMLInputElement).value) || 8;
      let sewMin = parseFloat((document.getElementById('cp2-sew') as HTMLInputElement).value) || 30;
      let finishMin = parseFloat((document.getElementById('cp2-finish') as HTMLInputElement).value) || 10;
      let qcMin = parseFloat((document.getElementById('cp2-qc') as HTMLInputElement).value) || 5;
      const rate = parseFloat((document.getElementById('cp2-rate') as HTMLInputElement).value) || 18;
      const workers = parseInt((document.getElementById('cp2-workers') as HTMLInputElement).value) || 3;
      const qty = parseInt((document.getElementById('cp2-qty') as HTMLInputElement).value) || 100;
      const hoursPerDay = parseFloat((document.getElementById('cp2-hours') as HTMLInputElement).value) || 8;

      // Presets
      const presets: Record<string, number[]> = {
        simple: [5, 15, 5, 3],
        moderate: [8, 30, 10, 5],
        complex: [15, 60, 20, 8],
        couture: [20, 120, 45, 15]
      };
      const p = presets[complex] || presets['moderate'];
      cutMin = p[0]; sewMin = p[1]; finishMin = p[2]; qcMin = p[3];
      (document.getElementById('cp2-cut') as HTMLInputElement).value = cutMin.toString();
      (document.getElementById('cp2-sew') as HTMLInputElement).value = sewMin.toString();
      (document.getElementById('cp2-finish') as HTMLInputElement).value = finishMin.toString();
      (document.getElementById('cp2-qc') as HTMLInputElement).value = qcMin.toString();

      const totalPerUnit = cutMin + sewMin + finishMin + qcMin;
      const laborCostPerUnit = (totalPerUnit / 60) * rate;
      const totalLaborCost = laborCostPerUnit * qty;

      // With parallel workers
      const totalMinutesAll = totalPerUnit * qty;
      const workerMinutesPerDay = hoursPerDay * 60 * workers;
      const daysNeeded = Math.ceil(totalMinutesAll / workerMinutesPerDay);
      const dailyOutput = Math.floor(workerMinutesPerDay / totalPerUnit);

      // Efficiency (assumes 85% standard)
      const efficiency = Math.min(100, (dailyOutput * totalPerUnit / workerMinutesPerDay) * 100 * 0.85);

      const totalHours = totalMinutesAll / 60;
      const displayTime = daysNeeded > 1 ? daysNeeded + ' work days' : (totalHours).toFixed(1) + ' hours';

      document.getElementById('cp2-result')!.textContent = displayTime;
      document.getElementById('cp2-perunit')!.textContent = totalPerUnit + ' min';
      document.getElementById('cp2-daily')!.textContent = dailyOutput + ' units';
      document.getElementById('cp2-days')!.textContent = daysNeeded.toString();
      document.getElementById('cp2-laborcost')!.textContent = '$' + laborCostPerUnit.toFixed(2);
      document.getElementById('cp2-totallabor')!.textContent = '$' + totalLaborCost.toLocaleString('en-US', {minimumFractionDigits: 0, maximumFractionDigits: 0});
      document.getElementById('cp2-eff')!.textContent = efficiency.toFixed(0) + '%';
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.cp2-in').forEach(el => { el.addEventListener('input', calcCP2); el.addEventListener('change', calcCP2); });
      calcCP2();
    }, 50);
  </script>
</CalculatorLayout>
