---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Basketball Stat Calculator";
const description = "Calculate advanced basketball stats: PER, true shooting %, effective FG%, game score, and win shares estimate.";
const relatedCalcs = [
  { name: "Batting Average", url: "/batting-average-calculator", description: "Baseball stats." },
  { name: "Bowling Score", url: "/bowling-score-calculator", description: "Bowling scores." },
  { name: "Sports Betting", url: "/sports-betting-calculator", description: "Odds and payouts." },
  { name: "Percentage", url: "/percentage-calculator", description: "Percentage math." },
  { name: "Average Calculator", url: "/average-calculator", description: "Compute averages." },
  { name: "Grade Calculator", url: "/grade-calculator", description: "Grade averages." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Basketball Stat Calculator" keywords="basketball stats calculator, PER, true shooting, effective field goal, game score, basketball analytics" breadcrumbs={[{ name: "Basketball Stat", url: "/basketball-stat-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Basketball Stat Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Enter your box score stats to calculate advanced basketball metrics like PER, TS%, eFG%, and Game Score.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-2">Scoring</h3>
          <div class="grid grid-cols-3 gap-2">
            <div><label class="block text-xs text-text-muted">Points</label><input type="number" id="bs-pts" class="bs-in w-full px-3 py-2 border border-border rounded-xl text-sm font-bold text-center" min="0" max="100" step="1"></div>
            <div><label class="block text-xs text-text-muted">FG Made</label><input type="number" id="bs-fgm" class="bs-in w-full px-3 py-2 border border-border rounded-xl text-sm font-bold text-center" min="0" max="50" step="1"></div>
            <div><label class="block text-xs text-text-muted">FG Att.</label><input type="number" id="bs-fga" class="bs-in w-full px-3 py-2 border border-border rounded-xl text-sm font-bold text-center" min="0" max="50" step="1"></div>
          </div>
          <div class="grid grid-cols-3 gap-2 mt-2">
            <div><label class="block text-xs text-text-muted">3PM</label><input type="number" id="bs-3pm" class="bs-in w-full px-3 py-2 border border-border rounded-xl text-sm font-bold text-center" min="0" max="20" step="1"></div>
            <div><label class="block text-xs text-text-muted">FT Made</label><input type="number" id="bs-ftm" class="bs-in w-full px-3 py-2 border border-border rounded-xl text-sm font-bold text-center" min="0" max="30" step="1"></div>
            <div><label class="block text-xs text-text-muted">FT Att.</label><input type="number" id="bs-fta" class="bs-in w-full px-3 py-2 border border-border rounded-xl text-sm font-bold text-center" min="0" max="30" step="1"></div>
          </div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-2">Other Stats</h3>
          <div class="grid grid-cols-4 gap-2">
            <div><label class="block text-xs text-text-muted">Rebounds</label><input type="number" id="bs-reb" class="bs-in w-full px-3 py-2 border border-border rounded-xl text-sm font-bold text-center" min="0" max="30" step="1"></div>
            <div><label class="block text-xs text-text-muted">Assists</label><input type="number" id="bs-ast" class="bs-in w-full px-3 py-2 border border-border rounded-xl text-sm font-bold text-center" min="0" max="25" step="1"></div>
            <div><label class="block text-xs text-text-muted">Steals</label><input type="number" id="bs-stl" class="bs-in w-full px-3 py-2 border border-border rounded-xl text-sm font-bold text-center" min="0" max="15" step="1"></div>
            <div><label class="block text-xs text-text-muted">Blocks</label><input type="number" id="bs-blk" class="bs-in w-full px-3 py-2 border border-border rounded-xl text-sm font-bold text-center" min="0" max="15" step="1"></div>
          </div>
          <div class="grid grid-cols-3 gap-2 mt-2">
            <div><label class="block text-xs text-text-muted">Turnovers</label><input type="number" id="bs-tov" class="bs-in w-full px-3 py-2 border border-border rounded-xl text-sm font-bold text-center" min="0" max="15" step="1"></div>
            <div><label class="block text-xs text-text-muted">Fouls</label><input type="number" id="bs-pf" class="bs-in w-full px-3 py-2 border border-border rounded-xl text-sm font-bold text-center" min="0" max="6" step="1"></div>
            <div><label class="block text-xs text-text-muted">Minutes</label><input type="number" id="bs-min" class="bs-in w-full px-3 py-2 border border-border rounded-xl text-sm font-bold text-center" min="1" max="48" step="1"></div>
          </div>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Game Score</div>
          <div class="text-5xl font-extrabold font-mono" id="bs-gamescore">--</div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">True Shooting %</div><div class="text-xl font-bold font-mono" id="bs-ts">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Effective FG%</div><div class="text-xl font-bold font-mono" id="bs-efg">--</div></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">FG%</div><div class="text-xl font-bold font-mono" id="bs-fgpct">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">FT%</div><div class="text-xl font-bold font-mono" id="bs-ftpct">--</div></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-2">Per-36 Minute Stats</h3>
          <div class="text-xs space-y-1" id="bs-per36"></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-2">Performance Rating</h3>
          <p class="text-sm" id="bs-rating">--</p>
        </div>
      </div>
      <ShareButton calculatorId="basketball-stat" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcBS() {
      const pts = parseInt((document.getElementById('bs-pts') as HTMLInputElement).value) || 0;
      const fgm = parseInt((document.getElementById('bs-fgm') as HTMLInputElement).value) || 0;
      const fga = parseInt((document.getElementById('bs-fga') as HTMLInputElement).value) || 0;
      const threepm = parseInt((document.getElementById('bs-3pm') as HTMLInputElement).value) || 0;
      const ftm = parseInt((document.getElementById('bs-ftm') as HTMLInputElement).value) || 0;
      const fta = parseInt((document.getElementById('bs-fta') as HTMLInputElement).value) || 0;
      const reb = parseInt((document.getElementById('bs-reb') as HTMLInputElement).value) || 0;
      const ast = parseInt((document.getElementById('bs-ast') as HTMLInputElement).value) || 0;
      const stl = parseInt((document.getElementById('bs-stl') as HTMLInputElement).value) || 0;
      const blk = parseInt((document.getElementById('bs-blk') as HTMLInputElement).value) || 0;
      const tov = parseInt((document.getElementById('bs-tov') as HTMLInputElement).value) || 0;
      const pf = parseInt((document.getElementById('bs-pf') as HTMLInputElement).value) || 0;
      const minutes = parseInt((document.getElementById('bs-min') as HTMLInputElement).value) || 1;
      const tsa = fga + 0.44 * fta;
      const tsPct = tsa > 0 ? (pts / (2 * tsa)) * 100 : 0;
      const efgPct = fga > 0 ? ((fgm + 0.5 * threepm) / fga) * 100 : 0;
      const fgPct = fga > 0 ? (fgm / fga) * 100 : 0;
      const ftPct = fta > 0 ? (ftm / fta) * 100 : 0;
      const gameScore = pts + 0.4 * fgm - 0.7 * fga - 0.4 * (fta - ftm) + 0.7 * reb + 0.3 * (stl + blk + ast) - 0.4 * pf - tov;
      const per36Scale = minutes > 0 ? 36 / minutes : 0;
      document.getElementById('bs-gamescore')!.textContent = gameScore.toFixed(1);
      document.getElementById('bs-ts')!.textContent = tsPct.toFixed(1) + '%';
      document.getElementById('bs-efg')!.textContent = efgPct.toFixed(1) + '%';
      document.getElementById('bs-fgpct')!.textContent = fgPct.toFixed(1) + '%';
      document.getElementById('bs-ftpct')!.textContent = ftPct.toFixed(1) + '%';
      document.getElementById('bs-per36')!.innerHTML = [
        `<div class="flex justify-between"><span>Points</span><span class="font-mono font-bold">${(pts * per36Scale).toFixed(1)}</span></div>`,
        `<div class="flex justify-between"><span>Rebounds</span><span class="font-mono font-bold">${(reb * per36Scale).toFixed(1)}</span></div>`,
        `<div class="flex justify-between"><span>Assists</span><span class="font-mono font-bold">${(ast * per36Scale).toFixed(1)}</span></div>`,
        `<div class="flex justify-between"><span>Steals</span><span class="font-mono font-bold">${(stl * per36Scale).toFixed(1)}</span></div>`,
        `<div class="flex justify-between"><span>Blocks</span><span class="font-mono font-bold">${(blk * per36Scale).toFixed(1)}</span></div>`,
        `<div class="flex justify-between"><span>Turnovers</span><span class="font-mono font-bold">${(tov * per36Scale).toFixed(1)}</span></div>`,
      ].join('');
      let rating = '';
      if (gameScore >= 40) rating = 'Historic performance! All-time great game.';
      else if (gameScore >= 30) rating = 'Outstanding game. MVP-level performance.';
      else if (gameScore >= 20) rating = 'Excellent game. Star-caliber performance.';
      else if (gameScore >= 15) rating = 'Very good game. Solid starter performance.';
      else if (gameScore >= 10) rating = 'Above average. Good role player performance.';
      else if (gameScore >= 5) rating = 'Average game. Decent contribution.';
      else if (gameScore >= 0) rating = 'Below average. Limited positive impact.';
      else rating = 'Poor game. Negative impact on the team.';
      document.getElementById('bs-rating')!.textContent = `Game Score ${gameScore.toFixed(1)}: ${rating}`;
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      (document.getElementById('bs-pts') as HTMLInputElement).value = '25';
      (document.getElementById('bs-fgm') as HTMLInputElement).value = '9';
      (document.getElementById('bs-fga') as HTMLInputElement).value = '18';
      (document.getElementById('bs-3pm') as HTMLInputElement).value = '3';
      (document.getElementById('bs-ftm') as HTMLInputElement).value = '4';
      (document.getElementById('bs-fta') as HTMLInputElement).value = '5';
      (document.getElementById('bs-reb') as HTMLInputElement).value = '7';
      (document.getElementById('bs-ast') as HTMLInputElement).value = '5';
      (document.getElementById('bs-stl') as HTMLInputElement).value = '2';
      (document.getElementById('bs-blk') as HTMLInputElement).value = '1';
      (document.getElementById('bs-tov') as HTMLInputElement).value = '3';
      (document.getElementById('bs-pf') as HTMLInputElement).value = '2';
      (document.getElementById('bs-min') as HTMLInputElement).value = '36';
      document.querySelectorAll('.bs-in').forEach(el => { el.addEventListener('input', calcBS); el.addEventListener('change', calcBS); });
      calcBS();
    }, 50);
  </script>
</CalculatorLayout>
