---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Field Area Calculator - Acres, Hectares & Fencing";
const description = "Calculate irregular field area from dimensions. Convert between acres and hectares, compute perimeter, and estimate fencing needed.";
const relatedCalcs = [
  { name: "Area Calculator", url: "/area-calculator", description: "Calculate area of shapes." },
  { name: "Fence Post Calculator", url: "/fence-post-calculator", description: "Post spacing and count." },
  { name: "Volume Calculator", url: "/volume-calculator", description: "General volume calculations." },
  { name: "Irrigation Calculator", url: "/irrigation-calculator", description: "Irrigation water needs." },
  { name: "Asphalt Calculator", url: "/asphalt-calculator", description: "Paving material estimates." },
  { name: "Percentage Calculator", url: "/percentage-calculator", description: "Percentage computations." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Field Area Calculator" keywords="field area calculator, acres to hectares, irregular field area, fencing perimeter, farm field size" breadcrumbs={[{ name: "Field Area", url: "/field-area-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Field Area Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate field area from dimensions, convert units, and estimate fencing requirements.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div>
          <label class="block text-xs font-medium text-text mb-1">Field Shape</label>
          <select id="fa-shape" class="fa-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
            <option value="rect" selected>Rectangle</option>
            <option value="triangle">Triangle</option>
            <option value="trapezoid">Trapezoid</option>
            <option value="circle">Circle</option>
          </select>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="block text-xs font-medium text-text mb-1" id="fa-l1-label">Length (feet)</label>
            <input type="number" id="fa-l1" class="fa-in w-full px-4 py-3 border border-border rounded-xl text-2xl font-bold" value="1000" min="1" step="1">
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1" id="fa-l2-label">Width (feet)</label>
            <input type="number" id="fa-l2" class="fa-in w-full px-4 py-3 border border-border rounded-xl text-2xl font-bold" value="500" min="1" step="1">
          </div>
        </div>
        <div id="fa-l3-wrap">
          <label class="block text-xs font-medium text-text mb-1" id="fa-l3-label">Second Parallel Side (feet)</label>
          <input type="number" id="fa-l3" class="fa-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="800" min="0" step="1">
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="block text-xs font-medium text-text mb-1">Fence Cost ($/foot)</label>
            <input type="number" id="fa-fcost" class="fa-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="3.50" min="0" step="0.25">
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Gate Openings</label>
            <input type="number" id="fa-gates" class="fa-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="2" min="0" max="20" step="1">
          </div>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Field Area</div>
          <div class="text-5xl font-extrabold font-mono" id="fa-area">--</div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Hectares</div>
            <div class="text-xl font-bold font-mono" id="fa-ha">--</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Square Feet</div>
            <div class="text-xl font-bold font-mono" id="fa-sqft">--</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Square Meters</div>
            <div class="text-xl font-bold font-mono" id="fa-sqm">--</div>
          </div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Perimeter (ft)</div>
            <div class="text-xl font-bold font-mono" id="fa-perim">--</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Fence Cost</div>
            <div class="text-xl font-bold font-mono" id="fa-fence">--</div>
          </div>
        </div>
      </div>
      <ShareButton calculatorId="field-area" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcFA() {
      const shape = (document.getElementById('fa-shape') as HTMLSelectElement).value;
      const l1 = parseFloat((document.getElementById('fa-l1') as HTMLInputElement).value) || 0;
      const l2 = parseFloat((document.getElementById('fa-l2') as HTMLInputElement).value) || 0;
      const l3 = parseFloat((document.getElementById('fa-l3') as HTMLInputElement).value) || 0;
      const fcost = parseFloat((document.getElementById('fa-fcost') as HTMLInputElement).value) || 0;
      const gates = parseInt((document.getElementById('fa-gates') as HTMLInputElement).value) || 0;
      const l3Wrap = document.getElementById('fa-l3-wrap') as HTMLElement;
      const l1Label = document.getElementById('fa-l1-label')!;
      const l2Label = document.getElementById('fa-l2-label')!;
      const l3Label = document.getElementById('fa-l3-label')!;
      let areaSqFt = 0;
      let perimeter = 0;
      if (shape === 'rect') {
        l1Label.textContent = 'Length (feet)';
        l2Label.textContent = 'Width (feet)';
        l3Wrap.style.display = 'none';
        areaSqFt = l1 * l2;
        perimeter = 2 * (l1 + l2);
      } else if (shape === 'triangle') {
        l1Label.textContent = 'Base (feet)';
        l2Label.textContent = 'Height (feet)';
        l3Wrap.style.display = 'none';
        areaSqFt = 0.5 * l1 * l2;
        const side = Math.sqrt((l1 / 2) * (l1 / 2) + l2 * l2);
        perimeter = l1 + 2 * side;
      } else if (shape === 'trapezoid') {
        l1Label.textContent = 'Side A (feet)';
        l2Label.textContent = 'Height (feet)';
        l3Label.textContent = 'Side B (feet)';
        l3Wrap.style.display = 'block';
        areaSqFt = 0.5 * (l1 + l3) * l2;
        const offset = Math.abs(l1 - l3) / 2;
        const leg = Math.sqrt(offset * offset + l2 * l2);
        perimeter = l1 + l3 + 2 * leg;
      } else {
        l1Label.textContent = 'Radius (feet)';
        l2Label.textContent = '(not used)';
        l3Wrap.style.display = 'none';
        areaSqFt = Math.PI * l1 * l1;
        perimeter = 2 * Math.PI * l1;
      }
      const acres = areaSqFt / 43560;
      const hectares = acres * 0.404686;
      const sqm = areaSqFt * 0.092903;
      const gateWidth = gates * 12;
      const fenceLength = Math.max(0, perimeter - gateWidth);
      const fenceCost = fenceLength * fcost;
      document.getElementById('fa-area')!.textContent = acres.toFixed(2) + ' acres';
      document.getElementById('fa-ha')!.textContent = hectares.toFixed(2);
      document.getElementById('fa-sqft')!.textContent = Math.round(areaSqFt).toLocaleString();
      document.getElementById('fa-sqm')!.textContent = Math.round(sqm).toLocaleString();
      document.getElementById('fa-perim')!.textContent = Math.round(perimeter).toLocaleString();
      document.getElementById('fa-fence')!.textContent = '$' + Math.round(fenceCost).toLocaleString();
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.fa-in').forEach(el => { el.addEventListener('input', calcFA); el.addEventListener('change', calcFA); });
      calcFA();
    }, 50);
  </script>
</CalculatorLayout>
