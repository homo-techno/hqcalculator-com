---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Zipper Length Calculator - Zipper Size & Type Guide";
const description = "Calculate zipper length from garment opening plus seam allowance. Get recommendations for zipper type including invisible, separating, and coil.";
const relatedCalcs = [
  { name: "Fabric Calculator", url: "/fabric-calculator", description: "Fabric yardage needs." },
  { name: "Length Converter", url: "/length-converter", description: "Length conversions." },
  { name: "Yarn Calculator", url: "/yarn-calculator", description: "Yarn yardage calculator." },
  { name: "Quilt Calculator", url: "/quilt-calculator", description: "Quilt sizing math." },
  { name: "Unit Price Calculator", url: "/unit-price-calculator", description: "Unit price comparison." },
  { name: "Percentage Calculator", url: "/percentage-calculator", description: "Percentage calculations." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Zipper Length Calculator" keywords="zipper length calculator, zipper size, invisible zipper, separating zipper, coil zipper, zipper for garment" breadcrumbs={[{ name: "Zipper Length", url: "/zipper-length-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Zipper Length Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Find the right zipper length and type for your garment opening.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div>
          <label class="block text-xs font-medium text-text mb-1">Garment Type</label>
          <select id="zl-garment" class="zl-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
            <option value="dress" selected>Dress (back)</option>
            <option value="skirt">Skirt (side/back)</option>
            <option value="pants">Pants (fly)</option>
            <option value="jacket">Jacket (front, separating)</option>
            <option value="hoodie">Hoodie (front, separating)</option>
            <option value="pillow">Pillow / Cushion</option>
            <option value="bag">Bag / Pouch</option>
            <option value="custom">Custom</option>
          </select>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Opening Length (inches)</label><input type="number" id="zl-open" class="zl-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="22" min="2" max="72" step="0.5"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Seam Allowance (inches)</label><input type="number" id="zl-seam" class="zl-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="0.625" min="0" max="2" step="0.125"></div>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Zipper Type</label>
          <select id="zl-type" class="zl-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
            <option value="invisible" selected>Invisible (concealed)</option>
            <option value="regular">Regular / Coil</option>
            <option value="separating">Separating (open-end)</option>
            <option value="metal">Metal Teeth</option>
            <option value="molded">Molded Plastic (Vislon)</option>
          </select>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Zipper Length Needed</div>
          <div class="text-4xl font-extrabold font-mono" id="zl-result">--</div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Standard Size</div><div class="text-xl font-bold font-mono" id="zl-std">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Zipper Gauge</div><div class="text-xl font-bold font-mono" id="zl-gauge">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Tape Width</div><div class="text-xl font-bold font-mono" id="zl-tape">--</div></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Foot Type</div><div class="text-xl font-bold font-mono" id="zl-foot">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Metric (cm)</div><div class="text-xl font-bold font-mono" id="zl-cm">--</div></div>
        </div>
      </div>
      <ShareButton calculatorId="zipper-length" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcZL() {
      const garment = (document.getElementById('zl-garment') as HTMLSelectElement).value;
      let openLen = parseFloat((document.getElementById('zl-open') as HTMLInputElement).value) || 22;
      const seam = parseFloat((document.getElementById('zl-seam') as HTMLInputElement).value) || 0.625;
      const ztype = (document.getElementById('zl-type') as HTMLSelectElement).value;

      // Preset opening lengths
      const presets: Record<string, number> = {
        dress: 22, skirt: 9, pants: 7, jacket: 26, hoodie: 24, pillow: 18, bag: 10
      };
      if (garment !== 'custom') {
        openLen = presets[garment] || 22;
        (document.getElementById('zl-open') as HTMLInputElement).value = openLen.toString();
      }

      // Zipper should be opening length or next standard size up
      const zipperLen = openLen + 1; // add 1 inch for stop/extension

      // Standard zipper sizes (inches)
      const stdSizes = [4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 36];
      let stdSize = stdSizes[0];
      for (const s of stdSizes) {
        if (s >= zipperLen) { stdSize = s; break; }
        stdSize = s;
      }

      // Gauge recommendation
      let gauge = '#3';
      let tapeWidth = '1"';
      if (ztype === 'invisible') { gauge = '#3'; tapeWidth = '5/8"'; }
      else if (ztype === 'regular') { gauge = '#3'; tapeWidth = '1"'; }
      else if (ztype === 'separating') { gauge = '#5'; tapeWidth = '1-1/4"'; }
      else if (ztype === 'metal') { gauge = '#5'; tapeWidth = '1-1/4"'; }
      else if (ztype === 'molded') { gauge = '#5'; tapeWidth = '1-3/8"'; }

      // If jacket/heavy outerwear, use heavier gauge
      if (garment === 'jacket' || garment === 'hoodie') {
        gauge = '#5';
        tapeWidth = '1-1/4"';
      }

      // Foot type
      let foot = 'Regular zipper foot';
      if (ztype === 'invisible') foot = 'Invisible zipper foot';
      else if (ztype === 'separating') foot = 'Zipper foot (one side)';

      const zipCm = (stdSize * 2.54).toFixed(0);

      document.getElementById('zl-result')!.textContent = stdSize + ' inches';
      document.getElementById('zl-std')!.textContent = stdSize + '"';
      document.getElementById('zl-gauge')!.textContent = gauge;
      document.getElementById('zl-tape')!.textContent = tapeWidth;
      document.getElementById('zl-foot')!.textContent = foot;
      document.getElementById('zl-cm')!.textContent = zipCm + ' cm';
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.zl-in').forEach(el => { el.addEventListener('input', calcZL); el.addEventListener('change', calcZL); });
      calcZL();
    }, 50);
  </script>
</CalculatorLayout>
