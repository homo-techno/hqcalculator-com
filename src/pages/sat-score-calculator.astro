---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "SAT Score Calculator - Scaled Scores & Percentiles";
const description = "Convert SAT raw scores to scaled scores, calculate your total, estimate percentile, and compare against target school requirements.";
const relatedCalcs = [
  { name: "ACT Score", url: "/act-score-calculator", description: "ACT scoring." },
  { name: "IELTS Score", url: "/ielts-score-calculator", description: "IELTS bands." },
  { name: "Spaced Repetition", url: "/spaced-repetition-calculator", description: "Study planning." },
  { name: "Scholarship", url: "/scholarship-calculator", description: "Scholarships." },
  { name: "Percentage Calculator", url: "/percentage-calculator", description: "Percentages." },
  { name: "GPA Calculator", url: "/gpa-calculator", description: "GPA." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="SAT Score Calculator" keywords="SAT score calculator, SAT raw to scaled, SAT percentile, SAT conversion, college admissions" breadcrumbs={[{ name: "SAT Score", url: "/sat-score-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">SAT Score Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Convert raw scores to scaled scores and see your percentile ranking.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Reading/Writing Raw (0-52)</label><input type="number" id="sa2-rw" class="sa2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="40" min="0" max="52" step="1"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Math Raw (0-44)</label><input type="number" id="sa2-math" class="sa2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="35" min="0" max="44" step="1"></div>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Total SAT Score</div>
          <div class="text-5xl font-extrabold font-mono" id="sa2-total">0</div>
          <div class="text-sm text-blue-200 mt-1">out of 1600</div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Evidence-Based R&amp;W</div><div class="text-xl font-bold" id="sa2-rw-scaled">0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Math Score</div><div class="text-xl font-bold" id="sa2-math-scaled">0</div></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Percentile Estimate</div><div class="text-xl font-bold" id="sa2-pct">0th</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Score Level</div><div class="text-xl font-bold" id="sa2-level">-</div></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-3">Target School Comparison</h3>
          <div class="space-y-2" id="sa2-schools"></div>
        </div>
      </div>
      <ShareButton calculatorId="sat-score" />
      <FeedbackWidget />
    </div>
    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">Understanding SAT Scores</h2>
      <p>The SAT is scored 400-1600 with two sections: Evidence-Based Reading &amp; Writing (200-800) and Math (200-800). Raw scores are converted to scaled scores using an equating process. These estimates approximate typical conversions.</p>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcSAT() {
      const rwRaw = Math.min(52, Math.max(0, parseFloat((document.getElementById('sa2-rw') as HTMLInputElement).value) || 0));
      const mathRaw = Math.min(44, Math.max(0, parseFloat((document.getElementById('sa2-math') as HTMLInputElement).value) || 0));
      // Approximate raw-to-scaled conversion
      // RW: raw 0-52 maps to ~200-800 (test score 10-40, then x20)
      const rwTestScore = Math.round(10 + (rwRaw / 52) * 30);
      const rwScaled = rwTestScore * 20;
      // Math: raw 0-44 maps to ~200-800
      const mathTestScore = Math.round(10 + (mathRaw / 44) * 30);
      const mathScaled = mathTestScore * 20;
      const total = rwScaled + mathScaled;
      // Percentile approximation based on total score
      let pct: number;
      if (total >= 1550) pct = 99;
      else if (total >= 1500) pct = 98;
      else if (total >= 1450) pct = 96;
      else if (total >= 1400) pct = 94;
      else if (total >= 1350) pct = 91;
      else if (total >= 1300) pct = 87;
      else if (total >= 1250) pct = 82;
      else if (total >= 1200) pct = 75;
      else if (total >= 1150) pct = 68;
      else if (total >= 1100) pct = 59;
      else if (total >= 1050) pct = 50;
      else if (total >= 1000) pct = 41;
      else if (total >= 950) pct = 32;
      else if (total >= 900) pct = 24;
      else if (total >= 850) pct = 17;
      else if (total >= 800) pct = 11;
      else pct = Math.max(1, Math.round(total / 800 * 10));
      let level: string;
      if (total >= 1400) level = 'Excellent';
      else if (total >= 1200) level = 'Above Average';
      else if (total >= 1050) level = 'Average';
      else if (total >= 900) level = 'Below Average';
      else level = 'Needs Improvement';
      document.getElementById('sa2-total')!.textContent = total.toString();
      document.getElementById('sa2-rw-scaled')!.textContent = rwScaled.toString();
      document.getElementById('sa2-math-scaled')!.textContent = mathScaled.toString();
      document.getElementById('sa2-pct')!.textContent = pct + 'th';
      document.getElementById('sa2-level')!.textContent = level;
      const schools = [
        { name: 'Ivy League', min: 1480, mid: 1530 },
        { name: 'Top 25', min: 1350, mid: 1450 },
        { name: 'Top 50', min: 1250, mid: 1350 },
        { name: 'State Flagship', min: 1100, mid: 1250 },
        { name: 'Average University', min: 950, mid: 1100 },
      ];
      const schoolsHTML = schools.map(s => {
        const status = total >= s.mid ? 'text-green-600' : (total >= s.min ? 'text-yellow-600' : 'text-red-500');
        const label = total >= s.mid ? 'Competitive' : (total >= s.min ? 'In Range' : 'Below Range');
        return `<div class="flex justify-between items-center py-1 border-b border-border last:border-0"><span class="text-sm">${s.name} (${s.min}-${s.mid})</span><span class="text-sm font-bold ${status}">${label}</span></div>`;
      }).join('');
      document.getElementById('sa2-schools')!.innerHTML = schoolsHTML;
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => { document.querySelectorAll('.sa2-in').forEach(el => { el.addEventListener('input', calcSAT); el.addEventListener('change', calcSAT); }); calcSAT(); }, 50);
  </script>
</CalculatorLayout>
