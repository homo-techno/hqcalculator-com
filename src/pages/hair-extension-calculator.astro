---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Hair Extension Calculator - Bundle Count by Method, Length & Volume";
const description = "Calculate how many hair extension bundles, wefts, or pieces you need based on installation method, desired length, and volume goal.";
const relatedCalcs = [
  { name: "Hair Growth Calculator", url: "/hair-growth-calculator", description: "Growth rate and length projection." },
  { name: "Hair Color Mixing Calculator", url: "/hair-color-mixing-calculator", description: "Hair dye mixing ratios." },
  { name: "Hair Developer Calculator", url: "/hair-developer-calculator", description: "Developer volume selection." },
  { name: "Hair Porosity Calculator", url: "/hair-porosity-calculator", description: "Porosity assessment." },
  { name: "Beauty Budget Calculator", url: "/beauty-budget-calculator", description: "Beauty spending breakdown." },
  { name: "Salon Revenue Calculator", url: "/salon-revenue-calculator", description: "Salon revenue projection." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Hair Extension Calculator" keywords="hair extensions, bundles, wefts, clip-in, tape-in, sew-in, fusion, hair extension length, hair volume" breadcrumbs={[{ name: "Hair Extension", url: "/hair-extension-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Hair Extension Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate how many extension bundles or pieces you need for your desired look.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div>
          <label class="block text-xs font-medium text-text mb-1">Extension Method</label>
          <select id="hex2-method" class="hex2-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="clipin">Clip-In Extensions</option>
            <option value="tapein" selected>Tape-In Extensions</option>
            <option value="sewin">Sew-In / Weave</option>
            <option value="fusion">Fusion / Keratin Bond</option>
            <option value="microlink">Micro-Link / I-Tip</option>
            <option value="halo">Halo Wire</option>
          </select>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Desired Length</label>
          <select id="hex2-length" class="hex2-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="12">12 inches (shoulder)</option>
            <option value="14">14 inches (past shoulders)</option>
            <option value="16" selected>16 inches (mid-back)</option>
            <option value="18">18 inches (bra strap)</option>
            <option value="20">20 inches (waist)</option>
            <option value="22">22 inches (below waist)</option>
            <option value="24">24 inches (hip)</option>
            <option value="26">26+ inches (extra long)</option>
          </select>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Natural Hair Density</label>
          <select id="hex2-density" class="hex2-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="thin">Thin / Fine</option>
            <option value="medium" selected>Medium / Average</option>
            <option value="thick">Thick / Full</option>
          </select>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Desired Volume</label>
          <select id="hex2-volume" class="hex2-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="subtle">Subtle (length only, minimal volume)</option>
            <option value="natural" selected>Natural (blend seamlessly)</option>
            <option value="full">Full (noticeable volume boost)</option>
            <option value="dramatic">Dramatic (maximum fullness)</option>
          </select>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Hair Quality</label>
          <select id="hex2-quality" class="hex2-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="synthetic">Synthetic ($)</option>
            <option value="remy" selected>Remy Human Hair ($$)</option>
            <option value="virgin">Virgin Human Hair ($$$)</option>
            <option value="european">European / Russian ($$$$)</option>
          </select>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Bundles / Packs Needed</div>
          <div class="text-5xl font-extrabold font-mono" id="hex2-bundles">0</div>
          <div class="text-sm text-blue-200 mt-1" id="hex2-weight">~0 grams total</div>
        </div>
        <div class="grid grid-cols-2 gap-4">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Estimated Cost</div><div class="text-xl font-bold" id="hex2-cost">$0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Installation Cost</div><div class="text-xl font-bold" id="hex2-install">$0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Total Investment</div><div class="text-xl font-bold" id="hex2-total">$0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Lifespan</div><div class="text-xl font-bold" id="hex2-lifespan">--</div></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-3">Method Details</h3>
          <div class="text-sm space-y-1" id="hex2-details"></div>
        </div>
      </div>
      <ShareButton calculatorId="hair-extension" />
      <FeedbackWidget />
    </div>
    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">Hair Extension Guide</h2>
      <p>Hair extension needs vary by method, desired length, natural hair density, and volume goals. Clip-ins require 100-200g for a full head. Tape-ins typically need 40-80 pieces (20-40 sandwiches). Sew-in weaves use 2-4 bundles of wefted hair. Fusion and micro-link methods use 100-200+ individual strands. Longer lengths require more hair weight. Always match extension quality to your natural hair for the best blend. Virgin and Remy human hair can be heat-styled and last 6-12 months with proper care.</p>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcHEX2() {
      const method = (document.getElementById('hex2-method') as HTMLSelectElement).value;
      const length = parseInt((document.getElementById('hex2-length') as HTMLSelectElement).value);
      const density = (document.getElementById('hex2-density') as HTMLSelectElement).value;
      const volume = (document.getElementById('hex2-volume') as HTMLSelectElement).value;
      const quality = (document.getElementById('hex2-quality') as HTMLSelectElement).value;

      let baseWeight = 120;
      if (length <= 14) baseWeight = 100;
      else if (length <= 16) baseWeight = 120;
      else if (length <= 18) baseWeight = 140;
      else if (length <= 20) baseWeight = 160;
      else if (length <= 22) baseWeight = 180;
      else if (length <= 24) baseWeight = 200;
      else baseWeight = 220;

      let densityMult = 1.0;
      if (density === 'thin') densityMult = 1.15;
      else if (density === 'thick') densityMult = 0.85;

      let volumeMult = 1.0;
      if (volume === 'subtle') volumeMult = 0.7;
      else if (volume === 'natural') volumeMult = 1.0;
      else if (volume === 'full') volumeMult = 1.3;
      else volumeMult = 1.6;

      const totalWeight = Math.round(baseWeight * densityMult * volumeMult);

      let bundles = 0;
      let bundleLabel = 'bundles';
      let installCost = 0;
      let lifespan = '3-6 months';
      const details: string[] = [];

      if (method === 'clipin') {
        bundles = Math.ceil(totalWeight / 120);
        bundleLabel = bundles === 1 ? 'set' : 'sets';
        installCost = 0;
        lifespan = '6-12 months';
        details.push('Clip-ins are temporary and can be self-installed.');
        details.push('Each set typically has 7-10 wefts covering the full head.');
        details.push('Best for occasional wear or beginners.');
      } else if (method === 'tapein') {
        const pieces = Math.ceil(totalWeight / 2.5);
        bundles = Math.ceil(pieces / 2);
        bundleLabel = 'sandwiches (' + pieces + ' pieces)';
        installCost = 200;
        lifespan = '4-8 weeks (reinstall)';
        details.push('Tape-in extensions sit flat against the head.');
        details.push('Each sandwich uses 2 tape pieces around natural hair.');
        details.push('Reinstallation needed every 4-8 weeks as hair grows.');
      } else if (method === 'sewin') {
        bundles = Math.ceil(totalWeight / 100);
        bundleLabel = 'bundles';
        installCost = 250;
        lifespan = '6-8 weeks';
        details.push('Hair is braided into cornrows and wefts are sewn onto braids.');
        details.push('Each bundle is typically 100g of wefted hair.');
        details.push('Full head usually needs ' + bundles + ' bundles plus a closure/frontal.');
      } else if (method === 'fusion') {
        const strands = Math.ceil(totalWeight / 0.8);
        bundles = strands;
        bundleLabel = 'strands';
        installCost = 500;
        lifespan = '3-6 months';
        details.push('Individual keratin-tipped strands are heat-bonded to natural hair.');
        details.push('Most natural-looking but time-intensive installation (3-5 hours).');
        details.push('Approximately ' + strands + ' individual bonds needed.');
      } else if (method === 'microlink') {
        const strands = Math.ceil(totalWeight / 0.8);
        bundles = strands;
        bundleLabel = 'strands';
        installCost = 450;
        lifespan = '3-4 months';
        details.push('Small metal beads clamp individual strands to natural hair.');
        details.push('No heat or glue - gentle on natural hair.');
        details.push('Maintenance every 6-8 weeks to move links up.');
      } else {
        bundles = 1;
        bundleLabel = 'piece';
        installCost = 0;
        lifespan = '6-12 months';
        details.push('A single wire piece sits on top of the head.');
        details.push('Easiest to apply - no clips, glue, or bonds.');
        details.push('Best for adding length without commitment.');
      }

      let pricePerGram = 0.5;
      if (quality === 'synthetic') pricePerGram = 0.15;
      else if (quality === 'remy') pricePerGram = 0.8;
      else if (quality === 'virgin') pricePerGram = 1.5;
      else pricePerGram = 3.0;

      const hairCost = Math.round(totalWeight * pricePerGram);
      const totalCost = hairCost + installCost;

      const displayBundles = (method === 'fusion' || method === 'microlink') ? Math.ceil(bundles / 25) + ' packs (~' + bundles + ' strands)' : bundles + ' ' + bundleLabel;

      document.getElementById('hex2-bundles')!.textContent = (method === 'fusion' || method === 'microlink') ? bundles.toString() : bundles.toString();
      document.getElementById('hex2-weight')!.textContent = '~' + totalWeight + ' grams total';
      document.getElementById('hex2-cost')!.textContent = '$' + hairCost;
      document.getElementById('hex2-install')!.textContent = installCost > 0 ? '$' + installCost : 'Self-install';
      document.getElementById('hex2-total')!.textContent = '$' + totalCost;
      document.getElementById('hex2-lifespan')!.textContent = lifespan;
      document.getElementById('hex2-details')!.innerHTML = details.map(d => '<p>' + d + '</p>').join('');
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.hex2-in').forEach(el => { el.addEventListener('input', calcHEX2); el.addEventListener('change', calcHEX2); });
      calcHEX2();
    }, 50);
  </script>
</CalculatorLayout>
