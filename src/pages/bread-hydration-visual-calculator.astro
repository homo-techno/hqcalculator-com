---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Bread Hydration Visual Calculator - Dough Characteristics by Hydration";
const description = "Visualize and understand bread dough characteristics at different hydration levels. See handling tips, ideal bread types, and expected crumb structure.";
const relatedCalcs = [
  { name: "Dough Hydration Calculator", url: "/dough-hydration-calculator", description: "Calculate and adjust hydration percentage." },
  { name: "Baker's Percentage Calculator", url: "/baker-percentage-calculator", description: "Calculate baker's percentages." },
  { name: "Bread Flour Calculator", url: "/bread-flour-calculator", description: "Flour protein and substitutions." },
  { name: "Fermentation Temperature Calculator", url: "/fermentation-temperature-calculator", description: "Calculate desired dough temperature." },
  { name: "Bread Proofing Calculator", url: "/bread-scoring-calculator", description: "Estimate proofing times." },
  { name: "Sourdough Calculator", url: "/sourdough-calculator", description: "Sourdough starter ratios." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Bread Hydration Visual Calculator" keywords="bread hydration, dough hydration visual, crumb structure, bread texture, hydration levels, dough handling" breadcrumbs={[{ name: "Bread Hydration Visual", url: "/bread-hydration-visual-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Bread Hydration Visual Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Explore how different hydration levels affect dough behavior, bread types, crumb structure, and handling techniques.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div>
          <label class="block text-xs font-medium text-text mb-1">Hydration Level (%)</label>
          <input type="range" id="bhv-slider" class="bhv-in w-full" min="45" max="100" value="65" step="1">
          <div class="flex justify-between text-xs text-text-muted mt-1">
            <span>45%</span>
            <span>60%</span>
            <span>75%</span>
            <span>90%</span>
            <span>100%</span>
          </div>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Or enter exact hydration</label>
          <input type="number" id="bhv-exact" class="bhv-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="65" min="45" max="100" step="1">
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Flour Type</label>
          <select id="bhv-flour" class="bhv-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="bread">Bread Flour (12-13%)</option>
            <option value="ap">All-Purpose (10-11%)</option>
            <option value="ww">Whole Wheat (14%)</option>
            <option value="rye">Rye Flour (8-9%)</option>
          </select>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Hydration</div>
          <div class="text-5xl font-extrabold font-mono" id="bhv-result">--</div>
        </div>
        <!-- Visual representation -->
        <div class="p-6 bg-surface-alt rounded-2xl">
          <div class="text-xs text-text-muted uppercase mb-3">Dough Visual Indicator</div>
          <div class="relative h-8 bg-gray-200 rounded-full overflow-hidden">
            <div class="absolute left-0 top-0 h-full rounded-full transition-all duration-300" id="bhv-bar" style="width: 50%; background: linear-gradient(90deg, #d4a373, #8b6f47);"></div>
          </div>
          <div class="flex justify-between text-xs text-text-muted mt-1">
            <span>Stiff</span>
            <span>Soft</span>
            <span>Wet</span>
            <span>Batter-like</span>
          </div>
        </div>
        <div class="grid grid-cols-2 gap-4">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Dough Feel</div>
            <div class="text-lg font-bold" id="bhv-feel">--</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Ideal Bread Types</div>
            <div class="text-lg font-bold" id="bhv-breads">--</div>
          </div>
        </div>
        <div class="grid grid-cols-2 gap-4">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Crumb Structure</div>
            <div class="text-lg font-bold" id="bhv-crumb">--</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Crust Character</div>
            <div class="text-lg font-bold" id="bhv-crust">--</div>
          </div>
        </div>
        <div class="grid grid-cols-2 gap-4">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Handling Difficulty</div>
            <div class="text-lg font-bold" id="bhv-difficulty">--</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Oven Spring</div>
            <div class="text-lg font-bold" id="bhv-spring">--</div>
          </div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <div class="text-xs text-text-muted uppercase mb-2">Handling Tips</div>
          <div class="text-sm text-text-secondary" id="bhv-tips">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <div class="text-xs text-text-muted uppercase mb-2">Flour Type Note</div>
          <div class="text-sm text-text-secondary" id="bhv-flour-note">--</div>
        </div>
      </div>
      <ShareButton calculatorId="bread-hydration-visual" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcBHV() {
      const slider = document.getElementById('bhv-slider') as HTMLInputElement;
      const exact = document.getElementById('bhv-exact') as HTMLInputElement;
      const flourType = (document.getElementById('bhv-flour') as HTMLSelectElement).value;

      // Sync slider and input
      let hydration = parseFloat(exact.value) || 65;
      if (document.activeElement === slider) {
        hydration = parseFloat(slider.value) || 65;
        exact.value = String(hydration);
      } else {
        slider.value = String(Math.min(100, Math.max(45, hydration)));
      }

      // Clamp
      hydration = Math.min(100, Math.max(45, hydration));

      // Visual bar width
      const barWidth = ((hydration - 45) / 55) * 100;
      const bar = document.getElementById('bhv-bar') as HTMLElement;
      bar.style.width = barWidth + '%';

      // Color gradient from brown (stiff) to blue (wet)
      if (hydration < 60) bar.style.background = 'linear-gradient(90deg, #c4956a, #b8845c)';
      else if (hydration < 70) bar.style.background = 'linear-gradient(90deg, #c4956a, #9a7b5a)';
      else if (hydration < 80) bar.style.background = 'linear-gradient(90deg, #9a7b5a, #6b8cae)';
      else bar.style.background = 'linear-gradient(90deg, #6b8cae, #4a7ab5)';

      document.getElementById('bhv-result')!.textContent = hydration + '%';

      let feel = '', breads = '', crumb = '', crust = '', difficulty = '', spring = '', tips = '';

      if (hydration < 55) {
        feel = 'Very stiff, dense, dry';
        breads = 'Pasta, bagels, pretzels';
        crumb = 'Very tight, dense, small holes';
        crust = 'Chewy, thick';
        difficulty = 'Easy - holds shape well';
        spring = 'Minimal';
        tips = 'Knead thoroughly to develop gluten. Dough will be firm and resist stretching. Use a bench scraper to work. Allow longer rest periods for hydration.';
      } else if (hydration < 62) {
        feel = 'Stiff, firm, smooth';
        breads = 'Bagels, sandwich bread, rolls';
        crumb = 'Tight, uniform, small holes';
        crust = 'Moderate crust';
        difficulty = 'Easy - manageable';
        spring = 'Moderate';
        tips = 'Good for beginners. Dough is easy to shape. Standard kneading works well. Shape firmly for good structure.';
      } else if (hydration < 68) {
        feel = 'Soft, pliable, slightly tacky';
        breads = 'Sandwich bread, dinner rolls, French bread';
        crumb = 'Medium, even crumb with small-medium holes';
        crust = 'Light, crisp crust';
        difficulty = 'Easy to moderate';
        spring = 'Good';
        tips = 'Classic bread hydration. Light dusting of flour when handling. Windowpane test works well at this range. Good balance of flavor and texture.';
      } else if (hydration < 75) {
        feel = 'Soft, tacky, stretchy';
        breads = 'Baguettes, country loaves, sourdough';
        crumb = 'Open crumb, irregular medium holes';
        crust = 'Crispy, crackly crust';
        difficulty = 'Moderate - some sticking';
        spring = 'Very good';
        tips = 'Use wet hands or bench scraper. Stretch and fold technique works better than kneading. Minimize flour when shaping. Allow good gluten development.';
      } else if (hydration < 82) {
        feel = 'Very soft, sticky, extensible';
        breads = 'Ciabatta, focaccia, pain de campagne';
        crumb = 'Open, large irregular holes';
        crust = 'Thin, very crispy';
        difficulty = 'Challenging - very sticky';
        spring = 'Excellent';
        tips = 'Wet hands are essential. Use stretch and fold method (3-4 sets during bulk). Shape gently to preserve gas. Pour into oiled pans for focaccia. Strong flour recommended.';
      } else if (hydration < 90) {
        feel = 'Extremely soft, batter-like, pourable';
        breads = 'High-hydration focaccia, pan bread';
        crumb = 'Very open, large holes, custardy';
        crust = 'Thin, delicate, crispy';
        difficulty = 'Very challenging';
        spring = 'Explosive (in pans)';
        tips = 'Almost impossible to shape by hand. Use well-oiled pans. Coil folds work best. Requires high-protein flour (13%+). Long cold fermentation helps develop structure. Use parchment paper.';
      } else {
        feel = 'Batter consistency, pours easily';
        breads = 'Specialty pan breads, experimental';
        crumb = 'Extremely open, very custardy';
        crust = 'Thin, soft';
        difficulty = 'Expert level';
        spring = 'Pan-dependent';
        tips = 'Essentially a thick batter. Must be baked in a pan. Very high protein flour essential. Extended autolyse (1-2 hours) helps. Multiple coil folds needed. Cold fermentation strongly recommended.';
      }

      // Flour type adjustments
      let flourNote = '';
      if (flourType === 'bread') {
        flourNote = 'Bread flour (12-13% protein) can handle higher hydration. Add 5-10% more water than AP flour recipes suggest.';
      } else if (flourType === 'ap') {
        flourNote = 'All-purpose flour (10-11% protein) works well up to ~72% hydration. Above that, dough may be harder to manage. Consider reducing hydration by 3-5%.';
      } else if (flourType === 'ww') {
        flourNote = 'Whole wheat absorbs more water. You can typically add 5-10% more hydration. The bran cuts gluten strands, so autolyse for 30-60 minutes. Expect a denser crumb.';
      } else if (flourType === 'rye') {
        flourNote = 'Rye flour has minimal gluten. Above 50% rye, dough behaves very differently. Hydration feels wetter because rye absorbs water slowly. Use a pan for high-rye loaves.';
      }

      document.getElementById('bhv-feel')!.textContent = feel;
      document.getElementById('bhv-breads')!.textContent = breads;
      document.getElementById('bhv-crumb')!.textContent = crumb;
      document.getElementById('bhv-crust')!.textContent = crust;
      document.getElementById('bhv-difficulty')!.textContent = difficulty;
      document.getElementById('bhv-spring')!.textContent = spring;
      document.getElementById('bhv-tips')!.textContent = tips;
      document.getElementById('bhv-flour-note')!.textContent = flourNote;

      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.bhv-in').forEach(el => { el.addEventListener('input', calcBHV); el.addEventListener('change', calcBHV); });
      calcBHV();
    }, 50);
  </script>
</CalculatorLayout>
