---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Glass Thickness Calculator - Wind Load, Span & Safety Factor";
const description = "Calculate required glass thickness for wind load, span, and safety factor. Supports annealed, tempered, and laminated glass types.";
const relatedCalcs = [
  { name: "Stained Glass Calculator", url: "/stained-glass-calculator", description: "Stained glass materials." },
  { name: "Glass Cutting Calculator", url: "/glass-cutting-calculator", description: "Glass cutting optimization." },
  { name: "Glass Fusing Calculator", url: "/glass-fusing-calculator", description: "Glass fusing schedules." },
  { name: "Glass Annealing Calculator", url: "/glass-annealing-calculator", description: "Annealing schedules." },
  { name: "Thermal Shock Calculator", url: "/thermal-shock-calculator", description: "Thermal shock resistance." },
  { name: "Ceramic Fiber Calculator", url: "/ceramic-fiber-calculator", description: "Insulation calculations." },
];
---
<CalculatorLayout
  title={title}
  description={description}
  calculatorName="Glass Thickness Calculator"
  keywords="glass thickness, wind load glass, glass strength, tempered glass, laminated glass, glass span, safety factor, architectural glass"
  breadcrumbs={[{ name: "Glass Thickness Calculator", url: "/glass-thickness-calculator" }]}
>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Glass Thickness Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Determine required glass thickness based on wind load, panel dimensions, glass type, and safety requirements.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="grid grid-cols-2 gap-4 mb-5">
        <div>
          <label class="block text-sm font-medium text-text mb-2">Width (inches)</label>
          <input type="number" id="gt2-width" class="gt2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="48" min="1" step="1">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-2">Height (inches)</label>
          <input type="number" id="gt2-height" class="gt2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="72" min="1" step="1">
        </div>
      </div>

      <div class="mb-5">
        <label class="block text-sm font-medium text-text mb-2">Wind Load (PSF - pounds per sq ft)</label>
        <input type="number" id="gt2-wind" class="gt2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="25" min="1" max="200" step="1">
        <p class="text-xs text-text-muted mt-1">Typical: 20-30 PSF residential, 30-50 PSF commercial, 50+ PSF high-rise/coastal</p>
      </div>

      <div class="mb-5">
        <label class="block text-sm font-medium text-text mb-2">Glass Type</label>
        <select id="gt2-type" class="gt2-in w-full px-4 py-3 border border-border rounded-xl text-lg">
          <option value="annealed">Annealed (Standard)</option>
          <option value="heat_strengthened">Heat Strengthened</option>
          <option value="tempered" selected>Fully Tempered</option>
          <option value="laminated">Laminated</option>
        </select>
      </div>

      <div class="mb-5">
        <label class="block text-sm font-medium text-text mb-2">Edge Support</label>
        <select id="gt2-support" class="gt2-in w-full px-4 py-3 border border-border rounded-xl text-lg">
          <option value="4" selected>4-sided support</option>
          <option value="3">3-sided support</option>
          <option value="2">2-sided support (top & bottom)</option>
        </select>
      </div>

      <div class="mb-5">
        <label class="block text-sm font-medium text-text mb-2">Safety Factor</label>
        <select id="gt2-safety" class="gt2-in w-full px-4 py-3 border border-border rounded-xl text-lg">
          <option value="2.5">2.5x (Standard)</option>
          <option value="3">3.0x (Commercial)</option>
          <option value="4" selected>4.0x (Safety/Overhead)</option>
        </select>
      </div>

      <!-- Primary Result -->
      <div class="p-6 bg-primary rounded-2xl text-white text-center mb-4">
        <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Minimum Glass Thickness</div>
        <div class="text-4xl font-extrabold" id="gt2-thick">--</div>
        <div class="text-sm text-blue-200 mt-1" id="gt2-nominal">--</div>
      </div>

      <div class="grid grid-cols-2 gap-4 mb-4">
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Panel Area</div>
          <div class="text-xl font-bold" id="gt2-area">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Panel Weight</div>
          <div class="text-xl font-bold" id="gt2-weight">--</div>
        </div>
      </div>

      <div class="grid grid-cols-2 gap-4 mb-4">
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Max Deflection</div>
          <div class="text-xl font-bold" id="gt2-deflection">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Stress Rating</div>
          <div class="text-xl font-bold" id="gt2-stress">--</div>
        </div>
      </div>

      <ShareButton calculatorId="glass-thickness" />
      <FeedbackWidget />
    </div>

    <article class="mt-12 max-w-4xl prose prose-slate">
      <h2 class="text-2xl font-bold text-text">Glass Thickness Selection</h2>
      <p>Glass thickness depends on the panel size, expected wind load, type of glass, and how many edges are supported. Tempered glass is about 4x stronger than annealed glass and is required in many safety applications.</p>
      <h3 class="text-xl font-semibold text-text mt-8">Standard Glass Thicknesses</h3>
      <ul>
        <li><strong>3/32" (2.5mm):</strong> Picture frames, small panels</li>
        <li><strong>1/8" (3mm):</strong> Small windows, cabinet glass</li>
        <li><strong>3/16" (5mm):</strong> Residential windows</li>
        <li><strong>1/4" (6mm):</strong> Standard residential and light commercial</li>
        <li><strong>3/8" (10mm):</strong> Large commercial panels</li>
        <li><strong>1/2" (12mm):</strong> Structural glass, glass floors</li>
      </ul>
    </article>

    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    function calcGT2() {
      const w = parseFloat((document.getElementById('gt2-width') as HTMLInputElement).value) || 48;
      const h = parseFloat((document.getElementById('gt2-height') as HTMLInputElement).value) || 72;
      const windPSF = parseFloat((document.getElementById('gt2-wind') as HTMLInputElement).value) || 25;
      const glassType = (document.getElementById('gt2-type') as HTMLSelectElement).value;
      const sides = parseInt((document.getElementById('gt2-support') as HTMLSelectElement).value) || 4;
      const sf = parseFloat((document.getElementById('gt2-safety') as HTMLSelectElement).value) || 4;

      // Glass allowable stress (PSI)
      const allowableStress: Record<string, number> = {
        annealed: 2800, heat_strengthened: 5600, tempered: 11200, laminated: 2500
      };

      // Support factor
      const supportFactor: Record<number, number> = { 4: 1.0, 3: 1.5, 2: 2.2 };
      const sFactor = supportFactor[sides] || 1.0;

      const shortSide = Math.min(w, h);
      const longSide = Math.max(w, h);
      const aspectRatio = longSide / shortSide;

      // Plate bending coefficient (simplified Navier solution for uniform load)
      // Beta coefficient depends on aspect ratio
      let beta = 0.0443; // for square
      if (aspectRatio >= 2) beta = 0.0616;
      else if (aspectRatio >= 1.5) beta = 0.0573;
      else if (aspectRatio >= 1.2) beta = 0.0501;

      // Wind pressure in PSI
      const windPSI = windPSF / 144;

      // Required thickness: t = shortSide * sqrt(beta * q * SF * supportFactor / allowable_stress)
      const allowable = allowableStress[glassType] || 2800;
      const tRequired = shortSide * Math.sqrt((beta * windPSI * sf * sFactor) / allowable);

      // Standard thicknesses in inches
      const standards = [
        { nominal: '3/32"', actual: 0.09375, mm: 2.5 },
        { nominal: '1/8"', actual: 0.125, mm: 3 },
        { nominal: '5/32"', actual: 0.15625, mm: 4 },
        { nominal: '3/16"', actual: 0.1875, mm: 5 },
        { nominal: '1/4"', actual: 0.25, mm: 6 },
        { nominal: '5/16"', actual: 0.3125, mm: 8 },
        { nominal: '3/8"', actual: 0.375, mm: 10 },
        { nominal: '1/2"', actual: 0.5, mm: 12 },
        { nominal: '5/8"', actual: 0.625, mm: 16 },
        { nominal: '3/4"', actual: 0.75, mm: 19 },
      ];

      let selected = standards[standards.length - 1];
      for (const s of standards) {
        if (s.actual >= tRequired) { selected = s; break; }
      }

      document.getElementById('gt2-thick')!.textContent = selected.nominal + ' (' + selected.mm + 'mm)';
      document.getElementById('gt2-nominal')!.textContent = 'Calculated min: ' + tRequired.toFixed(4) + '"';

      const areaSqFt = (w * h) / 144;
      document.getElementById('gt2-area')!.textContent = areaSqFt.toFixed(1) + ' sq ft';

      // Weight: glass is about 13.1 lbs per sq ft per inch of thickness
      const weightPerSqFt = selected.actual * 13.1;
      const totalWeight = weightPerSqFt * areaSqFt;
      document.getElementById('gt2-weight')!.textContent = totalWeight.toFixed(1) + ' lbs';

      // Max deflection (L/175 for wind load)
      const maxDeflection = shortSide / 175;
      document.getElementById('gt2-deflection')!.textContent = maxDeflection.toFixed(3) + '"';

      // Stress check
      const actualStress = beta * windPSI * (shortSide / selected.actual) ** 2;
      const stressRatio = actualStress / (allowable / sf);
      let stressLabel = 'OK';
      if (stressRatio > 0.9) stressLabel = 'Marginal';
      if (stressRatio > 1.0) stressLabel = 'Inadequate';
      if (stressRatio < 0.5) stressLabel = 'Conservative';
      document.getElementById('gt2-stress')!.textContent = stressLabel;

      document.dispatchEvent(new CustomEvent('calc-update'));
    }

    setTimeout(() => {
      document.querySelectorAll('.gt2-in').forEach(el => {
        el.addEventListener('input', calcGT2);
        el.addEventListener('change', calcGT2);
      });
      calcGT2();
    }, 50);
  </script>
</CalculatorLayout>
