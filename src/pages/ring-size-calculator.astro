---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Ring Size Calculator - US, UK & EU Sizes";
const description = "Find your ring size from finger circumference or diameter. Convert between US, UK, and EU ring sizes.";
const relatedCalcs = [
  { name: "Shoe Size Converter", url: "/shoe-size-converter", description: "Shoe size." },
  { name: "Length Converter", url: "/length-converter", description: "Length." },
  { name: "Bra Size Calculator", url: "/bra-size-calculator", description: "Bra size." },
  { name: "Circle Calculator", url: "/circle-calculator", description: "Circle." },
  { name: "Wedding Budget", url: "/wedding-budget-calculator", description: "Wedding." },
  { name: "Percentage Calculator", url: "/percentage-calculator", description: "Percentage." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Ring Size Calculator" keywords="ring size calculator, ring size chart, finger circumference, US UK EU ring size, ring converter" breadcrumbs={[{ name: "Ring Size", url: "/ring-size-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Ring Size Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Find your ring size from finger measurements.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="flex gap-2 mb-2">
          <button class="rn-mode flex-1 py-2 rounded-xl border-2 border-primary bg-blue-50 text-primary font-bold text-sm" data-mode="circ">Circumference</button>
          <button class="rn-mode flex-1 py-2 rounded-xl border-2 border-border text-text-muted font-bold text-sm" data-mode="dia">Diameter</button>
        </div>
        <div id="rn-circ-panel">
          <div><label class="block text-xs font-medium text-text mb-1">Finger Circumference (mm)</label><input type="number" id="rn-c" class="rn-in w-full px-4 py-3 border border-border rounded-xl text-2xl font-bold" value="57" min="40" max="80" step="0.5"></div>
        </div>
        <div id="rn-dia-panel" class="hidden">
          <div><label class="block text-xs font-medium text-text mb-1">Inner Diameter (mm)</label><input type="number" id="rn-d" class="rn-in w-full px-4 py-3 border border-border rounded-xl text-2xl font-bold" value="18.1" min="12" max="26" step="0.1"></div>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">US Ring Size</div>
          <div class="text-5xl font-extrabold font-mono" id="rn-result">0</div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">UK Size</div><div class="text-xl font-bold font-mono" id="rn-uk">-</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">EU Size</div><div class="text-xl font-bold font-mono" id="rn-eu">-</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Diameter</div><div class="text-xl font-bold font-mono" id="rn-dia">0 mm</div></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-2">Common Sizes</h3>
          <div class="text-xs space-y-1" id="rn-chart"></div>
        </div>
      </div>
      <ShareButton calculatorId="ring-size" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    const SIZES: { us: number; uk: string; circ: number; dia: number }[] = [
      {us:3,uk:'F',circ:44.2,dia:14.1},{us:3.5,uk:'G',circ:45.5,dia:14.5},{us:4,uk:'H',circ:46.8,dia:14.9},
      {us:4.5,uk:'I',circ:48.0,dia:15.3},{us:5,uk:'J',circ:49.3,dia:15.7},{us:5.5,uk:'K',circ:50.6,dia:16.1},
      {us:6,uk:'L',circ:51.9,dia:16.5},{us:6.5,uk:'M',circ:53.1,dia:16.9},{us:7,uk:'N',circ:54.4,dia:17.3},
      {us:7.5,uk:'O',circ:55.7,dia:17.7},{us:8,uk:'P',circ:57.0,dia:18.1},{us:8.5,uk:'Q',circ:58.3,dia:18.5},
      {us:9,uk:'R',circ:59.5,dia:18.9},{us:9.5,uk:'S',circ:60.8,dia:19.4},{us:10,uk:'T',circ:62.1,dia:19.8},
      {us:10.5,uk:'U',circ:63.4,dia:20.2},{us:11,uk:'V',circ:64.6,dia:20.6},{us:11.5,uk:'W',circ:65.9,dia:21.0},
      {us:12,uk:'X',circ:67.2,dia:21.4},{us:13,uk:'Z',circ:69.7,dia:22.2},
    ];
    let rnMode = 'circ';
    function setRnMode(m: string) {
      rnMode = m;
      document.getElementById('rn-circ-panel')!.classList.toggle('hidden', m !== 'circ');
      document.getElementById('rn-dia-panel')!.classList.toggle('hidden', m !== 'dia');
      document.querySelectorAll('.rn-mode').forEach(b => {
        const btn = b as HTMLButtonElement;
        const active = btn.dataset.mode === m;
        btn.className = `rn-mode flex-1 py-2 rounded-xl border-2 font-bold text-sm ${active ? 'border-primary bg-blue-50 text-primary' : 'border-border text-text-muted'}`;
      });
      calcRN();
    }
    function calcRN() {
      let circ: number;
      if (rnMode === 'circ') {
        circ = parseFloat((document.getElementById('rn-c') as HTMLInputElement).value) || 57;
      } else {
        const d = parseFloat((document.getElementById('rn-d') as HTMLInputElement).value) || 18.1;
        circ = d * Math.PI;
      }
      let best = SIZES[0];
      let bestDiff = Infinity;
      for (const s of SIZES) { const diff = Math.abs(circ - s.circ); if (diff < bestDiff) { bestDiff = diff; best = s; } }
      document.getElementById('rn-result')!.textContent = String(best.us);
      document.getElementById('rn-uk')!.textContent = best.uk;
      document.getElementById('rn-eu')!.textContent = String(Math.round(best.circ));
      document.getElementById('rn-dia')!.textContent = best.dia.toFixed(1) + ' mm';
      const chart = document.getElementById('rn-chart')!;
      chart.innerHTML = SIZES.filter(s => s.us >= best.us - 2 && s.us <= best.us + 2).map(s =>
        `<div class="${s.us === best.us ? 'font-bold text-primary' : ''}">US ${s.us} / UK ${s.uk} / EU ${Math.round(s.circ)} — ${s.circ}mm circ${s.us === best.us ? ' ← You' : ''}</div>`
      ).join('');
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.rn-mode').forEach(b => b.addEventListener('click', () => setRnMode((b as HTMLButtonElement).dataset.mode!)));
      document.querySelectorAll('.rn-in').forEach(el => { el.addEventListener('input', calcRN); el.addEventListener('change', calcRN); });
      calcRN();
    }, 50);
  </script>
</CalculatorLayout>
