---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Ceramic Mold Calculator - Plaster to Water Ratio by Weight";
const description = "Calculate plaster mold mixing ratios (water to plaster by weight) for ceramic slip casting molds. Supports different plaster types and mold sizes.";
const relatedCalcs = [
  { name: "Slip Casting Calculator", url: "/slip-casting-calculator", description: "Slip casting volumes." },
  { name: "Clay Weight Calculator", url: "/clay-weight-calculator", description: "Clay weight for forms." },
  { name: "Clay Shrinkage Calculator", url: "/clay-shrinkage-calculator", description: "Clay shrinkage rates." },
  { name: "Glaze Recipe Calculator", url: "/glaze-recipe-calculator", description: "Scale glaze recipes." },
  { name: "Kiln Temperature Calculator", url: "/kiln-temperature-calculator", description: "Firing schedules." },
  { name: "Concrete Calculator", url: "/concrete-calculator", description: "Concrete mixing." },
];
---
<CalculatorLayout
  title={title}
  description={description}
  calculatorName="Ceramic Mold Calculator"
  keywords="plaster mold, plaster ratio, water to plaster, pottery mold, slip casting mold, plaster of paris, pottery plaster, mold making"
  breadcrumbs={[{ name: "Ceramic Mold Calculator", url: "/ceramic-mold-calculator" }]}
>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Ceramic Mold Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate precise plaster-to-water ratios for ceramic molds. Get the right consistency for durable, absorbent molds.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="mb-5">
        <label class="block text-sm font-medium text-text mb-2">Plaster Type</label>
        <select id="cm2-type" class="cm2-in w-full px-4 py-3 border border-border rounded-xl text-lg">
          <option value="pottery" selected>Pottery Plaster #1 (USG)</option>
          <option value="hydrocal">Hydrocal (White)</option>
          <option value="hydrostone">Hydrostone</option>
          <option value="moulding">Moulding Plaster</option>
          <option value="custom">Custom Ratio</option>
        </select>
      </div>

      <div id="cm2-custom-ratio" class="mb-5 hidden">
        <label class="block text-sm font-medium text-text mb-2">Plaster Consistency (lbs plaster per 100 parts water)</label>
        <input type="number" id="cm2-ratio" class="cm2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="73" min="40" max="120" step="1">
      </div>

      <div class="mb-5">
        <label class="block text-sm font-medium text-text mb-2">Mold Volume Method</label>
        <select id="cm2-method" class="cm2-in w-full px-4 py-3 border border-border rounded-xl text-lg">
          <option value="volume" selected>Enter volume directly</option>
          <option value="box">Rectangular mold box</option>
          <option value="cylinder">Cylindrical mold</option>
        </select>
      </div>

      <div id="cm2-vol-input" class="mb-5">
        <label class="block text-sm font-medium text-text mb-2">Mold Volume (cubic inches)</label>
        <input type="number" id="cm2-vol" class="cm2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="200" min="1" step="10">
      </div>

      <div id="cm2-box-input" class="mb-5 hidden">
        <div class="grid grid-cols-3 gap-3">
          <div>
            <label class="block text-xs font-medium text-text mb-1">Length (in)</label>
            <input type="number" id="cm2-bl" class="cm2-in w-full px-3 py-3 border border-border rounded-xl text-lg font-bold" value="10" min="1" step="0.5">
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Width (in)</label>
            <input type="number" id="cm2-bw" class="cm2-in w-full px-3 py-3 border border-border rounded-xl text-lg font-bold" value="6" min="1" step="0.5">
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Height (in)</label>
            <input type="number" id="cm2-bh" class="cm2-in w-full px-3 py-3 border border-border rounded-xl text-lg font-bold" value="4" min="1" step="0.5">
          </div>
        </div>
      </div>

      <div id="cm2-cyl-input" class="mb-5 hidden">
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="block text-xs font-medium text-text mb-1">Diameter (in)</label>
            <input type="number" id="cm2-cd" class="cm2-in w-full px-3 py-3 border border-border rounded-xl text-lg font-bold" value="8" min="1" step="0.5">
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Height (in)</label>
            <input type="number" id="cm2-ch" class="cm2-in w-full px-3 py-3 border border-border rounded-xl text-lg font-bold" value="6" min="1" step="0.5">
          </div>
        </div>
      </div>

      <!-- Primary Result -->
      <div class="p-6 bg-primary rounded-2xl text-white text-center mb-4">
        <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Plaster Needed</div>
        <div class="text-4xl font-extrabold" id="cm2-plaster">--</div>
        <div class="text-sm text-blue-200 mt-1" id="cm2-plaster-note">--</div>
      </div>

      <div class="grid grid-cols-2 gap-4 mb-4">
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Water Needed</div>
          <div class="text-xl font-bold" id="cm2-water">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Total Mix Weight</div>
          <div class="text-xl font-bold" id="cm2-total">--</div>
        </div>
      </div>

      <div class="grid grid-cols-2 gap-4 mb-4">
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Mold Volume</div>
          <div class="text-xl font-bold" id="cm2-volume">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Set Time</div>
          <div class="text-xl font-bold" id="cm2-settime">--</div>
        </div>
      </div>

      <div class="p-4 bg-surface-alt rounded-xl mb-4">
        <h3 class="font-semibold text-sm text-text mb-2">Mixing Instructions</h3>
        <p class="text-xs text-text-muted" id="cm2-instructions">--</p>
      </div>

      <ShareButton calculatorId="ceramic-mold" />
      <FeedbackWidget />
    </div>

    <article class="mt-12 max-w-4xl prose prose-slate">
      <h2 class="text-2xl font-bold text-text">Plaster Mold Mixing</h2>
      <p>The correct plaster-to-water ratio is critical for mold quality. Too much plaster makes a dense, hard mold with poor absorption. Too little plaster makes a weak, soft mold. Pottery Plaster #1 at the standard 73:100 ratio gives the best balance for slip casting.</p>
      <h3 class="text-xl font-semibold text-text mt-8">Mixing Steps</h3>
      <ul>
        <li>Always add plaster to water (never water to plaster)</li>
        <li>Sift plaster onto water surface over 2-3 minutes</li>
        <li>Let plaster slake (soak) for 1-2 minutes</li>
        <li>Mix gently by hand or with a mixer for 2-3 minutes</li>
        <li>Pour when mixture reaches cream-like consistency</li>
        <li>Vibrate or tap mold box to release air bubbles</li>
      </ul>
    </article>

    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    function calcCM2() {
      const plasterType = (document.getElementById('cm2-type') as HTMLSelectElement).value;
      const method = (document.getElementById('cm2-method') as HTMLSelectElement).value;

      document.getElementById('cm2-custom-ratio')!.classList.toggle('hidden', plasterType !== 'custom');
      document.getElementById('cm2-vol-input')!.classList.toggle('hidden', method !== 'volume');
      document.getElementById('cm2-box-input')!.classList.toggle('hidden', method !== 'box');
      document.getElementById('cm2-cyl-input')!.classList.toggle('hidden', method !== 'cylinder');

      // Plaster ratio: lbs plaster per 100 lbs water (consistency)
      const ratios: Record<string, {ratio: number, setMin: number}> = {
        pottery: { ratio: 73, setMin: 25 },
        hydrocal: { ratio: 45, setMin: 20 },
        hydrostone: { ratio: 32, setMin: 17 },
        moulding: { ratio: 67, setMin: 27 },
        custom: { ratio: parseFloat((document.getElementById('cm2-ratio') as HTMLInputElement).value) || 73, setMin: 25 }
      };
      const pd = ratios[plasterType] || ratios['pottery'];

      // Calculate mold volume in cubic inches
      let vol = 0;
      if (method === 'volume') {
        vol = parseFloat((document.getElementById('cm2-vol') as HTMLInputElement).value) || 200;
      } else if (method === 'box') {
        const l = parseFloat((document.getElementById('cm2-bl') as HTMLInputElement).value) || 10;
        const w = parseFloat((document.getElementById('cm2-bw') as HTMLInputElement).value) || 6;
        const h = parseFloat((document.getElementById('cm2-bh') as HTMLInputElement).value) || 4;
        vol = l * w * h;
      } else {
        const d = parseFloat((document.getElementById('cm2-cd') as HTMLInputElement).value) || 8;
        const h = parseFloat((document.getElementById('cm2-ch') as HTMLInputElement).value) || 6;
        vol = Math.PI * (d / 2) * (d / 2) * h;
      }

      // Mixed plaster density depends on ratio
      // Water density: 0.0361 lbs/cu in (1 g/cm3)
      // Plaster density (calcium sulfate): ~0.0845 lbs/cu in (2.34 g/cm3)
      // For ratio R (lbs plaster per 100 lbs water):
      // Volume of water = 100 / 0.0361 / 16 = 172.6 cu in per 100 oz water...
      // Simplified formula: mixed density = (1 + R/100) / (1/waterDensity + (R/100)/plasterDensity)

      // Using standard approach: for 100 parts water (by weight)
      // Water volume = 100 / 62.4 = 1.603 cu ft = 2769.7 cu in (per 100 lbs water)
      // Plaster volume = R / (2.34 * 62.4) = R / 146.0 cu ft = R * 11.88 cu in per lb
      // Actually let's use a simpler conversion

      // Per 100 lbs water: volume = 100/62.4 cu ft = 1.603 cu ft
      // R lbs plaster: volume = R/146.0 cu ft (plaster specific gravity = 2.34)
      // Total mix volume for 100 lbs water + R lbs plaster:
      const waterVolPerUnit = 1.603; // cu ft per 100 lbs water
      const plasterVolPerUnit = pd.ratio / (2.34 * 62.4); // cu ft per R lbs plaster
      const mixVolPerUnit = waterVolPerUnit + plasterVolPerUnit; // cu ft total
      const mixVolCuIn = mixVolPerUnit * 1728; // convert to cu in

      // Scale to actual mold volume
      const scaleFactor = vol / mixVolCuIn;
      const waterLbs = 100 * scaleFactor;
      const plasterLbs = pd.ratio * scaleFactor;
      const totalLbs = waterLbs + plasterLbs;

      // Display
      document.getElementById('cm2-plaster')!.textContent = plasterLbs.toFixed(2) + ' lbs';
      document.getElementById('cm2-plaster-note')!.textContent = plasterType !== 'custom' ?
        plasterType.charAt(0).toUpperCase() + plasterType.slice(1) + ' at ' + pd.ratio + ':100 ratio' :
        'Custom ratio ' + pd.ratio + ':100';
      document.getElementById('cm2-water')!.textContent = waterLbs.toFixed(2) + ' lbs (' + (waterLbs / 8.34).toFixed(2) + ' gal)';
      document.getElementById('cm2-total')!.textContent = totalLbs.toFixed(2) + ' lbs';
      document.getElementById('cm2-volume')!.textContent = vol.toFixed(0) + ' cu in';
      document.getElementById('cm2-settime')!.textContent = '~' + pd.setMin + ' min';

      document.getElementById('cm2-instructions')!.textContent =
        'Measure ' + (waterLbs * 16).toFixed(0) + ' oz of water into a clean container. ' +
        'Slowly sift ' + plasterLbs.toFixed(2) + ' lbs of plaster onto the water surface over 2-3 minutes. ' +
        'Let slake for 1-2 minutes, then mix for 2-3 minutes until smooth. ' +
        'Pour into prepared mold. Set time: approximately ' + pd.setMin + ' minutes.';

      document.dispatchEvent(new CustomEvent('calc-update'));
    }

    setTimeout(() => {
      document.querySelectorAll('.cm2-in').forEach(el => {
        el.addEventListener('input', calcCM2);
        el.addEventListener('change', calcCM2);
      });
      calcCM2();
    }, 50);
  </script>
</CalculatorLayout>
