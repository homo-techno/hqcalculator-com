---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Glycemic Index Calculator - Glycemic Load (GL)";
const description = "Calculate glycemic load from glycemic index and carbs per serving. Classify foods as low, medium, or high GL.";
const relatedCalcs = [
  { name: "A1C Calculator", url: "/a1c-calculator", description: "HbA1c conversion." },
  { name: "Calorie Calculator", url: "/calorie-calculator", description: "Daily calorie needs." },
  { name: "Macro Calculator", url: "/macro-calculator", description: "Macronutrients." },
  { name: "Caloric Deficit Calculator", url: "/caloric-deficit-calculator", description: "Weight loss planning." },
  { name: "Sodium Intake Calculator", url: "/sodium-intake-calculator", description: "Daily sodium." },
  { name: "BMI Calculator", url: "/bmi-calculator", description: "Body mass index." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Glycemic Index Calculator" keywords="glycemic index, glycemic load, GI, GL, blood sugar, carbohydrates, diabetes" breadcrumbs={[{ name: "Glycemic Index", url: "/glycemic-index-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Glycemic Index Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate glycemic load and classify foods by blood sugar impact.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div>
          <label class="block text-xs font-medium text-text mb-1">Preset Food</label>
          <select id="gi-preset" class="w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="custom" selected>Custom Values</option>
            <option value="72,30">White bread (GI 72, 30g carbs)</option>
            <option value="55,40">Brown rice (GI 55, 40g carbs)</option>
            <option value="51,26">Oatmeal (GI 51, 26g carbs)</option>
            <option value="43,27">Pasta (GI 43, 27g carbs)</option>
            <option value="36,24">Apple (GI 36, 24g carbs)</option>
            <option value="103,26">Glucose (GI 103, 26g carbs)</option>
          </select>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Glycemic Index (GI)</label><input type="number" id="gi-val" class="gi-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="55" min="0" max="120" step="1"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Carbs per Serving (g)</label><input type="number" id="gi-carbs" class="gi-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="30" min="0" max="500" step="1"></div>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Number of Servings</label>
          <input type="number" id="gi-srv" class="gi-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="1" min="0.5" max="10" step="0.5">
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Glycemic Load</div>
          <div class="text-5xl font-extrabold font-mono" id="gi-gl">0</div>
          <div class="text-sm text-blue-200 mt-1" id="gi-class">--</div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">GI Category</div><div class="text-xl font-bold" id="gi-gicat">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Total Carbs</div><div class="text-xl font-bold" id="gi-totalcarbs">0g</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">GL Rating</div><div class="text-xl font-bold" id="gi-rating">--</div></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-3">Classification Reference</h3>
          <div class="grid grid-cols-2 gap-2 text-sm">
            <div class="flex justify-between"><span>Low GI</span><span class="font-bold">55 or less</span></div>
            <div class="flex justify-between"><span>Medium GI</span><span class="font-bold">56 - 69</span></div>
            <div class="flex justify-between"><span>High GI</span><span class="font-bold">70 or more</span></div>
            <div class="flex justify-between"><span>Low GL</span><span class="font-bold">10 or less</span></div>
            <div class="flex justify-between"><span>Medium GL</span><span class="font-bold">11 - 19</span></div>
            <div class="flex justify-between"><span>High GL</span><span class="font-bold">20 or more</span></div>
          </div>
        </div>
      </div>
      <ShareButton calculatorId="glycemic-index" />
      <FeedbackWidget />
    </div>
    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">Glycemic Index vs Glycemic Load</h2>
      <p>Glycemic Index (GI) ranks carbohydrate-containing foods by how much they raise blood glucose. Glycemic Load (GL) accounts for serving size: GL = GI x carbs (g) / 100. GL provides a more practical measure of a food's blood sugar impact.</p>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function setGiPreset() {
      const val = (document.getElementById('gi-preset') as HTMLSelectElement).value;
      if (val !== 'custom') {
        const parts = val.split(',');
        (document.getElementById('gi-val') as HTMLInputElement).value = parts[0];
        (document.getElementById('gi-carbs') as HTMLInputElement).value = parts[1];
      }
      calcGI();
    }
    function calcGI() {
      const gi = parseFloat((document.getElementById('gi-val') as HTMLInputElement).value) || 0;
      const carbs = parseFloat((document.getElementById('gi-carbs') as HTMLInputElement).value) || 0;
      const srv = parseFloat((document.getElementById('gi-srv') as HTMLInputElement).value) || 1;
      const totalCarbs = carbs * srv;
      const gl = (gi * totalCarbs) / 100;
      let giCat = 'Low';
      if (gi >= 70) giCat = 'High';
      else if (gi >= 56) giCat = 'Medium';
      let glClass = 'Low GL';
      let rating = 'Good';
      if (gl >= 20) { glClass = 'High GL'; rating = 'High Impact'; }
      else if (gl >= 11) { glClass = 'Medium GL'; rating = 'Moderate'; }
      document.getElementById('gi-gl')!.textContent = gl.toFixed(1);
      document.getElementById('gi-class')!.textContent = glClass;
      document.getElementById('gi-gicat')!.textContent = giCat;
      document.getElementById('gi-totalcarbs')!.textContent = totalCarbs.toFixed(0) + 'g';
      document.getElementById('gi-rating')!.textContent = rating;
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.getElementById('gi-preset')!.addEventListener('change', setGiPreset);
      document.querySelectorAll('.gi-in').forEach(el => { el.addEventListener('input', calcGI); el.addEventListener('change', calcGI); });
      calcGI();
    }, 50);
  </script>
</CalculatorLayout>
