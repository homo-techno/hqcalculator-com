---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Timber Value Calculator - Stumpage & Stand Value";
const description = "Calculate timber stumpage value from species, grade, and volume. Estimate market price, total stand value, and per-acre revenue.";
const relatedCalcs = [
  { name: "Lumber Calculator", url: "/lumber-calculator", description: "Calculate lumber needs." },
  { name: "Firewood Calculator", url: "/firewood-calculator", description: "Firewood cord and BTU needs." },
  { name: "Carbon Offset", url: "/carbon-offset-calculator", description: "Estimate carbon offsets." },
  { name: "Budget Calculator", url: "/budget-calculator", description: "Plan your budget." },
  { name: "Volume Calculator", url: "/volume-calculator", description: "General volume calculations." },
  { name: "Percentage Calculator", url: "/percentage-calculator", description: "Percentage computations." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Timber Value Calculator" keywords="timber value calculator, stumpage value, board feet price, stand value, timber appraisal, logging revenue" breadcrumbs={[{ name: "Timber Value", url: "/timber-value-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Timber Value Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Estimate stumpage value and total stand revenue from species, grade, and volume.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div>
          <label class="block text-xs font-medium text-text mb-1">Tree Species</label>
          <select id="tb-species" class="tb-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
            <option value="350">Red Oak ($350/MBF)</option>
            <option value="450">White Oak ($450/MBF)</option>
            <option value="500">Black Walnut ($500/MBF)</option>
            <option value="250">Hard Maple ($250/MBF)</option>
            <option value="200">Yellow Poplar ($200/MBF)</option>
            <option value="150">White Pine ($150/MBF)</option>
            <option value="180">Douglas Fir ($180/MBF)</option>
            <option value="120">Spruce ($120/MBF)</option>
          </select>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Log Grade</label>
          <select id="tb-grade" class="tb-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
            <option value="1.3">Veneer (130% premium)</option>
            <option value="1.0" selected>Grade 1 Sawlog (100%)</option>
            <option value="0.75">Grade 2 Sawlog (75%)</option>
            <option value="0.50">Grade 3 Sawlog (50%)</option>
            <option value="0.25">Pulpwood (25%)</option>
          </select>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="block text-xs font-medium text-text mb-1">Volume (MBF per acre)</label>
            <input type="number" id="tb-vol" class="tb-in w-full px-4 py-3 border border-border rounded-xl text-2xl font-bold" value="8" min="0.1" max="100" step="0.5">
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Stand Acres</label>
            <input type="number" id="tb-acres" class="tb-in w-full px-4 py-3 border border-border rounded-xl text-2xl font-bold" value="20" min="1" max="10000" step="1">
          </div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="block text-xs font-medium text-text mb-1">Logging Cost ($/MBF)</label>
            <input type="number" id="tb-logcost" class="tb-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="120" min="0" step="10">
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Hauling Cost ($/MBF)</label>
            <input type="number" id="tb-haul" class="tb-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="40" min="0" step="5">
          </div>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Total Stand Value</div>
          <div class="text-5xl font-extrabold font-mono" id="tb-total">--</div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Stumpage $/MBF</div>
            <div class="text-xl font-bold font-mono" id="tb-stump">--</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Value Per Acre</div>
            <div class="text-xl font-bold font-mono" id="tb-peracre">--</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Total Volume MBF</div>
            <div class="text-xl font-bold font-mono" id="tb-totvol">--</div>
          </div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Gross Revenue</div>
            <div class="text-xl font-bold font-mono" id="tb-gross">--</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Total Costs</div>
            <div class="text-xl font-bold font-mono" id="tb-costs">--</div>
          </div>
        </div>
      </div>
      <ShareButton calculatorId="timber-value" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcTB() {
      const basePrice = parseFloat((document.getElementById('tb-species') as HTMLSelectElement).value) || 350;
      const grade = parseFloat((document.getElementById('tb-grade') as HTMLSelectElement).value) || 1.0;
      const volPerAcre = parseFloat((document.getElementById('tb-vol') as HTMLInputElement).value) || 8;
      const acres = parseFloat((document.getElementById('tb-acres') as HTMLInputElement).value) || 20;
      const logCost = parseFloat((document.getElementById('tb-logcost') as HTMLInputElement).value) || 0;
      const haulCost = parseFloat((document.getElementById('tb-haul') as HTMLInputElement).value) || 0;
      const marketPrice = basePrice * grade;
      const stumpagePerMBF = marketPrice - logCost - haulCost;
      const totalVol = volPerAcre * acres;
      const grossRevenue = marketPrice * totalVol;
      const totalCosts = (logCost + haulCost) * totalVol;
      const netValue = stumpagePerMBF * totalVol;
      const perAcre = stumpagePerMBF * volPerAcre;
      document.getElementById('tb-total')!.textContent = '$' + Math.round(netValue).toLocaleString();
      document.getElementById('tb-stump')!.textContent = '$' + Math.round(stumpagePerMBF).toLocaleString();
      document.getElementById('tb-peracre')!.textContent = '$' + Math.round(perAcre).toLocaleString();
      document.getElementById('tb-totvol')!.textContent = totalVol.toFixed(1);
      document.getElementById('tb-gross')!.textContent = '$' + Math.round(grossRevenue).toLocaleString();
      document.getElementById('tb-costs')!.textContent = '$' + Math.round(totalCosts).toLocaleString();
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.tb-in').forEach(el => { el.addEventListener('input', calcTB); el.addEventListener('change', calcTB); });
      calcTB();
    }, 50);
  </script>
</CalculatorLayout>
