---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Cable Carrier Calculator - Drag Chain Sizing for Robotics";
const description = "Calculate cable carrier (drag chain) sizing for robotic and CNC applications. Determine inner dimensions, bend radius, travel length, and fill capacity.";
const relatedCalcs = [
  { name: "Robot Arm Calculator", url: "/robot-arm-calculator", description: "Calculate robot arm reach and workspace." },
  { name: "Linear Actuator Calculator", url: "/linear-actuator-calculator", description: "Calculate linear actuator force and stroke." },
  { name: "Ball Screw Calculator", url: "/ball-screw-calculator", description: "Calculate ball screw lead and critical speed." },
  { name: "Conveyor Speed Calculator", url: "/conveyor-speed-calculator", description: "Calculate conveyor belt speed requirements." },
  { name: "PLC I/O Calculator", url: "/plc-io-calculator", description: "Plan PLC I/O points for automation." },
  { name: "Servo Motor Calculator", url: "/servo-motor-calculator", description: "Size servo motors for axis drives." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Cable Carrier Calculator" keywords="cable carrier calculator, drag chain sizing, energy chain, cable management, bend radius, robotic cable chain, CNC cable carrier" breadcrumbs={[{ name: "Cable Carrier Calculator", url: "/cable-carrier-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Cable Carrier Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Size cable carriers (drag chains) for robotic and motion systems. Calculate inner dimensions, minimum bend radius, and total chain length from your cable bundle.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-6">
        <h3 class="text-lg font-bold text-text">Cable Bundle</h3>
        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-semibold text-text mb-2">Power Cables (qty)</label>
            <input type="number" id="ccr-power-qty" class="ccr-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="3" min="0" step="1">
          </div>
          <div>
            <label class="block text-sm font-semibold text-text mb-2">Power Cable OD (mm)</label>
            <input type="number" id="ccr-power-od" class="ccr-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="12" min="1" step="0.5">
          </div>
          <div>
            <label class="block text-sm font-semibold text-text mb-2">Signal Cables (qty)</label>
            <input type="number" id="ccr-signal-qty" class="ccr-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="4" min="0" step="1">
          </div>
          <div>
            <label class="block text-sm font-semibold text-text mb-2">Signal Cable OD (mm)</label>
            <input type="number" id="ccr-signal-od" class="ccr-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="6" min="1" step="0.5">
          </div>
          <div>
            <label class="block text-sm font-semibold text-text mb-2">Pneumatic Hoses (qty)</label>
            <input type="number" id="ccr-hose-qty" class="ccr-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="2" min="0" step="1">
          </div>
          <div>
            <label class="block text-sm font-semibold text-text mb-2">Hose OD (mm)</label>
            <input type="number" id="ccr-hose-od" class="ccr-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="8" min="1" step="0.5">
          </div>
        </div>

        <h3 class="text-lg font-bold text-text">Travel Parameters</h3>
        <div>
          <label class="block text-sm font-semibold text-text mb-2">Travel Length (mm)</label>
          <input type="number" id="ccr-travel" class="ccr-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="500" min="50" step="50">
        </div>
        <div>
          <label class="block text-sm font-semibold text-text mb-2">Max Speed (m/s)</label>
          <input type="number" id="ccr-speed" class="ccr-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="3" min="0.1" step="0.1">
        </div>
        <div>
          <label class="block text-sm font-semibold text-text mb-2">Fill Factor (%)</label>
          <input type="number" id="ccr-fill" class="ccr-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="60" min="30" max="80" step="5">
          <p class="text-xs text-text-secondary mt-1">Recommended: 50-60% for cables, max 80%</p>
        </div>

        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm font-medium opacity-80 mb-1">Recommended Inner Height</div>
          <div id="ccr-result-height" class="text-3xl sm:text-4xl font-extrabold">--</div>
          <div class="text-sm opacity-80 mt-1">mm (min inner dimension)</div>
        </div>

        <div class="grid grid-cols-2 gap-4">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-secondary mb-1">Min Inner Width</div>
            <div id="ccr-inner-width" class="text-lg font-bold text-text">--</div>
            <div class="text-xs text-text-secondary">mm</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-secondary mb-1">Min Bend Radius</div>
            <div id="ccr-bend-radius" class="text-lg font-bold text-text">--</div>
            <div class="text-xs text-text-secondary">mm</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-secondary mb-1">Total Chain Length</div>
            <div id="ccr-chain-length" class="text-lg font-bold text-text">--</div>
            <div class="text-xs text-text-secondary">mm</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-secondary mb-1">Cable Cross-section</div>
            <div id="ccr-cable-area" class="text-lg font-bold text-text">--</div>
            <div class="text-xs text-text-secondary">mmÂ² total</div>
          </div>
        </div>

        <ShareButton />
        <FeedbackWidget />
      </div>
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    function calcCCR() {
      const powerQty = parseInt((document.getElementById('ccr-power-qty') as HTMLInputElement).value) || 0;
      const powerOD = parseFloat((document.getElementById('ccr-power-od') as HTMLInputElement).value) || 12;
      const signalQty = parseInt((document.getElementById('ccr-signal-qty') as HTMLInputElement).value) || 0;
      const signalOD = parseFloat((document.getElementById('ccr-signal-od') as HTMLInputElement).value) || 6;
      const hoseQty = parseInt((document.getElementById('ccr-hose-qty') as HTMLInputElement).value) || 0;
      const hoseOD = parseFloat((document.getElementById('ccr-hose-od') as HTMLInputElement).value) || 8;
      const travel = parseFloat((document.getElementById('ccr-travel') as HTMLInputElement).value) || 500;
      const speed = parseFloat((document.getElementById('ccr-speed') as HTMLInputElement).value) || 3;
      const fillPct = parseFloat((document.getElementById('ccr-fill') as HTMLInputElement).value) / 100 || 0.6;

      const powerArea = powerQty * Math.PI * Math.pow(powerOD / 2, 2);
      const signalArea = signalQty * Math.PI * Math.pow(signalOD / 2, 2);
      const hoseArea = hoseQty * Math.PI * Math.pow(hoseOD / 2, 2);
      const totalCableArea = powerArea + signalArea + hoseArea;

      const largestOD = Math.max(powerQty > 0 ? powerOD : 0, signalQty > 0 ? signalOD : 0, hoseQty > 0 ? hoseOD : 0);
      const innerHeight = Math.ceil(largestOD * 1.1 + 2);

      const requiredInnerArea = totalCableArea / fillPct;
      const innerWidth = Math.ceil(requiredInnerArea / innerHeight);

      const minBendRadius = Math.max(largestOD * 10, 50);
      const chainLength = travel + Math.PI * minBendRadius + 200;

      document.getElementById('ccr-result-height')!.textContent = innerHeight.toString();
      document.getElementById('ccr-inner-width')!.textContent = innerWidth.toString();
      document.getElementById('ccr-bend-radius')!.textContent = minBendRadius.toFixed(0);
      document.getElementById('ccr-chain-length')!.textContent = chainLength.toFixed(0);
      document.getElementById('ccr-cable-area')!.textContent = totalCableArea.toFixed(1);
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.ccr-in').forEach(el => { el.addEventListener('input', calcCCR); el.addEventListener('change', calcCCR); });
      calcCCR();
    }, 50);
  </script>
</CalculatorLayout>
