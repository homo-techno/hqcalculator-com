---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Productivity Calculator - Efficiency & Deep Work Ratio";
const description = "Measure your productivity with tasks per hour, efficiency percentage, deep work ratio, and improvement suggestions.";
const relatedCalcs = [
  { name: "Meeting Cost", url: "/meeting-cost-calculator", description: "Meeting costs." },
  { name: "Break Schedule", url: "/break-schedule-calculator", description: "Break timing." },
  { name: "Project Timeline", url: "/project-timeline-calculator", description: "Timelines." },
  { name: "Time Calculator", url: "/time-calculator", description: "Time math." },
  { name: "Percentage Calculator", url: "/percentage-calculator", description: "Percentages." },
  { name: "Salary Calculator", url: "/salary-calculator", description: "Salary." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Productivity Calculator" keywords="productivity calculator, tasks per hour, efficiency, deep work, work productivity, time management" breadcrumbs={[{ name: "Productivity", url: "/productivity-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Productivity Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Analyze your work productivity and identify areas for improvement.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Tasks Completed</label><input type="number" id="pr-tasks" class="pr-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="12" min="0" step="1"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Hours Worked</label><input type="number" id="pr-hours" class="pr-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="8" min="0.5" step="0.5"></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Distractions/Interruptions</label><input type="number" id="pr-dist" class="pr-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="15" min="0" step="1"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Avg Distraction (minutes)</label><input type="number" id="pr-distmin" class="pr-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="5" min="1" max="30" step="1"></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Meetings (hours)</label><input type="number" id="pr-meet" class="pr-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="1.5" min="0" step="0.25"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Planned Tasks</label><input type="number" id="pr-planned" class="pr-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="15" min="1" step="1"></div>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Efficiency Score</div>
          <div class="text-5xl font-extrabold font-mono" id="pr-eff">0%</div>
          <div class="text-sm text-blue-200 mt-1">task completion rate</div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Tasks/Hour</div><div class="text-xl font-bold" id="pr-tph">0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Deep Work Ratio</div><div class="text-xl font-bold" id="pr-deep">0%</div></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Time Lost to Distractions</div><div class="text-xl font-bold" id="pr-lost">0 min</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Effective Work Hours</div><div class="text-xl font-bold" id="pr-effective">0</div></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-3">Improvement Suggestions</h3>
          <div class="space-y-1 text-sm text-text-secondary" id="pr-tips"></div>
        </div>
      </div>
      <ShareButton calculatorId="productivity" />
      <FeedbackWidget />
    </div>
    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">Measuring Productivity</h2>
      <p>True productivity is not just about doing more tasks, but about maximizing deep work time. Research shows the average worker is productive for only 2 hours 53 minutes of an 8-hour day. Reducing distractions and meetings significantly boosts output.</p>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcProd() {
      const tasks = parseFloat((document.getElementById('pr-tasks') as HTMLInputElement).value) || 0;
      const hours = parseFloat((document.getElementById('pr-hours') as HTMLInputElement).value) || 8;
      const dist = parseFloat((document.getElementById('pr-dist') as HTMLInputElement).value) || 0;
      const distMin = parseFloat((document.getElementById('pr-distmin') as HTMLInputElement).value) || 5;
      const meetHrs = parseFloat((document.getElementById('pr-meet') as HTMLInputElement).value) || 0;
      const planned = parseFloat((document.getElementById('pr-planned') as HTMLInputElement).value) || 1;
      const distHrs = (dist * distMin) / 60;
      const effectiveHrs = Math.max(0, hours - meetHrs - distHrs);
      const tph = effectiveHrs > 0 ? (tasks / effectiveHrs) : 0;
      const efficiency = Math.min(100, Math.round((tasks / planned) * 100));
      const deepWorkRatio = hours > 0 ? Math.round((effectiveHrs / hours) * 100) : 0;
      document.getElementById('pr-eff')!.textContent = efficiency + '%';
      document.getElementById('pr-tph')!.textContent = tph.toFixed(1);
      document.getElementById('pr-deep')!.textContent = deepWorkRatio + '%';
      document.getElementById('pr-lost')!.textContent = Math.round(dist * distMin) + ' min';
      document.getElementById('pr-effective')!.textContent = effectiveHrs.toFixed(1) + ' hrs';
      const tips: string[] = [];
      if (distHrs > 1) tips.push('Try time-blocking to reduce interruptions. You lose ' + Math.round(distHrs * 60) + ' min/day to distractions.');
      if (meetHrs > 2) tips.push('Consider async communication to reduce meeting time.');
      if (deepWorkRatio < 50) tips.push('Aim for at least 50% deep work ratio. Try the Pomodoro technique.');
      if (efficiency < 70) tips.push('Break large tasks into smaller ones to improve completion rate.');
      if (tph < 1) tips.push('Focus on high-impact tasks first (Eisenhower matrix).');
      if (tips.length === 0) tips.push('Great productivity! Keep up the deep work habits.');
      document.getElementById('pr-tips')!.innerHTML = tips.map(t => `<div class="py-1">&#8226; ${t}</div>`).join('');
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => { document.querySelectorAll('.pr-in').forEach(el => { el.addEventListener('input', calcProd); el.addEventListener('change', calcProd); }); calcProd(); }, 50);
  </script>
</CalculatorLayout>
