---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Internet Speed Calculator - Download Time & Bandwidth";
const description = "Calculate file download times, convert between bandwidth units, and find the right internet speed for your needs.";
const relatedCalcs = [
  { name: "Data Storage", url: "/data-storage-converter", description: "Data units." },
  { name: "Percentage Calculator", url: "/percentage-calculator", description: "Percentages." },
  { name: "Scientific Notation", url: "/scientific-notation-calculator", description: "Sci notation." },
  { name: "Time Calculator", url: "/time-calculator", description: "Time." },
  { name: "Typing Speed", url: "/typing-speed-calculator", description: "Typing." },
  { name: "Unit Converter", url: "/length-converter", description: "Units." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Internet Speed Calculator" keywords="internet speed calculator, download time, bandwidth calculator, mbps to mbps, file transfer time" breadcrumbs={[{ name: "Internet Speed", url: "/internet-speed-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Internet Speed Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate download times and convert bandwidth units.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="block text-xs font-medium text-text mb-1">File Size</label>
            <div class="flex gap-1">
              <input type="number" id="is-size" class="is-in flex-1 px-4 py-3 border border-border rounded-xl text-lg font-bold" value="4.7" min="0" step="0.1">
              <select id="is-sunit" class="is-in px-2 py-3 border border-border rounded-xl text-sm">
                <option value="1">Bytes</option><option value="1024">KB</option><option value="1048576">MB</option><option value="1073741824" selected>GB</option><option value="1099511627776">TB</option>
              </select>
            </div>
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Internet Speed</label>
            <div class="flex gap-1">
              <input type="number" id="is-speed" class="is-in flex-1 px-4 py-3 border border-border rounded-xl text-lg font-bold" value="100" min="0.1" step="1">
              <select id="is-spunit" class="is-in px-2 py-3 border border-border rounded-xl text-sm">
                <option value="1000">Kbps</option><option value="1000000" selected>Mbps</option><option value="1000000000">Gbps</option>
              </select>
            </div>
          </div>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Download Time</div>
          <div class="text-4xl font-extrabold" id="is-time">0</div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Speed (MB/s)</div><div class="text-xl font-bold" id="is-mbps">0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Speed (Mbps)</div><div class="text-xl font-bold" id="is-mbits">0</div></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-3">Common File Downloads</h3>
          <div class="space-y-1 text-sm" id="is-common"></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-3">Speed Recommendations</h3>
          <div class="grid grid-cols-2 gap-2 text-sm">
            <div class="flex justify-between"><span>Email/Web</span><span class="font-bold">5-10 Mbps</span></div>
            <div class="flex justify-between"><span>HD Streaming</span><span class="font-bold">25 Mbps</span></div>
            <div class="flex justify-between"><span>4K Streaming</span><span class="font-bold">50 Mbps</span></div>
            <div class="flex justify-between"><span>Online Gaming</span><span class="font-bold">25-50 Mbps</span></div>
            <div class="flex justify-between"><span>Video Calls</span><span class="font-bold">10-20 Mbps</span></div>
            <div class="flex justify-between"><span>Large Downloads</span><span class="font-bold">100+ Mbps</span></div>
          </div>
        </div>
      </div>
      <ShareButton calculatorId="internet-speed" />
      <FeedbackWidget />
    </div>
    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">Bandwidth vs Speed</h2>
      <p>Internet speeds are measured in bits per second (bps). 1 byte = 8 bits. So 100 Mbps = 12.5 MB/s actual download speed.</p>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function fmtTime(seconds: number): string {
      if (seconds < 1) return (seconds * 1000).toFixed(0) + ' ms';
      if (seconds < 60) return seconds.toFixed(1) + ' seconds';
      if (seconds < 3600) { const m = Math.floor(seconds / 60); const s = Math.round(seconds % 60); return m + 'm ' + s + 's'; }
      if (seconds < 86400) { const h = Math.floor(seconds / 3600); const m = Math.round((seconds % 3600) / 60); return h + 'h ' + m + 'm'; }
      const d = Math.floor(seconds / 86400); const h = Math.round((seconds % 86400) / 3600); return d + 'd ' + h + 'h';
    }
    function calcIS() {
      const sizeBytes = parseFloat((document.getElementById('is-size') as HTMLInputElement).value) * parseFloat((document.getElementById('is-sunit') as HTMLSelectElement).value) || 0;
      const speedBps = parseFloat((document.getElementById('is-speed') as HTMLInputElement).value) * parseFloat((document.getElementById('is-spunit') as HTMLSelectElement).value) || 1;
      const sizeBits = sizeBytes * 8;
      const seconds = sizeBits / speedBps;
      const mbps = speedBps / 1000000;
      const mBps = speedBps / 8 / 1000000;
      document.getElementById('is-time')!.textContent = fmtTime(seconds);
      document.getElementById('is-mbps')!.textContent = mBps.toFixed(2) + ' MB/s';
      document.getElementById('is-mbits')!.textContent = mbps.toFixed(1) + ' Mbps';
      const commonFiles = [
        { name: 'Song (5 MB)', bytes: 5e6 },
        { name: 'Photo (3 MB)', bytes: 3e6 },
        { name: 'HD Movie (4.7 GB)', bytes: 4.7e9 },
        { name: '4K Movie (20 GB)', bytes: 20e9 },
        { name: 'Game (50 GB)', bytes: 50e9 },
        { name: 'OS Update (5 GB)', bytes: 5e9 },
      ];
      document.getElementById('is-common')!.innerHTML = commonFiles.map(f => {
        const t = f.bytes * 8 / speedBps;
        return `<div class="flex justify-between"><span>${f.name}</span><span class="font-bold font-mono">${fmtTime(t)}</span></div>`;
      }).join('');
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => { document.querySelectorAll('.is-in').forEach(el => { el.addEventListener('input', calcIS); el.addEventListener('change', calcIS); }); calcIS(); }, 50);
  </script>
</CalculatorLayout>
