---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Proportions Calculator - Solve a/b = c/d";
const description = "Solve proportions and cross-multiplication problems. Enter any 3 values to find the 4th.";
const relatedCalcs = [
  { name: "Ratio Calculator", url: "/ratio-calculator", description: "Ratios." },
  { name: "Percentage Calculator", url: "/percentage-calculator", description: "Percentages." },
  { name: "Fraction Calculator", url: "/fraction-calculator", description: "Fractions." },
  { name: "Scale Calculator", url: "/aspect-ratio-calculator", description: "Aspect ratio." },
  { name: "Unit Price", url: "/unit-price-calculator", description: "Unit price." },
  { name: "Discount Calculator", url: "/discount-calculator", description: "Discounts." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Proportions Calculator" keywords="proportions calculator, cross multiplication, solve proportion, ratio proportion, a/b = c/d" breadcrumbs={[{ name: "Proportions", url: "/proportions-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Proportions Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Enter 3 values to solve the proportion a/b = c/d.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="flex items-center gap-3 justify-center">
          <div class="text-center">
            <input type="number" id="pr-a" class="pr-in w-24 px-3 py-3 border border-border rounded-xl text-2xl font-bold text-center" value="3" step="0.1">
            <div class="border-t-2 border-text my-1"></div>
            <input type="number" id="pr-b" class="pr-in w-24 px-3 py-3 border border-border rounded-xl text-2xl font-bold text-center" value="4" step="0.1">
          </div>
          <div class="text-3xl font-bold text-text">=</div>
          <div class="text-center">
            <input type="number" id="pr-c" class="pr-in w-24 px-3 py-3 border border-border rounded-xl text-2xl font-bold text-center" value="9" step="0.1">
            <div class="border-t-2 border-text my-1"></div>
            <input type="number" id="pr-d" class="pr-in w-24 px-3 py-3 border border-border rounded-xl text-2xl font-bold text-center" placeholder="?" step="0.1">
          </div>
        </div>
        <p class="text-xs text-text-muted text-center">Leave one field empty to solve for it</p>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Missing Value</div>
          <div class="text-5xl font-extrabold font-mono" id="pr-result">0</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-2">Step-by-Step</h3>
          <div class="font-mono text-sm space-y-1" id="pr-steps"></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Cross Product 1 (a×d)</div><div class="text-xl font-bold font-mono" id="pr-cp1">0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Cross Product 2 (b×c)</div><div class="text-xl font-bold font-mono" id="pr-cp2">0</div></div>
        </div>
      </div>
      <ShareButton calculatorId="proportions" />
      <FeedbackWidget />
    </div>
    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">Proportions</h2>
      <p>If a/b = c/d, then a×d = b×c (cross multiplication). Solve for any unknown by rearranging.</p>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcProp() {
      const aEl = document.getElementById('pr-a') as HTMLInputElement;
      const bEl = document.getElementById('pr-b') as HTMLInputElement;
      const cEl = document.getElementById('pr-c') as HTMLInputElement;
      const dEl = document.getElementById('pr-d') as HTMLInputElement;
      const av = aEl.value, bv = bEl.value, cv = cEl.value, dv = dEl.value;
      const a = parseFloat(av), b = parseFloat(bv), c = parseFloat(cv), d = parseFloat(dv);
      let result: number, steps: string[];
      if (!dv || isNaN(d)) {
        result = (b * c) / a; steps = [`a/b = c/d`, `${a}/${b} = ${c}/d`, `d = b×c/a = ${b}×${c}/${a}`, `d = ${result.toFixed(6)}`];
      } else if (!cv || isNaN(c)) {
        result = (a * d) / b; steps = [`a/b = c/d`, `${a}/${b} = c/${d}`, `c = a×d/b = ${a}×${d}/${b}`, `c = ${result.toFixed(6)}`];
      } else if (!bv || isNaN(b)) {
        result = (a * d) / c; steps = [`a/b = c/d`, `${a}/b = ${c}/${d}`, `b = a×d/c = ${a}×${d}/${c}`, `b = ${result.toFixed(6)}`];
      } else {
        result = (b * c) / d; steps = [`a/b = c/d`, `a/${b} = ${c}/${d}`, `a = b×c/d = ${b}×${c}/${d}`, `a = ${result.toFixed(6)}`];
      }
      document.getElementById('pr-result')!.textContent = isNaN(result) || !isFinite(result) ? 'Error' : result.toFixed(4);
      document.getElementById('pr-steps')!.innerHTML = steps.map(s => `<div>${s}</div>`).join('');
      const finalA = isNaN(a) ? result : a, finalD = isNaN(d) ? result : d;
      const finalB = isNaN(b) ? result : b, finalC = isNaN(c) ? result : c;
      document.getElementById('pr-cp1')!.textContent = (finalA * finalD).toFixed(4);
      document.getElementById('pr-cp2')!.textContent = (finalB * finalC).toFixed(4);
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => { document.querySelectorAll('.pr-in').forEach(el => el.addEventListener('input', calcProp)); calcProp(); }, 50);
  </script>
</CalculatorLayout>
