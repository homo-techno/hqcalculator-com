---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Hair Porosity Calculator - Assessment & Product Recommendations";
const description = "Assess your hair porosity level through a guided quiz and get personalized product recommendations for low, medium, or high porosity hair.";
const relatedCalcs = [
  { name: "Hair Growth Calculator", url: "/hair-growth-calculator", description: "Growth rate and length projection." },
  { name: "Hair Color Mixing Calculator", url: "/hair-color-mixing-calculator", description: "Hair dye mixing ratios." },
  { name: "Hair Developer Calculator", url: "/hair-developer-calculator", description: "Developer volume selection." },
  { name: "Hair Extension Calculator", url: "/hair-extension-calculator", description: "Extension bundle count." },
  { name: "Hair Lightening Calculator", url: "/hair-lightening-calculator", description: "Bleach mixing and processing." },
  { name: "Skincare Routine Calculator", url: "/skincare-routine-calculator", description: "Product layering order." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Hair Porosity Calculator" keywords="hair porosity, low porosity, high porosity, hair test, hair care, product recommendations, cuticle" breadcrumbs={[{ name: "Hair Porosity", url: "/hair-porosity-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Hair Porosity Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Assess your hair porosity and get personalized product recommendations.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div>
          <label class="block text-xs font-medium text-text mb-1">Water Absorption Test</label>
          <select id="hpo-water" class="hpo-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="1">Hair floats on water for a long time</option>
            <option value="2" selected>Hair slowly sinks after a few minutes</option>
            <option value="3">Hair sinks immediately</option>
          </select>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Drying Time</label>
          <select id="hpo-dry" class="hpo-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="1">Takes very long to air dry</option>
            <option value="2" selected>Dries at a moderate pace</option>
            <option value="3">Dries very quickly</option>
          </select>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Product Absorption</label>
          <select id="hpo-absorb" class="hpo-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="1">Products sit on hair, feel greasy</option>
            <option value="2" selected>Products absorb normally</option>
            <option value="3">Hair drinks up products quickly, needs frequent reapplication</option>
          </select>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Hair Texture After Washing</label>
          <select id="hpo-texture" class="hpo-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="1">Smooth, shiny, sometimes stiff</option>
            <option value="2" selected>Soft and manageable</option>
            <option value="3">Rough, frizzy, or tangled</option>
          </select>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Chemical / Heat History</label>
          <select id="hpo-history" class="hpo-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="1">No color, minimal heat styling</option>
            <option value="2" selected>Some color or regular heat styling</option>
            <option value="3">Bleached, permed, or frequent heat damage</option>
          </select>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Frizz Level</label>
          <select id="hpo-frizz" class="hpo-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="1">Rarely frizzy</option>
            <option value="2" selected>Sometimes frizzy in humidity</option>
            <option value="3">Constantly frizzy</option>
          </select>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Your Hair Porosity</div>
          <div class="text-4xl font-extrabold font-mono" id="hpo-result">--</div>
          <div class="text-sm text-blue-200 mt-1" id="hpo-score">Score: --</div>
        </div>
        <div class="grid grid-cols-2 gap-4">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Cuticle State</div><div class="text-xl font-bold" id="hpo-cuticle">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Moisture Retention</div><div class="text-xl font-bold" id="hpo-moisture">--</div></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-3">Product Recommendations</h3>
          <div class="text-sm space-y-1" id="hpo-recs"></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-3">Care Tips</h3>
          <div class="text-sm space-y-1" id="hpo-tips"></div>
        </div>
      </div>
      <ShareButton calculatorId="hair-porosity" />
      <FeedbackWidget />
    </div>
    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">Understanding Hair Porosity</h2>
      <p>Hair porosity refers to how well your hair absorbs and retains moisture, determined by the state of the cuticle layer. Low porosity hair has tightly closed cuticles that resist moisture penetration. Medium porosity hair absorbs and retains moisture well. High porosity hair has raised or damaged cuticles that absorb moisture quickly but lose it just as fast. Knowing your porosity helps you choose the right products and techniques for healthy, moisturized hair.</p>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcHPO() {
      const water = parseInt((document.getElementById('hpo-water') as HTMLSelectElement).value);
      const dry = parseInt((document.getElementById('hpo-dry') as HTMLSelectElement).value);
      const absorb = parseInt((document.getElementById('hpo-absorb') as HTMLSelectElement).value);
      const texture = parseInt((document.getElementById('hpo-texture') as HTMLSelectElement).value);
      const history = parseInt((document.getElementById('hpo-history') as HTMLSelectElement).value);
      const frizz = parseInt((document.getElementById('hpo-frizz') as HTMLSelectElement).value);

      const total = water + dry + absorb + texture + history + frizz;
      const avg = total / 6;

      let porosity = 'Medium Porosity';
      let cuticle = 'Slightly Raised';
      let moisture = 'Good';
      let recs: string[] = [];
      let tips: string[] = [];

      if (avg <= 1.5) {
        porosity = 'Low Porosity';
        cuticle = 'Tightly Closed';
        moisture = 'Resistant to Moisture';
        recs = [
          'Use lightweight, water-based products',
          'Avoid heavy butters and oils (they sit on hair)',
          'Look for humectants like glycerin and honey',
          'Use clarifying shampoo monthly to remove buildup',
          'Try liquid leave-in conditioners over creams',
        ];
        tips = [
          'Apply products to damp, warm hair (heat opens cuticles)',
          'Use a steamer or warm towel during deep conditioning',
          'Avoid protein-heavy products (can cause stiffness)',
          'Use the LOC method: Liquid, Oil, Cream',
        ];
      } else if (avg <= 2.3) {
        porosity = 'Medium Porosity';
        cuticle = 'Slightly Raised';
        moisture = 'Good Retention';
        recs = [
          'Most products work well for your hair type',
          'Use occasional deep conditioning treatments',
          'Balance protein and moisture treatments',
          'Medium-weight leave-in conditioners',
          'Argan oil or jojoba oil for sealing',
        ];
        tips = [
          'Maintain with regular conditioning',
          'Avoid over-processing with heat or chemicals',
          'Protein treatments every 4-6 weeks',
          'Your hair is in a healthy porosity range',
        ];
      } else {
        porosity = 'High Porosity';
        cuticle = 'Raised / Damaged';
        moisture = 'Loses Moisture Fast';
        recs = [
          'Use heavy butters and oils (shea, castor oil)',
          'Protein treatments every 1-2 weeks to fill gaps',
          'Anti-humectant products in humid weather',
          'Leave-in conditioners and hair masks regularly',
          'Seal with heavier oils like castor or olive oil',
        ];
        tips = [
          'Use the LCO method: Liquid, Cream, Oil (seal last)',
          'Cold water rinse after conditioning to close cuticles',
          'Avoid excessive heat styling',
          'Apple cider vinegar rinse helps smooth cuticles',
          'Sleep with a satin pillowcase or bonnet',
        ];
      }

      document.getElementById('hpo-result')!.textContent = porosity;
      document.getElementById('hpo-score')!.textContent = 'Score: ' + avg.toFixed(1) + ' / 3.0';
      document.getElementById('hpo-cuticle')!.textContent = cuticle;
      document.getElementById('hpo-moisture')!.textContent = moisture;
      document.getElementById('hpo-recs')!.innerHTML = recs.map(r => '<p>- ' + r + '</p>').join('');
      document.getElementById('hpo-tips')!.innerHTML = tips.map(t => '<p>- ' + t + '</p>').join('');
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.hpo-in').forEach(el => { el.addEventListener('input', calcHPO); el.addEventListener('change', calcHPO); });
      calcHPO();
    }, 50);
  </script>
</CalculatorLayout>
