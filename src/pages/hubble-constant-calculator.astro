---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Hubble Constant Calculator";
const description = "Calculate distance from redshift using Hubble's law, estimate the age of the universe, and explore expansion rate parameters.";
const relatedCalcs = [
  { name: "Speed Calculator", url: "/speed-calculator", description: "Speed." },
  { name: "Orbital Period", url: "/orbital-period-calculator", description: "Orbits." },
  { name: "Escape Velocity", url: "/escape-velocity-calculator", description: "Escape speed." },
  { name: "Scientific Notation", url: "/scientific-notation-calculator", description: "Notation." },
  { name: "Doppler Effect", url: "/doppler-effect-calculator", description: "Doppler shift." },
  { name: "Wavelength", url: "/wavelength-calculator", description: "Wavelengths." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Hubble Constant Calculator" keywords="Hubble constant, Hubble law, cosmic expansion, age of universe, redshift distance, recession velocity" breadcrumbs={[{ name: "Hubble Constant", url: "/hubble-constant-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Hubble Constant Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">v = H\u2080 \u00d7 d \u2014 Hubble's Law relates recession velocity to distance.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div><label class="block text-xs font-medium text-text mb-1">Hubble Constant H\u2080 (km/s/Mpc)</label><input type="number" id="hb2-h0" class="hb2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="70" step="0.1" min="1"></div>
        <div><label class="block text-xs font-medium text-text mb-1">Solve For</label>
          <select id="hb2-solve" class="hb2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
            <option value="dist" selected>Distance from Velocity</option>
            <option value="vel">Velocity from Distance</option>
            <option value="h0">H\u2080 from Velocity and Distance</option>
          </select>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Recession Velocity (km/s)</label><input type="number" id="hb2-vel" class="hb2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="7000" step="100" min="0"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Distance (Mpc)</label><input type="number" id="hb2-dist" class="hb2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="100" step="1" min="0.01"></div>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1" id="hb2-label">Result</div>
          <div class="text-5xl font-extrabold font-mono" id="hb2-result">--</div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Hubble Time (age est.)</div><div class="text-xl font-bold font-mono" id="hb2-age">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Redshift (z)</div><div class="text-xl font-bold font-mono" id="hb2-z">--</div></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Distance (Mly)</div><div class="text-xl font-bold font-mono" id="hb2-mly">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Hubble Radius</div><div class="text-xl font-bold font-mono" id="hb2-hr">--</div></div>
        </div>
      </div>
      <ShareButton calculatorId="hubble-constant" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcHB2() {
      const solve = (document.getElementById('hb2-solve') as HTMLSelectElement).value;
      let H0 = parseFloat((document.getElementById('hb2-h0') as HTMLInputElement).value) || 70;
      let vel = parseFloat((document.getElementById('hb2-vel') as HTMLInputElement).value) || 0;
      let dist = parseFloat((document.getElementById('hb2-dist') as HTMLInputElement).value) || 0;
      const c = 299792.458;

      if (solve === 'dist') {
        dist = vel / H0;
        document.getElementById('hb2-label')!.textContent = 'Distance';
        document.getElementById('hb2-result')!.textContent = dist.toFixed(2) + ' Mpc';
      } else if (solve === 'vel') {
        vel = H0 * dist;
        document.getElementById('hb2-label')!.textContent = 'Recession Velocity';
        document.getElementById('hb2-result')!.textContent = vel.toFixed(0) + ' km/s';
      } else {
        H0 = vel / dist;
        document.getElementById('hb2-label')!.textContent = 'Hubble Constant';
        document.getElementById('hb2-result')!.textContent = H0.toFixed(1) + ' km/s/Mpc';
      }

      const hubbleTimeSec = (3.086e22) / (H0 * 1000);
      const hubbleTimeGyr = hubbleTimeSec / (3.156e16);
      const z = vel / c;
      const mly = dist * 3.2616;
      const hubbleRadius = c / H0;

      document.getElementById('hb2-age')!.textContent = hubbleTimeGyr.toFixed(2) + ' Gyr';
      document.getElementById('hb2-z')!.textContent = z.toFixed(6);
      document.getElementById('hb2-mly')!.textContent = mly.toFixed(1) + ' Mly';
      document.getElementById('hb2-hr')!.textContent = hubbleRadius.toFixed(0) + ' Mpc';
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.hb2-in').forEach(el => { el.addEventListener('input', calcHB2); el.addEventListener('change', calcHB2); });
      calcHB2();
    }, 50);
  </script>
</CalculatorLayout>
