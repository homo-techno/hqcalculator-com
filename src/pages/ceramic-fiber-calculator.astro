---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Ceramic Fiber Calculator - Kiln Insulation Blanket & Board";
const description = "Calculate ceramic fiber blanket and board insulation for kiln building. Determine R-value, thickness needed, and material quantities.";
const relatedCalcs = [
  { name: "Kiln Energy Calculator", url: "/kiln-energy-calculator", description: "Firing energy costs." },
  { name: "Kiln Temperature Calculator", url: "/kiln-temperature-calculator", description: "Firing schedules." },
  { name: "Kiln Shelf Calculator", url: "/kiln-shelf-calculator", description: "Kiln shelf arrangement." },
  { name: "Thermal Shock Calculator", url: "/thermal-shock-calculator", description: "Thermal shock resistance." },
  { name: "Raku Firing Calculator", url: "/raku-firing-calculator", description: "Raku firing planning." },
  { name: "Pottery Pricing Calculator", url: "/pottery-pricing-calculator", description: "Pottery pricing." },
];
---
<CalculatorLayout
  title={title}
  description={description}
  calculatorName="Ceramic Fiber Calculator"
  keywords="ceramic fiber, kiln insulation, fiber blanket, fiber board, kiln building, refractory insulation, kaowool, R-value, kiln wall"
  breadcrumbs={[{ name: "Ceramic Fiber Calculator", url: "/ceramic-fiber-calculator" }]}
>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Ceramic Fiber Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate ceramic fiber insulation needs for kiln building. Determine thickness, quantity, and thermal performance.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="mb-5">
        <label class="block text-sm font-medium text-text mb-2">Kiln Type</label>
        <select id="cf2-kiln" class="cf2-in w-full px-4 py-3 border border-border rounded-xl text-lg">
          <option value="box" selected>Box / Top-loading Kiln</option>
          <option value="car">Car Kiln / Front-loading</option>
          <option value="raku">Raku Kiln (top-hat)</option>
          <option value="custom">Custom Dimensions</option>
        </select>
      </div>

      <h3 class="font-semibold text-text mb-3">Interior Dimensions</h3>
      <div class="grid grid-cols-3 gap-3 mb-5">
        <div>
          <label class="block text-xs font-medium text-text mb-1">Width (in)</label>
          <input type="number" id="cf2-w" class="cf2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="24" min="6" step="1">
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Depth (in)</label>
          <input type="number" id="cf2-d" class="cf2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="24" min="6" step="1">
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Height (in)</label>
          <input type="number" id="cf2-h" class="cf2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="24" min="6" step="1">
        </div>
      </div>

      <div class="mb-5">
        <label class="block text-sm font-medium text-text mb-2">Maximum Temperature</label>
        <select id="cf2-temp" class="cf2-in w-full px-4 py-3 border border-border rounded-xl text-lg">
          <option value="1800">1800°F / 982°C (Low fire)</option>
          <option value="2300" selected>2300°F / 1260°C (Mid/High fire)</option>
          <option value="2600">2600°F / 1427°C (High fire +)</option>
        </select>
      </div>

      <div class="mb-5">
        <label class="block text-sm font-medium text-text mb-2">Insulation Product</label>
        <select id="cf2-product" class="cf2-in w-full px-4 py-3 border border-border rounded-xl text-lg">
          <option value="blanket8" selected>Ceramic Fiber Blanket (8 lb/cu ft)</option>
          <option value="blanket6">Ceramic Fiber Blanket (6 lb/cu ft)</option>
          <option value="board">Ceramic Fiber Board</option>
          <option value="combo">Blanket + IFB Backup (combo)</option>
        </select>
      </div>

      <div class="mb-5">
        <label class="block text-sm font-medium text-text mb-2">Desired Wall Thickness (inches)</label>
        <input type="number" id="cf2-thick" class="cf2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="6" min="2" max="12" step="1">
        <p class="text-xs text-text-muted mt-1">Typical: 4-6" for moderate temps, 6-9" for high fire</p>
      </div>

      <!-- Primary Result -->
      <div class="p-6 bg-primary rounded-2xl text-white text-center mb-4">
        <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Total Insulation Needed</div>
        <div class="text-4xl font-extrabold" id="cf2-total">--</div>
        <div class="text-sm text-blue-200 mt-1">square feet of material</div>
      </div>

      <div class="grid grid-cols-2 gap-4 mb-4">
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Wall Area</div>
          <div class="text-xl font-bold" id="cf2-wall-area">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Top/Bottom Area</div>
          <div class="text-xl font-bold" id="cf2-top-area">--</div>
        </div>
      </div>

      <div class="grid grid-cols-2 gap-4 mb-4">
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Number of Layers</div>
          <div class="text-xl font-bold" id="cf2-layers">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">R-Value (est.)</div>
          <div class="text-xl font-bold" id="cf2-rvalue">--</div>
        </div>
      </div>

      <div class="grid grid-cols-2 gap-4 mb-4">
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Outer Shell Temp (est.)</div>
          <div class="text-xl font-bold" id="cf2-outer">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Total Weight (est.)</div>
          <div class="text-xl font-bold" id="cf2-weight">--</div>
        </div>
      </div>

      <div class="p-4 bg-surface-alt rounded-xl mb-4">
        <h3 class="font-semibold text-sm text-text mb-2">Notes</h3>
        <p class="text-xs text-text-muted" id="cf2-notes">--</p>
      </div>

      <ShareButton calculatorId="ceramic-fiber" />
      <FeedbackWidget />
    </div>

    <article class="mt-12 max-w-4xl prose prose-slate">
      <h2 class="text-2xl font-bold text-text">Ceramic Fiber Kiln Insulation</h2>
      <p>Ceramic fiber (alumina-silica fiber) is an excellent lightweight insulation for kilns. It heats up fast, has low thermal mass, and excellent insulating properties. Common brands include Kaowool, Inswool, and Unifrax.</p>
      <h3 class="text-xl font-semibold text-text mt-8">Insulation Guidelines</h3>
      <ul>
        <li><strong>8 lb density blanket:</strong> Best for hot-face (interior) layers, more durable</li>
        <li><strong>6 lb density blanket:</strong> Good for backup (outer) layers, lighter weight</li>
        <li><strong>Fiber board:</strong> Rigid, good for structural walls and doors</li>
        <li>Use rigidizer on the hot face to reduce fiber release</li>
        <li>Always wear respiratory protection when handling ceramic fiber</li>
      </ul>
    </article>

    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    function calcCF2() {
      const kilnType = (document.getElementById('cf2-kiln') as HTMLSelectElement).value;
      const w = parseFloat((document.getElementById('cf2-w') as HTMLInputElement).value) || 24;
      const d = parseFloat((document.getElementById('cf2-d') as HTMLInputElement).value) || 24;
      const h = parseFloat((document.getElementById('cf2-h') as HTMLInputElement).value) || 24;
      const maxTemp = parseInt((document.getElementById('cf2-temp') as HTMLSelectElement).value) || 2300;
      const product = (document.getElementById('cf2-product') as HTMLSelectElement).value;
      const wallThick = parseFloat((document.getElementById('cf2-thick') as HTMLInputElement).value) || 6;

      // Surface areas (interior dimensions)
      const wallArea = 2 * (w + d) * h; // 4 walls
      const topArea = w * d; // top
      const bottomArea = w * d; // bottom
      const totalInteriorSqIn = wallArea + topArea + bottomArea;
      const totalInteriorSqFt = totalInteriorSqIn / 144;

      // Blanket typically comes in 1" thick layers
      let layerThick = 1; // inch
      if (product === 'board') layerThick = 1; // boards are 1" or 2"
      const numLayers = Math.ceil(wallThick / layerThick);

      // Total material = interior area x number of layers (each layer covers the surface)
      // Outer layers are slightly larger due to increasing dimensions, approximate +5% per layer
      let totalSqFt = 0;
      for (let i = 0; i < numLayers; i++) {
        const expand = 1 + (i * 0.03); // each layer slightly larger
        totalSqFt += totalInteriorSqFt * expand;
      }

      // Thermal conductivity of ceramic fiber at mean temp (BTU-in/hr-ft2-°F)
      // At 2000°F mean: ~1.5 for 8lb, ~1.8 for 6lb, ~1.2 for board
      const kValues: Record<string, number> = {
        blanket8: 1.5, blanket6: 1.8, board: 1.2, combo: 1.4
      };
      const k = kValues[product] || 1.5;

      // R-value = thickness / k
      const rValue = wallThick / k;

      // Estimate outer shell temp: T_outer = T_inner - (T_inner - T_ambient) * (1 - 1/(1 + R*h_conv))
      // Simplified: outer temp approximately
      const ambientTemp = 70; // °F
      const outerTemp = ambientTemp + (maxTemp - ambientTemp) / (1 + rValue * 1.5);

      // Weight: density x volume
      const densities: Record<string, number> = {
        blanket8: 8, blanket6: 6, board: 16, combo: 10
      };
      const density = densities[product] || 8; // lb/cu ft
      const totalVolCuFt = (totalInteriorSqFt * wallThick) / 12;
      const totalWeight = totalVolCuFt * density;

      document.getElementById('cf2-total')!.textContent = Math.round(totalSqFt) + ' sq ft';
      document.getElementById('cf2-wall-area')!.textContent = (wallArea / 144).toFixed(1) + ' sq ft';
      document.getElementById('cf2-top-area')!.textContent = ((topArea + bottomArea) / 144).toFixed(1) + ' sq ft';
      document.getElementById('cf2-layers')!.textContent = numLayers + ' x ' + layerThick + '"';
      document.getElementById('cf2-rvalue')!.textContent = 'R-' + rValue.toFixed(1);
      document.getElementById('cf2-outer')!.textContent = '~' + Math.round(outerTemp) + '°F';
      document.getElementById('cf2-weight')!.textContent = Math.round(totalWeight) + ' lbs';

      // Notes
      const notes = [];
      if (outerTemp > 200) notes.push('Outer shell will be very hot (' + Math.round(outerTemp) + '°F). Consider adding more insulation or a ventilated outer shell.');
      if (outerTemp <= 200) notes.push('Good insulation - outer shell should stay below 200°F.');
      if (maxTemp > 2300 && product !== 'blanket8' && product !== 'board') notes.push('Use 8 lb density or board for high-temperature applications.');
      notes.push('Standard ceramic fiber blanket rolls are 24" wide x 25 ft long x 1" thick (50 sq ft per roll).');
      document.getElementById('cf2-notes')!.textContent = notes.join(' ');

      document.dispatchEvent(new CustomEvent('calc-update'));
    }

    setTimeout(() => {
      document.querySelectorAll('.cf2-in').forEach(el => {
        el.addEventListener('input', calcCF2);
        el.addEventListener('change', calcCF2);
      });
      calcCF2();
    }, 50);
  </script>
</CalculatorLayout>
