---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';

const title = "Power of Attorney Cost Calculator - Fees & Timeline";
const description = "Estimate the cost of creating a power of attorney by type, state, and whether you use an attorney or DIY approach.";

const relatedCalcs = [
  { name: "Notary Fee", url: "/notary-fee-calculator", description: "Notary costs." },
  { name: "Estate Planning", url: "/estate-planning-calculator", description: "Estate planning." },
  { name: "Life Insurance", url: "/life-insurance-calculator", description: "Life coverage." },
  { name: "Divorce Cost", url: "/divorce-cost-calculator", description: "Divorce expenses." },
  { name: "Net Worth", url: "/net-worth-calculator", description: "Track net worth." },
  { name: "Budget Calculator", url: "/budget-calculator", description: "Budget planning." },
];
---

<CalculatorLayout title={title} description={description} calculatorName="Power of Attorney Cost Calculator" keywords="power of attorney calculator, POA cost, durable power of attorney, medical power of attorney, legal fees, POA filing" breadcrumbs={[{ name: "Power of Attorney", url: "/power-of-attorney-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Power of Attorney Cost Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Estimate the cost of establishing a power of attorney based on type, complexity, and preparation method.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8">
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
        <div class="space-y-4">
          <div>
            <label class="block text-sm font-medium text-text mb-1">Type of Power of Attorney</label>
            <select id="po2-type" class="w-full px-4 py-3 border border-border rounded-xl text-lg">
              <option value="general">General POA</option>
              <option value="durable" selected>Durable POA</option>
              <option value="medical">Medical / Healthcare POA</option>
              <option value="financial">Financial POA</option>
              <option value="limited">Limited / Special POA</option>
            </select>
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Preparation Method</label>
            <select id="po2-method" class="w-full px-4 py-3 border border-border rounded-xl text-lg">
              <option value="diy">DIY (online template)</option>
              <option value="online-service">Online Legal Service</option>
              <option value="attorney" selected>Attorney</option>
            </select>
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">State Cost Level</label>
            <select id="po2-state" class="w-full px-4 py-3 border border-border rounded-xl text-lg">
              <option value="low">Low cost state</option>
              <option value="medium" selected>Average cost state</option>
              <option value="high">High cost state (CA, NY, etc.)</option>
            </select>
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Number of POA Documents</label>
            <input type="number" id="po2-count" class="w-full px-4 py-3 border border-border rounded-xl text-lg" value="1" min="1" max="5" step="1">
            <p class="text-xs text-text-muted mt-1">Many people create both a financial and medical POA</p>
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Include Notarization</label>
            <select id="po2-notary" class="w-full px-4 py-3 border border-border rounded-xl text-lg">
              <option value="yes" selected>Yes (recommended)</option>
              <option value="no">No</option>
            </select>
          </div>
        </div>

        <div class="space-y-3">
          <div class="p-6 bg-primary rounded-2xl text-white text-center">
            <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Estimated Total Cost</div>
            <div class="text-5xl font-extrabold font-mono" id="po2-total">$0</div>
          </div>
          <div class="grid grid-cols-2 gap-3">
            <div class="p-4 bg-surface-alt rounded-xl text-center">
              <div class="text-xs text-text-muted uppercase">Preparation Cost</div>
              <div class="text-xl font-bold text-secondary" id="po2-prep">$0</div>
            </div>
            <div class="p-4 bg-surface-alt rounded-xl text-center">
              <div class="text-xs text-text-muted uppercase">Filing / Recording Fees</div>
              <div class="text-xl font-bold" id="po2-filing">$0</div>
            </div>
            <div class="p-4 bg-surface-alt rounded-xl text-center">
              <div class="text-xs text-text-muted uppercase">Notarization</div>
              <div class="text-xl font-bold" id="po2-notary-fee">$0</div>
            </div>
            <div class="p-4 bg-surface-alt rounded-xl text-center">
              <div class="text-xs text-text-muted uppercase">Cost Range</div>
              <div class="text-xl font-bold" id="po2-range">$0-$0</div>
            </div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Typical Timeline</div>
            <div class="text-xl font-bold" id="po2-timeline">--</div>
          </div>
        </div>
      </div>
      <ShareButton calculatorId="power-of-attorney" />
      <FeedbackWidget />
    </div>

    <article class="mt-12 max-w-4xl prose prose-slate">
      <h2 class="text-2xl font-bold text-text">Types of Power of Attorney</h2>
      <p><strong>General POA</strong> gives broad authority. <strong>Durable POA</strong> remains in effect if you become incapacitated. <strong>Medical/Healthcare POA</strong> designates someone for health decisions. <strong>Financial POA</strong> covers financial matters. <strong>Limited POA</strong> covers specific transactions.</p>
      <h3 class="text-xl font-semibold text-text mt-8">Attorney vs. DIY</h3>
      <p>A simple POA can be created using online templates ($0-$35), but an attorney ($150-$500) ensures the document meets your state's requirements and addresses your specific needs. For complex situations, professional preparation is recommended.</p>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    const fmt = (n: number) => '$' + Math.round(n).toLocaleString();

    function calcPO2() {
      const poaType = (document.getElementById('po2-type') as HTMLSelectElement).value;
      const method = (document.getElementById('po2-method') as HTMLSelectElement).value;
      const stateLevel = (document.getElementById('po2-state') as HTMLSelectElement).value;
      const count = parseInt((document.getElementById('po2-count') as HTMLInputElement).value) || 1;
      const includeNotary = (document.getElementById('po2-notary') as HTMLSelectElement).value === 'yes';

      // Base preparation cost by method
      const methodCosts: Record<string, number> = {
        diy: 15,
        'online-service': 75,
        attorney: 300
      };
      let prepCost = methodCosts[method] || 75;

      // Type complexity adjustment
      const typeMultiplier: Record<string, number> = {
        general: 0.8,
        durable: 1.0,
        medical: 0.9,
        financial: 1.1,
        limited: 0.7
      };
      prepCost *= typeMultiplier[poaType] || 1.0;

      // State cost adjustment
      const stateMultiplier: Record<string, number> = { low: 0.75, medium: 1.0, high: 1.4 };
      prepCost *= stateMultiplier[stateLevel] || 1.0;

      // Multiply by document count (discount for additional docs with attorney)
      if (count > 1 && method === 'attorney') {
        prepCost = prepCost + prepCost * (count - 1) * 0.6; // 40% discount on additional
      } else {
        prepCost *= count;
      }

      // Filing/recording fees
      const filingFee = 25 * count;

      // Notarization
      const notaryFee = includeNotary ? 15 * count : 0;

      const total = prepCost + filingFee + notaryFee;

      // Cost range (Â±30%)
      const low = Math.round(total * 0.7);
      const high = Math.round(total * 1.3);

      // Timeline
      let timeline = '';
      if (method === 'diy') timeline = '1-2 days';
      else if (method === 'online-service') timeline = '1-3 days';
      else timeline = '1-2 weeks';

      document.getElementById('po2-total')!.textContent = fmt(total);
      document.getElementById('po2-prep')!.textContent = fmt(prepCost);
      document.getElementById('po2-filing')!.textContent = fmt(filingFee);
      document.getElementById('po2-notary-fee')!.textContent = fmt(notaryFee);
      document.getElementById('po2-range')!.textContent = fmt(low) + ' - ' + fmt(high);
      document.getElementById('po2-timeline')!.textContent = timeline;

      document.dispatchEvent(new CustomEvent('calc-update'));
    }

    setTimeout(() => {
      ['po2-count'].forEach(id => {
        const el = document.getElementById(id);
        if (el) { el.addEventListener('input', calcPO2); el.addEventListener('change', calcPO2); }
      });
      ['po2-type', 'po2-method', 'po2-state', 'po2-notary'].forEach(id => {
        const el = document.getElementById(id);
        if (el) { el.addEventListener('change', calcPO2); }
      });
      calcPO2();
    }, 50);
  </script>
</CalculatorLayout>
