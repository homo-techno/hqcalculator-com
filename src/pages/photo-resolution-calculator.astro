---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Photo Resolution Calculator - Megapixels, Aspect Ratio & File Size";
const description = "Calculate megapixels from image dimensions, find aspect ratios, and estimate file sizes for RAW, JPEG, and TIFF formats.";
const relatedCalcs = [
  { name: "Print Size", url: "/print-size-calculator", description: "Print dimensions from megapixels." },
  { name: "Aspect Ratio", url: "/aspect-ratio-calculator", description: "Aspect ratio calculations." },
  { name: "Pixel Calculator", url: "/pixel-calculator", description: "Pixel conversions." },
  { name: "Camera Sensor", url: "/camera-sensor-calculator", description: "Sensor sizes and crop." },
  { name: "Data Storage", url: "/data-storage-converter", description: "Storage unit conversions." },
  { name: "Screen Size", url: "/screen-size-calculator", description: "Display dimensions." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Photo Resolution Calculator" keywords="photo resolution calculator, megapixels calculator, image file size, RAW JPEG TIFF size, pixel dimensions, aspect ratio" breadcrumbs={[{ name: "Photo Resolution", url: "/photo-resolution-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Photo Resolution Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate megapixels from dimensions and estimate file sizes across different formats.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-text mb-1">Quick Presets</label>
          <div class="flex flex-wrap gap-2">
            <button class="pr2-preset px-3 py-1.5 rounded-lg text-xs font-semibold border border-border hover:bg-surface-alt" data-w="8256" data-h="5504">45 MP</button>
            <button class="pr2-preset px-3 py-1.5 rounded-lg text-xs font-semibold border border-border hover:bg-surface-alt" data-w="6000" data-h="4000">24 MP</button>
            <button class="pr2-preset px-3 py-1.5 rounded-lg text-xs font-semibold border border-border hover:bg-surface-alt" data-w="5472" data-h="3648">20 MP</button>
            <button class="pr2-preset px-3 py-1.5 rounded-lg text-xs font-semibold border border-border hover:bg-surface-alt" data-w="4000" data-h="3000">12 MP</button>
            <button class="pr2-preset px-3 py-1.5 rounded-lg text-xs font-semibold border border-border hover:bg-surface-alt" data-w="3840" data-h="2160">4K UHD</button>
            <button class="pr2-preset px-3 py-1.5 rounded-lg text-xs font-semibold border border-border hover:bg-surface-alt" data-w="1920" data-h="1080">1080p</button>
          </div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="block text-sm font-medium text-text mb-1">Width (pixels)</label>
            <input type="number" id="pr2-width" class="pr2-in w-full px-4 py-3 border border-border rounded-xl text-lg" value="6000" min="1" step="1">
          </div>
          <div>
            <label class="block text-sm font-medium text-text mb-1">Height (pixels)</label>
            <input type="number" id="pr2-height" class="pr2-in w-full px-4 py-3 border border-border rounded-xl text-lg" value="4000" min="1" step="1">
          </div>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Bit Depth</label>
          <select id="pr2-bits" class="pr2-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="8">8-bit (JPEG)</option>
            <option value="12">12-bit (RAW)</option>
            <option value="14" selected>14-bit (RAW)</option>
            <option value="16">16-bit (TIFF/RAW)</option>
          </select>
        </div>

        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Total Resolution</div>
          <div class="text-4xl font-extrabold" id="pr2-mp"></div>
          <div class="text-sm text-blue-200 mt-1" id="pr2-total"></div>
        </div>

        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-secondary uppercase tracking-wide">Aspect Ratio</div>
            <div class="text-xl font-bold text-text" id="pr2-ratio"></div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-secondary uppercase tracking-wide">Pixel Count</div>
            <div class="text-xl font-bold text-text" id="pr2-pixels"></div>
          </div>
        </div>

        <div class="p-4 bg-surface-alt rounded-xl">
          <h4 class="font-semibold text-sm text-text mb-2">Estimated File Sizes</h4>
          <div class="space-y-2">
            <div class="flex justify-between text-sm"><span>JPEG (high quality)</span><span class="font-bold" id="pr2-jpeg"></span></div>
            <div class="flex justify-between text-sm"><span>RAW (compressed)</span><span class="font-bold" id="pr2-raw-c"></span></div>
            <div class="flex justify-between text-sm"><span>RAW (uncompressed)</span><span class="font-bold" id="pr2-raw-u"></span></div>
            <div class="flex justify-between text-sm"><span>TIFF (uncompressed)</span><span class="font-bold" id="pr2-tiff"></span></div>
            <div class="flex justify-between text-sm"><span>PNG (lossless)</span><span class="font-bold" id="pr2-png"></span></div>
          </div>
        </div>

        <div class="p-4 bg-surface-alt rounded-xl">
          <h4 class="font-semibold text-sm text-text mb-2">Max Print Size at 300 DPI</h4>
          <div class="text-lg font-bold text-text" id="pr2-print"></div>
        </div>
      </div>
      <ShareButton calculatorId="photo-resolution" />
      <FeedbackWidget />
    </div>

    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">Understanding Photo Resolution</h2>
      <p>Megapixels (MP) are millions of pixels. A 24 MP sensor captures 24 million pixels of data. Higher megapixels allow for larger prints and more cropping flexibility.</p>
      <p><strong>File size varies by format:</strong> JPEG uses lossy compression (smallest), RAW preserves all sensor data, and TIFF is uncompressed (largest).</p>
    </article>

    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    function calcPR2() {
      const w = parseInt((document.getElementById('pr2-width') as HTMLInputElement).value) || 6000;
      const h = parseInt((document.getElementById('pr2-height') as HTMLInputElement).value) || 4000;
      const bits = parseInt((document.getElementById('pr2-bits') as HTMLSelectElement).value);

      const totalPixels = w * h;
      const mp = totalPixels / 1000000;

      document.getElementById('pr2-mp')!.textContent = mp.toFixed(1) + ' Megapixels';
      document.getElementById('pr2-total')!.textContent = w.toLocaleString() + ' x ' + h.toLocaleString() + ' pixels';
      document.getElementById('pr2-pixels')!.textContent = totalPixels.toLocaleString();

      function gcd(a: number, b: number): number {
        a = Math.abs(Math.round(a)); b = Math.abs(Math.round(b));
        while (b) { [a, b] = [b, a % b]; } return a;
      }
      const g = gcd(w, h);
      document.getElementById('pr2-ratio')!.textContent = (w / g) + ':' + (h / g);

      function fmtSize(bytes: number): string {
        if (bytes >= 1073741824) return (bytes / 1073741824).toFixed(2) + ' GB';
        return (bytes / 1048576).toFixed(1) + ' MB';
      }

      const jpegBytes = totalPixels * 3 * 0.15;
      const rawCompBytes = totalPixels * (bits / 8) * 0.6;
      const rawUncompBytes = totalPixels * (bits / 8);
      const tiffBytes = totalPixels * 3 * (bits / 8);
      const pngBytes = totalPixels * 3 * 0.55;

      document.getElementById('pr2-jpeg')!.textContent = fmtSize(jpegBytes);
      document.getElementById('pr2-raw-c')!.textContent = fmtSize(rawCompBytes);
      document.getElementById('pr2-raw-u')!.textContent = fmtSize(rawUncompBytes);
      document.getElementById('pr2-tiff')!.textContent = fmtSize(tiffBytes);
      document.getElementById('pr2-png')!.textContent = fmtSize(pngBytes);

      const printW = (w / 300).toFixed(1);
      const printH = (h / 300).toFixed(1);
      document.getElementById('pr2-print')!.textContent = printW + '" x ' + printH + '" (' + (w / 300 * 2.54).toFixed(0) + ' x ' + (h / 300 * 2.54).toFixed(0) + ' cm)';

      document.dispatchEvent(new CustomEvent('calc-update'));
    }

    setTimeout(() => {
      document.querySelectorAll('.pr2-in').forEach(el => {
        el.addEventListener('input', calcPR2);
        el.addEventListener('change', calcPR2);
      });
      document.querySelectorAll('.pr2-preset').forEach(btn => {
        btn.addEventListener('click', () => {
          (document.getElementById('pr2-width') as HTMLInputElement).value = (btn as HTMLElement).dataset.w || '6000';
          (document.getElementById('pr2-height') as HTMLInputElement).value = (btn as HTMLElement).dataset.h || '4000';
          calcPR2();
        });
      });
      calcPR2();
    }, 50);
  </script>
</CalculatorLayout>
