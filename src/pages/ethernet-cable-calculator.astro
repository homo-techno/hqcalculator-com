---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';

const title = "Ethernet Cable Calculator - Speed, Length & PoE Budget 2026";
const description = "Calculate Ethernet cable specifications including maximum length, speed ratings, PoE power budget, and cable requirements for your network installation.";

const relatedCalcs = [
  { name: "Bandwidth Calculator", url: "/bandwidth-calculator", description: "Network bandwidth requirements." },
  { name: "Network Throughput Calculator", url: "/network-throughput-calculator", description: "TCP throughput estimation." },
  { name: "Data Transfer Calculator", url: "/data-transfer-calculator", description: "File transfer time estimation." },
  { name: "Cable Attenuation Calculator", url: "/cable-attenuation-calculator", description: "Coaxial cable signal attenuation." },
  { name: "Fiber Optic Loss Calculator", url: "/fiber-optic-loss-calculator", description: "Fiber optic link loss budget." },
  { name: "IP Subnet Calculator", url: "/ip-subnet-calculator", description: "IP subnetting and CIDR." },
];
---

<CalculatorLayout
  title={title}
  description={description}
  calculatorName="Ethernet Cable Calculator"
  keywords="ethernet cable calculator, Cat5e, Cat6, Cat6a, Cat7, cable length, PoE budget, network cable, speed rating"
  breadcrumbs={[{ name: "Ethernet Cable Calculator", url: "/ethernet-cable-calculator" }]}
>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Ethernet Cable Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Determine Ethernet cable specifications, maximum supported speed at your cable length, and PoE power delivery budget.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="mb-4">
        <label class="block text-sm font-medium text-text mb-1">Cable Category</label>
        <select id="etc-cat" class="etc-in w-full px-4 py-3 border border-border rounded-xl text-lg">
          <option value="cat5e">Cat 5e</option>
          <option value="cat6" selected>Cat 6</option>
          <option value="cat6a">Cat 6a</option>
          <option value="cat7">Cat 7</option>
          <option value="cat8">Cat 8</option>
        </select>
      </div>

      <div class="mb-4">
        <label class="block text-sm font-medium text-text mb-1">Cable Run Length</label>
        <div class="flex gap-2">
          <input type="number" id="etc-length" class="etc-in flex-1 px-4 py-3 border border-border rounded-xl text-lg font-bold" value="50" step="1" min="1">
          <select id="etc-length-unit" class="etc-in px-4 py-3 border border-border rounded-xl text-lg">
            <option value="m" selected>meters</option>
            <option value="ft">feet</option>
          </select>
        </div>
      </div>

      <div class="mb-4">
        <label class="block text-sm font-medium text-text mb-1">PoE Standard</label>
        <select id="etc-poe" class="etc-in w-full px-4 py-3 border border-border rounded-xl text-lg">
          <option value="none">No PoE</option>
          <option value="af" selected>802.3af (PoE, 15.4W)</option>
          <option value="at">802.3at (PoE+, 30W)</option>
          <option value="bt3">802.3bt Type 3 (60W)</option>
          <option value="bt4">802.3bt Type 4 (90W)</option>
        </select>
      </div>

      <div class="mb-6">
        <label class="block text-sm font-medium text-text mb-1">Number of PoE Devices</label>
        <input type="number" id="etc-devices" class="etc-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="10" step="1" min="0">
      </div>

      <!-- Primary Result -->
      <div class="p-6 bg-primary rounded-2xl text-white text-center mb-4">
        <div class="text-sm font-medium text-blue-100 mb-1">Maximum Speed at This Length</div>
        <div class="text-4xl font-extrabold" id="etc-speed">--</div>
      </div>

      <!-- Cable Specs -->
      <div class="space-y-2 mb-4">
        <div class="flex justify-between items-center p-3 bg-surface-alt rounded-xl">
          <span class="text-sm text-text-secondary">Cable Category</span>
          <span class="font-bold text-text" id="etc-cat-name">--</span>
        </div>
        <div class="flex justify-between items-center p-3 bg-surface-alt rounded-xl">
          <span class="text-sm text-text-secondary">Max Speed (full distance)</span>
          <span class="font-bold text-text" id="etc-max-speed">--</span>
        </div>
        <div class="flex justify-between items-center p-3 bg-surface-alt rounded-xl">
          <span class="text-sm text-text-secondary">Max Distance (standard)</span>
          <span class="font-bold text-text" id="etc-max-dist">--</span>
        </div>
        <div class="flex justify-between items-center p-3 bg-surface-alt rounded-xl">
          <span class="text-sm text-text-secondary">Frequency Rating</span>
          <span class="font-bold text-text" id="etc-freq">--</span>
        </div>
        <div class="flex justify-between items-center p-3 bg-surface-alt rounded-xl">
          <span class="text-sm text-text-secondary">Length Status</span>
          <span class="font-bold" id="etc-status">--</span>
        </div>
      </div>

      <!-- PoE Stats -->
      <div class="grid grid-cols-2 gap-4 mb-6">
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted mb-1">PoE per Port</div>
          <div class="text-xl font-bold text-text" id="etc-poe-port">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted mb-1">Total PoE Budget</div>
          <div class="text-xl font-bold text-text" id="etc-poe-total">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted mb-1">Cable Resistance Loss</div>
          <div class="text-xl font-bold text-text" id="etc-resistance">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted mb-1">Delivered Power (est.)</div>
          <div class="text-xl font-bold text-text" id="etc-delivered">--</div>
        </div>
      </div>

      <ShareButton calculatorId="ethernet-cable" />
      <FeedbackWidget />
    </div>

    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">Ethernet Cable Standards</h2>
      <p>Ethernet cable categories define maximum data rates and bandwidth at specified distances. All copper Ethernet cables have a standard maximum length of 100 meters (328 feet) for a complete channel, though some higher categories have shorter limits for maximum speeds.</p>
      <p>Power over Ethernet (PoE) delivers DC power over the same cable as data. The cable resistance causes some power loss, which increases with length. For long runs, higher-wattage PoE standards or thicker cable (lower AWG) may be needed.</p>
    </article>

    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    function calcETC() {
      const cat = (document.getElementById('etc-cat') as HTMLSelectElement).value;
      const lengthVal = parseFloat((document.getElementById('etc-length') as HTMLInputElement).value) || 1;
      const lengthUnit = (document.getElementById('etc-length-unit') as HTMLSelectElement).value;
      const poe = (document.getElementById('etc-poe') as HTMLSelectElement).value;
      const devices = parseFloat((document.getElementById('etc-devices') as HTMLInputElement).value) || 0;

      let lengthM = lengthVal;
      if (lengthUnit === 'ft') lengthM = lengthVal * 0.3048;

      const specs: Record<string, { name: string; maxSpeed: string; maxDist: number; freq: string; speedGbps: number; highSpeedDist?: number; highSpeed?: string }> = {
        cat5e: { name: 'Cat 5e', maxSpeed: '1 Gbps', maxDist: 100, freq: '100 MHz', speedGbps: 1 },
        cat6: { name: 'Cat 6', maxSpeed: '1 Gbps (10G at 55m)', maxDist: 100, freq: '250 MHz', speedGbps: 1, highSpeedDist: 55, highSpeed: '10 Gbps' },
        cat6a: { name: 'Cat 6a', maxSpeed: '10 Gbps', maxDist: 100, freq: '500 MHz', speedGbps: 10 },
        cat7: { name: 'Cat 7', maxSpeed: '10 Gbps', maxDist: 100, freq: '600 MHz', speedGbps: 10 },
        cat8: { name: 'Cat 8', maxSpeed: '25/40 Gbps', maxDist: 30, freq: '2000 MHz', speedGbps: 40, highSpeedDist: 30, highSpeed: '25/40 Gbps' },
      };

      const spec = specs[cat] || specs.cat6;

      // Determine speed at given length
      let currentSpeed = spec.maxSpeed;
      if (cat === 'cat6' && lengthM <= 55) {
        currentSpeed = '10 Gbps';
      } else if (cat === 'cat6' && lengthM <= 100) {
        currentSpeed = '1 Gbps';
      } else if (cat === 'cat8' && lengthM <= 30) {
        currentSpeed = '25/40 Gbps';
      } else if (cat === 'cat8' && lengthM <= 100) {
        currentSpeed = '10 Gbps';
      }

      const withinLimit = lengthM <= spec.maxDist;
      const statusEl = document.getElementById('etc-status')!;
      if (withinLimit) {
        statusEl.textContent = 'Within limits (' + lengthM.toFixed(1) + 'm / ' + spec.maxDist + 'm)';
        statusEl.className = 'font-bold text-green-600';
      } else {
        statusEl.textContent = 'Exceeds max! (' + lengthM.toFixed(1) + 'm > ' + spec.maxDist + 'm)';
        statusEl.className = 'font-bold text-red-500';
        currentSpeed = 'Not supported';
      }

      document.getElementById('etc-speed')!.textContent = currentSpeed;
      document.getElementById('etc-cat-name')!.textContent = spec.name;
      document.getElementById('etc-max-speed')!.textContent = spec.maxSpeed;
      document.getElementById('etc-max-dist')!.textContent = spec.maxDist + 'm (' + (spec.maxDist * 3.28084).toFixed(0) + ' ft)';
      document.getElementById('etc-freq')!.textContent = spec.freq;

      // PoE calculations
      const poeWatts: Record<string, number> = { none: 0, af: 15.4, at: 30, bt3: 60, bt4: 90 };
      const poePerPort = poeWatts[poe] || 0;
      const totalPoe = poePerPort * devices;

      // Cable resistance: Cat5e/6 ~9.38 ohm/100m per pair, 4 pairs used
      // Power loss = I^2 * R, where R = resistance * length * 2 (round trip) / pairs
      const resistancePer100m = 9.38; // ohm per 100m per pair
      const cableResistance = (resistancePer100m * lengthM / 100) * 2 / 2; // 2 pairs for PoE, round trip
      const powerLossPct = poePerPort > 0 ? (cableResistance / (cableResistance + 25)) * 100 : 0; // simplified model
      const deliveredPower = poePerPort * (1 - powerLossPct / 100);

      document.getElementById('etc-poe-port')!.textContent = poePerPort > 0 ? poePerPort + ' W' : 'N/A';
      document.getElementById('etc-poe-total')!.textContent = totalPoe > 0 ? totalPoe.toFixed(0) + ' W' : 'N/A';
      document.getElementById('etc-resistance')!.textContent = poePerPort > 0 ? powerLossPct.toFixed(1) + '%' : 'N/A';
      document.getElementById('etc-delivered')!.textContent = poePerPort > 0 ? deliveredPower.toFixed(1) + ' W' : 'N/A';

      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.etc-in').forEach(el => { el.addEventListener('input', calcETC); el.addEventListener('change', calcETC); });
      calcETC();
    }, 50);
  </script>
</CalculatorLayout>
