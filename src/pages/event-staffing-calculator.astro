---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Event Staffing Calculator - Servers, Bartenders & Crew Needed";
const description = "Calculate the number of servers, bartenders, setup crew, and coordinators needed based on guest count, event type, and service style.";
const relatedCalcs = [
  { name: "Event Budget Calculator", url: "/event-budget-calculator", description: "Total event cost breakdown." },
  { name: "Bartender Calculator", url: "/bartender-calculator", description: "Bar service quantities." },
  { name: "Catering Quantity Calculator", url: "/catering-quantity-calculator", description: "Food quantities per guest." },
  { name: "Banquet Room Calculator", url: "/banquet-room-calculator", description: "Room size for events." },
  { name: "Event Timeline Calculator", url: "/event-timeline-calculator", description: "Event schedule planner." },
  { name: "Conference Calculator", url: "/conference-calculator", description: "Conference planning needs." },
];
---

<CalculatorLayout
  title={title}
  description={description}
  calculatorName="Event Staffing Calculator"
  keywords="event staffing calculator, event staff needed, server ratio, bartender ratio, event crew, catering staff"
  breadcrumbs={[{ name: "Event Staffing", url: "/event-staffing-calculator" }]}
>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Event Staffing Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Determine how many staff members you need for a well-run event.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4 mb-6">
        <div>
          <label class="block text-sm font-medium text-text mb-1">Number of Guests</label>
          <input type="number" id="es2-guests" class="es2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="150" min="1" step="1">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Event Type</label>
          <select id="es2-type" class="es2-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="seated">Seated Dinner</option>
            <option value="buffet">Buffet</option>
            <option value="cocktail">Cocktail Party</option>
            <option value="corporate">Corporate Event</option>
            <option value="wedding">Wedding</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Service Level</label>
          <select id="es2-level" class="es2-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="standard">Standard</option>
            <option value="premium">Premium / White Glove</option>
            <option value="casual">Casual / Self-Serve</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Event Duration (hours)</label>
          <input type="number" id="es2-hours" class="es2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="5" min="1" max="12" step="0.5">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Hourly Rate per Staff ($)</label>
          <input type="number" id="es2-rate" class="es2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="25" min="10" step="1">
        </div>
      </div>

      <div class="p-6 bg-primary rounded-2xl text-white text-center mb-4">
        <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Total Staff Needed</div>
        <div class="text-5xl font-extrabold" id="es2-total">--</div>
        <div class="text-sm mt-1" id="es2-ratio">--</div>
      </div>

      <div class="grid grid-cols-2 gap-4 mb-4">
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Servers</div>
          <div class="text-xl font-bold" id="es2-servers">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Bartenders</div>
          <div class="text-xl font-bold" id="es2-bartenders">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Setup / Breakdown</div>
          <div class="text-xl font-bold" id="es2-setup">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Est. Labor Cost</div>
          <div class="text-xl font-bold" id="es2-cost">--</div>
        </div>
      </div>

      <div class="p-4 bg-surface-alt rounded-xl mb-4" id="es2-details"></div>

      <ShareButton calculatorId="event-staffing" />
      <FeedbackWidget />
    </div>

    <article class="mt-12 max-w-4xl prose prose-slate">
      <h2 class="text-2xl font-bold text-text">Event Staffing Guidelines</h2>
      <p>Standard ratios: 1 server per 20 guests for seated dinners, 1 per 30 for buffets. Premium service: 1 server per 10-12 guests. Bartenders: 1 per 50-75 guests.</p>
    </article>

    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    function calcES2() {
      const guests = parseInt((document.getElementById('es2-guests') as HTMLInputElement).value) || 1;
      const eventType = (document.getElementById('es2-type') as HTMLSelectElement).value;
      const level = (document.getElementById('es2-level') as HTMLSelectElement).value;
      const hours = parseFloat((document.getElementById('es2-hours') as HTMLInputElement).value) || 5;
      const rate = parseFloat((document.getElementById('es2-rate') as HTMLInputElement).value) || 25;

      let serverRatio = 20;
      if (eventType === 'seated') serverRatio = 20;
      else if (eventType === 'buffet') serverRatio = 30;
      else if (eventType === 'cocktail') serverRatio = 25;
      else if (eventType === 'corporate') serverRatio = 25;
      else if (eventType === 'wedding') serverRatio = 18;

      if (level === 'premium') serverRatio = Math.floor(serverRatio * 0.55);
      else if (level === 'casual') serverRatio = Math.floor(serverRatio * 1.5);

      const servers = Math.max(1, Math.ceil(guests / serverRatio));
      const bartenders = Math.max(1, Math.ceil(guests / (level === 'premium' ? 40 : 60)));
      const setupCrew = Math.max(2, Math.ceil(guests / 50));
      const kitchen = Math.max(1, Math.ceil(guests / 40));
      const coordinator = guests > 75 ? 1 : 0;
      const captains = Math.max(0, Math.floor(servers / 5));

      const totalStaff = servers + bartenders + setupCrew + kitchen + coordinator + captains;
      const totalHours = hours + 2;
      const laborCost = totalStaff * rate * totalHours;

      document.getElementById('es2-total')!.textContent = totalStaff.toString();
      document.getElementById('es2-ratio')!.textContent = '1 server per ' + serverRatio + ' guests';
      document.getElementById('es2-servers')!.textContent = servers.toString();
      document.getElementById('es2-bartenders')!.textContent = bartenders.toString();
      document.getElementById('es2-setup')!.textContent = setupCrew.toString();
      document.getElementById('es2-cost')!.textContent = '$' + Math.round(laborCost).toLocaleString();

      let details = '<h3 class="font-semibold text-sm text-text mb-2">Full Staffing Breakdown</h3><ul class="text-sm text-text-secondary space-y-1">';
      details += '<li>Servers/Waitstaff: ' + servers + '</li>';
      details += '<li>Bartenders: ' + bartenders + '</li>';
      details += '<li>Kitchen staff: ' + kitchen + '</li>';
      details += '<li>Setup/breakdown crew: ' + setupCrew + '</li>';
      if (captains > 0) details += '<li>Service captains: ' + captains + '</li>';
      if (coordinator > 0) details += '<li>Event coordinator: ' + coordinator + '</li>';
      details += '<li>Total staff hours: ' + (totalStaff * totalHours) + ' hrs (includes 2hr setup/cleanup)</li>';
      details += '<li>Estimated labor cost: $' + Math.round(laborCost).toLocaleString() + ' at $' + rate + '/hr</li>';
      details += '</ul>';
      document.getElementById('es2-details')!.innerHTML = details;

      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.es2-in').forEach(el => { el.addEventListener('input', calcES2); el.addEventListener('change', calcES2); });
      calcES2();
    }, 50);
  </script>
</CalculatorLayout>
