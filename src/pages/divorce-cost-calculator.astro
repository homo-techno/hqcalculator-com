---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';

const title = "Divorce Cost Calculator - Estimate Legal Fees & Expenses";
const description = "Estimate the cost of divorce including legal fees, mediation, court costs, and other expenses based on complexity.";

const relatedCalcs = [
  { name: "Alimony", url: "/alimony-calculator", description: "Alimony estimate." },
  { name: "Child Support", url: "/child-support-calculator", description: "Child support." },
  { name: "Budget Calculator", url: "/budget-calculator", description: "Budget planning." },
  { name: "Net Worth", url: "/net-worth-calculator", description: "Track net worth." },
  { name: "Emergency Fund", url: "/emergency-fund-calculator", description: "Emergency savings." },
  { name: "Estate Planning", url: "/estate-planning-calculator", description: "Estate planning." },
];
---

<CalculatorLayout title={title} description={description} calculatorName="Divorce Cost Calculator" keywords="divorce cost calculator, divorce expenses, legal fees, mediation cost, contested divorce, uncontested divorce" breadcrumbs={[{ name: "Divorce Cost", url: "/divorce-cost-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Divorce Cost Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Estimate the total cost of divorce based on your specific situation. Results are general estimates.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8">
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
        <div class="space-y-4">
          <div>
            <label class="block text-sm font-medium text-text mb-1">Divorce Type</label>
            <select id="dc-type" class="w-full px-4 py-3 border border-border rounded-xl text-lg">
              <option value="uncontested">Uncontested (agreement on all issues)</option>
              <option value="mediated" selected>Mediated (some disagreements)</option>
              <option value="contested">Contested (significant disputes)</option>
              <option value="high-conflict">High-Conflict (trial likely)</option>
            </select>
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Children Involved</label>
            <select id="dc-children" class="w-full px-4 py-3 border border-border rounded-xl text-lg">
              <option value="no" selected>No children</option>
              <option value="yes-agree">Yes, custody agreed</option>
              <option value="yes-dispute">Yes, custody disputed</option>
            </select>
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Property Complexity</label>
            <select id="dc-property" class="w-full px-4 py-3 border border-border rounded-xl text-lg">
              <option value="simple">Simple (few assets)</option>
              <option value="moderate" selected>Moderate (home, retirement accounts)</option>
              <option value="complex">Complex (business, multiple properties)</option>
            </select>
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">State Cost Level</label>
            <select id="dc-state" class="w-full px-4 py-3 border border-border rounded-xl text-lg">
              <option value="low">Low cost state</option>
              <option value="medium" selected>Average cost state</option>
              <option value="high">High cost state (CA, NY, etc.)</option>
            </select>
          </div>
        </div>

        <div class="space-y-3">
          <div class="p-6 bg-primary rounded-2xl text-white text-center">
            <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Estimated Total Cost</div>
            <div class="text-5xl font-extrabold font-mono" id="dc-total">$0</div>
          </div>
          <div class="grid grid-cols-2 gap-3">
            <div class="p-4 bg-surface-alt rounded-xl text-center">
              <div class="text-xs text-text-muted uppercase">Attorney Fees</div>
              <div class="text-xl font-bold text-secondary" id="dc-attorney">$0</div>
            </div>
            <div class="p-4 bg-surface-alt rounded-xl text-center">
              <div class="text-xs text-text-muted uppercase">Mediation Cost</div>
              <div class="text-xl font-bold" id="dc-mediation">$0</div>
            </div>
            <div class="p-4 bg-surface-alt rounded-xl text-center">
              <div class="text-xs text-text-muted uppercase">Court/Filing Fees</div>
              <div class="text-xl font-bold" id="dc-court">$0</div>
            </div>
            <div class="p-4 bg-surface-alt rounded-xl text-center">
              <div class="text-xs text-text-muted uppercase">Other Expenses</div>
              <div class="text-xl font-bold" id="dc-other">$0</div>
            </div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Estimated Timeline</div>
            <div class="text-xl font-bold" id="dc-timeline">--</div>
          </div>
        </div>
      </div>
      <ShareButton calculatorId="divorce-cost" />
      <FeedbackWidget />
    </div>

    <article class="mt-12 max-w-4xl prose prose-slate">
      <h2 class="text-2xl font-bold text-text">How Much Does Divorce Cost?</h2>
      <p>The average US divorce costs $7,000-$15,000 per person. Uncontested divorces can cost as little as $500-$2,000, while contested cases with trials can exceed $30,000-$100,000+. Mediation typically costs 40-60% less than litigation.</p>
      <h3 class="text-xl font-semibold text-text mt-8">Ways to Reduce Costs</h3>
      <p>Choose mediation over litigation when possible, agree on major issues before hiring attorneys, use a collaborative divorce process, and avoid using the legal process for emotional battles.</p>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    const fmt = (n: number) => '$' + Math.round(n).toLocaleString();

    function calcDC() {
      const divorceType = (document.getElementById('dc-type') as HTMLSelectElement).value;
      const children = (document.getElementById('dc-children') as HTMLSelectElement).value;
      const property = (document.getElementById('dc-property') as HTMLSelectElement).value;
      const stateLevel = (document.getElementById('dc-state') as HTMLSelectElement).value;

      // Base attorney fees by type
      const baseFees: Record<string, number> = {
        uncontested: 1500,
        mediated: 5000,
        contested: 15000,
        'high-conflict': 35000
      };
      let attorneyFees = baseFees[divorceType] || 5000;

      // Children add complexity
      if (children === 'yes-agree') attorneyFees *= 1.2;
      else if (children === 'yes-dispute') attorneyFees *= 1.8;

      // Property complexity
      if (property === 'moderate') attorneyFees *= 1.15;
      else if (property === 'complex') attorneyFees *= 1.5;

      // State cost multiplier
      const stateMultiplier: Record<string, number> = { low: 0.7, medium: 1.0, high: 1.5 };
      attorneyFees *= stateMultiplier[stateLevel] || 1.0;

      // Mediation cost
      let mediationCost = 0;
      if (divorceType === 'mediated') mediationCost = 3000;
      else if (divorceType === 'contested') mediationCost = 2000; // court-ordered
      if (children === 'yes-dispute') mediationCost += 1500;

      // Court/filing fees
      const courtFees = stateLevel === 'high' ? 450 : stateLevel === 'medium' ? 300 : 200;

      // Other (appraisals, financial analysis, counseling, etc.)
      let other = 500;
      if (property === 'complex') other += 3000; // business valuation, appraisals
      if (children === 'yes-dispute') other += 2000; // custody evaluation

      const total = attorneyFees + mediationCost + courtFees + other;

      // Timeline estimate
      let timeline = '';
      if (divorceType === 'uncontested') timeline = '2-4 months';
      else if (divorceType === 'mediated') timeline = '4-8 months';
      else if (divorceType === 'contested') timeline = '8-18 months';
      else timeline = '1-3 years';

      document.getElementById('dc-total')!.textContent = fmt(total);
      document.getElementById('dc-attorney')!.textContent = fmt(attorneyFees);
      document.getElementById('dc-mediation')!.textContent = fmt(mediationCost);
      document.getElementById('dc-court')!.textContent = fmt(courtFees);
      document.getElementById('dc-other')!.textContent = fmt(other);
      document.getElementById('dc-timeline')!.textContent = timeline;

      document.dispatchEvent(new CustomEvent('calc-update'));
    }

    setTimeout(() => {
      ['dc-type', 'dc-children', 'dc-property', 'dc-state'].forEach(id => {
        const el = document.getElementById(id);
        if (el) { el.addEventListener('change', calcDC); }
      });
      calcDC();
    }, 50);
  </script>
</CalculatorLayout>
