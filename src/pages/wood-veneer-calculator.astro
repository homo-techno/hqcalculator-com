---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';

const title = "Wood Veneer Calculator - Coverage, Sheets & Adhesive Estimator";
const description = "Calculate veneer coverage, number of sheets needed, and adhesive quantity for wood veneering projects. Supports multiple veneer sizes and adhesive types.";

const relatedCalcs = [
  { name: "Wood Finish Calculator", url: "/wood-finish-calculator", description: "Finish coverage." },
  { name: "Wood Glue Calculator", url: "/wood-glue-calculator", description: "Glue coverage." },
  { name: "Board Foot Calculator", url: "/board-foot-calculator", description: "Board feet calculator." },
  { name: "Plywood Cut Calculator", url: "/plywood-cut-calculator", description: "Plywood optimizer." },
  { name: "Wood Weight Calculator", url: "/wood-weight-calculator", description: "Wood weight estimator." },
  { name: "Wood Moisture Calculator", url: "/wood-moisture-calculator", description: "Moisture content." },
];
---

<CalculatorLayout
  title={title}
  description={description}
  calculatorName="Wood Veneer Calculator"
  keywords="veneer calculator, wood veneer, veneer coverage, veneer adhesive, veneer sheets, veneering, edgebanding"
  breadcrumbs={[{ name: "Wood Veneer Calculator", url: "/wood-veneer-calculator" }]}
>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Wood Veneer Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate veneer sheets needed, adhesive quantity, and total coverage for your veneering project.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <h3 class="text-lg font-bold text-text mb-4">Surface to Veneer</h3>
      <div class="grid grid-cols-2 gap-4 mb-5">
        <div>
          <label class="block text-sm font-medium text-text mb-2">Surface Width (inches)</label>
          <input type="number" id="wvn-sw" class="wvn-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="24" min="1" step="0.5">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-2">Surface Length (inches)</label>
          <input type="number" id="wvn-sl" class="wvn-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="48" min="1" step="0.5">
        </div>
      </div>

      <div class="grid grid-cols-2 gap-4 mb-5">
        <div>
          <label class="block text-sm font-medium text-text mb-2">Number of Surfaces</label>
          <input type="number" id="wvn-surfaces" class="wvn-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="2" min="1" max="20" step="1">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-2">Waste Factor (%)</label>
          <input type="number" id="wvn-waste" class="wvn-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="15" min="0" max="50" step="1">
        </div>
      </div>

      <h3 class="text-lg font-bold text-text mb-4">Veneer Sheet Size</h3>
      <div class="grid grid-cols-2 gap-4 mb-5">
        <div>
          <label class="block text-sm font-medium text-text mb-2">Sheet Width (inches)</label>
          <input type="number" id="wvn-vw" class="wvn-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="8" min="1" step="0.5">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-2">Sheet Length (inches)</label>
          <input type="number" id="wvn-vl" class="wvn-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="96" min="1" step="1">
        </div>
      </div>

      <div class="grid grid-cols-2 gap-4 mb-5">
        <div>
          <label class="block text-sm font-medium text-text mb-2">Adhesive Type</label>
          <select id="wvn-glue" class="wvn-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="contact" selected>Contact Cement</option>
            <option value="pva">PVA (vacuum press)</option>
            <option value="urea">Urea Formaldehyde</option>
            <option value="psa">Pressure Sensitive (PSA)</option>
            <option value="iron-on">Iron-On (pre-glued)</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-2">Price per Sheet ($)</label>
          <input type="number" id="wvn-price" class="wvn-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="4" min="0" step="0.50">
        </div>
      </div>

      <!-- Primary Result -->
      <div class="p-6 bg-primary rounded-2xl text-white text-center mb-4">
        <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Veneer Sheets Needed</div>
        <div class="text-4xl font-extrabold" id="wvn-sheets">--</div>
        <div class="text-sm text-blue-200 mt-1" id="wvn-sheets-sub">--</div>
      </div>

      <div class="grid grid-cols-2 gap-4 mb-4">
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Total Area to Cover</div>
          <div class="text-xl font-bold" id="wvn-area">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Area with Waste</div>
          <div class="text-xl font-bold" id="wvn-area-waste">--</div>
        </div>
      </div>

      <div class="grid grid-cols-2 gap-4 mb-4">
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Adhesive Needed</div>
          <div class="text-xl font-bold" id="wvn-adhesive">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Estimated Cost</div>
          <div class="text-xl font-bold text-secondary" id="wvn-cost">--</div>
        </div>
      </div>

      <div class="p-4 bg-surface-alt rounded-xl text-center mb-6">
        <div class="text-xs text-text-muted uppercase">Matching Pattern</div>
        <div class="text-sm font-bold" id="wvn-pattern">--</div>
      </div>

      <ShareButton calculatorId="wood-veneer" />
      <FeedbackWidget />
    </div>

    <article class="mt-12 max-w-4xl prose prose-slate">
      <h2 class="text-2xl font-bold text-text">Wood Veneering Guide</h2>
      <ul>
        <li><strong>Contact cement:</strong> Most common for flat panels. Apply to both surfaces, let dry, then press together.</li>
        <li><strong>PVA with vacuum press:</strong> Strongest bond, best for curved surfaces. Requires vacuum bag and pump.</li>
        <li><strong>Urea formaldehyde:</strong> Professional grade, heat-activated. Best for high-production work.</li>
        <li><strong>Iron-on veneer:</strong> Pre-glued, easiest to apply. Best for edgebanding and small repairs.</li>
      </ul>
      <h3 class="text-xl font-semibold text-text mt-8">Veneer Matching Patterns</h3>
      <ul>
        <li><strong>Book match:</strong> Alternate sheets flipped like book pages for mirror pattern</li>
        <li><strong>Slip match:</strong> Sheets laid side by side in same orientation</li>
        <li><strong>Random match:</strong> Sheets laid randomly for a natural look</li>
      </ul>
    </article>

    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    function calcWVN() {
      const surfW = parseFloat((document.getElementById('wvn-sw') as HTMLInputElement).value) || 24;
      const surfL = parseFloat((document.getElementById('wvn-sl') as HTMLInputElement).value) || 48;
      const surfaces = parseInt((document.getElementById('wvn-surfaces') as HTMLInputElement).value) || 1;
      const waste = (parseFloat((document.getElementById('wvn-waste') as HTMLInputElement).value) || 0) / 100;
      const venW = parseFloat((document.getElementById('wvn-vw') as HTMLInputElement).value) || 8;
      const venL = parseFloat((document.getElementById('wvn-vl') as HTMLInputElement).value) || 96;
      const glueType = (document.getElementById('wvn-glue') as HTMLSelectElement).value;
      const pricePerSheet = parseFloat((document.getElementById('wvn-price') as HTMLInputElement).value) || 0;

      // Total area
      const areaPerSurface = surfW * surfL;
      const totalArea = areaPerSurface * surfaces;
      const totalAreaWithWaste = totalArea * (1 + waste);

      // Veneer sheet area
      const sheetArea = venW * venL;

      // Sheets needed
      const sheetsNeeded = Math.ceil(totalAreaWithWaste / sheetArea);

      // How many strips per surface width
      const stripsPerSurface = Math.ceil(surfW / venW);
      const sheetsPerSurface = Math.ceil(surfL / venL) * stripsPerSurface;

      // Adhesive needed (coverage rates in sq in per oz)
      const adhesiveRates: Record<string, [number, string]> = {
        'contact': [40, 'oz of contact cement'],
        'pva': [50, 'oz of PVA glue'],
        'urea': [45, 'oz of urea glue'],
        'psa': [0, 'sheets (pre-applied)'],
        'iron-on': [0, '(pre-glued)'],
      };

      const rate = adhesiveRates[glueType] || adhesiveRates['contact'];
      let adhesiveText = '';
      if (rate[0] > 0) {
        const oz = totalAreaWithWaste / rate[0];
        adhesiveText = oz.toFixed(1) + ' ' + rate[1];
      } else {
        adhesiveText = rate[1];
      }

      // Pattern recommendation based on strip count
      let pattern = '';
      if (stripsPerSurface <= 2) {
        pattern = 'Book match recommended (2 sequential sheets, one flipped)';
      } else if (stripsPerSurface <= 4) {
        pattern = 'Book match or slip match (' + stripsPerSurface + ' strips per panel)';
      } else {
        pattern = 'Random match or slip match (' + stripsPerSurface + ' strips per panel)';
      }

      const cost = sheetsNeeded * pricePerSheet;

      document.getElementById('wvn-sheets')!.textContent = sheetsNeeded.toString();
      document.getElementById('wvn-sheets-sub')!.textContent = stripsPerSurface + ' strips wide x ' + surfaces + ' surface(s)';
      document.getElementById('wvn-area')!.textContent = (totalArea / 144).toFixed(1) + ' sq ft';
      document.getElementById('wvn-area-waste')!.textContent = (totalAreaWithWaste / 144).toFixed(1) + ' sq ft';
      document.getElementById('wvn-adhesive')!.textContent = adhesiveText;
      document.getElementById('wvn-cost')!.textContent = '$' + cost.toFixed(2);
      document.getElementById('wvn-pattern')!.textContent = pattern;

      document.dispatchEvent(new CustomEvent('calc-update'));
    }

    setTimeout(() => {
      document.querySelectorAll('.wvn-in').forEach(el => {
        el.addEventListener('input', calcWVN);
        el.addEventListener('change', calcWVN);
      });
      calcWVN();
    }, 50);
  </script>
</CalculatorLayout>
