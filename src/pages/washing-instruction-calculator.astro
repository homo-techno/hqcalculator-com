---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Washing Instruction Calculator - Care Label Guide";
const description = "Get care label guidance from fiber content including wash temperature, drying method, ironing temperature, shrinkage risk, and colorfastness.";
const relatedCalcs = [
  { name: "Fabric Calculator", url: "/fabric-calculator", description: "Fabric yardage needs." },
  { name: "Yarn Calculator", url: "/yarn-calculator", description: "Yarn yardage calculator." },
  { name: "Weight Converter", url: "/weight-converter", description: "Weight conversions." },
  { name: "Percentage Calculator", url: "/percentage-calculator", description: "Percentage calculations." },
  { name: "Quilt Calculator", url: "/quilt-calculator", description: "Quilt sizing math." },
  { name: "Upholstery Calculator", url: "/upholstery-calculator", description: "Upholstery fabric needs." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Washing Instruction Calculator" keywords="washing instruction calculator, care label guide, fiber content, wash temperature, shrinkage risk, colorfastness, laundry guide" breadcrumbs={[{ name: "Washing Instructions", url: "/washing-instruction-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Washing Instruction Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Get care instructions based on fiber content, including temperature limits, drying, and shrinkage risk.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div>
          <label class="block text-xs font-medium text-text mb-1">Primary Fiber (dominant)</label>
          <select id="wi-fiber1" class="wi-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
            <option value="cotton" selected>Cotton</option>
            <option value="polyester">Polyester</option>
            <option value="nylon">Nylon</option>
            <option value="wool">Wool</option>
            <option value="silk">Silk</option>
            <option value="linen">Linen</option>
            <option value="rayon">Rayon / Viscose</option>
            <option value="acrylic">Acrylic</option>
            <option value="spandex">Spandex / Elastane</option>
            <option value="cashmere">Cashmere</option>
            <option value="bamboo">Bamboo</option>
          </select>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Primary Fiber %</label><input type="number" id="wi-pct1" class="wi-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="100" min="50" max="100" step="5"></div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Secondary Fiber</label>
            <select id="wi-fiber2" class="wi-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
              <option value="none" selected>None</option>
              <option value="polyester">Polyester</option>
              <option value="spandex">Spandex / Elastane</option>
              <option value="nylon">Nylon</option>
              <option value="cotton">Cotton</option>
              <option value="wool">Wool</option>
              <option value="rayon">Rayon</option>
              <option value="silk">Silk</option>
            </select>
          </div>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Color / Print</label>
          <select id="wi-color" class="wi-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
            <option value="white">White / Light Solid</option>
            <option value="dark" selected>Dark Solid</option>
            <option value="bright">Bright / Vivid Colors</option>
            <option value="print">Printed / Multi-color</option>
          </select>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Construction</label>
          <select id="wi-construct" class="wi-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
            <option value="woven" selected>Woven</option>
            <option value="knit">Knit</option>
            <option value="delicate">Delicate / Lace</option>
            <option value="structured">Structured / Tailored</option>
          </select>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Wash Temperature</div>
          <div class="text-4xl font-extrabold font-mono" id="wi-result">--</div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Wash Cycle</div><div class="text-xl font-bold font-mono" id="wi-cycle">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Drying</div><div class="text-xl font-bold font-mono" id="wi-dry">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Iron Temp</div><div class="text-xl font-bold font-mono" id="wi-iron">--</div></div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Shrinkage Risk</div><div class="text-xl font-bold font-mono" id="wi-shrink">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Color Risk</div><div class="text-xl font-bold font-mono" id="wi-colorrisk">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Bleach</div><div class="text-xl font-bold font-mono" id="wi-bleach">--</div></div>
        </div>
      </div>
      <ShareButton calculatorId="washing-instruction" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcWI() {
      const fiber1 = (document.getElementById('wi-fiber1') as HTMLSelectElement).value;
      const fiber2 = (document.getElementById('wi-fiber2') as HTMLSelectElement).value;
      const color = (document.getElementById('wi-color') as HTMLSelectElement).value;
      const construct = (document.getElementById('wi-construct') as HTMLSelectElement).value;

      interface FiberCare {
        maxTemp: number;
        tempF: number;
        cycle: string;
        dry: string;
        iron: string;
        shrink: string;
        bleach: string;
      }

      const fiberCare: Record<string, FiberCare> = {
        cotton:    { maxTemp: 60, tempF: 140, cycle: 'Normal', dry: 'Tumble low', iron: 'High (400F)', shrink: 'Medium (3-5%)', bleach: 'Chlorine OK (white)' },
        polyester: { maxTemp: 40, tempF: 104, cycle: 'Permanent Press', dry: 'Tumble low', iron: 'Low (275F)', shrink: 'Very Low (<1%)', bleach: 'No chlorine' },
        nylon:     { maxTemp: 40, tempF: 104, cycle: 'Gentle', dry: 'Tumble low', iron: 'Low (275F)', shrink: 'Low (1-2%)', bleach: 'No chlorine' },
        wool:      { maxTemp: 30, tempF: 86, cycle: 'Wool / Hand wash', dry: 'Flat dry', iron: 'Medium (300F) with steam', shrink: 'High (5-10%)', bleach: 'No bleach' },
        silk:      { maxTemp: 30, tempF: 86, cycle: 'Hand wash', dry: 'Flat dry', iron: 'Low (275F)', shrink: 'Low (2-3%)', bleach: 'No bleach' },
        linen:     { maxTemp: 60, tempF: 140, cycle: 'Normal', dry: 'Line dry', iron: 'High (445F) damp', shrink: 'Medium (3-7%)', bleach: 'Chlorine OK (white)' },
        rayon:     { maxTemp: 30, tempF: 86, cycle: 'Gentle / Hand wash', dry: 'Flat dry', iron: 'Medium (300F)', shrink: 'High (3-8%)', bleach: 'No bleach' },
        acrylic:   { maxTemp: 40, tempF: 104, cycle: 'Gentle', dry: 'Tumble low', iron: 'Low (275F)', shrink: 'Very Low', bleach: 'No chlorine' },
        spandex:   { maxTemp: 30, tempF: 86, cycle: 'Gentle', dry: 'Line dry', iron: 'Do not iron', shrink: 'Low', bleach: 'No bleach' },
        cashmere:  { maxTemp: 30, tempF: 86, cycle: 'Hand wash', dry: 'Flat dry', iron: 'Low with cloth', shrink: 'Medium (3-5%)', bleach: 'No bleach' },
        bamboo:    { maxTemp: 40, tempF: 104, cycle: 'Gentle', dry: 'Line dry', iron: 'Medium (300F)', shrink: 'Low (2-3%)', bleach: 'No bleach' }
      };

      let care = fiberCare[fiber1] || fiberCare['cotton'];

      // If secondary fiber is more delicate, use lower temp
      if (fiber2 !== 'none') {
        const care2 = fiberCare[fiber2];
        if (care2 && care2.maxTemp < care.maxTemp) {
          care = { ...care, maxTemp: care2.maxTemp, tempF: care2.tempF };
          if (care2.cycle.includes('Hand') || care2.cycle.includes('Gentle')) care.cycle = care2.cycle;
          if (care2.dry.includes('Flat')) care.dry = care2.dry;
          if (care2.bleach.includes('No')) care.bleach = care2.bleach;
        }
      }

      // Construction overrides
      if (construct === 'delicate') {
        care.cycle = 'Hand wash / Delicate';
        if (care.maxTemp > 30) { care.maxTemp = 30; care.tempF = 86; }
      } else if (construct === 'structured') {
        care.dry = 'Hang dry / Shape';
      }

      // Color adjustments
      let colorRisk = 'Low';
      if (color === 'dark') { colorRisk = 'Medium'; care.cycle = care.cycle.includes('Hand') ? care.cycle : 'Cold wash, inside out'; }
      else if (color === 'bright') { colorRisk = 'High'; }
      else if (color === 'print') { colorRisk = 'Medium-High'; }

      if (color !== 'white') {
        care.bleach = 'No bleach';
        if (care.maxTemp > 40) { care.maxTemp = 40; care.tempF = 104; }
      }

      document.getElementById('wi-result')!.textContent = care.maxTemp + '\u00B0C / ' + care.tempF + '\u00B0F';
      document.getElementById('wi-cycle')!.textContent = care.cycle;
      document.getElementById('wi-dry')!.textContent = care.dry;
      document.getElementById('wi-iron')!.textContent = care.iron;
      document.getElementById('wi-shrink')!.textContent = care.shrink;
      document.getElementById('wi-colorrisk')!.textContent = colorRisk;
      document.getElementById('wi-bleach')!.textContent = care.bleach;
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.wi-in').forEach(el => { el.addEventListener('input', calcWI); el.addEventListener('change', calcWI); });
      calcWI();
    }, 50);
  </script>
</CalculatorLayout>
