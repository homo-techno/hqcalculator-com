---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';

const title = "GPA Calculator - Free Grade Point Average Calculator 2026";
const description = "Calculate your GPA instantly. Add courses, credits, and grades. Supports 4.0 scale, weighted GPA, cumulative GPA. Free for college and high school students.";

const relatedCalcs = [
  { name: "Percentage Calculator", url: "/percentage-calculator", description: "Calculate percentages easily." },
  { name: "Fraction Calculator", url: "/fraction-calculator", description: "Add, subtract, multiply fractions." },
  { name: "Scientific Calculator", url: "/scientific-calculator", description: "Advanced math operations." },
  { name: "Age Calculator", url: "/age-calculator", description: "Calculate your exact age." },
  { name: "GCF Calculator", url: "/gcf-calculator", description: "Greatest common factor." },
  { name: "LCM Calculator", url: "/lcm-calculator", description: "Least common multiple." },
];
---

<CalculatorLayout
  title={title}
  description={description}
  calculatorName="GPA Calculator"
  keywords="gpa calculator, grade point average, college gpa calculator, cumulative gpa, weighted gpa, 4.0 scale gpa"
  breadcrumbs={[{ name: "GPA Calculator", url: "/gpa-calculator" }]}
>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">GPA Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate your semester or cumulative GPA. Add your courses, credits, and grades below.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8">
      <!-- GPA Result Banner -->
      <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-8">
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Semester GPA</div>
          <div class="text-4xl sm:text-5xl font-extrabold" id="gpa-semester">0.00</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center flex flex-col justify-center">
          <div class="text-xs text-text-muted uppercase">Total Credits</div>
          <div class="text-2xl font-bold" id="gpa-credits">0</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center flex flex-col justify-center">
          <div class="text-xs text-text-muted uppercase">Quality Points</div>
          <div class="text-2xl font-bold" id="gpa-points">0.00</div>
        </div>
      </div>

      <!-- Course Table -->
      <div class="overflow-x-auto mb-4">
        <table class="w-full text-sm" id="gpa-table">
          <thead>
            <tr class="border-b border-border text-left">
              <th class="py-2 pr-2 font-semibold w-2/5">Course Name</th>
              <th class="py-2 pr-2 font-semibold w-1/5">Credits</th>
              <th class="py-2 pr-2 font-semibold w-1/5">Grade</th>
              <th class="py-2 pr-2 font-semibold w-1/10 text-right">Points</th>
              <th class="py-2 w-8"></th>
            </tr>
          </thead>
          <tbody id="gpa-tbody"></tbody>
        </table>
      </div>

      <button id="gpa-add-btn" class="px-4 py-2 bg-primary text-white rounded-lg text-sm font-semibold hover:bg-primary/90 transition-colors">
        + Add Course
      </button>

      <!-- Cumulative GPA Section -->
      <div class="mt-8 pt-6 border-t border-border">
        <h3 class="font-semibold text-text mb-4">Cumulative GPA (Optional)</h3>
        <p class="text-sm text-text-secondary mb-4">Enter your current cumulative GPA and total credits to calculate your new cumulative GPA.</p>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4">
          <div>
            <label class="block text-sm font-medium text-text mb-1">Current Cumulative GPA</label>
            <input type="number" id="gpa-cum-current" class="w-full px-3 py-2 border border-border rounded-lg" placeholder="3.50" step="0.01" min="0" max="4">
          </div>
          <div>
            <label class="block text-sm font-medium text-text mb-1">Total Credits Earned</label>
            <input type="number" id="gpa-cum-credits" class="w-full px-3 py-2 border border-border rounded-lg" placeholder="60" step="1" min="0">
          </div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">New Cumulative GPA</div>
          <div class="text-3xl font-bold text-primary" id="gpa-cumulative">—</div>
        </div>
      </div>

      <div class="mt-6">
        <ShareButton calculatorId="gpa" />
        <FeedbackWidget />
      </div>
    </div>

    <!-- GPA Scale Reference -->
    <div class="mt-12 bg-white border border-border rounded-2xl p-6 sm:p-8">
      <h2 class="text-2xl font-bold text-text mb-4">GPA Scale Reference</h2>
      <div class="overflow-x-auto">
        <table class="w-full text-sm">
          <thead>
            <tr class="border-b border-border text-left">
              <th class="py-2 pr-3 font-semibold">Letter Grade</th>
              <th class="py-2 pr-3 font-semibold">Grade Points</th>
              <th class="py-2 pr-3 font-semibold">Percentage</th>
              <th class="py-2 font-semibold">Description</th>
            </tr>
          </thead>
          <tbody class="text-text-secondary">
            <tr class="border-b border-border/30"><td class="py-2 pr-3 font-medium text-primary">A+</td><td class="py-2 pr-3">4.0</td><td class="py-2 pr-3">97-100%</td><td class="py-2">Exceptional</td></tr>
            <tr class="border-b border-border/30"><td class="py-2 pr-3 font-medium text-primary">A</td><td class="py-2 pr-3">4.0</td><td class="py-2 pr-3">93-96%</td><td class="py-2">Excellent</td></tr>
            <tr class="border-b border-border/30"><td class="py-2 pr-3 font-medium">A-</td><td class="py-2 pr-3">3.7</td><td class="py-2 pr-3">90-92%</td><td class="py-2">Very Good</td></tr>
            <tr class="border-b border-border/30"><td class="py-2 pr-3 font-medium">B+</td><td class="py-2 pr-3">3.3</td><td class="py-2 pr-3">87-89%</td><td class="py-2">Good</td></tr>
            <tr class="border-b border-border/30"><td class="py-2 pr-3 font-medium">B</td><td class="py-2 pr-3">3.0</td><td class="py-2 pr-3">83-86%</td><td class="py-2">Above Average</td></tr>
            <tr class="border-b border-border/30"><td class="py-2 pr-3 font-medium">B-</td><td class="py-2 pr-3">2.7</td><td class="py-2 pr-3">80-82%</td><td class="py-2">Satisfactory</td></tr>
            <tr class="border-b border-border/30"><td class="py-2 pr-3 font-medium">C+</td><td class="py-2 pr-3">2.3</td><td class="py-2 pr-3">77-79%</td><td class="py-2">Average</td></tr>
            <tr class="border-b border-border/30"><td class="py-2 pr-3 font-medium">C</td><td class="py-2 pr-3">2.0</td><td class="py-2 pr-3">73-76%</td><td class="py-2">Satisfactory</td></tr>
            <tr class="border-b border-border/30"><td class="py-2 pr-3 font-medium">C-</td><td class="py-2 pr-3">1.7</td><td class="py-2 pr-3">70-72%</td><td class="py-2">Below Average</td></tr>
            <tr class="border-b border-border/30"><td class="py-2 pr-3 font-medium">D+</td><td class="py-2 pr-3">1.3</td><td class="py-2 pr-3">67-69%</td><td class="py-2">Poor</td></tr>
            <tr class="border-b border-border/30"><td class="py-2 pr-3 font-medium">D</td><td class="py-2 pr-3">1.0</td><td class="py-2 pr-3">63-66%</td><td class="py-2">Below Standard</td></tr>
            <tr class="border-b border-border/30"><td class="py-2 pr-3 font-medium">D-</td><td class="py-2 pr-3">0.7</td><td class="py-2 pr-3">60-62%</td><td class="py-2">Barely Passing</td></tr>
            <tr><td class="py-2 pr-3 font-medium text-danger">F</td><td class="py-2 pr-3">0.0</td><td class="py-2 pr-3">0-59%</td><td class="py-2">Failing</td></tr>
          </tbody>
        </table>
      </div>
    </div>

    <article class="mt-12 max-w-4xl prose prose-slate">
      <h2 class="text-2xl font-bold text-text">How GPA Is Calculated</h2>
      <p>Your Grade Point Average (GPA) is a numerical representation of your academic performance. It's calculated by dividing the total number of quality points by the total number of credit hours attempted.</p>

      <div class="bg-surface-alt rounded-xl p-4 my-4 text-center font-mono">
        GPA = Total Quality Points / Total Credit Hours
      </div>
      <p>Quality points for each course = Grade Points × Credit Hours. For example, an A (4.0) in a 3-credit course = 4.0 × 3 = 12.0 quality points.</p>

      <h3 class="text-xl font-semibold text-text mt-8">Semester vs. Cumulative GPA</h3>
      <ul>
        <li><strong>Semester GPA:</strong> Calculated using only the courses from one semester.</li>
        <li><strong>Cumulative GPA:</strong> Calculated using all courses taken throughout your academic career. This is the GPA that appears on your transcript.</li>
      </ul>

      <h3 class="text-xl font-semibold text-text mt-8">What Is a Good GPA?</h3>
      <ul>
        <li><strong>3.7 - 4.0:</strong> Summa Cum Laude range, top of the class</li>
        <li><strong>3.5 - 3.69:</strong> Magna Cum Laude, Dean's List at most schools</li>
        <li><strong>3.0 - 3.49:</strong> Above average, Cum Laude at 3.0+</li>
        <li><strong>2.5 - 2.99:</strong> Average, meets minimum requirements for most programs</li>
        <li><strong>2.0 - 2.49:</strong> Below average, minimum to graduate at most institutions</li>
        <li><strong>Below 2.0:</strong> Academic probation at most schools</li>
      </ul>

      <h3 class="text-xl font-semibold text-text mt-8">Tips to Improve Your GPA</h3>
      <ul>
        <li><strong>Prioritize high-credit courses:</strong> Courses with more credits have a bigger impact on your GPA.</li>
        <li><strong>Use grade replacement:</strong> Many schools allow you to retake courses and replace the old grade.</li>
        <li><strong>Start strong:</strong> Getting a high GPA early makes it easier to maintain.</li>
        <li><strong>Balance your schedule:</strong> Mix challenging and easier courses each semester.</li>
        <li><strong>Seek help early:</strong> Use tutoring, office hours, and study groups before falling behind.</li>
      </ul>

      <h3 class="text-xl font-semibold text-text mt-8">Frequently Asked Questions</h3>
      <p><strong>Is a 3.5 GPA good?</strong> Yes, a 3.5 GPA is considered very good. It typically places you on the Dean's List and qualifies you for Magna Cum Laude honors at many universities.</p>
      <p><strong>Do all schools use the 4.0 scale?</strong> Most US colleges and universities use the standard 4.0 scale. Some high schools use weighted GPAs that go up to 5.0 for honors and AP courses.</p>
      <p><strong>Does GPA matter for jobs?</strong> GPA matters most for your first job after graduation, especially in competitive fields like finance, consulting, and engineering. After a few years of work experience, employers focus more on your skills and achievements.</p>
    </article>

    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    const gradePoints: Record<string, number> = {
      'A+': 4.0, 'A': 4.0, 'A-': 3.7,
      'B+': 3.3, 'B': 3.0, 'B-': 2.7,
      'C+': 2.3, 'C': 2.0, 'C-': 1.7,
      'D+': 1.3, 'D': 1.0, 'D-': 0.7,
      'F': 0.0
    };

    const gradeOptions = Object.keys(gradePoints).map(g =>
      `<option value="${g}">${g} (${gradePoints[g].toFixed(1)})</option>`
    ).join('');

    let courseCount = 0;

    function addCourse(name = '', credits = '3', grade = 'A') {
      courseCount++;
      const tbody = document.getElementById('gpa-tbody')!;
      const tr = document.createElement('tr');
      tr.className = 'border-b border-border/30 gpa-row';
      tr.dataset.id = String(courseCount);
      tr.innerHTML = `
        <td class="py-2 pr-2">
          <input type="text" class="w-full px-2 py-1.5 border border-border rounded-lg text-sm gpa-name" placeholder="Course ${courseCount}" value="${name}">
        </td>
        <td class="py-2 pr-2">
          <input type="number" class="w-full px-2 py-1.5 border border-border rounded-lg text-sm gpa-credit" min="0" max="12" step="1" value="${credits}">
        </td>
        <td class="py-2 pr-2">
          <select class="w-full px-2 py-1.5 border border-border rounded-lg text-sm gpa-grade">
            ${gradeOptions}
          </select>
        </td>
        <td class="py-2 pr-2 text-right font-medium gpa-row-points">${(gradePoints[grade] * parseInt(credits)).toFixed(1)}</td>
        <td class="py-2 text-center">
          <button class="text-text-muted hover:text-danger transition-colors gpa-remove" title="Remove course">&times;</button>
        </td>
      `;
      tbody.appendChild(tr);

      // Set selected grade
      const select = tr.querySelector('.gpa-grade') as HTMLSelectElement;
      select.value = grade;

      // Events
      tr.querySelector('.gpa-credit')!.addEventListener('input', calcGPA);
      tr.querySelector('.gpa-grade')!.addEventListener('change', calcGPA);
      tr.querySelector('.gpa-remove')!.addEventListener('click', () => {
        tr.remove();
        calcGPA();
      });

      calcGPA();
    }

    function calcGPA() {
      const rows = document.querySelectorAll('.gpa-row');
      let totalPoints = 0;
      let totalCredits = 0;

      rows.forEach(row => {
        const credits = parseFloat((row.querySelector('.gpa-credit') as HTMLInputElement).value) || 0;
        const grade = (row.querySelector('.gpa-grade') as HTMLSelectElement).value;
        const points = gradePoints[grade] * credits;
        (row.querySelector('.gpa-row-points') as HTMLElement).textContent = points.toFixed(1);
        totalPoints += points;
        totalCredits += credits;
      });

      const semesterGPA = totalCredits > 0 ? totalPoints / totalCredits : 0;

      document.getElementById('gpa-semester')!.textContent = semesterGPA.toFixed(2);
      document.getElementById('gpa-credits')!.textContent = String(totalCredits);
      document.getElementById('gpa-points')!.textContent = totalPoints.toFixed(2);

      // Color the GPA
      const gpaEl = document.getElementById('gpa-semester')!;
      gpaEl.parentElement!.className = 'p-6 rounded-2xl text-white text-center ' +
        (semesterGPA >= 3.5 ? 'bg-primary' : semesterGPA >= 3.0 ? 'bg-secondary' : semesterGPA >= 2.0 ? 'bg-accent' : 'bg-danger');

      // Cumulative GPA
      const cumGPA = parseFloat((document.getElementById('gpa-cum-current') as HTMLInputElement).value) || 0;
      const cumCredits = parseFloat((document.getElementById('gpa-cum-credits') as HTMLInputElement).value) || 0;

      if (cumGPA > 0 && cumCredits > 0 && totalCredits > 0) {
        const cumPoints = cumGPA * cumCredits;
        const newCumGPA = (cumPoints + totalPoints) / (cumCredits + totalCredits);
        document.getElementById('gpa-cumulative')!.textContent = newCumGPA.toFixed(2);
      } else {
        document.getElementById('gpa-cumulative')!.textContent = '—';
      }

      document.dispatchEvent(new CustomEvent('calc-update'));
    }

    setTimeout(() => {
      document.getElementById('gpa-add-btn')!.addEventListener('click', () => addCourse());

      document.getElementById('gpa-cum-current')!.addEventListener('input', calcGPA);
      document.getElementById('gpa-cum-credits')!.addEventListener('input', calcGPA);

      // Start with 4 default courses
      addCourse('', '3', 'A');
      addCourse('', '3', 'B+');
      addCourse('', '4', 'A-');
      addCourse('', '3', 'B');
    }, 50);
  </script>
</CalculatorLayout>
