---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Small Claims Calculator - Court Limits, Fees & Recovery";
const description = "Calculate small claims court filing fees, jurisdiction limits, and potential net recovery based on claim amount and state limits.";
const relatedCalcs = [
  { name: "Court Fee Calculator", url: "/court-fee-calculator", description: "Court filing fees." },
  { name: "Legal Fee Calculator", url: "/legal-fee-calculator", description: "Lawyer cost estimates." },
  { name: "Litigation Cost Calculator", url: "/litigation-cost-calculator", description: "Total litigation costs." },
  { name: "Contract Value Calculator", url: "/contract-value-calculator", description: "Contract valuation." },
  { name: "Arbitration Cost Calculator", url: "/arbitration-cost-calculator", description: "ADR cost comparison." },
  { name: "Legal Billing Calculator", url: "/legal-billing-calculator", description: "Track legal costs." },
];
---

<CalculatorLayout title={title} description={description} calculatorName="Small Claims Calculator" keywords="small claims calculator, small claims court, filing fee, claim limit, court costs, net recovery, small claims limit" breadcrumbs={[{ name: "Small Claims", url: "/small-claims-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Small Claims Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Estimate small claims court costs, limits, and your potential net recovery.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-text mb-1">Claim Amount ($)</label>
          <input type="number" id="smc-amount" class="smc-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="5000" min="100" step="100">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">State Claim Limit</label>
          <select id="smc-limit" class="smc-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="5000">$5,000 (e.g., RI, AZ)</option>
            <option value="7500">$7,500 (e.g., NY, WA)</option>
            <option value="10000" selected>$10,000 (e.g., CA, NJ, TX)</option>
            <option value="12000">$12,000 (e.g., GA)</option>
            <option value="15000">$15,000 (e.g., DE)</option>
            <option value="25000">$25,000 (e.g., TN)</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Claim Type</label>
          <select id="smc-type" class="smc-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="money" selected>Money owed / debt</option>
            <option value="property">Property damage</option>
            <option value="deposit">Security deposit</option>
            <option value="services">Services not rendered</option>
            <option value="breach">Breach of contract</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Filing as</label>
          <select id="smc-filer" class="smc-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="individual" selected>Individual</option>
            <option value="business">Business</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Estimated Win Probability (%)</label>
          <input type="number" id="smc-prob" class="smc-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="70" min="0" max="100" step="5">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Include Service of Process?</label>
          <select id="smc-service" class="smc-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="self">Self-serve (certified mail)</option>
            <option value="sheriff" selected>Sheriff / process server</option>
          </select>
        </div>
      </div>

      <div class="mt-6 space-y-3">
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Expected Net Recovery</div>
          <div class="text-5xl font-extrabold font-mono" id="smc-net"></div>
        </div>
        <div class="grid grid-cols-2 gap-4">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Filing Fee</div>
            <div class="text-xl font-bold text-secondary" id="smc-fee"></div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Service Costs</div>
            <div class="text-xl font-bold" id="smc-service-cost"></div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Total Court Costs</div>
            <div class="text-xl font-bold text-orange-600" id="smc-total-cost"></div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Within Limit?</div>
            <div class="text-xl font-bold" id="smc-within"></div>
          </div>
        </div>
      </div>
      <ShareButton calculatorId="small-claims" />
      <FeedbackWidget />
    </div>

    <article class="mt-12 max-w-4xl prose prose-slate">
      <h2 class="text-2xl font-bold text-text">Understanding Small Claims Court</h2>
      <p>Small claims court provides a simplified, low-cost way to resolve disputes under a certain dollar threshold. Attorneys are not required (and in some states, not allowed). Filing fees typically range from $30 to $200 depending on the claim amount and state. Cases are usually heard within 30-70 days of filing.</p>
      <h3 class="text-xl font-semibold text-text mt-8">Maximizing Your Recovery</h3>
      <p>Bring all documentation (contracts, receipts, photos, correspondence). Even if you win, collecting the judgment can be challenging. Consider whether the defendant has assets to pay before filing.</p>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    const fmt = (n: number) => '$' + Math.round(n).toLocaleString();

    function calcSMC() {
      const amount = parseFloat((document.getElementById('smc-amount') as HTMLInputElement).value) || 0;
      const limit = parseFloat((document.getElementById('smc-limit') as HTMLSelectElement).value) || 10000;
      const prob = parseFloat((document.getElementById('smc-prob') as HTMLInputElement).value) || 50;
      const service = (document.getElementById('smc-service') as HTMLSelectElement).value;

      // Filing fee based on claim amount
      let filingFee = 30;
      if (amount > 1500) filingFee = 50;
      if (amount > 5000) filingFee = 75;
      if (amount > 10000) filingFee = 100;

      const serviceCost = service === 'sheriff' ? 75 : 15;
      const totalCost = filingFee + serviceCost;

      const claimable = Math.min(amount, limit);
      const expectedRecovery = claimable * (prob / 100);
      const netRecovery = expectedRecovery - totalCost;

      const withinLimit = amount <= limit;

      document.getElementById('smc-net')!.textContent = fmt(Math.max(netRecovery, 0));
      document.getElementById('smc-fee')!.textContent = fmt(filingFee);
      document.getElementById('smc-service-cost')!.textContent = fmt(serviceCost);
      document.getElementById('smc-total-cost')!.textContent = fmt(totalCost);
      const withinEl = document.getElementById('smc-within')!;
      withinEl.textContent = withinLimit ? 'Yes' : 'Exceeds limit';
      withinEl.className = 'text-xl font-bold ' + (withinLimit ? 'text-green-600' : 'text-red-600');

      document.dispatchEvent(new CustomEvent('calc-update'));
    }

    setTimeout(() => {
      document.querySelectorAll('.smc-in').forEach(el => {
        el.addEventListener('input', calcSMC);
        el.addEventListener('change', calcSMC);
      });
      calcSMC();
    }, 50);
  </script>
</CalculatorLayout>
