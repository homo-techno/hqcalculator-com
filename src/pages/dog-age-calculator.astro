---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';

const title = "Dog Age Calculator - Dog Years to Human Years Converter";
const description = "Convert your dog's age to human years using the latest scientific method. Accounts for breed size ‚Äî small, medium, large, and giant dogs age differently.";

const relatedCalcs = [
  { name: "Age Calculator", url: "/age-calculator", description: "Human age." },
  { name: "Date Calculator", url: "/date-calculator", description: "Date math." },
  { name: "BMI Calculator", url: "/bmi-calculator", description: "Body Mass Index." },
  { name: "Calorie Calculator", url: "/calorie-calculator", description: "Daily calories." },
  { name: "Percentage Calculator", url: "/percentage-calculator", description: "Percentages." },
  { name: "Average Calculator", url: "/average-calculator", description: "Mean & median." },
];
---

<CalculatorLayout
  title={title}
  description={description}
  calculatorName="Dog Age Calculator"
  keywords="dog age calculator, dog years to human years, dog age chart, how old is my dog, puppy age calculator"
  breadcrumbs={[{ name: "Dog Age Calculator", url: "/dog-age-calculator" }]}
>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Dog Age Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Convert your dog's age to human years. Different sizes age at different rates.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4 mb-6">
        <div>
          <label class="block text-sm font-medium text-text mb-1">Dog's Age</label>
          <div class="flex gap-3">
            <div class="flex-1">
              <label class="block text-xs text-text-muted mb-1">Years</label>
              <input type="number" id="da-years" class="w-full px-4 py-3 border border-border rounded-xl text-2xl font-bold text-center" value="5" min="0" max="30" step="1">
            </div>
            <div class="flex-1">
              <label class="block text-xs text-text-muted mb-1">Months</label>
              <input type="number" id="da-months" class="w-full px-4 py-3 border border-border rounded-xl text-2xl font-bold text-center" value="0" min="0" max="11" step="1">
            </div>
          </div>
        </div>

        <div>
          <label class="block text-sm font-medium text-text mb-2">Dog Size</label>
          <div class="grid grid-cols-2 gap-2">
            <button class="da-size-btn px-3 py-3 rounded-xl text-sm font-semibold border border-border text-center" data-size="small">
              <div class="text-lg">üêï</div>
              <div>Small</div>
              <div class="text-xs text-text-muted">&lt; 20 lbs</div>
            </button>
            <button class="da-size-btn px-3 py-3 rounded-xl text-sm font-semibold border border-primary bg-blue-50 text-primary text-center" data-size="medium">
              <div class="text-lg">üêï</div>
              <div>Medium</div>
              <div class="text-xs text-text-muted">20-50 lbs</div>
            </button>
            <button class="da-size-btn px-3 py-3 rounded-xl text-sm font-semibold border border-border text-center" data-size="large">
              <div class="text-lg">üêï</div>
              <div>Large</div>
              <div class="text-xs text-text-muted">50-100 lbs</div>
            </button>
            <button class="da-size-btn px-3 py-3 rounded-xl text-sm font-semibold border border-border text-center" data-size="giant">
              <div class="text-lg">üêï</div>
              <div>Giant</div>
              <div class="text-xs text-text-muted">100+ lbs</div>
            </button>
          </div>
        </div>
      </div>

      <div class="p-6 bg-primary rounded-2xl text-white text-center mb-4">
        <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Human Age Equivalent</div>
        <div class="text-5xl font-extrabold" id="da-human">0</div>
        <div class="text-sm text-blue-200 mt-1">human years</div>
      </div>

      <div class="grid grid-cols-2 gap-3 mb-4">
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Life Stage</div>
          <div class="text-lg font-bold" id="da-stage">Adult</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Avg. Lifespan</div>
          <div class="text-lg font-bold" id="da-lifespan">10-13 yrs</div>
        </div>
      </div>

      <!-- Age chart -->
      <div class="p-4 bg-surface-alt rounded-xl mb-6">
        <h3 class="font-semibold text-sm text-text mb-3">Dog-to-Human Age Chart</h3>
        <div class="overflow-x-auto">
          <div class="text-xs" id="da-chart"></div>
        </div>
      </div>

      <ShareButton calculatorId="dog-age" />
      <FeedbackWidget />
    </div>

    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">How Dog Years Work</h2>
      <p>The old "7 years per human year" rule is inaccurate. Dogs age faster in their first two years, then the rate slows down. Larger breeds age faster than smaller ones ‚Äî a Great Dane is "senior" at 6, while a Chihuahua might not be senior until 10-11.</p>

      <h3 class="text-xl font-semibold text-text mt-8">The Modern Method</h3>
      <p>This calculator uses the American Kennel Club (AKC) guidelines, which account for size-based aging differences:</p>
      <ul>
        <li><strong>Year 1:</strong> 15 human years (all sizes)</li>
        <li><strong>Year 2:</strong> +9 human years (all sizes)</li>
        <li><strong>Year 3+:</strong> +4 to +9 per year depending on size</li>
      </ul>

      <h3 class="text-xl font-semibold text-text mt-8">Average Lifespans by Size</h3>
      <ul>
        <li><strong>Small breeds</strong> (Chihuahua, Yorkie): 12-16 years</li>
        <li><strong>Medium breeds</strong> (Beagle, Bulldog): 10-13 years</li>
        <li><strong>Large breeds</strong> (Lab, Golden Retriever): 8-12 years</li>
        <li><strong>Giant breeds</strong> (Great Dane, Mastiff): 6-10 years</li>
      </ul>

      <h3 class="text-xl font-semibold text-text mt-8">Frequently Asked Questions</h3>
      <p><strong>Why do small dogs live longer?</strong> Scientists aren't entirely sure, but larger dogs grow faster, which may lead to accelerated cellular aging and higher cancer rates.</p>
      <p><strong>When is a dog considered senior?</strong> Small dogs: 10-12 years. Medium dogs: 8-10 years. Large dogs: 6-8 years. Giant dogs: 5-6 years.</p>
    </article>

    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    let daSize = 'medium';

    // Rate per year after year 2 by size
    const ratePerYear: Record<string, number> = { small: 4, medium: 5, large: 6, giant: 8 };
    const lifespans: Record<string, string> = { small: '12-16 yrs', medium: '10-13 yrs', large: '8-12 yrs', giant: '6-10 yrs' };

    function dogToHuman(dogYears: number, size: string): number {
      if (dogYears <= 0) return 0;
      let human = 0;
      if (dogYears <= 1) {
        human = dogYears * 15;
      } else if (dogYears <= 2) {
        human = 15 + (dogYears - 1) * 9;
      } else {
        human = 24 + (dogYears - 2) * ratePerYear[size];
      }
      return Math.round(human * 10) / 10;
    }

    function getStage(dogYears: number, size: string): string {
      if (dogYears < 0.5) return 'Puppy';
      if (dogYears < 1) return 'Junior';
      if (dogYears < 2) return 'Young Adult';
      const seniorAge = { small: 10, medium: 8, large: 6, giant: 5 }[size] || 8;
      if (dogYears >= seniorAge) return 'Senior';
      if (dogYears >= seniorAge - 2) return 'Mature';
      return 'Adult';
    }

    function calcDogAge() {
      const years = parseFloat((document.getElementById('da-years') as HTMLInputElement).value) || 0;
      const months = parseFloat((document.getElementById('da-months') as HTMLInputElement).value) || 0;
      const totalYears = years + months / 12;

      const humanAge = dogToHuman(totalYears, daSize);
      document.getElementById('da-human')!.textContent = humanAge % 1 === 0 ? String(humanAge) : humanAge.toFixed(1);
      document.getElementById('da-stage')!.textContent = getStage(totalYears, daSize);
      document.getElementById('da-lifespan')!.textContent = lifespans[daSize];

      // Build chart
      const ages = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16];
      document.getElementById('da-chart')!.innerHTML =
        '<div class="grid grid-cols-5 gap-1 font-semibold text-text-muted mb-1"><span>Dog Age</span><span>Small</span><span>Medium</span><span>Large</span><span>Giant</span></div>' +
        ages.map(a => {
          const isHighlighted = Math.abs(a - totalYears) < 0.5;
          return `<div class="grid grid-cols-5 gap-1 ${isHighlighted ? 'bg-blue-50 rounded font-bold' : ''}">
            <span class="font-semibold">${a} yr</span>
            <span>${dogToHuman(a, 'small')}</span>
            <span>${dogToHuman(a, 'medium')}</span>
            <span>${dogToHuman(a, 'large')}</span>
            <span>${dogToHuman(a, 'giant')}</span>
          </div>`;
        }).join('');

      document.dispatchEvent(new CustomEvent('calc-update'));
    }

    setTimeout(() => {
      document.querySelectorAll('.da-size-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          document.querySelectorAll('.da-size-btn').forEach(b => { b.classList.remove('border-primary', 'bg-blue-50', 'text-primary'); b.classList.add('border-border'); });
          btn.classList.remove('border-border'); btn.classList.add('border-primary', 'bg-blue-50', 'text-primary');
          daSize = (btn as HTMLElement).dataset.size || 'medium';
          calcDogAge();
        });
      });

      ['da-years', 'da-months'].forEach(id => {
        document.getElementById(id)?.addEventListener('input', calcDogAge);
      });

      calcDogAge();
    }, 50);
  </script>
</CalculatorLayout>
