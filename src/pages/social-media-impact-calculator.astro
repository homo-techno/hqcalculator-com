---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Social Media Impact Calculator - Screen Time & Digital Wellbeing";
const description = "Assess how social media affects your well-being. Get a screen time impact score, comparison frequency analysis, FOMO index, and digital wellness recommendations.";
const relatedCalcs = [
  { name: "Screen Time", url: "/screen-time-calculator", description: "Screen usage." },
  { name: "Sleep Calculator", url: "/sleep-calculator", description: "Optimize sleep cycles." },
  { name: "Productivity Calculator", url: "/productivity-calculator", description: "Productivity metrics." },
  { name: "Reading Time", url: "/reading-time-calculator", description: "Reading duration." },
  { name: "Age Calculator", url: "/age-calculator", description: "Calculate exact age." },
  { name: "Calorie Calculator", url: "/calorie-calculator", description: "Daily calorie needs." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Social Media Impact Calculator" keywords="social media impact, screen time, FOMO, digital wellbeing, social comparison, digital detox, social media health" breadcrumbs={[{ name: "Social Media Impact", url: "/social-media-impact-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Social Media Impact Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Evaluate how your social media habits affect your mental health and well-being.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-text mb-1">Daily social media time (minutes)</label>
          <input type="number" id="si-time" class="si-in w-full px-4 py-3 border border-border rounded-xl text-lg text-center" min="0" max="720" step="5">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Number of social media platforms used</label>
          <input type="number" id="si-platforms" class="si-in w-full px-4 py-3 border border-border rounded-xl text-lg text-center" min="0" max="15" step="1">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">How often do you compare yourself to others online? (1-10)</label>
          <input type="range" id="si-compare" class="si-in w-full" min="1" max="10" step="1">
          <div class="flex justify-between text-xs text-text-secondary"><span>Rarely (1)</span><span>Constantly (10)</span></div>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">How anxious do you feel when unable to check social media? (1-10)</label>
          <input type="range" id="si-fomo" class="si-in w-full" min="1" max="10" step="1">
          <div class="flex justify-between text-xs text-text-secondary"><span>Not at all (1)</span><span>Very anxious (10)</span></div>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Do you check social media within 30 min of waking?</label>
          <select id="si-morning" class="si-in w-full px-4 py-3 border border-border rounded-xl text-lg text-center">
            <option value="1">Yes, immediately</option>
            <option value="0">No</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Do you check social media within 30 min of sleeping?</label>
          <select id="si-night" class="si-in w-full px-4 py-3 border border-border rounded-xl text-lg text-center">
            <option value="1">Yes</option>
            <option value="0">No</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Primary usage type</label>
          <select id="si-usage" class="si-in w-full px-4 py-3 border border-border rounded-xl text-lg text-center">
            <option value="passive">Passive scrolling / consuming</option>
            <option value="active">Active posting / creating</option>
            <option value="social">Messaging / connecting with friends</option>
            <option value="mixed">Mixed</option>
          </select>
        </div>

        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm opacity-80">Overall Impact Assessment</div>
          <div class="text-2xl font-extrabold mt-1" id="si-overall">--</div>
        </div>

        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-secondary">Screen Time Impact</div>
            <div class="text-xl font-bold text-text mt-1" id="si-screenscore">--</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-secondary">Comparison Score</div>
            <div class="text-xl font-bold text-text mt-1" id="si-compscore">--</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-secondary">FOMO Index</div>
            <div class="text-xl font-bold text-text mt-1" id="si-fomoscore">--</div>
          </div>
        </div>

        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-secondary">Annual Hours on Social Media</div>
            <div class="text-xl font-bold text-text mt-1" id="si-annual">--</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-secondary">That's Equivalent To</div>
            <div class="text-xl font-bold text-text mt-1" id="si-equiv">--</div>
          </div>
        </div>

        <div class="p-4 bg-surface-alt rounded-xl">
          <div class="text-xs text-text-secondary mb-2">Digital Wellbeing Recommendations</div>
          <div class="text-sm text-text" id="si-recs">--</div>
        </div>
      </div>

      <ShareButton calculatorId="social-media-impact" />
      <FeedbackWidget />
    </div>

    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    function calcSI() {
      const dailyMin = parseInt((document.getElementById('si-time') as HTMLInputElement).value) || 120;
      const platforms = parseInt((document.getElementById('si-platforms') as HTMLInputElement).value) || 4;
      const compare = parseInt((document.getElementById('si-compare') as HTMLInputElement).value) || 5;
      const fomo = parseInt((document.getElementById('si-fomo') as HTMLInputElement).value) || 5;
      const morning = parseInt((document.getElementById('si-morning') as HTMLSelectElement).value) || 1;
      const night = parseInt((document.getElementById('si-night') as HTMLSelectElement).value) || 1;
      const usage = (document.getElementById('si-usage') as HTMLSelectElement).value;

      // Screen time impact (0-10)
      let screenScore = 0;
      if (dailyMin < 30) screenScore = 1;
      else if (dailyMin < 60) screenScore = 3;
      else if (dailyMin < 120) screenScore = 5;
      else if (dailyMin < 180) screenScore = 7;
      else screenScore = 9;
      screenScore += platforms > 5 ? 1 : 0;

      // Comparison frequency (0-10)
      const compScore = compare;

      // FOMO index (0-10)
      let fomoIndex = Math.round((fomo * 0.5 + morning * 2 + night * 2 + (compare > 7 ? 1 : 0)));
      fomoIndex = Math.min(10, fomoIndex);

      // Usage type adjustment
      let usagePenalty = 0;
      if (usage === 'passive') usagePenalty = 2;
      else if (usage === 'active') usagePenalty = 0;
      else if (usage === 'social') usagePenalty = -1;
      else usagePenalty = 1;

      // Overall impact score (higher = more negative)
      const overall = Math.min(10, Math.max(1, Math.round((screenScore + compScore + fomoIndex) / 3 + usagePenalty)));

      let overallLabel = '';
      if (overall <= 3) overallLabel = 'Low Negative Impact - Healthy usage';
      else if (overall <= 5) overallLabel = 'Moderate Impact - Some concerns';
      else if (overall <= 7) overallLabel = 'High Impact - Likely affecting well-being';
      else overallLabel = 'Very High Impact - Strongly recommended to reduce';

      // Annual hours
      const annualHours = Math.round(dailyMin * 365 / 60);
      const annualDays = (annualHours / 24).toFixed(1);
      const equiv = annualHours > 500 ? annualDays + ' full days awake' : annualHours + ' hours';

      document.getElementById('si-overall')!.textContent = overall + '/10 - ' + overallLabel;
      document.getElementById('si-screenscore')!.textContent = Math.min(10, screenScore) + '/10';
      document.getElementById('si-compscore')!.textContent = compScore + '/10';
      document.getElementById('si-fomoscore')!.textContent = fomoIndex + '/10';
      document.getElementById('si-annual')!.textContent = annualHours.toLocaleString() + ' hrs/year';
      document.getElementById('si-equiv')!.textContent = equiv;

      let recs: string[] = [];
      if (dailyMin > 120) recs.push('Research (Hunt et al., 2018) found limiting social media to 30 min/day significantly reduced depression and loneliness. Try reducing by 30 min/week.');
      if (morning === 1) recs.push('Avoid checking social media in the first hour of waking. Start your day intentionally instead of reactively.');
      if (night === 1) recs.push('Stop using social media 1 hour before bed. Blue light and stimulating content disrupt sleep quality.');
      if (compare > 6) recs.push('High social comparison is linked to lower self-esteem. Unfollow accounts that trigger comparison. Curate your feed for inspiration, not comparison.');
      if (fomo > 6) recs.push('Your FOMO score is elevated. Practice "JOMO" (Joy of Missing Out). Turn off non-essential notifications.');
      if (usage === 'passive') recs.push('Passive scrolling is most harmful. Shift to active engagement: comment, create, or message friends directly.');
      if (platforms > 5) recs.push('Using many platforms fragments attention. Consider consolidating to 2-3 that add the most value.');
      if (recs.length === 0) recs.push('Your social media habits appear healthy. Continue mindful usage and periodic self-assessment.');

      document.getElementById('si-recs')!.textContent = recs.join(' ');

      document.dispatchEvent(new CustomEvent('calc-update'));
    }

    setTimeout(() => {
      (document.getElementById('si-time') as HTMLInputElement).value = '120';
      (document.getElementById('si-platforms') as HTMLInputElement).value = '4';
      (document.getElementById('si-compare') as HTMLInputElement).value = '5';
      (document.getElementById('si-fomo') as HTMLInputElement).value = '5';
      document.querySelectorAll('.si-in').forEach(el => {
        el.addEventListener('input', calcSI);
        el.addEventListener('change', calcSI);
      });
      calcSI();
    }, 50);
  </script>
</CalculatorLayout>
