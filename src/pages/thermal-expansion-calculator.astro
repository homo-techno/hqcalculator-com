---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Thermal Expansion Calculator";
const description = "Calculate linear, area, or volume thermal expansion for various materials based on temperature change.";
const relatedCalcs = [
  { name: "Temperature", url: "/temperature-converter", description: "Temperature." },
  { name: "Heat Transfer", url: "/heat-transfer-calculator", description: "Heat." },
  { name: "Length Converter", url: "/length-converter", description: "Length." },
  { name: "Density", url: "/density-calculator", description: "Density." },
  { name: "BTU Calculator", url: "/btu-calculator", description: "BTU." },
  { name: "Unit Converter", url: "/unit-converter", description: "Units." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Thermal Expansion Calculator" keywords="thermal expansion, linear expansion, coefficient of expansion, temperature change, material expansion" breadcrumbs={[{ name: "Thermal Expansion", url: "/thermal-expansion-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Thermal Expansion Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">ΔL = α × L₀ × ΔT — calculate expansion from heat.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div><label class="block text-xs font-medium text-text mb-1">Material</label>
          <select id="te-mat" class="te-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
            <option value="12">Steel (12)</option>
            <option value="23" selected>Aluminum (23)</option>
            <option value="17">Copper (17)</option>
            <option value="9">Concrete (9)</option>
            <option value="11">Iron (11)</option>
            <option value="0.5">Glass (Pyrex) (0.5)</option>
            <option value="custom">Custom α</option>
          </select>
        </div>
        <div id="te-custom-wrap" class="hidden"><label class="block text-xs font-medium text-text mb-1">Custom α (×10⁻⁶ /°C)</label><input type="number" id="te-alpha" class="te-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="12" min="0" step="0.1"></div>
        <div class="grid grid-cols-3 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Original Length (m)</label><input type="number" id="te-len" class="te-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="10" min="0" step="0.1"></div>
          <div><label class="block text-xs font-medium text-text mb-1">T₁ (°C)</label><input type="number" id="te-t1" class="te-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="20" step="1"></div>
          <div><label class="block text-xs font-medium text-text mb-1">T₂ (°C)</label><input type="number" id="te-t2" class="te-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="80" step="1"></div>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Length Change (ΔL)</div>
          <div class="text-5xl font-extrabold font-mono" id="te-result">0</div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">New Length</div><div class="text-xl font-bold font-mono" id="te-new">0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">ΔT</div><div class="text-xl font-bold font-mono" id="te-dt">0°C</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">% Change</div><div class="text-xl font-bold font-mono" id="te-pct">0%</div></div>
        </div>
      </div>
      <ShareButton calculatorId="thermal-expansion" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcTE() {
      const matVal = (document.getElementById('te-mat') as HTMLSelectElement).value;
      const customWrap = document.getElementById('te-custom-wrap')!;
      customWrap.classList.toggle('hidden', matVal !== 'custom');
      let alpha: number;
      if (matVal === 'custom') {
        alpha = parseFloat((document.getElementById('te-alpha') as HTMLInputElement).value) || 0;
      } else {
        alpha = parseFloat(matVal);
      }
      alpha = alpha * 1e-6;
      const len = parseFloat((document.getElementById('te-len') as HTMLInputElement).value) || 0;
      const t1 = parseFloat((document.getElementById('te-t1') as HTMLInputElement).value) || 0;
      const t2 = parseFloat((document.getElementById('te-t2') as HTMLInputElement).value) || 0;
      const dt = t2 - t1;
      const dl = alpha * len * dt;
      const newLen = len + dl;
      const pct = len > 0 ? (dl / len) * 100 : 0;
      let dlLabel: string;
      if (Math.abs(dl) >= 1) dlLabel = dl.toFixed(4) + ' m';
      else if (Math.abs(dl) >= 0.001) dlLabel = (dl * 1000).toFixed(3) + ' mm';
      else dlLabel = (dl * 1e6).toFixed(2) + ' μm';
      document.getElementById('te-result')!.textContent = dlLabel;
      document.getElementById('te-new')!.textContent = newLen.toFixed(6) + ' m';
      document.getElementById('te-dt')!.textContent = dt + '°C';
      document.getElementById('te-pct')!.textContent = pct.toFixed(6) + '%';
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.te-in').forEach(el => { el.addEventListener('input', calcTE); el.addEventListener('change', calcTE); });
      calcTE();
    }, 50);
  </script>
</CalculatorLayout>
