---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';

const title = "Fire Pit Calculator - Blocks, Stones, Cap & Gravel Estimator";
const description = "Calculate fire pit materials by diameter, height, and wall type. Get block/stone count, cap stones, gravel base, and fire ring size.";

const relatedCalcs = [
  { name: "Patio Calculator", url: "/patio-calculator", description: "Patio material." },
  { name: "Mortar Calculator", url: "/mortar-calculator", description: "Mortar for masonry." },
  { name: "Concrete Calculator", url: "/concrete-calculator", description: "Concrete volume." },
  { name: "Pergola Calculator", url: "/pergola-calculator", description: "Pergola lumber." },
  { name: "Post Hole Calculator", url: "/post-hole-calculator", description: "Post hole concrete." },
  { name: "Excavation Calculator", url: "/excavation-calculator", description: "Dig volume." },
];
---

<CalculatorLayout
  title={title}
  description={description}
  calculatorName="Fire Pit Calculator"
  keywords="fire pit calculator, fire pit blocks, fire pit stones, fire ring, fire pit gravel, cap stones, fire pit materials"
  breadcrumbs={[{ name: "Fire Pit Calculator", url: "/fire-pit-calculator" }]}
>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Fire Pit Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Estimate materials for building a circular fire pit including blocks, cap stones, and gravel.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8">
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
        <div>
          <div class="grid grid-cols-2 gap-3 mb-5">
            <div>
              <label class="block text-xs font-medium text-text mb-1">Inside Diameter (ft)</label>
              <input type="number" id="fp2-diameter" class="w-full px-3 py-3 border border-border rounded-xl text-lg" value="4" min="2" max="8" step="0.5">
            </div>
            <div>
              <label class="block text-xs font-medium text-text mb-1">Wall Height (inches)</label>
              <input type="number" id="fp2-height" class="w-full px-3 py-3 border border-border rounded-xl text-lg" value="12" min="6" max="36" step="1">
            </div>
          </div>

          <div class="mb-5">
            <label class="block text-xs font-medium text-text mb-1">Wall Thickness (inches)</label>
            <select id="fp2-thickness" class="w-full px-3 py-3 border border-border rounded-xl text-lg">
              <option value="4">4 inches (single block)</option>
              <option value="6" selected>6 inches (standard)</option>
              <option value="8">8 inches (thick wall)</option>
              <option value="12">12 inches (double wall)</option>
            </select>
          </div>

          <div class="mb-5">
            <label class="block text-xs font-medium text-text mb-1">Wall Material</label>
            <select id="fp2-material" class="w-full px-3 py-3 border border-border rounded-xl text-lg">
              <option value="block" selected>Retaining Wall Block (12x4x6)</option>
              <option value="stone">Natural Stone (~8x6 avg)</option>
              <option value="brick">Fire Brick (9x4.5x2.5)</option>
            </select>
          </div>

          <div class="p-4 bg-surface-alt rounded-xl">
            <div>
              <label class="block text-xs font-medium text-text mb-1">Gravel Base Depth (inches)</label>
              <input type="number" id="fp2-gravel" class="w-full px-3 py-2 border border-border rounded-lg" value="6" min="2" max="12" step="1">
            </div>
          </div>
        </div>

        <div class="space-y-3">
          <div class="p-6 bg-primary rounded-2xl text-white text-center">
            <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Blocks / Stones Needed</div>
            <div class="text-5xl font-extrabold font-mono" id="fp2-blocks">0</div>
            <div class="text-sm text-blue-200 mt-1" id="fp2-unitlabel">retaining wall blocks</div>
          </div>
          <div class="grid grid-cols-2 gap-3">
            <div class="p-4 bg-surface-alt rounded-xl text-center">
              <div class="text-xs text-text-muted uppercase">Cap Stones</div>
              <div class="text-xl font-bold" id="fp2-caps">0</div>
              <div class="text-xs text-text-muted">for top row</div>
            </div>
            <div class="p-4 bg-surface-alt rounded-xl text-center">
              <div class="text-xs text-text-muted uppercase">Rows / Courses</div>
              <div class="text-xl font-bold" id="fp2-rows">0</div>
            </div>
          </div>
          <div class="grid grid-cols-2 gap-3">
            <div class="p-4 bg-surface-alt rounded-xl text-center">
              <div class="text-xs text-text-muted uppercase">Gravel Needed</div>
              <div class="text-xl font-bold" id="fp2-gravelamt">0 cu ft</div>
            </div>
            <div class="p-4 bg-surface-alt rounded-xl text-center">
              <div class="text-xs text-text-muted uppercase">Fire Ring Size</div>
              <div class="text-xl font-bold" id="fp2-ring">--</div>
            </div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Outside Diameter</div>
            <div class="text-xl font-bold" id="fp2-outsidedia">0 ft</div>
          </div>
        </div>
      </div>

      <ShareButton calculatorId="fire-pit" />
      <FeedbackWidget />
    </div>

    <article class="mt-12 max-w-4xl prose prose-slate">
      <h2 class="text-2xl font-bold text-text">How to Calculate Fire Pit Materials</h2>
      <div class="bg-surface-alt rounded-xl p-4 my-4 font-mono text-sm space-y-1">
        <p><strong>Circumference:</strong> Pi x Inside diameter</p>
        <p><strong>Blocks per row:</strong> Circumference / Block width</p>
        <p><strong>Rows:</strong> Wall height / Block height</p>
        <p><strong>Total blocks:</strong> Blocks per row x Rows</p>
      </div>

      <h3 class="text-xl font-semibold text-text mt-8">Fire Pit Building Tips</h3>
      <ul>
        <li><strong>Location:</strong> At least 10-20 feet from structures</li>
        <li><strong>Base:</strong> 6" of gravel for drainage, extending 12" beyond walls</li>
        <li><strong>Fire ring insert:</strong> Protects blocks from direct heat</li>
        <li><strong>Cap stones:</strong> Use adhesive on top course for safety</li>
      </ul>
    </article>

    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    // Material block sizes in inches: width x height x depth
    const fp2Sizes: Record<string, { w: number; h: number }> = {
      block: { w: 12, h: 4 },    // retaining wall block face
      stone: { w: 8, h: 6 },     // average natural stone
      brick: { w: 9, h: 2.5 },   // fire brick
    };

    const fp2Labels: Record<string, string> = {
      block: 'retaining wall blocks',
      stone: 'natural stones (avg)',
      brick: 'fire bricks',
    };

    function calcFirePit() {
      const insideDiaFt = parseFloat((document.getElementById('fp2-diameter') as HTMLInputElement).value) || 4;
      const wallHeightIn = parseFloat((document.getElementById('fp2-height') as HTMLInputElement).value) || 12;
      const thicknessIn = parseFloat((document.getElementById('fp2-thickness') as HTMLSelectElement).value) || 6;
      const material = (document.getElementById('fp2-material') as HTMLSelectElement).value;
      const gravelDepthIn = parseFloat((document.getElementById('fp2-gravel') as HTMLInputElement).value) || 6;

      const insideDiaIn = insideDiaFt * 12;
      const outsideDiaIn = insideDiaIn + 2 * thicknessIn;
      const outsideDiaFt = outsideDiaIn / 12;

      // Middle circumference (average of inside and outside)
      const midCircumIn = Math.PI * (insideDiaIn + thicknessIn);

      const matSize = fp2Sizes[material] || fp2Sizes.block;

      const blocksPerRow = Math.ceil(midCircumIn / matSize.w);
      const rows = Math.ceil(wallHeightIn / matSize.h);
      const totalBlocks = blocksPerRow * rows;

      // Cap stones: same as blocks per row in top course
      const capStones = blocksPerRow;

      // Gravel: circle area (outside dia + 12" each side for overhang)
      const gravelDiaIn = outsideDiaIn + 24;
      const gravelAreaSqIn = Math.PI * Math.pow(gravelDiaIn / 2, 2);
      const gravelCuIn = gravelAreaSqIn * gravelDepthIn;
      const gravelCuFt = gravelCuIn / 1728;

      // Fire ring insert size (standard sizes)
      let ringSize = '--';
      if (insideDiaIn <= 30) ringSize = '24" insert';
      else if (insideDiaIn <= 38) ringSize = '30" insert';
      else if (insideDiaIn <= 44) ringSize = '36" insert';
      else if (insideDiaIn <= 52) ringSize = '42" insert';
      else ringSize = '48" insert';

      document.getElementById('fp2-blocks')!.textContent = String(totalBlocks);
      document.getElementById('fp2-unitlabel')!.textContent = fp2Labels[material] || 'blocks';
      document.getElementById('fp2-caps')!.textContent = String(capStones);
      document.getElementById('fp2-rows')!.textContent = String(rows);
      document.getElementById('fp2-gravelamt')!.textContent = gravelCuFt.toFixed(1) + ' cu ft';
      document.getElementById('fp2-ring')!.textContent = ringSize;
      document.getElementById('fp2-outsidedia')!.textContent = outsideDiaFt.toFixed(1) + ' ft';

      document.dispatchEvent(new CustomEvent('calc-update'));
    }

    setTimeout(() => {
      document.querySelectorAll('#fp2-diameter, #fp2-height, #fp2-gravel').forEach(el => {
        el.addEventListener('input', calcFirePit);
        el.addEventListener('change', calcFirePit);
      });
      document.querySelectorAll('#fp2-thickness, #fp2-material').forEach(el => {
        el.addEventListener('input', calcFirePit);
        el.addEventListener('change', calcFirePit);
      });
      calcFirePit();
    }, 50);
  </script>
</CalculatorLayout>
