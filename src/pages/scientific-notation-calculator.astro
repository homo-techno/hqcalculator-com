---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Scientific Notation Calculator - Convert & Calculate";
const description = "Convert between scientific notation and decimal, and perform arithmetic with scientific notation.";
const relatedCalcs = [
  { name: "Exponent Calculator", url: "/exponent-calculator", description: "Exponents." },
  { name: "Logarithm Calculator", url: "/logarithm-calculator", description: "Logarithms." },
  { name: "Scientific Calculator", url: "/scientific-calculator", description: "Scientific math." },
  { name: "Square Root", url: "/square-root-calculator", description: "Square roots." },
  { name: "Percentage Calculator", url: "/percentage-calculator", description: "Percentages." },
  { name: "Fraction Calculator", url: "/fraction-calculator", description: "Fractions." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Scientific Notation Calculator" keywords="scientific notation, scientific notation converter, e notation, standard form, engineering notation" breadcrumbs={[{ name: "Scientific Notation", url: "/scientific-notation-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Scientific Notation Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Convert numbers to/from scientific notation and perform arithmetic.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="flex gap-2 mb-2">
          <button id="sn-convert" class="px-4 py-2 rounded-lg text-sm font-semibold border-2 border-primary bg-blue-50 text-primary">Convert</button>
          <button id="sn-calc" class="px-4 py-2 rounded-lg text-sm font-semibold border-2 border-border text-text-muted">Arithmetic</button>
        </div>
        <div id="sn-convert-panel">
          <div>
            <label class="block text-xs font-medium text-text mb-1">Enter Number</label>
            <input type="text" id="sn-input" class="w-full px-4 py-3 border border-border rounded-xl text-2xl font-bold font-mono" value="602200000000000000000000" placeholder="e.g. 6.022e23 or 602200000...">
          </div>
        </div>
        <div id="sn-calc-panel" class="hidden space-y-3">
          <div class="grid grid-cols-3 gap-2">
            <div><label class="block text-xs font-medium text-text mb-1">Coefficient</label><input type="number" id="sn-c1" class="w-full px-3 py-3 border border-border rounded-xl text-lg font-bold" value="6.022" step="0.001"></div>
            <div><label class="block text-xs font-medium text-text mb-1">× 10^</label><input type="number" id="sn-e1" class="w-full px-3 py-3 border border-border rounded-xl text-lg font-bold" value="23" step="1"></div>
            <div><label class="block text-xs font-medium text-text mb-1">Operation</label>
              <select id="sn-op" class="w-full px-3 py-3 border border-border rounded-xl text-lg">
                <option value="add">+</option><option value="sub">−</option><option value="mul" selected>×</option><option value="div">÷</option>
              </select>
            </div>
          </div>
          <div class="grid grid-cols-2 gap-2">
            <div><label class="block text-xs font-medium text-text mb-1">Coefficient</label><input type="number" id="sn-c2" class="w-full px-3 py-3 border border-border rounded-xl text-lg font-bold" value="1.602" step="0.001"></div>
            <div><label class="block text-xs font-medium text-text mb-1">× 10^</label><input type="number" id="sn-e2" class="w-full px-3 py-3 border border-border rounded-xl text-lg font-bold" value="-19" step="1"></div>
          </div>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Scientific Notation</div>
          <div class="text-3xl font-extrabold font-mono" id="sn-sci">-</div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Decimal</div><div class="text-lg font-bold font-mono break-all" id="sn-dec">-</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">E-Notation</div><div class="text-lg font-bold font-mono" id="sn-enot">-</div></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Engineering</div><div class="text-lg font-bold font-mono" id="sn-eng">-</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Order of Magnitude</div><div class="text-xl font-bold" id="sn-order">-</div></div>
        </div>
      </div>
      <ShareButton calculatorId="scientific-notation" />
      <FeedbackWidget />
    </div>
    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">Scientific Notation</h2>
      <p>Scientific notation expresses numbers as a × 10ⁿ where 1 ≤ |a| < 10. Example: 6.022 × 10²³ (Avogadro's number).</p>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    let mode = 'convert';
    function setMode(m: string) {
      mode = m;
      document.getElementById('sn-convert')!.className = `px-4 py-2 rounded-lg text-sm font-semibold border-2 ${m==='convert' ? 'border-primary bg-blue-50 text-primary' : 'border-border text-text-muted'}`;
      document.getElementById('sn-calc')!.className = `px-4 py-2 rounded-lg text-sm font-semibold border-2 ${m==='calc' ? 'border-primary bg-blue-50 text-primary' : 'border-border text-text-muted'}`;
      document.getElementById('sn-convert-panel')!.classList.toggle('hidden', m !== 'convert');
      document.getElementById('sn-calc-panel')!.classList.toggle('hidden', m !== 'calc');
      compute();
    }
    function toSci(n: number): [number, number] {
      if (n === 0) return [0, 0];
      const e = Math.floor(Math.log10(Math.abs(n)));
      return [n / Math.pow(10, e), e];
    }
    function display(val: number) {
      const [coeff, exp] = toSci(val);
      document.getElementById('sn-sci')!.textContent = `${coeff.toFixed(4)} × 10^${exp}`;
      document.getElementById('sn-enot')!.textContent = `${coeff.toFixed(4)}e${exp}`;
      document.getElementById('sn-dec')!.textContent = val === 0 ? '0' : (Math.abs(exp) < 20 ? val.toFixed(Math.max(0, -exp + 4)) : `${coeff.toFixed(4)}e${exp}`);
      const engExp = Math.floor(exp / 3) * 3;
      const engCoeff = val / Math.pow(10, engExp);
      document.getElementById('sn-eng')!.textContent = `${engCoeff.toFixed(4)} × 10^${engExp}`;
      document.getElementById('sn-order')!.textContent = `10^${exp}`;
    }
    function compute() {
      if (mode === 'convert') {
        const input = (document.getElementById('sn-input') as HTMLInputElement).value.trim();
        const val = parseFloat(input);
        if (isNaN(val)) { document.getElementById('sn-sci')!.textContent = 'Invalid'; return; }
        display(val);
      } else {
        const c1 = parseFloat((document.getElementById('sn-c1') as HTMLInputElement).value) || 0;
        const e1 = parseFloat((document.getElementById('sn-e1') as HTMLInputElement).value) || 0;
        const c2 = parseFloat((document.getElementById('sn-c2') as HTMLInputElement).value) || 0;
        const e2 = parseFloat((document.getElementById('sn-e2') as HTMLInputElement).value) || 0;
        const a = c1 * Math.pow(10, e1), b = c2 * Math.pow(10, e2);
        const op = (document.getElementById('sn-op') as HTMLSelectElement).value;
        let result: number;
        if (op === 'add') result = a + b;
        else if (op === 'sub') result = a - b;
        else if (op === 'mul') result = a * b;
        else result = b !== 0 ? a / b : 0;
        display(result);
      }
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.getElementById('sn-convert')!.addEventListener('click', () => setMode('convert'));
      document.getElementById('sn-calc')!.addEventListener('click', () => setMode('calc'));
      document.getElementById('sn-input')!.addEventListener('input', compute);
      ['sn-c1','sn-e1','sn-c2','sn-e2'].forEach(id => document.getElementById(id)!.addEventListener('input', compute));
      document.getElementById('sn-op')!.addEventListener('change', compute);
      compute();
    }, 50);
  </script>
</CalculatorLayout>
