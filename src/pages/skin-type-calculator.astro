---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Skin Type Calculator - Oily, Dry, Combination, Sensitive or Normal";
const description = "Determine your skin type through a guided assessment. Get personalized skincare recommendations for oily, dry, combination, sensitive, or normal skin.";
const relatedCalcs = [
  { name: "Skincare Routine Calculator", url: "/skincare-routine-calculator", description: "Product layering order." },
  { name: "SPF Calculator", url: "/spf-calculator", description: "SPF protection time." },
  { name: "Chemical Peel Calculator", url: "/chemical-peel-calculator", description: "Peel depth and recovery." },
  { name: "Cosmetic Expiration Calculator", url: "/cosmetic-expiration-calculator", description: "Product shelf life tracker." },
  { name: "Hair Porosity Calculator", url: "/hair-porosity-calculator", description: "Hair porosity assessment." },
  { name: "Beauty Budget Calculator", url: "/beauty-budget-calculator", description: "Beauty spending breakdown." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Skin Type Calculator" keywords="skin type, oily skin, dry skin, combination skin, sensitive skin, normal skin, skin assessment, skincare" breadcrumbs={[{ name: "Skin Type", url: "/skin-type-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Skin Type Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Assess your skin type and get personalized skincare recommendations.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div>
          <label class="block text-xs font-medium text-text mb-1">After cleansing, how does your face feel in 30 min?</label>
          <select id="skt-q1" class="skt-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="oily">Shiny and oily all over</option>
            <option value="combo">Oily T-zone, normal/dry cheeks</option>
            <option value="normal" selected>Comfortable, balanced</option>
            <option value="dry">Tight, dry, maybe flaky</option>
            <option value="sensitive">Irritated, red, stinging</option>
          </select>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">How often do you experience breakouts?</label>
          <select id="skt-q2" class="skt-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="oily">Frequently, especially in T-zone</option>
            <option value="combo">Occasionally in T-zone only</option>
            <option value="normal" selected>Rarely</option>
            <option value="dry">Almost never</option>
            <option value="sensitive">Sometimes, with redness and irritation</option>
          </select>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">How visible are your pores?</label>
          <select id="skt-q3" class="skt-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="oily">Large and visible all over</option>
            <option value="combo">Visible on nose/forehead, small on cheeks</option>
            <option value="normal" selected>Small to medium, barely noticeable</option>
            <option value="dry">Very small, barely visible</option>
            <option value="sensitive">Small, but skin appears blotchy</option>
          </select>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">How does your skin react to new products?</label>
          <select id="skt-q4" class="skt-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="oily">Gets more oily</option>
            <option value="combo">Varies by area</option>
            <option value="normal" selected>Usually fine, no reaction</option>
            <option value="dry">Absorbs quickly, wants more</option>
            <option value="sensitive">Often burns, stings, or turns red</option>
          </select>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">By midday, what does your skin look like?</label>
          <select id="skt-q5" class="skt-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="oily">Very shiny, needs blotting</option>
            <option value="combo">Shiny T-zone, matte cheeks</option>
            <option value="normal" selected>Still looks balanced</option>
            <option value="dry">Feels tight, dull, or flaky</option>
            <option value="sensitive">Patchy redness, reactive</option>
          </select>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">How does your skin feel in winter?</label>
          <select id="skt-q6" class="skt-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="oily">Still oily</option>
            <option value="combo">Less oily, some dryness</option>
            <option value="normal" selected>Slightly drier but manageable</option>
            <option value="dry">Very dry, cracking, uncomfortable</option>
            <option value="sensitive">Red, irritated, and reactive</option>
          </select>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Your Skin Type</div>
          <div class="text-4xl font-extrabold font-mono" id="skt-type">--</div>
          <div class="text-sm text-blue-200 mt-1" id="skt-confidence">--</div>
        </div>
        <div class="grid grid-cols-2 gap-4">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Sebum Level</div><div class="text-xl font-bold" id="skt-sebum">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Hydration Need</div><div class="text-xl font-bold" id="skt-hydration">--</div></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-3">Recommended Routine</h3>
          <div class="text-sm space-y-1" id="skt-routine"></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-3">Ingredients to Look For</h3>
          <div class="text-sm space-y-1" id="skt-ingredients"></div>
        </div>
      </div>
      <ShareButton calculatorId="skin-type" />
      <FeedbackWidget />
    </div>
    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">Understanding Your Skin Type</h2>
      <p>Your skin type is determined by genetics but can be influenced by environment, diet, hormones, and skincare habits. The five main types are: Normal (balanced, few imperfections), Oily (excess sebum, enlarged pores), Dry (flaky, tight, dull), Combination (oily T-zone with dry cheeks), and Sensitive (reactive, easily irritated). Knowing your type helps you choose the right products and avoid ingredients that can worsen your skin concerns.</p>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcSKT() {
      const answers = ['skt-q1','skt-q2','skt-q3','skt-q4','skt-q5','skt-q6'].map(id =>
        (document.getElementById(id) as HTMLSelectElement).value
      );

      const counts: Record<string,number> = {oily:0, combo:0, normal:0, dry:0, sensitive:0};
      answers.forEach(a => counts[a]++);

      let maxType = 'normal';
      let maxCount = 0;
      for (const [type, count] of Object.entries(counts)) {
        if (count > maxCount) { maxType = type; maxCount = count; }
      }

      const confidence = Math.round((maxCount / 6) * 100);
      const labels: Record<string,string> = {
        oily: 'Oily Skin',
        combo: 'Combination Skin',
        normal: 'Normal Skin',
        dry: 'Dry Skin',
        sensitive: 'Sensitive Skin'
      };

      let sebum = 'Balanced';
      let hydration = 'Moderate';
      let routine: string[] = [];
      let ingredients: string[] = [];

      if (maxType === 'oily') {
        sebum = 'High'; hydration = 'Low-Moderate';
        routine = ['Gel or foaming cleanser (AM/PM)', 'Alcohol-free toner', 'Lightweight, oil-free moisturizer', 'Niacinamide serum', 'Clay mask 1-2x/week', 'Oil-free SPF 30+'];
        ingredients = ['Niacinamide (controls oil)', 'Salicylic acid (unclogs pores)', 'Hyaluronic acid (lightweight hydration)', 'Clay (absorbs excess oil)', 'Zinc (regulates sebum)'];
      } else if (maxType === 'dry') {
        sebum = 'Low'; hydration = 'High';
        routine = ['Cream or milk cleanser', 'Hydrating toner/essence', 'Hyaluronic acid serum', 'Rich cream moisturizer', 'Face oil (evening)', 'Hydrating SPF 30+'];
        ingredients = ['Hyaluronic acid (intense hydration)', 'Ceramides (repair barrier)', 'Squalane (nourishing oil)', 'Shea butter (rich moisture)', 'Glycerin (humectant)'];
      } else if (maxType === 'combo') {
        sebum = 'Mixed (T-zone high)'; hydration = 'Moderate';
        routine = ['Gentle gel cleanser', 'Balancing toner', 'Lightweight serum', 'Gel-cream moisturizer', 'Clay mask on T-zone only', 'Lightweight SPF 30+'];
        ingredients = ['Niacinamide (balances)', 'Hyaluronic acid (hydrates without oil)', 'Green tea (antioxidant)', 'Witch hazel (gentle astringent)', 'Jojoba oil (mimics natural sebum)'];
      } else if (maxType === 'sensitive') {
        sebum = 'Variable'; hydration = 'High (barrier support)';
        routine = ['Fragrance-free micellar water or gentle cleanser', 'Calming toner (no alcohol)', 'Centella/cica serum', 'Barrier repair moisturizer', 'Mineral SPF 30+ (zinc oxide/titanium dioxide)'];
        ingredients = ['Centella asiatica / cica (calming)', 'Ceramides (barrier repair)', 'Allantoin (soothing)', 'Oat extract (anti-irritant)', 'Avoid: fragrance, alcohol, essential oils'];
      } else {
        sebum = 'Balanced'; hydration = 'Moderate';
        routine = ['Gentle cleanser (AM/PM)', 'Optional toner', 'Antioxidant serum (Vitamin C)', 'Lightweight moisturizer', 'SPF 30+', 'Retinol (PM, 2-3x/week)'];
        ingredients = ['Vitamin C (brightening)', 'Retinol (anti-aging)', 'Peptides (firming)', 'Hyaluronic acid (hydration)', 'SPF (prevention)'];
      }

      document.getElementById('skt-type')!.textContent = labels[maxType] || 'Normal Skin';
      document.getElementById('skt-confidence')!.textContent = 'Confidence: ' + confidence + '%';
      document.getElementById('skt-sebum')!.textContent = sebum;
      document.getElementById('skt-hydration')!.textContent = hydration;
      document.getElementById('skt-routine')!.innerHTML = routine.map(r => '<p>- ' + r + '</p>').join('');
      document.getElementById('skt-ingredients')!.innerHTML = ingredients.map(i => '<p>- ' + i + '</p>').join('');
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.skt-in').forEach(el => { el.addEventListener('input', calcSKT); el.addEventListener('change', calcSKT); });
      calcSKT();
    }, 50);
  </script>
</CalculatorLayout>
