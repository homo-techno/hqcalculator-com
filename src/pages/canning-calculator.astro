---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Canning Calculator - Jars Needed & Processing Time";
const description = "Calculate how many canning jars you need, processing times, and sugar or vinegar amounts for common canning recipes.";
const relatedCalcs = [
  { name: "Baking Conversion", url: "/baking-conversion-calculator", description: "Convert baking measurements." },
  { name: "Sourdough Calculator", url: "/sourdough-calculator", description: "Sourdough bread ratios." },
  { name: "Harvest Date Calculator", url: "/harvest-date-calculator", description: "Predict harvest dates." },
  { name: "Food Cost Calculator", url: "/food-cost-calculator", description: "Restaurant food cost analysis." },
  { name: "Meal Prep Calculator", url: "/meal-prep-calculator", description: "Plan weekly meal prep." },
  { name: "Beer Brewing Calculator", url: "/beer-brewing-calculator", description: "Homebrew ABV and stats." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Canning Calculator" keywords="canning calculator, canning jars needed, processing time, canning recipe, preserving food, canning guide" breadcrumbs={[{ name: "Canning", url: "/canning-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Canning Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate jars needed, processing times, and ingredient amounts for home canning.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div>
          <label class="block text-xs font-medium text-text mb-1">Produce Type</label>
          <select id="cn-produce" class="cn-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
            <option value="tomato">Tomatoes (Salsa/Sauce)</option>
            <option value="peach">Peaches</option>
            <option value="apple">Applesauce</option>
            <option value="cucumber">Cucumbers (Pickles)</option>
            <option value="berry">Berries (Jam)</option>
            <option value="pepper">Peppers (Hot Sauce)</option>
            <option value="green_bean">Green Beans</option>
          </select>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="block text-xs font-medium text-text mb-1">Produce Amount (lbs)</label>
            <input type="number" id="cn-amount" class="cn-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="20" min="0" step="1">
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Jar Size</label>
            <select id="cn-jar" class="cn-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
              <option value="8">Half Pint (8 oz)</option>
              <option value="16" selected>Pint (16 oz)</option>
              <option value="32">Quart (32 oz)</option>
            </select>
          </div>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Jars Needed</div>
          <div class="text-5xl font-extrabold font-mono" id="cn-result">0</div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Processing Time</div><div class="text-xl font-bold font-mono" id="cn-time">0 min</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Sugar Needed</div><div class="text-xl font-bold font-mono" id="cn-sugar">0 cups</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Vinegar Needed</div><div class="text-xl font-bold font-mono" id="cn-vinegar">0 cups</div></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Method</div><div class="text-xl font-bold font-mono" id="cn-method">-</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Yield</div><div class="text-xl font-bold font-mono" id="cn-yield">-</div></div>
        </div>
      </div>
      <ShareButton calculatorId="canning" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcCN() {
      const produce = (document.getElementById('cn-produce') as HTMLSelectElement).value;
      const amount = parseFloat((document.getElementById('cn-amount') as HTMLInputElement).value) || 0;
      const jarOz = parseFloat((document.getElementById('cn-jar') as HTMLSelectElement).value) || 16;
      // Yield: approximate quarts per pound of raw produce
      const yieldPerLb: Record<string, number> = {
        tomato: 0.5, peach: 0.55, apple: 0.5, cucumber: 0.5,
        berry: 0.45, pepper: 0.6, green_bean: 0.5
      };
      // Processing times for pints (minutes, water bath or pressure canner)
      const procTime: Record<string, Record<number, number>> = {
        tomato:     { 8: 35, 16: 40, 32: 45 },
        peach:      { 8: 20, 16: 25, 32: 30 },
        apple:      { 8: 15, 16: 20, 32: 20 },
        cucumber:   { 8: 10, 16: 15, 32: 15 },
        berry:      { 8: 10, 16: 15, 32: 15 },
        pepper:     { 8: 10, 16: 15, 32: 15 },
        green_bean: { 8: 20, 16: 25, 32: 25 }
      };
      // Sugar cups per pound (for jams/preserves)
      const sugarPerLb: Record<string, number> = {
        tomato: 0, peach: 0.3, apple: 0.2, cucumber: 0,
        berry: 0.75, pepper: 0, green_bean: 0
      };
      // Vinegar cups per pound (for pickles/salsas)
      const vinegarPerLb: Record<string, number> = {
        tomato: 0.1, peach: 0, apple: 0, cucumber: 0.5,
        berry: 0, pepper: 0.4, green_bean: 0.1
      };
      const method: Record<string, string> = {
        tomato: 'Water Bath', peach: 'Water Bath', apple: 'Water Bath',
        cucumber: 'Water Bath', berry: 'Water Bath', pepper: 'Water Bath',
        green_bean: 'Pressure'
      };
      const quartsYield = amount * (yieldPerLb[produce] || 0.5);
      const ouncesYield = quartsYield * 32;
      const jarsNeeded = Math.ceil(ouncesYield / jarOz);
      const time = procTime[produce]?.[jarOz] || 20;
      const sugar = amount * (sugarPerLb[produce] || 0);
      const vinegar = amount * (vinegarPerLb[produce] || 0);
      const jarName = jarOz === 8 ? 'half-pints' : jarOz === 16 ? 'pints' : 'quarts';
      document.getElementById('cn-result')!.textContent = jarsNeeded + ' ' + jarName;
      document.getElementById('cn-time')!.textContent = time + ' min';
      document.getElementById('cn-sugar')!.textContent = sugar > 0 ? sugar.toFixed(1) + ' cups' : 'N/A';
      document.getElementById('cn-vinegar')!.textContent = vinegar > 0 ? vinegar.toFixed(1) + ' cups' : 'N/A';
      document.getElementById('cn-method')!.textContent = method[produce] || 'Water Bath';
      document.getElementById('cn-yield')!.textContent = quartsYield.toFixed(1) + ' quarts';
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.cn-in').forEach(el => { el.addEventListener('input', calcCN); el.addEventListener('change', calcCN); });
      calcCN();
    }, 50);
  </script>
</CalculatorLayout>
