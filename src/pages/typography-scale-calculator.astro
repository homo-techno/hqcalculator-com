---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Typography Scale Calculator - Modular Type Scale Generator";
const description = "Generate modular type scales with ratio-based heading sizes from a base font size. Create harmonious typographic hierarchies for web and print.";
const relatedCalcs = [
  { name: "Font Size Calculator", url: "/font-size-calculator", description: "Convert font size units." },
  { name: "Typesetting Calculator", url: "/typesetting-calculator", description: "Characters per page." },
  { name: "Magazine Layout Calculator", url: "/magazine-layout-calculator", description: "Magazine page planning." },
  { name: "Print Resolution Calculator", url: "/print-resolution-calculator", description: "DPI/PPI calculations." },
  { name: "Bleed Margin Calculator", url: "/bleed-margin-calculator", description: "Print bleed calculations." },
  { name: "Poster Size Calculator", url: "/poster-size-calculator", description: "Poster dimensions." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Typography Scale Calculator" keywords="type scale, modular scale, typography ratio, heading sizes, font hierarchy, golden ratio, typographic scale" breadcrumbs={[{ name: "Typography Scale Calculator", url: "/typography-scale-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Typography Scale Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Generate a modular type scale by choosing a base size and a ratio. Get harmonious font sizes for headings, body text, and small text.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Base Font Size (px)</label><input type="number" id="tys-base" class="tys-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="8" max="32" step="1"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Scale Ratio</label>
            <select id="tys-ratio" class="tys-in w-full px-4 py-3 border border-border rounded-xl text-lg">
              <option value="1.067">Minor Second (1.067)</option>
              <option value="1.125">Major Second (1.125)</option>
              <option value="1.2">Minor Third (1.200)</option>
              <option value="1.25">Major Third (1.250)</option>
              <option value="1.333">Perfect Fourth (1.333)</option>
              <option value="1.414">Augmented Fourth (1.414)</option>
              <option value="1.5">Perfect Fifth (1.500)</option>
              <option value="1.618">Golden Ratio (1.618)</option>
              <option value="custom">Custom Ratio</option>
            </select>
          </div>
        </div>
        <div><label class="block text-xs font-medium text-text mb-1">Custom Ratio (if selected above)</label><input type="number" id="tys-custom" class="tys-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="1.01" max="3" step="0.001"></div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Scale Steps Up</label><input type="number" id="tys-up" class="tys-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="1" max="10" step="1"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Scale Steps Down</label><input type="number" id="tys-down" class="tys-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="0" max="5" step="1"></div>
        </div>
        <div><label class="block text-xs font-medium text-text mb-1">Line Height Multiplier</label><input type="number" id="tys-lh" class="tys-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="1" max="2.5" step="0.05"></div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Type Scale</div>
          <div class="text-3xl font-extrabold font-mono" id="tys-result">--</div>
          <div class="text-sm text-blue-200 mt-1" id="tys-subtitle"></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-2">Generated Scale</h3>
          <div class="space-y-2" id="tys-scale"></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-2">CSS Output</h3>
          <pre class="font-mono text-sm overflow-x-auto whitespace-pre-wrap" id="tys-css"></pre>
        </div>
      </div>
      <ShareButton calculatorId="typography-scale" />
      <FeedbackWidget />
    </div>
    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">Modular Type Scales</h2>
      <div class="bg-surface-alt rounded-xl p-4 my-4 font-mono text-sm space-y-1">
        <p>Size at step N = Base x Ratio^N</p>
        <p>Minor Third (1.2): Classic web scale, subtle contrast</p>
        <p>Major Third (1.25): Good for body-heavy pages</p>
        <p>Perfect Fourth (1.333): Strong hierarchy</p>
        <p>Golden Ratio (1.618): Dramatic contrast, best for sparse layouts</p>
      </div>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcTys() {
      const base = parseFloat((document.getElementById('tys-base') as HTMLInputElement).value) || 16;
      const ratioSelect = (document.getElementById('tys-ratio') as HTMLSelectElement).value;
      const customRatio = parseFloat((document.getElementById('tys-custom') as HTMLInputElement).value) || 1.25;
      const stepsUp = parseFloat((document.getElementById('tys-up') as HTMLInputElement).value) || 6;
      const stepsDown = parseFloat((document.getElementById('tys-down') as HTMLInputElement).value) || 2;
      const lh = parseFloat((document.getElementById('tys-lh') as HTMLInputElement).value) || 1.5;
      const ratio = ratioSelect === 'custom' ? customRatio : parseFloat(ratioSelect);
      const labels = ['small-2', 'small-1', 'base', 'h6', 'h5', 'h4', 'h3', 'h2', 'h1', 'display-1', 'display-2', 'display-3', 'display-4', 'display-5'];
      const cssVarNames = ['--text-xs', '--text-sm', '--text-base', '--text-lg', '--text-xl', '--text-2xl', '--text-3xl', '--text-4xl', '--text-5xl', '--text-6xl', '--text-7xl', '--text-8xl', '--text-9xl', '--text-10xl'];
      const scaleHtml: string[] = [];
      const cssLines: string[] = [':root {'];
      const startStep = -stepsDown;
      const endStep = stepsUp;
      let baseIdx = stepsDown;
      for (let i = startStep; i <= endStep; i++) {
        const size = base * Math.pow(ratio, i);
        const sizePt = size * 0.75;
        const sizeRem = size / 16;
        const lineHeight = Math.round(size * lh);
        const labelIdx = i + stepsDown;
        const label = labelIdx < labels.length ? labels[labelIdx] : 'step-' + i;
        const cssVar = labelIdx < cssVarNames.length ? cssVarNames[labelIdx] : '--text-step-' + i;
        const isBase = i === 0;
        const sizePx = Math.round(size * 100) / 100;
        const previewSize = Math.min(Math.max(sizePx, 10), 48);
        scaleHtml.push(
          '<div class="flex items-center justify-between py-1 ' + (isBase ? 'font-bold bg-blue-50 px-2 rounded' : '') + '">' +
          '<span style="font-size:' + previewSize + 'px;line-height:1.2" class="font-bold">' + label + '</span>' +
          '<span class="font-mono text-xs text-text-muted">' + sizePx.toFixed(2) + 'px / ' + sizeRem.toFixed(3) + 'rem / ' + sizePt.toFixed(1) + 'pt (lh: ' + lineHeight + 'px)</span>' +
          '</div>'
        );
        cssLines.push('  ' + cssVar + ': ' + sizeRem.toFixed(4) + 'rem; /* ' + sizePx.toFixed(1) + 'px */');
      }
      cssLines.push('  --line-height: ' + lh + ';');
      cssLines.push('}');
      document.getElementById('tys-result')!.textContent = base + 'px x ' + ratio;
      document.getElementById('tys-subtitle')!.textContent = (stepsUp + stepsDown + 1) + ' sizes from ' + (base * Math.pow(ratio, startStep)).toFixed(1) + 'px to ' + (base * Math.pow(ratio, endStep)).toFixed(1) + 'px';
      document.getElementById('tys-scale')!.innerHTML = scaleHtml.join('');
      document.getElementById('tys-css')!.textContent = cssLines.join('\n');
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      (document.getElementById('tys-base') as HTMLInputElement).value = '16';
      (document.getElementById('tys-custom') as HTMLInputElement).value = '1.25';
      (document.getElementById('tys-up') as HTMLInputElement).value = '6';
      (document.getElementById('tys-down') as HTMLInputElement).value = '2';
      (document.getElementById('tys-lh') as HTMLInputElement).value = '1.5';
      document.querySelectorAll('.tys-in').forEach(el => { el.addEventListener('input', calcTys); el.addEventListener('change', calcTys); });
      calcTys();
    }, 50);
  </script>
</CalculatorLayout>
