---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Batting Average Calculator";
const description = "Calculate batting average (BA), on-base percentage (OBP), slugging (SLG), and OPS for baseball/softball.";
const relatedCalcs = [
  { name: "Average Calculator", url: "/average-calculator", description: "Average." },
  { name: "Percentage", url: "/percentage-calculator", description: "Percentage." },
  { name: "GPA Calculator", url: "/gpa-calculator", description: "GPA." },
  { name: "Probability", url: "/probability-calculator", description: "Probability." },
  { name: "Sports Betting", url: "/sports-betting-calculator", description: "Betting." },
  { name: "Ratio Calculator", url: "/ratio-calculator", description: "Ratio." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Batting Average Calculator" keywords="batting average, OBP, slugging percentage, OPS, baseball stats, softball stats" breadcrumbs={[{ name: "Batting Average", url: "/batting-average-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Batting Average Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate BA, OBP, SLG, and OPS from your stats.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">At Bats (AB)</label><input type="number" id="ba-ab" class="ba-in w-full px-4 py-3 border border-border rounded-xl text-2xl font-bold" value="400" min="0" step="1"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Hits (H)</label><input type="number" id="ba-h" class="ba-in w-full px-4 py-3 border border-border rounded-xl text-2xl font-bold" value="120" min="0" step="1"></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Doubles (2B)</label><input type="number" id="ba-2b" class="ba-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="25" min="0" step="1"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Triples (3B)</label><input type="number" id="ba-3b" class="ba-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="3" min="0" step="1"></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Home Runs (HR)</label><input type="number" id="ba-hr" class="ba-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="18" min="0" step="1"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Walks (BB)</label><input type="number" id="ba-bb" class="ba-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="50" min="0" step="1"></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Hit By Pitch (HBP)</label><input type="number" id="ba-hbp" class="ba-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="5" min="0" step="1"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Sacrifice Flies (SF)</label><input type="number" id="ba-sf" class="ba-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="4" min="0" step="1"></div>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Batting Average</div>
          <div class="text-5xl font-extrabold font-mono" id="ba-result">.000</div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">OBP</div><div class="text-xl font-bold font-mono" id="ba-obp">.000</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">SLG</div><div class="text-xl font-bold font-mono" id="ba-slg">.000</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">OPS</div><div class="text-xl font-bold font-mono" id="ba-ops">.000</div></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Singles</div><div class="text-xl font-bold font-mono" id="ba-1b">0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Total Bases</div><div class="text-xl font-bold font-mono" id="ba-tb">0</div></div>
        </div>
        <div class="p-4 rounded-xl text-center" id="ba-status-box"><div class="font-bold text-sm" id="ba-status">-</div></div>
      </div>
      <ShareButton calculatorId="batting-average" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcBA() {
      const ab = parseFloat((document.getElementById('ba-ab') as HTMLInputElement).value) || 0;
      const h = parseFloat((document.getElementById('ba-h') as HTMLInputElement).value) || 0;
      const d = parseFloat((document.getElementById('ba-2b') as HTMLInputElement).value) || 0;
      const t = parseFloat((document.getElementById('ba-3b') as HTMLInputElement).value) || 0;
      const hr = parseFloat((document.getElementById('ba-hr') as HTMLInputElement).value) || 0;
      const bb = parseFloat((document.getElementById('ba-bb') as HTMLInputElement).value) || 0;
      const hbp = parseFloat((document.getElementById('ba-hbp') as HTMLInputElement).value) || 0;
      const sf = parseFloat((document.getElementById('ba-sf') as HTMLInputElement).value) || 0;
      const singles = h - d - t - hr;
      const tb = singles + 2 * d + 3 * t + 4 * hr;
      const ba = ab > 0 ? h / ab : 0;
      const obpDenom = ab + bb + hbp + sf;
      const obp = obpDenom > 0 ? (h + bb + hbp) / obpDenom : 0;
      const slg = ab > 0 ? tb / ab : 0;
      const ops = obp + slg;
      const fmt = (v: number) => v.toFixed(3);
      document.getElementById('ba-result')!.textContent = fmt(ba);
      document.getElementById('ba-obp')!.textContent = fmt(obp);
      document.getElementById('ba-slg')!.textContent = fmt(slg);
      document.getElementById('ba-ops')!.textContent = fmt(ops);
      document.getElementById('ba-1b')!.textContent = Math.max(0, singles).toFixed(0);
      document.getElementById('ba-tb')!.textContent = tb.toFixed(0);
      let status: string, color: string;
      if (ba >= .300) { status = 'Elite hitter (.300+)'; color = 'bg-green-50 text-green-800'; }
      else if (ba >= .270) { status = 'Above average (.270+)'; color = 'bg-blue-50 text-blue-800'; }
      else if (ba >= .250) { status = 'Average hitter'; color = 'bg-yellow-50 text-yellow-800'; }
      else { status = 'Below average'; color = 'bg-red-50 text-red-800'; }
      document.getElementById('ba-status')!.textContent = status;
      document.getElementById('ba-status-box')!.className = `p-4 rounded-xl text-center ${color}`;
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.ba-in').forEach(el => { el.addEventListener('input', calcBA); el.addEventListener('change', calcBA); });
      calcBA();
    }, 50);
  </script>
</CalculatorLayout>
