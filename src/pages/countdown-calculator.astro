---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Countdown Calculator - Days Until Any Date";
const description = "Count down to any future date. See days, hours, minutes, and seconds remaining until your target date.";
const relatedCalcs = [
  { name: "Date Calculator", url: "/date-calculator", description: "Date math." },
  { name: "Age Calculator", url: "/age-calculator", description: "Age." },
  { name: "Hours Calculator", url: "/hours-calculator", description: "Hours." },
  { name: "Time Calculator", url: "/time-calculator", description: "Time." },
  { name: "Business Days", url: "/business-days-calculator", description: "Work days." },
  { name: "Pregnancy Calculator", url: "/pregnancy-calculator", description: "Due date." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Countdown Calculator" keywords="countdown calculator, days until, countdown timer, date countdown, time until event" breadcrumbs={[{ name: "Countdown", url: "/countdown-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Countdown Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">See exactly how much time remains until any date.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Target Date</label><input type="date" id="cd-date" class="cd-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="2026-12-31"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Event Name</label><input type="text" id="cd-name" class="w-full px-4 py-3 border border-border rounded-xl text-lg" value="New Year 2027" placeholder="Optional"></div>
        </div>
        <div class="flex gap-2 flex-wrap">
          <button class="cd-preset px-3 py-1 rounded-full text-xs border border-border font-bold hover:bg-blue-50" data-date="2026-12-25" data-name="Christmas">Christmas</button>
          <button class="cd-preset px-3 py-1 rounded-full text-xs border border-border font-bold hover:bg-blue-50" data-date="2027-01-01" data-name="New Year 2027">New Year</button>
          <button class="cd-preset px-3 py-1 rounded-full text-xs border border-border font-bold hover:bg-blue-50" data-date="2026-07-04" data-name="July 4th">July 4th</button>
          <button class="cd-preset px-3 py-1 rounded-full text-xs border border-border font-bold hover:bg-blue-50" data-date="2026-10-31" data-name="Halloween">Halloween</button>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1" id="cd-label">Time Until</div>
          <div class="text-5xl font-extrabold font-mono" id="cd-days">0</div>
          <div class="text-sm text-blue-200 mt-1">days</div>
        </div>
        <div class="grid grid-cols-4 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Days</div><div class="text-2xl font-bold font-mono" id="cd-d">0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Hours</div><div class="text-2xl font-bold font-mono" id="cd-h">0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Minutes</div><div class="text-2xl font-bold font-mono" id="cd-m">0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Seconds</div><div class="text-2xl font-bold font-mono" id="cd-s">0</div></div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Weeks</div><div class="text-xl font-bold" id="cd-weeks">0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Total Hours</div><div class="text-xl font-bold" id="cd-totH">0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Total Minutes</div><div class="text-xl font-bold" id="cd-totM">0</div></div>
        </div>
      </div>
      <ShareButton calculatorId="countdown" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcCD() {
      const dateStr = (document.getElementById('cd-date') as HTMLInputElement).value;
      const name = (document.getElementById('cd-name') as HTMLInputElement).value || 'Target Date';
      if (!dateStr) return;
      const target = new Date(dateStr + 'T00:00:00');
      const now = new Date();
      const diff = target.getTime() - now.getTime();
      const past = diff < 0;
      const absDiff = Math.abs(diff);
      const totalDays = Math.floor(absDiff / 86400000);
      const hours = Math.floor((absDiff % 86400000) / 3600000);
      const mins = Math.floor((absDiff % 3600000) / 60000);
      const secs = Math.floor((absDiff % 60000) / 1000);
      document.getElementById('cd-label')!.textContent = past ? `Time Since ${name}` : `Time Until ${name}`;
      document.getElementById('cd-days')!.textContent = (past ? '-' : '') + totalDays.toLocaleString();
      document.getElementById('cd-d')!.textContent = String(totalDays);
      document.getElementById('cd-h')!.textContent = String(hours);
      document.getElementById('cd-m')!.textContent = String(mins);
      document.getElementById('cd-s')!.textContent = String(secs);
      document.getElementById('cd-weeks')!.textContent = (totalDays / 7).toFixed(1);
      document.getElementById('cd-totH')!.textContent = Math.floor(absDiff / 3600000).toLocaleString();
      document.getElementById('cd-totM')!.textContent = Math.floor(absDiff / 60000).toLocaleString();
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.cd-in').forEach(el => el.addEventListener('input', calcCD));
      document.querySelectorAll('.cd-preset').forEach(btn => btn.addEventListener('click', () => {
        (document.getElementById('cd-date') as HTMLInputElement).value = (btn as HTMLElement).dataset.date!;
        (document.getElementById('cd-name') as HTMLInputElement).value = (btn as HTMLElement).dataset.name!;
        calcCD();
      }));
      calcCD();
      setInterval(calcCD, 1000);
    }, 50);
  </script>
</CalculatorLayout>
