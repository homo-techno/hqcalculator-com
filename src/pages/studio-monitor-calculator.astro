---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Studio Monitor Calculator - Listening Triangle & Placement";
const description = "Calculate optimal studio monitor placement including listening triangle dimensions, monitor angle, desk reflection point, and boundary distances.";
const relatedCalcs = [
  { name: "Sound Speed Calculator", url: "/sound-speed-calculator", description: "Speed of sound." },
  { name: "Decibel Calculator", url: "/decibel-calculator", description: "Decibel math." },
  { name: "Noise Level Calculator", url: "/noise-level-calculator", description: "Noise levels." },
  { name: "Frequency Calculator", url: "/frequency-calculator", description: "Convert frequency units." },
  { name: "Length Converter", url: "/length-converter", description: "Convert lengths." },
  { name: "Noise Reduction Calculator", url: "/noise-reduction-calculator", description: "Noise reduction." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Studio Monitor Calculator" keywords="studio monitor placement, listening triangle, monitor angle, desk reflection, boundary distance, mixing position" breadcrumbs={[{ name: "Studio Monitor", url: "/studio-monitor-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Studio Monitor Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate optimal monitor placement for an accurate listening environment.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="block text-xs font-medium text-text mb-1">Distance from You to Monitor (inches)</label>
            <input type="number" id="sm2-dist" class="sm2-in w-full px-4 py-3 border border-border rounded-xl text-2xl font-bold" min="20" max="200" step="1">
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Monitor Woofer Size (inches)</label>
            <select id="sm2-woof" class="sm2-in w-full px-4 py-3 border border-border rounded-xl text-lg">
              <option value="3">3" (Near-field)</option>
              <option value="5" selected>5" (Near-field)</option>
              <option value="6.5">6.5" (Near-field)</option>
              <option value="8">8" (Mid-field)</option>
              <option value="10">10" (Mid-field)</option>
            </select>
          </div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div>
            <label class="block text-xs font-medium text-text mb-1">Room Width (ft)</label>
            <input type="number" id="sm2-rw" class="sm2-in w-full px-4 py-3 border border-border rounded-xl text-lg" min="5" max="50" step="0.5">
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Room Length (ft)</label>
            <input type="number" id="sm2-rl" class="sm2-in w-full px-4 py-3 border border-border rounded-xl text-lg" min="5" max="50" step="0.5">
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Desk Height (inches)</label>
            <input type="number" id="sm2-dh" class="sm2-in w-full px-4 py-3 border border-border rounded-xl text-lg" min="24" max="48" step="1">
          </div>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Ear Height (seated, inches from floor)</label>
          <input type="number" id="sm2-eh" class="sm2-in w-full px-4 py-3 border border-border rounded-xl text-lg" min="30" max="55" step="1">
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Equilateral Triangle Side</div>
          <div class="text-4xl font-extrabold font-mono" id="sm2-tri">0"</div>
          <div class="text-sm text-blue-200 mt-1" id="sm2-tricm">0 cm</div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Speaker Spread</div><div class="text-xl font-bold font-mono" id="sm2-spread">0"</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Toe-In Angle</div><div class="text-xl font-bold font-mono" id="sm2-angle">0 deg</div></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Monitor Height (tweeter)</div><div class="text-xl font-bold font-mono" id="sm2-height">0"</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Desk Reflection Point</div><div class="text-xl font-bold font-mono" id="sm2-refl">0"</div></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Min Wall Distance (rear)</div><div class="text-xl font-bold font-mono" id="sm2-wall">0"</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Min Side Wall Distance</div><div class="text-xl font-bold font-mono" id="sm2-side">0"</div></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <div class="text-xs text-text-muted uppercase mb-2">Placement Tips</div>
          <div class="text-sm space-y-1" id="sm2-tips"></div>
        </div>
      </div>
      <ShareButton calculatorId="studio-monitor" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcSM2() {
      const dist = parseFloat((document.getElementById('sm2-dist') as HTMLInputElement).value) || 48;
      const woofer = parseFloat((document.getElementById('sm2-woof') as HTMLSelectElement).value);
      const roomW = parseFloat((document.getElementById('sm2-rw') as HTMLInputElement).value) || 12;
      const roomL = parseFloat((document.getElementById('sm2-rl') as HTMLInputElement).value) || 15;
      const deskH = parseFloat((document.getElementById('sm2-dh') as HTMLInputElement).value) || 30;
      const earH = parseFloat((document.getElementById('sm2-eh') as HTMLInputElement).value) || 44;

      const triSide = dist;
      document.getElementById('sm2-tri')!.textContent = triSide.toFixed(1) + '"';
      document.getElementById('sm2-tricm')!.textContent = (triSide * 2.54).toFixed(1) + ' cm';

      const spread = triSide;
      document.getElementById('sm2-spread')!.textContent = spread.toFixed(1) + '" center to center';

      const angleRad = Math.atan2(spread / 2, dist);
      const angleDeg = angleRad * 180 / Math.PI;
      document.getElementById('sm2-angle')!.textContent = (30).toFixed(0) + '\u00B0 each (60\u00B0 total)';

      document.getElementById('sm2-height')!.textContent = earH + '" from floor (at ear level)';

      const monitorAboveDesk = earH - deskH;
      const reflDist = dist / 2;
      document.getElementById('sm2-refl')!.textContent = reflDist.toFixed(0) + '" from monitors';

      const minWallDist = 12 + woofer;
      const minSideDist = spread / 2 + 12;
      document.getElementById('sm2-wall')!.textContent = minWallDist.toFixed(0) + '"';
      document.getElementById('sm2-side')!.textContent = minSideDist.toFixed(0) + '"';

      const tips = document.getElementById('sm2-tips')!;
      let tipsHTML = '';
      if (monitorAboveDesk < 6) {
        tipsHTML += '<div>Consider monitor stands: tweeters should be at ear height (' + earH + '" from floor).</div>';
      }
      if (woofer >= 8 && dist < 60) {
        tipsHTML += '<div>For ' + woofer + '" monitors, consider increasing distance to ' + (woofer * 8) + '" or more.</div>';
      }
      if (woofer <= 5 && dist > 72) {
        tipsHTML += '<div>Small ' + woofer + '" monitors may lack SPL at ' + dist + '". Consider larger monitors.</div>';
      }
      tipsHTML += '<div>Place absorption at the desk reflection point (' + reflDist.toFixed(0) + '" from monitors).</div>';
      tipsHTML += '<div>Keep monitors symmetric relative to room side walls.</div>';
      tipsHTML += '<div>Avoid placing monitors exactly at 33% or 50% of room length (' + (roomL * 12 / 3).toFixed(0) + '" or ' + (roomL * 12 / 2).toFixed(0) + '" from rear wall).</div>';
      tips.innerHTML = tipsHTML;

      document.dispatchEvent(new CustomEvent('calc-update'));
    }

    setTimeout(() => {
      (document.getElementById('sm2-dist') as HTMLInputElement).value = '48';
      (document.getElementById('sm2-rw') as HTMLInputElement).value = '12';
      (document.getElementById('sm2-rl') as HTMLInputElement).value = '15';
      (document.getElementById('sm2-dh') as HTMLInputElement).value = '30';
      (document.getElementById('sm2-eh') as HTMLInputElement).value = '44';
      document.querySelectorAll('.sm2-in').forEach(el => { el.addEventListener('input', calcSM2); el.addEventListener('change', calcSM2); });
      calcSM2();
    }, 50);
  </script>
</CalculatorLayout>
