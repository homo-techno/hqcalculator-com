---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Plate Tectonics Calculator - Velocity & Distance Over Time";
const description = "Calculate tectonic plate velocity, distance traveled over geological time, convergence/divergence rate, and future position estimates.";
const relatedCalcs = [
  { name: "Earthquake Magnitude", url: "/earthquake-magnitude-calculator", description: "Earthquake scale." },
  { name: "Erosion Calculator", url: "/erosion-calculator", description: "Erosion rates." },
  { name: "Density Calculator", url: "/density-calculator", description: "Material density." },
  { name: "Force Calculator", url: "/force-calculator", description: "Force calculations." },
  { name: "Energy Converter", url: "/energy-converter", description: "Energy units." },
  { name: "Age Calculator", url: "/age-calculator", description: "Calculate age." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Plate Tectonics Calculator" keywords="plate tectonics, plate velocity, convergence rate, divergence, tectonic movement, continental drift" breadcrumbs={[{ name: "Plate Tectonics", url: "/plate-tectonics-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Plate Tectonics Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Estimate tectonic plate velocity, distance traveled over time, convergence/divergence rates, and project future positions.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-text mb-1">Plate / Boundary</label>
          <select id="pt4-plate" class="pt4-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="25">Pacific Plate (~25 mm/yr, fastest)</option>
            <option value="18">Indian Plate (~18 mm/yr)</option>
            <option value="23">Australian Plate (~23 mm/yr)</option>
            <option value="10">North American Plate (~10 mm/yr)</option>
            <option value="21">South American Plate (~21 mm/yr)</option>
            <option value="6">Eurasian Plate (~6 mm/yr)</option>
            <option value="15">African Plate (~15 mm/yr)</option>
            <option value="8">Antarctic Plate (~8 mm/yr)</option>
            <option value="0">Custom Rate</option>
          </select>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="block text-sm font-medium text-text mb-1">Plate Velocity (mm/yr)</label>
            <input type="number" id="pt4-velocity" class="pt4-in w-full px-4 py-3 border border-border rounded-xl text-lg" value="25" min="0" step="0.5">
          </div>
          <div>
            <label class="block text-sm font-medium text-text mb-1">Time Period (million years)</label>
            <input type="number" id="pt4-time" class="pt4-in w-full px-4 py-3 border border-border rounded-xl text-lg" value="100" min="0" step="1">
          </div>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Boundary Type</label>
          <select id="pt4-boundary" class="pt4-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="divergent">Divergent (spreading apart)</option>
            <option value="convergent">Convergent (coming together)</option>
            <option value="transform">Transform (sliding past)</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Second Plate Velocity (mm/yr) - for relative motion</label>
          <input type="number" id="pt4-vel2" class="pt4-in w-full px-4 py-3 border border-border rounded-xl text-lg" value="10" min="0" step="0.5">
        </div>
      </div>

      <div class="mt-6 space-y-3">
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Distance Traveled</div>
          <div class="text-4xl font-extrabold" id="pt4-dist">0 km</div>
          <div class="text-sm text-blue-200 mt-1" id="pt4-distmi">0 miles</div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Velocity (cm/yr)</div>
            <div class="text-xl font-bold" id="pt4-cmyr">0</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Relative Motion Rate</div>
            <div class="text-xl font-bold" id="pt4-relative">0 mm/yr</div>
          </div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Distance per 1 My</div>
            <div class="text-xl font-bold" id="pt4-per1my">0 km</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Relative Distance</div>
            <div class="text-xl font-bold" id="pt4-reldist">0 km</div>
          </div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Speed Comparison</div>
          <div class="text-sm font-bold" id="pt4-compare">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Boundary Note</div>
          <div class="text-sm" id="pt4-note">--</div>
        </div>
      </div>

      <ShareButton calculatorId="plate-tectonics" />
      <FeedbackWidget />
    </div>

    <article class="mt-12 max-w-4xl prose prose-slate">
      <h2 class="text-2xl font-bold text-text">Plate Tectonics Calculations</h2>
      <div class="bg-surface-alt rounded-xl p-4 my-4 font-mono text-sm space-y-1">
        <p><strong>Distance</strong> = Velocity (mm/yr) x Time (years)</p>
        <p><strong>Relative Rate</strong> = |Plate1 Velocity +/- Plate2 Velocity|</p>
        <p>Average plate speed: ~25 mm/year (about as fast as fingernails grow)</p>
      </div>
    </article>

    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    function calcPT4() {
      const plateVal = (document.getElementById('pt4-plate') as HTMLSelectElement).value;
      if (plateVal !== '0') {
        (document.getElementById('pt4-velocity') as HTMLInputElement).value = plateVal;
      }

      const vel = parseFloat((document.getElementById('pt4-velocity') as HTMLInputElement).value) || 0;
      const time = parseFloat((document.getElementById('pt4-time') as HTMLInputElement).value) || 0;
      const boundary = (document.getElementById('pt4-boundary') as HTMLSelectElement).value;
      const vel2 = parseFloat((document.getElementById('pt4-vel2') as HTMLInputElement).value) || 0;

      const distKm = (vel / 1000) * time * 1e6 / 1000;
      const distMi = distKm * 0.621371;
      const cmYr = vel / 10;
      const per1My = (vel / 1000) * 1e6 / 1000;

      let relativeRate = 0;
      if (boundary === 'divergent') relativeRate = vel + vel2;
      else if (boundary === 'convergent') relativeRate = Math.abs(vel - vel2);
      else relativeRate = vel;

      const relDistKm = (relativeRate / 1000) * time * 1e6 / 1000;

      const fingernailGrowth = 3.5;
      const hairGrowth = 15;
      let compare = '';
      if (vel < fingernailGrowth) compare = 'Slower than fingernail growth (' + fingernailGrowth + ' mm/yr)';
      else if (vel < hairGrowth) compare = 'Similar to fingernail growth speed';
      else compare = 'Faster than fingernails, approaching hair growth rate (' + hairGrowth + ' mm/yr)';

      const notes: Record<string, string> = {
        divergent: 'Plates move apart; new crust forms at mid-ocean ridges (e.g., Mid-Atlantic Ridge)',
        convergent: 'Plates collide; subduction zones, mountain building (e.g., Himalayas, Andes)',
        transform: 'Plates slide laterally; earthquakes common (e.g., San Andreas Fault)'
      };

      const fmt = (n: number) => n.toLocaleString('en-US', { maximumFractionDigits: 1 });

      document.getElementById('pt4-dist')!.textContent = fmt(distKm) + ' km';
      document.getElementById('pt4-distmi')!.textContent = fmt(distMi) + ' miles';
      document.getElementById('pt4-cmyr')!.textContent = cmYr.toFixed(2) + ' cm/yr';
      document.getElementById('pt4-relative')!.textContent = fmt(relativeRate) + ' mm/yr';
      document.getElementById('pt4-per1my')!.textContent = fmt(per1My) + ' km';
      document.getElementById('pt4-reldist')!.textContent = fmt(relDistKm) + ' km';
      document.getElementById('pt4-compare')!.textContent = compare;
      document.getElementById('pt4-note')!.textContent = notes[boundary] || '';

      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.pt4-in').forEach(el => { el.addEventListener('input', calcPT4); el.addEventListener('change', calcPT4); });
      calcPT4();
    }, 50);
  </script>
</CalculatorLayout>
