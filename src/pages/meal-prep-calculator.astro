---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Meal Prep Calculator - Weekly Meals, Macros & Grocery Estimate";
const description = "Plan your weekly meal prep with total meals, calories, macro splits (protein, carbs, fat), and grocery cost estimates.";
const relatedCalcs = [
  { name: "Protein Per Dollar", url: "/protein-per-dollar-calculator", description: "Compare protein value of foods." },
  { name: "Food Cost Calculator", url: "/food-cost-calculator", description: "Restaurant food cost analysis." },
  { name: "Meat Cooking Calculator", url: "/meat-cooking-calculator", description: "Cooking times and temps." },
  { name: "Baking Conversion", url: "/baking-conversion-calculator", description: "Convert baking measurements." },
  { name: "Sourdough Calculator", url: "/sourdough-calculator", description: "Sourdough bread ratios." },
  { name: "Calorie Calculator", url: "/calorie-calculator", description: "Daily calorie needs." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Meal Prep Calculator" keywords="meal prep calculator, weekly meal prep, macro calculator, meal planning, grocery budget, meal prep cost" breadcrumbs={[{ name: "Meal Prep", url: "/meal-prep-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Meal Prep Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Plan your weekly meal prep with macro breakdowns and grocery cost estimates.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="block text-xs font-medium text-text mb-1">Meals Per Day</label>
            <input type="number" id="mp-meals" class="mp-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="3" min="1" max="8" step="1">
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Days to Prep</label>
            <input type="number" id="mp-days" class="mp-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="5" min="1" max="7" step="1">
          </div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="block text-xs font-medium text-text mb-1">Calories Per Meal</label>
            <input type="number" id="mp-cal" class="mp-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="500" min="100" step="50">
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">People</label>
            <input type="number" id="mp-people" class="mp-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="1" min="1" step="1">
          </div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div>
            <label class="block text-xs font-medium text-text mb-1">Protein (%)</label>
            <input type="number" id="mp-prot" class="mp-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="30" min="0" max="100" step="5">
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Carbs (%)</label>
            <input type="number" id="mp-carb" class="mp-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="40" min="0" max="100" step="5">
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Fat (%)</label>
            <input type="number" id="mp-fat" class="mp-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="30" min="0" max="100" step="5">
          </div>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Est. Cost Per Meal ($)</label>
          <input type="number" id="mp-cost" class="mp-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="4.00" min="0" step="0.25">
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Total Meals to Prep</div>
          <div class="text-5xl font-extrabold font-mono" id="mp-result">0</div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Total Calories</div><div class="text-xl font-bold font-mono" id="mp-totalcal">0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Daily Calories</div><div class="text-xl font-bold font-mono" id="mp-dailycal">0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Grocery Est.</div><div class="text-xl font-bold font-mono" id="mp-grocery">$0</div></div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Protein / Meal</div><div class="text-xl font-bold font-mono" id="mp-protg">0 g</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Carbs / Meal</div><div class="text-xl font-bold font-mono" id="mp-carbg">0 g</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Fat / Meal</div><div class="text-xl font-bold font-mono" id="mp-fatg">0 g</div></div>
        </div>
      </div>
      <ShareButton calculatorId="meal-prep" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcMP() {
      const mealsPerDay = parseFloat((document.getElementById('mp-meals') as HTMLInputElement).value) || 0;
      const days = parseFloat((document.getElementById('mp-days') as HTMLInputElement).value) || 0;
      const calPerMeal = parseFloat((document.getElementById('mp-cal') as HTMLInputElement).value) || 0;
      const people = parseFloat((document.getElementById('mp-people') as HTMLInputElement).value) || 1;
      const protPct = parseFloat((document.getElementById('mp-prot') as HTMLInputElement).value) || 0;
      const carbPct = parseFloat((document.getElementById('mp-carb') as HTMLInputElement).value) || 0;
      const fatPct = parseFloat((document.getElementById('mp-fat') as HTMLInputElement).value) || 0;
      const costPerMeal = parseFloat((document.getElementById('mp-cost') as HTMLInputElement).value) || 0;
      const totalMeals = mealsPerDay * days * people;
      const totalCalories = totalMeals * calPerMeal;
      const dailyCalories = mealsPerDay * calPerMeal;
      const groceryEst = totalMeals * costPerMeal;
      // Macros per meal (protein=4cal/g, carbs=4cal/g, fat=9cal/g)
      const proteinGrams = (calPerMeal * (protPct / 100)) / 4;
      const carbGrams = (calPerMeal * (carbPct / 100)) / 4;
      const fatGrams = (calPerMeal * (fatPct / 100)) / 9;
      document.getElementById('mp-result')!.textContent = totalMeals.toString();
      document.getElementById('mp-totalcal')!.textContent = totalCalories.toLocaleString();
      document.getElementById('mp-dailycal')!.textContent = dailyCalories.toLocaleString();
      document.getElementById('mp-grocery')!.textContent = '$' + groceryEst.toFixed(2);
      document.getElementById('mp-protg')!.textContent = proteinGrams.toFixed(0) + ' g';
      document.getElementById('mp-carbg')!.textContent = carbGrams.toFixed(0) + ' g';
      document.getElementById('mp-fatg')!.textContent = fatGrams.toFixed(0) + ' g';
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.mp-in').forEach(el => { el.addEventListener('input', calcMP); el.addEventListener('change', calcMP); });
      calcMP();
    }, 50);
  </script>
</CalculatorLayout>
