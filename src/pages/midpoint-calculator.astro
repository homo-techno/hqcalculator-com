---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Midpoint Calculator - Find Midpoint Between Two Points";
const description = "Calculate the midpoint, distance, and slope between two points in 2D or 3D space.";
const relatedCalcs = [
  { name: "Slope Calculator", url: "/slope-calculator", description: "Line slope." },
  { name: "Pythagorean Theorem", url: "/pythagorean-theorem-calculator", description: "Right triangles." },
  { name: "Triangle Calculator", url: "/triangle-calculator", description: "Triangles." },
  { name: "Circle Calculator", url: "/circle-calculator", description: "Circles." },
  { name: "Area Calculator", url: "/area-calculator", description: "2D areas." },
  { name: "Length Converter", url: "/length-converter", description: "Length units." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Midpoint Calculator" keywords="midpoint calculator, midpoint formula, distance between two points, midpoint of a line" breadcrumbs={[{ name: "Midpoint Calculator", url: "/midpoint-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Midpoint Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Find the midpoint and distance between two points.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="flex gap-2 mb-2">
          <button id="mp-2d" class="px-4 py-2 rounded-lg text-sm font-semibold border-2 border-primary bg-blue-50 text-primary">2D</button>
          <button id="mp-3d" class="px-4 py-2 rounded-lg text-sm font-semibold border-2 border-border text-text-muted">3D</button>
        </div>
        <div class="grid grid-cols-2 gap-4">
          <div class="space-y-2">
            <h3 class="font-semibold text-sm text-text">Point 1</h3>
            <div class="grid grid-cols-2 gap-2" id="mp-p1-grid">
              <div><label class="block text-xs font-medium text-text mb-1">x₁</label><input type="number" id="mp-x1" class="mp-in w-full px-3 py-3 border border-border rounded-xl text-lg font-bold" value="2" step="0.5"></div>
              <div><label class="block text-xs font-medium text-text mb-1">y₁</label><input type="number" id="mp-y1" class="mp-in w-full px-3 py-3 border border-border rounded-xl text-lg font-bold" value="3" step="0.5"></div>
            </div>
          </div>
          <div class="space-y-2">
            <h3 class="font-semibold text-sm text-text">Point 2</h3>
            <div class="grid grid-cols-2 gap-2" id="mp-p2-grid">
              <div><label class="block text-xs font-medium text-text mb-1">x₂</label><input type="number" id="mp-x2" class="mp-in w-full px-3 py-3 border border-border rounded-xl text-lg font-bold" value="8" step="0.5"></div>
              <div><label class="block text-xs font-medium text-text mb-1">y₂</label><input type="number" id="mp-y2" class="mp-in w-full px-3 py-3 border border-border rounded-xl text-lg font-bold" value="7" step="0.5"></div>
            </div>
          </div>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Midpoint</div>
          <div class="text-4xl font-extrabold font-mono" id="mp-result">(0, 0)</div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-secondary rounded-xl text-white text-center"><div class="text-xs uppercase tracking-wide mb-1 opacity-80">Distance</div><div class="text-xl font-bold" id="mp-dist">0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Slope</div><div class="text-xl font-bold" id="mp-slope">0</div></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-2">Step-by-Step</h3>
          <div class="font-mono text-sm space-y-1" id="mp-steps"></div>
        </div>
      </div>
      <ShareButton calculatorId="midpoint" />
      <FeedbackWidget />
    </div>
    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">Midpoint Formula</h2>
      <div class="bg-surface-alt rounded-xl p-4 my-4 font-mono text-sm space-y-1">
        <p>M = ((x₁+x₂)/2, (y₁+y₂)/2)</p>
        <p>Distance = √((x₂−x₁)² + (y₂−y₁)²)</p>
      </div>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    let is3D = false;
    function setMode(mode: string) {
      is3D = mode === '3d';
      document.getElementById('mp-2d')!.className = `px-4 py-2 rounded-lg text-sm font-semibold border-2 ${!is3D ? 'border-primary bg-blue-50 text-primary' : 'border-border text-text-muted'}`;
      document.getElementById('mp-3d')!.className = `px-4 py-2 rounded-lg text-sm font-semibold border-2 ${is3D ? 'border-primary bg-blue-50 text-primary' : 'border-border text-text-muted'}`;
      const z1 = document.getElementById('mp-z1-wrap');
      const z2 = document.getElementById('mp-z2-wrap');
      if (is3D && !z1) {
        const d1 = document.createElement('div'); d1.id = 'mp-z1-wrap';
        d1.innerHTML = '<label class="block text-xs font-medium text-text mb-1">z₁</label><input type="number" id="mp-z1" class="mp-in w-full px-3 py-3 border border-border rounded-xl text-lg font-bold" value="0" step="0.5">';
        document.getElementById('mp-p1-grid')!.appendChild(d1);
        document.getElementById('mp-p1-grid')!.className = 'grid grid-cols-3 gap-2';
        const d2 = document.createElement('div'); d2.id = 'mp-z2-wrap';
        d2.innerHTML = '<label class="block text-xs font-medium text-text mb-1">z₂</label><input type="number" id="mp-z2" class="mp-in w-full px-3 py-3 border border-border rounded-xl text-lg font-bold" value="0" step="0.5">';
        document.getElementById('mp-p2-grid')!.appendChild(d2);
        document.getElementById('mp-p2-grid')!.className = 'grid grid-cols-3 gap-2';
        document.querySelectorAll('.mp-in').forEach(el => el.addEventListener('input', calcMid));
      } else if (!is3D && z1) {
        z1.remove(); z2!.remove();
        document.getElementById('mp-p1-grid')!.className = 'grid grid-cols-2 gap-2';
        document.getElementById('mp-p2-grid')!.className = 'grid grid-cols-2 gap-2';
      }
      calcMid();
    }
    function calcMid() {
      const x1 = parseFloat((document.getElementById('mp-x1') as HTMLInputElement).value) || 0;
      const y1 = parseFloat((document.getElementById('mp-y1') as HTMLInputElement).value) || 0;
      const x2 = parseFloat((document.getElementById('mp-x2') as HTMLInputElement).value) || 0;
      const y2 = parseFloat((document.getElementById('mp-y2') as HTMLInputElement).value) || 0;
      const z1 = is3D ? (parseFloat((document.getElementById('mp-z1') as HTMLInputElement)?.value) || 0) : 0;
      const z2 = is3D ? (parseFloat((document.getElementById('mp-z2') as HTMLInputElement)?.value) || 0) : 0;
      const mx = (x1+x2)/2, my = (y1+y2)/2, mz = (z1+z2)/2;
      const dx = x2-x1, dy = y2-y1, dz = z2-z1;
      const dist = Math.sqrt(dx*dx + dy*dy + dz*dz);
      document.getElementById('mp-result')!.textContent = is3D ? `(${mx.toFixed(2)}, ${my.toFixed(2)}, ${mz.toFixed(2)})` : `(${mx.toFixed(2)}, ${my.toFixed(2)})`;
      document.getElementById('mp-dist')!.textContent = dist.toFixed(4);
      if (dx === 0) { document.getElementById('mp-slope')!.textContent = 'Undefined'; }
      else { document.getElementById('mp-slope')!.textContent = (dy/dx).toFixed(4); }
      const steps: string[] = [];
      steps.push(`Midpoint x = (${x1} + ${x2}) / 2 = ${mx.toFixed(2)}`);
      steps.push(`Midpoint y = (${y1} + ${y2}) / 2 = ${my.toFixed(2)}`);
      if (is3D) steps.push(`Midpoint z = (${z1} + ${z2}) / 2 = ${mz.toFixed(2)}`);
      steps.push(`Distance = √(${dx}² + ${dy}²${is3D ? ` + ${dz}²` : ''}) = ${dist.toFixed(4)}`);
      document.getElementById('mp-steps')!.innerHTML = steps.map(s => `<div>${s}</div>`).join('');
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.mp-in').forEach(el => el.addEventListener('input', calcMid));
      document.getElementById('mp-2d')!.addEventListener('click', () => setMode('2d'));
      document.getElementById('mp-3d')!.addEventListener('click', () => setMode('3d'));
      calcMid();
    }, 50);
  </script>
</CalculatorLayout>
