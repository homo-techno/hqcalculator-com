---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Pet Medication Calculator - Dosage by Weight & Concentration";
const description = "Calculate pet medication dosages by weight for common veterinary drugs. Includes concentration conversion and tablet splitting guidance.";
const relatedCalcs = [
  { name: "Dog Food Calculator", url: "/dog-food-calculator", description: "Daily food portions for dogs." },
  { name: "Cat Food Calculator", url: "/cat-food-calculator", description: "Daily calories for cats." },
  { name: "Flea Treatment Calculator", url: "/flea-treatment-calculator", description: "Flea treatment schedule and dosage." },
  { name: "Animal Calorie Calculator", url: "/animal-calorie-calculator", description: "Energy requirements for animals." },
  { name: "Pet Insurance Calculator", url: "/pet-insurance-calculator", description: "Estimate insurance premiums." },
  { name: "Pet Cost Calculator", url: "/pet-cost-calculator", description: "Annual pet ownership costs." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Pet Medication Calculator" keywords="pet medication dosage, dog medication calculator, cat medication, veterinary dosage, tablet splitting" breadcrumbs={[{ name: "Pet Medication", url: "/pet-medication-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Pet Medication Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate medication dosage by weight, convert concentrations, and get tablet splitting guidance. Always consult your vet.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="block text-xs font-medium text-text mb-1">Pet Weight (lbs)</label>
            <input type="number" id="pm2-weight" class="pm2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="30" min="1" max="300" step="0.5">
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Medication</label>
            <select id="pm2-med" class="pm2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
              <option value="amoxicillin" selected>Amoxicillin</option>
              <option value="metronidazole">Metronidazole</option>
              <option value="carprofen">Carprofen (Rimadyl)</option>
              <option value="benadryl">Diphenhydramine (Benadryl)</option>
              <option value="gabapentin">Gabapentin</option>
              <option value="tramadol">Tramadol</option>
              <option value="prednisone">Prednisone</option>
              <option value="custom">Custom Dosage</option>
            </select>
          </div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="block text-xs font-medium text-text mb-1">Tablet Strength (mg)</label>
            <input type="number" id="pm2-strength" class="pm2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="250" min="1" step="1">
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Custom Dose (mg/kg) - if custom</label>
            <input type="number" id="pm2-custom" class="pm2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="10" min="0.1" step="0.1">
          </div>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Liquid Concentration (mg/mL) - if liquid</label>
          <input type="number" id="pm2-conc" class="pm2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="50" min="1" step="1">
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Dose Per Administration</div>
          <div class="text-5xl font-extrabold font-mono" id="pm2-result">--</div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Tablets</div><div class="text-xl font-bold font-mono" id="pm2-tabs">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Liquid (mL)</div><div class="text-xl font-bold font-mono" id="pm2-ml">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Frequency</div><div class="text-xl font-bold font-mono" id="pm2-freq">--</div></div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Daily Total</div><div class="text-xl font-bold font-mono" id="pm2-daily">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Weight (kg)</div><div class="text-xl font-bold font-mono" id="pm2-kg">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Dose (mg/kg)</div><div class="text-xl font-bold font-mono" id="pm2-mgkg">--</div></div>
        </div>
        <div class="p-3 bg-amber-50 border border-amber-200 rounded-xl text-sm text-amber-800">
          Always consult your veterinarian before administering any medication. This calculator is for informational purposes only.
        </div>
      </div>
      <ShareButton calculatorId="pet-medication" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcPM2() {
      const weight = parseFloat((document.getElementById('pm2-weight') as HTMLInputElement).value) || 0;
      const med = (document.getElementById('pm2-med') as HTMLSelectElement).value;
      const strength = parseFloat((document.getElementById('pm2-strength') as HTMLInputElement).value) || 250;
      const customDose = parseFloat((document.getElementById('pm2-custom') as HTMLInputElement).value) || 10;
      const conc = parseFloat((document.getElementById('pm2-conc') as HTMLInputElement).value) || 50;

      const weightKg = weight * 0.4536;

      // Standard dosages (mg/kg) and frequencies
      const medData: Record<string, { dose: number; freq: string; timesDay: number }> = {
        amoxicillin: { dose: 11, freq: 'Every 12 hrs', timesDay: 2 },
        metronidazole: { dose: 12.5, freq: 'Every 12 hrs', timesDay: 2 },
        carprofen: { dose: 2.2, freq: 'Every 12 hrs', timesDay: 2 },
        benadryl: { dose: 2, freq: 'Every 8 hrs', timesDay: 3 },
        gabapentin: { dose: 5, freq: 'Every 8-12 hrs', timesDay: 2 },
        tramadol: { dose: 3, freq: 'Every 8-12 hrs', timesDay: 2 },
        prednisone: { dose: 0.5, freq: 'Once daily', timesDay: 1 },
        custom: { dose: customDose, freq: 'As directed', timesDay: 1 },
      };

      const data = medData[med] || medData['custom'];
      const doseMg = weightKg * data.dose;
      const tablets = doseMg / strength;
      const liquidMl = doseMg / conc;
      const dailyTotal = doseMg * data.timesDay;

      document.getElementById('pm2-result')!.textContent = doseMg.toFixed(1) + ' mg';
      document.getElementById('pm2-tabs')!.textContent = tablets.toFixed(2);
      document.getElementById('pm2-ml')!.textContent = liquidMl.toFixed(1);
      document.getElementById('pm2-freq')!.textContent = data.freq;
      document.getElementById('pm2-daily')!.textContent = dailyTotal.toFixed(1) + ' mg';
      document.getElementById('pm2-kg')!.textContent = weightKg.toFixed(1);
      document.getElementById('pm2-mgkg')!.textContent = data.dose.toFixed(1);
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.pm2-in').forEach(el => { el.addEventListener('input', calcPM2); el.addEventListener('change', calcPM2); });
      calcPM2();
    }, 50);
  </script>
</CalculatorLayout>
