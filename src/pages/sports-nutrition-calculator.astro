---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Sports Nutrition Calculator";
const description = "Calculate pre, during, and post-workout nutrition needs including carbs, protein, and hydration based on sport type and duration.";
const relatedCalcs = [
  { name: "Macro Calculator", url: "/macro-calculator", description: "Daily macros." },
  { name: "Protein Calculator", url: "/protein-calculator", description: "Protein needs." },
  { name: "Calorie Calculator", url: "/calorie-calculator", description: "Daily calories." },
  { name: "TDEE Calculator", url: "/tdee-calculator", description: "Daily energy." },
  { name: "Water Intake", url: "/water-intake-calculator", description: "Hydration needs." },
  { name: "Hydration Calculator", url: "/hydration-calculator", description: "Fluid balance." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Sports Nutrition Calculator" keywords="sports nutrition calculator, workout nutrition, pre workout, post workout, carb loading, sports hydration" breadcrumbs={[{ name: "Sports Nutrition", url: "/sports-nutrition-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Sports Nutrition Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Get personalized pre, during, and post-workout nutrition recommendations based on your sport and intensity.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Body Weight (kg)</label><input type="number" id="sn2-weight" class="sn2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="30" max="200" step="1"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Duration (minutes)</label><input type="number" id="sn2-dur" class="sn2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="15" max="600" step="15"></div>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Sport Type</label>
          <select id="sn2-sport" class="sn2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
            <option value="endurance">Endurance (Running, Cycling, Swimming)</option>
            <option value="strength">Strength Training (Weights, CrossFit)</option>
            <option value="team">Team Sports (Soccer, Basketball)</option>
            <option value="hiit">HIIT / Interval Training</option>
            <option value="climbing">Climbing / Bouldering</option>
            <option value="racket">Racket Sports (Tennis, Badminton)</option>
          </select>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Intensity</label>
          <select id="sn2-intensity" class="sn2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
            <option value="low">Low (easy pace, recovery)</option>
            <option value="moderate" selected>Moderate (steady state)</option>
            <option value="high">High (threshold, race pace)</option>
            <option value="max">Max (competition, all-out)</option>
          </select>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Goal</label>
          <select id="sn2-goal" class="sn2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
            <option value="performance">Performance / Recovery</option>
            <option value="loss">Fat Loss (calorie deficit)</option>
            <option value="gain">Muscle Gain</option>
          </select>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Est. Calories Burned</div>
          <div class="text-5xl font-extrabold font-mono" id="sn2-cal">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-2">Pre-Workout (1-3 hrs before)</h3>
          <div class="text-sm space-y-1" id="sn2-pre"></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-2">During Workout</h3>
          <div class="text-sm space-y-1" id="sn2-during"></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-2">Post-Workout (within 30-60 min)</h3>
          <div class="text-sm space-y-1" id="sn2-post"></div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Total Carbs</div><div class="text-xl font-bold font-mono" id="sn2-carbs">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Total Protein</div><div class="text-xl font-bold font-mono" id="sn2-protein">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Total Fluid</div><div class="text-xl font-bold font-mono" id="sn2-fluid">--</div></div>
        </div>
      </div>
      <ShareButton calculatorId="sports-nutrition" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcSN2() {
      const weight = parseFloat((document.getElementById('sn2-weight') as HTMLInputElement).value) || 0;
      const dur = parseFloat((document.getElementById('sn2-dur') as HTMLInputElement).value) || 0;
      const sport = (document.getElementById('sn2-sport') as HTMLSelectElement).value;
      const intensity = (document.getElementById('sn2-intensity') as HTMLSelectElement).value;
      const goal = (document.getElementById('sn2-goal') as HTMLSelectElement).value;
      if (weight <= 0 || dur <= 0) return;
      let metMultiplier = 6;
      if (sport === 'endurance') metMultiplier = intensity === 'max' ? 14 : intensity === 'high' ? 11 : intensity === 'moderate' ? 8 : 5;
      else if (sport === 'strength') metMultiplier = intensity === 'max' ? 8 : intensity === 'high' ? 6 : intensity === 'moderate' ? 5 : 3;
      else if (sport === 'team') metMultiplier = intensity === 'max' ? 12 : intensity === 'high' ? 10 : intensity === 'moderate' ? 7 : 4;
      else if (sport === 'hiit') metMultiplier = intensity === 'max' ? 13 : intensity === 'high' ? 10 : intensity === 'moderate' ? 8 : 5;
      else if (sport === 'climbing') metMultiplier = intensity === 'max' ? 10 : intensity === 'high' ? 8 : intensity === 'moderate' ? 6 : 4;
      else if (sport === 'racket') metMultiplier = intensity === 'max' ? 11 : intensity === 'high' ? 9 : intensity === 'moderate' ? 7 : 4;
      const calBurned = Math.round(metMultiplier * weight * (dur / 60));
      const isEndurance = sport === 'endurance' || sport === 'team';
      const isStrength = sport === 'strength';
      let preCarbsGKg = isEndurance ? 1.5 : 1.0;
      let preProteinGKg = isStrength ? 0.3 : 0.2;
      let duringCarbsGHr = 0;
      if (dur > 60) duringCarbsGHr = isEndurance ? 60 : 30;
      else if (dur > 45) duringCarbsGHr = 30;
      let postCarbsGKg = isEndurance ? 1.2 : 0.8;
      let postProteinGKg = isStrength ? 0.4 : 0.3;
      if (goal === 'loss') {
        preCarbsGKg *= 0.7;
        postCarbsGKg *= 0.6;
        postProteinGKg *= 1.1;
      } else if (goal === 'gain') {
        preCarbsGKg *= 1.2;
        postCarbsGKg *= 1.3;
        postProteinGKg *= 1.3;
      }
      const preCarbs = Math.round(preCarbsGKg * weight);
      const preProtein = Math.round(preProteinGKg * weight);
      const preFat = Math.round(weight * 0.15);
      const duringCarbs = Math.round(duringCarbsGHr * (dur / 60));
      const duringHours = dur / 60;
      const fluidDuringMl = Math.round(duringHours * 600);
      const postCarbs = Math.round(postCarbsGKg * weight);
      const postProtein = Math.round(postProteinGKg * weight);
      const totalCarbs = preCarbs + duringCarbs + postCarbs;
      const totalProtein = preProtein + postProtein;
      const totalFluidMl = fluidDuringMl + 500;
      document.getElementById('sn2-cal')!.textContent = calBurned + ' kcal';
      document.getElementById('sn2-pre')!.innerHTML = [
        `<div class="flex justify-between"><span class="text-text-muted">Carbohydrates</span><span class="font-bold font-mono">${preCarbs}g</span></div>`,
        `<div class="flex justify-between"><span class="text-text-muted">Protein</span><span class="font-bold font-mono">${preProtein}g</span></div>`,
        `<div class="flex justify-between"><span class="text-text-muted">Fat (low)</span><span class="font-bold font-mono">${preFat}g</span></div>`,
        `<div class="flex justify-between"><span class="text-text-muted">Water</span><span class="font-bold font-mono">400-600 ml</span></div>`,
        `<div class="text-xs text-text-muted mt-1">Examples: oatmeal + banana, toast + eggs, rice + chicken</div>`,
      ].join('');
      const duringHTML = [];
      if (dur > 45) {
        duringHTML.push(`<div class="flex justify-between"><span class="text-text-muted">Carbohydrates</span><span class="font-bold font-mono">${duringCarbs}g total (${duringCarbsGHr}g/hr)</span></div>`);
        duringHTML.push(`<div class="flex justify-between"><span class="text-text-muted">Fluid</span><span class="font-bold font-mono">${fluidDuringMl} ml (${Math.round(fluidDuringMl / duringHours)} ml/hr)</span></div>`);
        duringHTML.push(`<div class="flex justify-between"><span class="text-text-muted">Sodium</span><span class="font-bold font-mono">${Math.round(duringHours * 500)} mg</span></div>`);
        duringHTML.push(`<div class="text-xs text-text-muted mt-1">Examples: sports drink, gels, bananas, energy chews</div>`);
      } else {
        duringHTML.push(`<div class="flex justify-between"><span class="text-text-muted">Fluid</span><span class="font-bold font-mono">${fluidDuringMl} ml</span></div>`);
        duringHTML.push(`<div class="text-xs text-text-muted mt-1">Water is sufficient for sessions under 45 min</div>`);
      }
      document.getElementById('sn2-during')!.innerHTML = duringHTML.join('');
      document.getElementById('sn2-post')!.innerHTML = [
        `<div class="flex justify-between"><span class="text-text-muted">Carbohydrates</span><span class="font-bold font-mono">${postCarbs}g</span></div>`,
        `<div class="flex justify-between"><span class="text-text-muted">Protein</span><span class="font-bold font-mono">${postProtein}g</span></div>`,
        `<div class="flex justify-between"><span class="text-text-muted">Water</span><span class="font-bold font-mono">500+ ml</span></div>`,
        `<div class="text-xs text-text-muted mt-1">Examples: protein shake + fruit, chocolate milk, rice + fish</div>`,
      ].join('');
      document.getElementById('sn2-carbs')!.textContent = totalCarbs + 'g';
      document.getElementById('sn2-protein')!.textContent = totalProtein + 'g';
      document.getElementById('sn2-fluid')!.textContent = (totalFluidMl / 1000).toFixed(1) + ' L';
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      (document.getElementById('sn2-weight') as HTMLInputElement).value = '75';
      (document.getElementById('sn2-dur') as HTMLInputElement).value = '90';
      document.querySelectorAll('.sn2-in').forEach(el => { el.addEventListener('input', calcSN2); el.addEventListener('change', calcSN2); });
      calcSN2();
    }, 50);
  </script>
</CalculatorLayout>
