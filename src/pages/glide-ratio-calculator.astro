---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Glide Ratio Calculator - Glide Distance, Best Glide & Emergency Range";
const description = "Calculate glide distance from altitude and glide ratio. Find best glide speed, headwind effects, and emergency range for engine-out scenarios.";
const relatedCalcs = [
  { name: "Speed Calculator", url: "/speed-calculator", description: "Speed computations." },
  { name: "Acceleration", url: "/acceleration-calculator", description: "Acceleration math." },
  { name: "Kinetic Energy", url: "/kinetic-energy-calculator", description: "Energy math." },
  { name: "Force Calculator", url: "/force-calculator", description: "Force calculations." },
  { name: "Bearing Calculator", url: "/bearing-calculator", description: "Bearing angles." },
  { name: "Flight Time", url: "/flight-time-calculator", description: "Flight duration." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Glide Ratio Calculator" keywords="glide ratio, glide distance, best glide speed, engine out, emergency range, L/D ratio, sink rate" breadcrumbs={[{ name: "Glide Ratio", url: "/glide-ratio-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Glide Ratio Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Determine glide distance, best glide speed, and emergency range for engine-out situations.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div>
          <label for="gl2-alt" class="block text-sm font-medium text-text mb-1">Altitude AGL (ft)</label>
          <input type="number" id="gl2-alt" class="gl2-in w-full border border-border rounded-lg px-3 py-2" min="0" step="500" />
        </div>
        <div>
          <label for="gl2-ratio" class="block text-sm font-medium text-text mb-1">Glide Ratio (e.g., 9 for 9:1)</label>
          <input type="number" id="gl2-ratio" class="gl2-in w-full border border-border rounded-lg px-3 py-2" min="1" max="60" step="0.5" />
        </div>
        <div>
          <label for="gl2-bg" class="block text-sm font-medium text-text mb-1">Best Glide Speed (kts IAS)</label>
          <input type="number" id="gl2-bg" class="gl2-in w-full border border-border rounded-lg px-3 py-2" min="0" step="1" />
        </div>
        <div>
          <label for="gl2-hw" class="block text-sm font-medium text-text mb-1">Headwind (kts, negative = tailwind)</label>
          <input type="number" id="gl2-hw" class="gl2-in w-full border border-border rounded-lg px-3 py-2" step="5" />
        </div>
        <div>
          <label for="gl2-wt" class="block text-sm font-medium text-text mb-1">Current Weight (lbs)</label>
          <input type="number" id="gl2-wt" class="gl2-in w-full border border-border rounded-lg px-3 py-2" min="0" step="50" />
        </div>
        <div>
          <label for="gl2-mgw" class="block text-sm font-medium text-text mb-1">Max Gross Weight (lbs)</label>
          <input type="number" id="gl2-mgw" class="gl2-in w-full border border-border rounded-lg px-3 py-2" min="0" step="50" />
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Maximum Glide Distance</div>
          <div class="text-5xl font-extrabold font-mono" id="gl2-result">--</div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">No-Wind Glide Distance</div>
            <div class="text-xl font-bold font-mono" id="gl2-nowind">--</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Glide Time</div>
            <div class="text-xl font-bold font-mono" id="gl2-time">--</div>
          </div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Sink Rate</div>
            <div class="text-xl font-bold font-mono" id="gl2-sink">--</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Adjusted Best Glide</div>
            <div class="text-xl font-bold font-mono" id="gl2-adjbg">--</div>
          </div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Glide Angle</div>
            <div class="text-xl font-bold font-mono" id="gl2-angle">--</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Ground Speed</div>
            <div class="text-xl font-bold font-mono" id="gl2-gs">--</div>
          </div>
        </div>
      </div>
      <ShareButton calculatorId="glide-ratio" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcGL2() {
      const alt = parseFloat((document.getElementById('gl2-alt') as HTMLInputElement).value) || 5000;
      const ratio = parseFloat((document.getElementById('gl2-ratio') as HTMLInputElement).value) || 9;
      const bg = parseFloat((document.getElementById('gl2-bg') as HTMLInputElement).value) || 68;
      const hw = parseFloat((document.getElementById('gl2-hw') as HTMLInputElement).value) || 0;
      const wt = parseFloat((document.getElementById('gl2-wt') as HTMLInputElement).value) || 2200;
      const mgw = parseFloat((document.getElementById('gl2-mgw') as HTMLInputElement).value) || 2550;

      // No-wind glide distance in feet, then NM
      const glideFt = alt * ratio;
      const glideNM = glideFt / 6076.12;

      // Adjusted best glide for weight: Vbg_adj = Vbg * sqrt(wt/mgw)
      const bgAdj = bg * Math.sqrt(wt / mgw);

      // Sink rate: best glide speed (ft/min) / glide ratio
      const bgFtMin = bgAdj * 6076.12 / 60;
      const sinkRate = bgFtMin / ratio;

      // Glide time
      const glideTimeMin = sinkRate > 0 ? alt / sinkRate : 0;

      // Ground speed during glide
      const gs = bgAdj - hw;

      // Wind-adjusted glide distance
      const windGlideFt = gs > 0 ? (glideTimeMin / 60) * gs * 6076.12 : 0;
      const windGlideNM = (glideTimeMin / 60) * gs;

      // Glide angle
      const glideAngle = Math.atan(1 / ratio) * 180 / Math.PI;

      const mins = Math.floor(glideTimeMin);
      const secs = Math.round((glideTimeMin - mins) * 60);

      document.getElementById('gl2-result')!.textContent = windGlideNM.toFixed(1) + ' NM';
      document.getElementById('gl2-nowind')!.textContent = glideNM.toFixed(1) + ' NM';
      document.getElementById('gl2-time')!.textContent = mins + 'm ' + secs + 's';
      document.getElementById('gl2-sink')!.textContent = Math.round(sinkRate) + ' FPM';
      document.getElementById('gl2-adjbg')!.textContent = bgAdj.toFixed(0) + ' kts';
      document.getElementById('gl2-angle')!.textContent = glideAngle.toFixed(1) + 'Â°';
      document.getElementById('gl2-gs')!.textContent = gs.toFixed(0) + ' kts';

      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      (document.getElementById('gl2-alt') as HTMLInputElement).value = '5000';
      (document.getElementById('gl2-ratio') as HTMLInputElement).value = '9';
      (document.getElementById('gl2-bg') as HTMLInputElement).value = '68';
      (document.getElementById('gl2-hw') as HTMLInputElement).value = '10';
      (document.getElementById('gl2-wt') as HTMLInputElement).value = '2200';
      (document.getElementById('gl2-mgw') as HTMLInputElement).value = '2550';
      document.querySelectorAll('.gl2-in').forEach(el => { el.addEventListener('input', calcGL2); el.addEventListener('change', calcGL2); });
      calcGL2();
    }, 50);
  </script>
</CalculatorLayout>
