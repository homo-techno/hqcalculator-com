---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Light Travel Time Calculator";
const description = "Calculate distances in light-minutes, light-hours, and light-years, plus travel time at various speeds.";
const relatedCalcs = [
  { name: "Speed Calculator", url: "/speed-calculator", description: "Speed." },
  { name: "Length Converter", url: "/length-converter-calculator", description: "Distances." },
  { name: "Orbital Period", url: "/orbital-period-calculator", description: "Orbits." },
  { name: "Scientific Notation", url: "/scientific-notation-calculator", description: "Notation." },
  { name: "Flight Time", url: "/flight-time-calculator", description: "Flight time." },
  { name: "Time Calculator", url: "/time-calculator", description: "Time." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Light Travel Time Calculator" keywords="light travel time, light year, light minute, speed of light, cosmic distance, travel time" breadcrumbs={[{ name: "Light Travel Time", url: "/light-travel-time-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Light Travel Time Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">How long does light take to travel a distance? How far could you go at different fractions of light speed?</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div><label class="block text-xs font-medium text-text mb-1">Input Mode</label>
          <select id="lt-mode" class="lt-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
            <option value="dist" selected>Distance to Light Travel Time</option>
            <option value="preset">Preset Distances</option>
          </select>
        </div>
        <div id="lt-dist-panel">
          <div class="grid grid-cols-2 gap-3">
            <div><label class="block text-xs font-medium text-text mb-1">Distance Value</label><input type="number" id="lt-val" class="lt-in w-full px-4 py-3 border border-border rounded-xl text-2xl font-bold" value="384400" step="1" min="0"></div>
            <div><label class="block text-xs font-medium text-text mb-1">Unit</label>
              <select id="lt-unit" class="lt-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
                <option value="km" selected>Kilometers</option>
                <option value="mi">Miles</option>
                <option value="au">AU</option>
                <option value="ly">Light-years</option>
                <option value="pc">Parsecs</option>
              </select>
            </div>
          </div>
        </div>
        <div id="lt-preset-panel" style="display:none;">
          <select id="lt-preset" class="lt-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
            <option value="384400">Earth to Moon (384,400 km)</option>
            <option value="149597870.7">Earth to Sun (1 AU)</option>
            <option value="778500000">Earth to Jupiter (~5.2 AU)</option>
            <option value="4494000000">Earth to Neptune (~30 AU)</option>
            <option value="40208000000000">Alpha Centauri (4.25 ly)</option>
            <option value="2.537e17">Andromeda Galaxy (2.537 Mly)</option>
          </select>
        </div>
        <div><label class="block text-xs font-medium text-text mb-1">Travel Speed (% of light speed)</label><input type="number" id="lt-speed" class="lt-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="100" step="1" min="0.001" max="100"></div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Light Travel Time</div>
          <div class="text-4xl font-extrabold font-mono" id="lt-result">--</div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Distance (km)</div><div class="text-xl font-bold font-mono" id="lt-km">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Distance (AU)</div><div class="text-xl font-bold font-mono" id="lt-au">--</div></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Distance (light-years)</div><div class="text-xl font-bold font-mono" id="lt-ly">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Travel at Your Speed</div><div class="text-xl font-bold font-mono" id="lt-custom">--</div></div>
        </div>
      </div>
      <ShareButton calculatorId="light-travel-time" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    const C_LT = 299792.458;
    const AU_KM = 149597870.7;
    const LY_KM = 9.461e12;
    const PC_KM = 3.0857e13;

    function formatTime(seconds: number): string {
      if (seconds < 0.001) return (seconds * 1e6).toFixed(2) + ' \u00b5s';
      if (seconds < 1) return (seconds * 1000).toFixed(2) + ' ms';
      if (seconds < 60) return seconds.toFixed(2) + ' seconds';
      if (seconds < 3600) return (seconds / 60).toFixed(2) + ' minutes';
      if (seconds < 86400) return (seconds / 3600).toFixed(2) + ' hours';
      if (seconds < 86400 * 365.25) return (seconds / 86400).toFixed(2) + ' days';
      const years = seconds / (86400 * 365.25);
      if (years < 1e6) return years.toFixed(2) + ' years';
      if (years < 1e9) return (years / 1e6).toFixed(2) + ' million years';
      return (years / 1e9).toFixed(2) + ' billion years';
    }

    function calcLT() {
      const mode = (document.getElementById('lt-mode') as HTMLSelectElement).value;
      document.getElementById('lt-dist-panel')!.style.display = mode === 'dist' ? 'block' : 'none';
      document.getElementById('lt-preset-panel')!.style.display = mode === 'preset' ? 'block' : 'none';

      let distKm = 0;
      if (mode === 'dist') {
        const val = parseFloat((document.getElementById('lt-val') as HTMLInputElement).value) || 0;
        const unit = (document.getElementById('lt-unit') as HTMLSelectElement).value;
        if (unit === 'km') distKm = val;
        else if (unit === 'mi') distKm = val * 1.60934;
        else if (unit === 'au') distKm = val * AU_KM;
        else if (unit === 'ly') distKm = val * LY_KM;
        else if (unit === 'pc') distKm = val * PC_KM;
      } else {
        distKm = parseFloat((document.getElementById('lt-preset') as HTMLSelectElement).value) || 0;
      }

      const speedPct = parseFloat((document.getElementById('lt-speed') as HTMLInputElement).value) || 100;
      const lightTimeSec = distKm / C_LT;
      const customSpeed = C_LT * speedPct / 100;
      const customTimeSec = distKm / customSpeed;

      document.getElementById('lt-result')!.textContent = formatTime(lightTimeSec);
      document.getElementById('lt-km')!.textContent = distKm < 1e9 ? distKm.toLocaleString(undefined, {maximumFractionDigits: 0}) : distKm.toExponential(3);
      document.getElementById('lt-au')!.textContent = (distKm / AU_KM).toFixed(6);
      document.getElementById('lt-ly')!.textContent = (distKm / LY_KM).toFixed(6);
      document.getElementById('lt-custom')!.textContent = formatTime(customTimeSec);
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.lt-in').forEach(el => { el.addEventListener('input', calcLT); el.addEventListener('change', calcLT); });
      calcLT();
    }, 50);
  </script>
</CalculatorLayout>
