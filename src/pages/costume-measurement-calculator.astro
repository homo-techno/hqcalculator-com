---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Costume Measurement Calculator - Sizing & Period Adjustments";
const description = "Calculate costume sizing from body measurements with historical period adjustments, armor allowances, and prop accommodation for cosplay and theater.";
const relatedCalcs = [
  { name: "Fabric Calculator", url: "/fabric-calculator", description: "Fabric yardage needs." },
  { name: "BMI Calculator", url: "/bmi-calculator", description: "Body mass index." },
  { name: "Body Fat Calculator", url: "/body-fat-calculator", description: "Body fat percentage." },
  { name: "Yarn Calculator", url: "/yarn-calculator", description: "Yarn yardage calculator." },
  { name: "Percentage Calculator", url: "/percentage-calculator", description: "Percentage calculations." },
  { name: "Length Converter", url: "/length-converter", description: "Length conversions." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Costume Measurement Calculator" keywords="costume measurement calculator, costume sizing, cosplay measurements, historical costume, armor allowance, period clothing" breadcrumbs={[{ name: "Costume Measurement", url: "/costume-measurement-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Costume Measurement Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate costume dimensions with period adjustments, armor allowances, and prop accommodations.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div>
          <label class="block text-xs font-medium text-text mb-1">Costume Period / Style</label>
          <select id="cm2-period" class="cm2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
            <option value="modern" selected>Modern / Contemporary</option>
            <option value="victorian">Victorian (1837-1901)</option>
            <option value="medieval">Medieval (500-1500)</option>
            <option value="renaissance">Renaissance (1400-1600)</option>
            <option value="regency">Regency (1811-1820)</option>
            <option value="1920s">1920s Flapper</option>
            <option value="1950s">1950s / Full Skirt</option>
            <option value="anime">Anime / Fantasy</option>
            <option value="armor">Armor / Mech</option>
            <option value="superhero">Superhero / Bodysuit</option>
          </select>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Bust / Chest (in)</label><input type="number" id="cm2-bust" class="cm2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="36" min="20" max="60" step="0.5"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Waist (in)</label><input type="number" id="cm2-waist" class="cm2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="28" min="18" max="54" step="0.5"></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Hip (in)</label><input type="number" id="cm2-hip" class="cm2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="38" min="24" max="60" step="0.5"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Height (in)</label><input type="number" id="cm2-height" class="cm2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="66" min="48" max="84" step="0.5"></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Shoulder Width (in)</label><input type="number" id="cm2-shoulder" class="cm2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="15" min="10" max="24" step="0.25"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Arm Length (in)</label><input type="number" id="cm2-arm" class="cm2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="24" min="14" max="36" step="0.5"></div>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Underlayer / Padding</label>
          <select id="cm2-under" class="cm2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
            <option value="none" selected>None</option>
            <option value="thin">Thin Undergarments (+0.5")</option>
            <option value="corset">Corset / Shapewear</option>
            <option value="padding">Muscle Padding (+2")</option>
            <option value="armor">Foam Armor Layer (+3")</option>
            <option value="heavy">Heavy Armor / Props (+4-6")</option>
          </select>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Adjusted Bust / Chest</div>
          <div class="text-4xl font-extrabold font-mono" id="cm2-result">--</div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Adj. Waist</div><div class="text-xl font-bold font-mono" id="cm2-adjwaist">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Adj. Hip</div><div class="text-xl font-bold font-mono" id="cm2-adjhip">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Adj. Shoulder</div><div class="text-xl font-bold font-mono" id="cm2-adjshoulder">--</div></div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Skirt Length</div><div class="text-xl font-bold font-mono" id="cm2-skirt">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Fabric Est.</div><div class="text-xl font-bold font-mono" id="cm2-fabric">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Period Note</div><div class="text-xl font-bold font-mono" id="cm2-note">--</div></div>
        </div>
      </div>
      <ShareButton calculatorId="costume-measurement" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcCM2() {
      const period = (document.getElementById('cm2-period') as HTMLSelectElement).value;
      const bust = parseFloat((document.getElementById('cm2-bust') as HTMLInputElement).value) || 36;
      const waist = parseFloat((document.getElementById('cm2-waist') as HTMLInputElement).value) || 28;
      const hip = parseFloat((document.getElementById('cm2-hip') as HTMLInputElement).value) || 38;
      const height = parseFloat((document.getElementById('cm2-height') as HTMLInputElement).value) || 66;
      const shoulder = parseFloat((document.getElementById('cm2-shoulder') as HTMLInputElement).value) || 15;
      const arm = parseFloat((document.getElementById('cm2-arm') as HTMLInputElement).value) || 24;
      const under = (document.getElementById('cm2-under') as HTMLSelectElement).value;

      // Underlayer additions
      const underAdd: Record<string, number[]> = {
        none: [0, 0, 0, 0],
        thin: [0.5, 0.5, 0.5, 0],
        corset: [1, -2, 0, 0], // corset reduces waist
        padding: [2, 1, 1, 1],
        armor: [3, 2, 2, 2],
        heavy: [5, 4, 3, 3]
      };
      const ua = underAdd[under] || [0, 0, 0, 0];

      // Period ease adjustments [bust, waist, hip, shoulder_extra]
      interface PeriodData { ease: number[]; skirtMult: number; note: string; fabricMult: number }
      const periodData: Record<string, PeriodData> = {
        modern:      { ease: [3, 2, 3, 0], skirtMult: 0.55, note: 'Standard ease', fabricMult: 2.5 },
        victorian:   { ease: [4, -1, 6, 0], skirtMult: 0.85, note: 'Corseted waist, full skirt', fabricMult: 8 },
        medieval:    { ease: [5, 4, 5, 1], skirtMult: 0.8, note: 'Loose layers, full length', fabricMult: 6 },
        renaissance: { ease: [4, 0, 5, 2], skirtMult: 0.8, note: 'Structured bodice', fabricMult: 7 },
        regency:     { ease: [2, 6, 4, 0], skirtMult: 0.75, note: 'Empire waist, flowing', fabricMult: 5 },
        '1920s':     { ease: [4, 4, 2, 0], skirtMult: 0.35, note: 'Dropped waist, straight', fabricMult: 3 },
        '1950s':     { ease: [3, -1, 5, 0], skirtMult: 0.6, note: 'Nipped waist, full skirt', fabricMult: 5 },
        anime:       { ease: [3, 2, 3, 1], skirtMult: 0.5, note: 'Exaggerated proportions', fabricMult: 3.5 },
        armor:       { ease: [6, 4, 4, 4], skirtMult: 0, note: 'Foam/thermoplastic over body', fabricMult: 0 },
        superhero:   { ease: [0, 0, 0, 0], skirtMult: 0, note: 'Skin-tight stretch fabric', fabricMult: 2 }
      };

      const pd = periodData[period] || periodData['modern'];

      const adjBust = bust + pd.ease[0] + ua[0];
      const adjWaist = waist + pd.ease[1] + ua[1];
      const adjHip = hip + pd.ease[2] + ua[2];
      const adjShoulder = shoulder + pd.ease[3] + ua[3];

      // Skirt length as fraction of height
      const skirtLen = pd.skirtMult > 0 ? (height * pd.skirtMult) : 0;

      // Rough fabric estimate (yards)
      const fabricYards = pd.fabricMult;

      document.getElementById('cm2-result')!.textContent = adjBust.toFixed(1) + '"';
      document.getElementById('cm2-adjwaist')!.textContent = adjWaist.toFixed(1) + '"';
      document.getElementById('cm2-adjhip')!.textContent = adjHip.toFixed(1) + '"';
      document.getElementById('cm2-adjshoulder')!.textContent = adjShoulder.toFixed(1) + '"';
      document.getElementById('cm2-skirt')!.textContent = skirtLen > 0 ? skirtLen.toFixed(1) + '"' : 'N/A';
      document.getElementById('cm2-fabric')!.textContent = fabricYards > 0 ? fabricYards + ' yd' : 'Foam/Worbla';
      document.getElementById('cm2-note')!.textContent = pd.note;
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.cm2-in').forEach(el => { el.addEventListener('input', calcCM2); el.addEventListener('change', calcCM2); });
      calcCM2();
    }, 50);
  </script>
</CalculatorLayout>
