---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Animal Calorie Calculator - RER, MER & Life Stage Calorie Needs";
const description = "Calculate resting energy requirement (RER), maintenance energy requirement (MER), and calorie needs by species, weight, and life stage.";
const relatedCalcs = [
  { name: "Dog Food Calculator", url: "/dog-food-calculator", description: "Daily food portions for dogs." },
  { name: "Cat Food Calculator", url: "/cat-food-calculator", description: "Daily calories for cats." },
  { name: "Pet Food Calculator", url: "/pet-food-calculator", description: "General pet food portions." },
  { name: "Dog BMI Calculator", url: "/dog-bmi-calculator", description: "Body condition score for dogs." },
  { name: "Horse Feed Calculator", url: "/horse-feed-calculator", description: "Feed amounts for horses." },
  { name: "Calorie Calculator", url: "/calorie-calculator", description: "Calculate human calorie needs." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Animal Calorie Calculator" keywords="animal calorie calculator, RER, MER, resting energy requirement, maintenance energy, pet calories" breadcrumbs={[{ name: "Animal Calorie", url: "/animal-calorie-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Animal Calorie Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate RER, MER, and daily calorie needs for your pet based on species, weight, and life stage.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="block text-xs font-medium text-text mb-1">Animal Species</label>
            <select id="ac2-species" class="ac2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
              <option value="dog" selected>Dog</option>
              <option value="cat">Cat</option>
              <option value="rabbit">Rabbit</option>
              <option value="bird">Bird (parrot)</option>
              <option value="horse">Horse</option>
            </select>
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Body Weight (lbs)</label>
            <input type="number" id="ac2-weight" class="ac2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="30" min="0.5" max="2500" step="0.5">
          </div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="block text-xs font-medium text-text mb-1">Life Stage</label>
            <select id="ac2-stage" class="ac2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
              <option value="growth">Growth (young)</option>
              <option value="adult" selected>Adult (neutered)</option>
              <option value="intact">Adult (intact)</option>
              <option value="senior">Senior</option>
              <option value="pregnant">Pregnant</option>
              <option value="lactating">Lactating</option>
              <option value="weight_loss">Weight Loss</option>
              <option value="critical">Critical Care / Illness</option>
            </select>
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Activity Level</label>
            <select id="ac2-activity" class="ac2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
              <option value="sedentary">Sedentary</option>
              <option value="normal" selected>Normal</option>
              <option value="active">Active</option>
              <option value="working">Working / Sporting</option>
            </select>
          </div>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Daily Energy Requirement (MER)</div>
          <div class="text-5xl font-extrabold font-mono" id="ac2-result">--</div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">RER (kcal/day)</div><div class="text-xl font-bold font-mono" id="ac2-rer">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">MER Factor</div><div class="text-xl font-bold font-mono" id="ac2-factor">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Weight (kg)</div><div class="text-xl font-bold font-mono" id="ac2-kg">--</div></div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Protein (g/day)</div><div class="text-xl font-bold font-mono" id="ac2-protein">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Fat (g/day)</div><div class="text-xl font-bold font-mono" id="ac2-fat">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Water (mL/day)</div><div class="text-xl font-bold font-mono" id="ac2-water">--</div></div>
        </div>
      </div>
      <ShareButton calculatorId="animal-calorie" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcAC2() {
      const species = (document.getElementById('ac2-species') as HTMLSelectElement).value;
      const weight = parseFloat((document.getElementById('ac2-weight') as HTMLInputElement).value) || 0;
      const stage = (document.getElementById('ac2-stage') as HTMLSelectElement).value;
      const activity = (document.getElementById('ac2-activity') as HTMLSelectElement).value;

      const weightKg = weight * 0.4536;

      // RER = 70 * (body weight in kg)^0.75
      const rer = 70 * Math.pow(weightKg, 0.75);

      // MER factors by life stage (for dogs/cats)
      const merFactors: Record<string, number> = {
        growth: 2.5, adult: 1.4, intact: 1.6, senior: 1.2,
        pregnant: 1.8, lactating: 3.0, weight_loss: 1.0, critical: 1.0
      };

      // Activity adjustment
      const actAdj: Record<string, number> = {
        sedentary: 0.85, normal: 1.0, active: 1.2, working: 1.6
      };

      // Species-specific adjustments
      const speciesAdj: Record<string, number> = {
        dog: 1.0, cat: 0.85, rabbit: 0.7, bird: 0.9, horse: 1.0
      };

      let factor = (merFactors[stage] || 1.4) * (actAdj[activity] || 1.0) * (speciesAdj[species] || 1.0);
      const mer = rer * factor;

      // Macronutrient estimates
      // Dogs: ~25% calories from protein, ~30% from fat
      // Cats: ~35% from protein, ~35% from fat
      const proteinPct = species === 'cat' ? 0.35 : 0.25;
      const fatPct = species === 'cat' ? 0.35 : 0.30;
      const proteinG = (mer * proteinPct) / 4; // 4 kcal/g protein
      const fatG = (mer * fatPct) / 9; // 9 kcal/g fat

      // Water: approximately 1 mL per kcal of energy
      const waterMl = Math.round(mer);

      document.getElementById('ac2-result')!.textContent = Math.round(mer) + ' kcal';
      document.getElementById('ac2-rer')!.textContent = Math.round(rer).toString();
      document.getElementById('ac2-factor')!.textContent = factor.toFixed(2) + 'x';
      document.getElementById('ac2-kg')!.textContent = weightKg.toFixed(1);
      document.getElementById('ac2-protein')!.textContent = Math.round(proteinG).toString();
      document.getElementById('ac2-fat')!.textContent = Math.round(fatG).toString();
      document.getElementById('ac2-water')!.textContent = waterMl.toString();
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.ac2-in').forEach(el => { el.addEventListener('input', calcAC2); el.addEventListener('change', calcAC2); });
      calcAC2();
    }, 50);
  </script>
</CalculatorLayout>
