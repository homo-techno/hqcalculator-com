---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Event Parking Calculator - Parking Spaces Needed";
const description = "Calculate parking spaces needed for your event based on guest count, transportation mix, and venue type. Plan for valet, shuttle, and overflow parking.";
const relatedCalcs = [
  { name: "Event Budget Calculator", url: "/event-budget-calculator", description: "Total event cost breakdown." },
  { name: "Event Staffing Calculator", url: "/event-staffing-calculator", description: "Staff needed for events." },
  { name: "Banquet Room Calculator", url: "/banquet-room-calculator", description: "Room size for events." },
  { name: "Event Timeline Calculator", url: "/event-timeline-calculator", description: "Event schedule planner." },
  { name: "Hotel Block Calculator", url: "/hotel-block-calculator", description: "Hotel room blocks." },
  { name: "Event Insurance Calculator", url: "/event-insurance-calculator", description: "Event liability insurance." },
];
---

<CalculatorLayout
  title={title}
  description={description}
  calculatorName="Event Parking Calculator"
  keywords="event parking calculator, parking spaces needed, valet parking, event transportation, parking lot planning"
  breadcrumbs={[{ name: "Event Parking", url: "/event-parking-calculator" }]}
>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Event Parking Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Determine how many parking spaces you need for your event.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4 mb-6">
        <div>
          <label class="block text-sm font-medium text-text mb-1">Number of Guests</label>
          <input type="number" id="ep2-guests" class="ep2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="150" min="1" step="1">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Average Guests per Vehicle</label>
          <input type="number" id="ep2-percar" class="ep2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="2.2" min="1" max="6" step="0.1">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Guests Using Rideshare / Taxi (%)</label>
          <input type="number" id="ep2-rideshare" class="ep2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="10" min="0" max="100" step="5">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Guests Using Shuttle / Bus (%)</label>
          <input type="number" id="ep2-shuttle" class="ep2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="0" min="0" max="100" step="5">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Staff & Vendor Vehicles</label>
          <input type="number" id="ep2-staff" class="ep2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="10" min="0" step="1">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Parking Type</label>
          <select id="ep2-type" class="ep2-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="self">Self-Park</option>
            <option value="valet">Valet (stacks closer)</option>
          </select>
        </div>
      </div>

      <div class="p-6 bg-primary rounded-2xl text-white text-center mb-4">
        <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Parking Spaces Needed</div>
        <div class="text-5xl font-extrabold" id="ep2-spaces">--</div>
        <div class="text-sm mt-1" id="ep2-note">--</div>
      </div>

      <div class="grid grid-cols-2 gap-4 mb-4">
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Guest Vehicles</div>
          <div class="text-xl font-bold" id="ep2-guestveh">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Lot Size Needed (sq ft)</div>
          <div class="text-xl font-bold" id="ep2-lotsqft">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">ADA Accessible</div>
          <div class="text-xl font-bold" id="ep2-ada">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Peak Arrival Cars/hr</div>
          <div class="text-xl font-bold" id="ep2-peak">--</div>
        </div>
      </div>

      <ShareButton calculatorId="event-parking" />
      <FeedbackWidget />
    </div>

    <article class="mt-12 max-w-4xl prose prose-slate">
      <h2 class="text-2xl font-bold text-text">Event Parking Planning</h2>
      <p>Average vehicle occupancy for events is 2-2.5 people per car. Standard parking space: 180 sq ft (9x20 ft) plus drive aisle space. Valet parking can fit 30-40% more cars. ADA requires accessible spaces based on total lot size.</p>
    </article>

    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    function calcEP2() {
      const guests = parseInt((document.getElementById('ep2-guests') as HTMLInputElement).value) || 1;
      const perCar = parseFloat((document.getElementById('ep2-percar') as HTMLInputElement).value) || 2.2;
      const rideshare = parseFloat((document.getElementById('ep2-rideshare') as HTMLInputElement).value) || 0;
      const shuttle = parseFloat((document.getElementById('ep2-shuttle') as HTMLInputElement).value) || 0;
      const staffVeh = parseInt((document.getElementById('ep2-staff') as HTMLInputElement).value) || 0;
      const parkType = (document.getElementById('ep2-type') as HTMLSelectElement).value;

      const drivingPct = Math.max(0, 100 - rideshare - shuttle) / 100;
      const guestVehicles = Math.ceil(guests * drivingPct / perCar);
      const totalSpaces = guestVehicles + staffVeh;

      const sqftPerSpace = parkType === 'valet' ? 130 : 180;
      const lotSqft = totalSpaces * sqftPerSpace;

      let adaSpaces = 1;
      if (totalSpaces <= 25) adaSpaces = 1;
      else if (totalSpaces <= 50) adaSpaces = 2;
      else if (totalSpaces <= 75) adaSpaces = 3;
      else if (totalSpaces <= 100) adaSpaces = 4;
      else if (totalSpaces <= 150) adaSpaces = 5;
      else if (totalSpaces <= 200) adaSpaces = 6;
      else adaSpaces = Math.ceil(totalSpaces / 40) + 2;

      const peakCarsPerHr = Math.ceil(guestVehicles * 0.6);

      document.getElementById('ep2-spaces')!.textContent = totalSpaces.toLocaleString();
      document.getElementById('ep2-note')!.textContent = guestVehicles + ' guest + ' + staffVeh + ' staff/vendor';
      document.getElementById('ep2-guestveh')!.textContent = guestVehicles.toString();
      document.getElementById('ep2-lotsqft')!.textContent = lotSqft.toLocaleString();
      document.getElementById('ep2-ada')!.textContent = adaSpaces + ' spaces';
      document.getElementById('ep2-peak')!.textContent = peakCarsPerHr.toString();

      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.ep2-in').forEach(el => { el.addEventListener('input', calcEP2); el.addEventListener('change', calcEP2); });
      calcEP2();
    }, 50);
  </script>
</CalculatorLayout>
