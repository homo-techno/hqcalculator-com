---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Total Station Calculator - Distance & Elevation from Angles";
const description = "Calculate horizontal distance, vertical distance, and elevation from total station measurements including slope distance, zenith angle, and instrument heights.";
const relatedCalcs = [
  { name: "Elevation Difference", url: "/elevation-difference-calculator", description: "Trig leveling." },
  { name: "Traverse Calculator", url: "/traverse-calculator", description: "Closed traverse." },
  { name: "Leveling Calculator", url: "/leveling-calculator", description: "Differential leveling." },
  { name: "Stakeout Calculator", url: "/stakeout-calculator", description: "Stakeout coordinates." },
  { name: "Distance & Bearing", url: "/distance-bearing-calculator", description: "GPS distance & bearing." },
  { name: "Coordinate Converter", url: "/coordinate-converter-calculator", description: "Coordinate formats." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Total Station Calculator" keywords="total station calculator, slope distance, zenith angle, horizontal distance, vertical distance, survey instrument" breadcrumbs={[{ name: "Total Station Calculator", url: "/total-station-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Total Station Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Compute horizontal/vertical distances and target elevation from total station measurements.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-semibold text-text mb-1">Slope Distance (ft)</label>
          <input type="number" id="tsc-sd" class="tsc-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="350.00" step="0.01">
        </div>
        <div>
          <label class="block text-sm font-semibold text-text mb-1">Zenith Angle (degrees from vertical)</label>
          <input type="number" id="tsc-za" class="tsc-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="85.5" step="0.01">
          <p class="text-xs text-text-muted mt-1">90 = horizontal, less than 90 = looking up, greater than 90 = looking down</p>
        </div>
        <div>
          <label class="block text-sm font-semibold text-text mb-1">Horizontal Angle / Azimuth (degrees)</label>
          <input type="number" id="tsc-ha" class="tsc-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="45.00" step="0.01">
        </div>
        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-semibold text-text mb-1">Instrument Height (ft)</label>
            <input type="number" id="tsc-hi" class="tsc-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="5.20" step="0.01">
          </div>
          <div>
            <label class="block text-sm font-semibold text-text mb-1">Prism Height (ft)</label>
            <input type="number" id="tsc-ht" class="tsc-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="5.20" step="0.01">
          </div>
        </div>
        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-semibold text-text mb-1">Station Northing</label>
            <input type="number" id="tsc-sn" class="tsc-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="1000.00">
          </div>
          <div>
            <label class="block text-sm font-semibold text-text mb-1">Station Easting</label>
            <input type="number" id="tsc-se" class="tsc-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="1000.00">
          </div>
        </div>
        <div>
          <label class="block text-sm font-semibold text-text mb-1">Station Elevation (ft)</label>
          <input type="number" id="tsc-elev" class="tsc-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="100.00">
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Horizontal Distance</div>
          <div class="text-5xl font-extrabold font-mono" id="tsc-hd">--</div>
        </div>
        <div class="grid grid-cols-2 gap-4">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Vertical Distance</div>
            <div class="text-xl font-bold" id="tsc-vd">--</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Target Elevation</div>
            <div class="text-xl font-bold" id="tsc-te">--</div>
          </div>
        </div>
        <div class="grid grid-cols-2 gap-4">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Target Northing</div>
            <div class="text-xl font-bold" id="tsc-tn">--</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Target Easting</div>
            <div class="text-xl font-bold" id="tsc-te2">--</div>
          </div>
        </div>
      </div>
      <ShareButton calculatorId="total-station" />
      <FeedbackWidget />
    </div>
    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">Total Station Formulas</h2>
      <div class="bg-surface-alt rounded-xl p-4 my-4 font-mono text-sm space-y-1">
        <p>HD = SD * sin(ZA)</p>
        <p>VD = SD * cos(ZA)</p>
        <p>Target Elev = Station Elev + HI + VD - HT</p>
        <p>dN = HD * cos(HA), dE = HD * sin(HA)</p>
      </div>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcTSC() {
      const sd = parseFloat((document.getElementById('tsc-sd') as HTMLInputElement).value) || 0;
      const za = parseFloat((document.getElementById('tsc-za') as HTMLInputElement).value) || 90;
      const ha = parseFloat((document.getElementById('tsc-ha') as HTMLInputElement).value) || 0;
      const hi = parseFloat((document.getElementById('tsc-hi') as HTMLInputElement).value) || 0;
      const ht = parseFloat((document.getElementById('tsc-ht') as HTMLInputElement).value) || 0;
      const sn = parseFloat((document.getElementById('tsc-sn') as HTMLInputElement).value) || 0;
      const se = parseFloat((document.getElementById('tsc-se') as HTMLInputElement).value) || 0;
      const elev = parseFloat((document.getElementById('tsc-elev') as HTMLInputElement).value) || 0;
      const zaRad = za * Math.PI / 180;
      const haRad = ha * Math.PI / 180;
      const hd = sd * Math.sin(zaRad);
      const vd = sd * Math.cos(zaRad);
      const targetElev = elev + hi + vd - ht;
      const dN = hd * Math.cos(haRad);
      const dE = hd * Math.sin(haRad);
      const tN = sn + dN;
      const tE = se + dE;
      document.getElementById('tsc-hd')!.textContent = hd.toFixed(3) + ' ft';
      document.getElementById('tsc-vd')!.textContent = vd.toFixed(3) + ' ft';
      document.getElementById('tsc-te')!.textContent = targetElev.toFixed(3) + ' ft';
      document.getElementById('tsc-tn')!.textContent = tN.toFixed(3);
      document.getElementById('tsc-te2')!.textContent = tE.toFixed(3);
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.tsc-in').forEach(el => { el.addEventListener('input', calcTSC); el.addEventListener('change', calcTSC); });
      calcTSC();
    }, 50);
  </script>
</CalculatorLayout>
