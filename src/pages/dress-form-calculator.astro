---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Dress Form Calculator - Padding & Fitting Guide";
const description = "Calculate dress form padding amounts from body-to-form differences across key measurement points for accurate garment fitting.";
const relatedCalcs = [
  { name: "Fabric Calculator", url: "/fabric-calculator", description: "Fabric yardage needs." },
  { name: "BMI Calculator", url: "/bmi-calculator", description: "Body mass index." },
  { name: "Body Fat Calculator", url: "/body-fat-calculator", description: "Body fat percentage." },
  { name: "Yarn Calculator", url: "/yarn-calculator", description: "Yarn yardage calculator." },
  { name: "Percentage Calculator", url: "/percentage-calculator", description: "Percentage calculations." },
  { name: "Length Converter", url: "/length-converter", description: "Length conversions." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Dress Form Calculator" keywords="dress form calculator, dress form padding, fitting guide, body measurements, dress form sizing, padding amount" breadcrumbs={[{ name: "Dress Form", url: "/dress-form-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Dress Form Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate padding amounts needed to match your dress form to your body measurements.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <p class="text-xs text-text-muted font-medium">Enter your body measurements and dress form measurements (all in inches):</p>
        <div class="grid grid-cols-3 gap-3">
          <div class="text-xs font-bold text-text-muted pt-8">Measurement</div>
          <div class="text-xs font-bold text-text-muted text-center">Your Body</div>
          <div class="text-xs font-bold text-text-muted text-center">Dress Form</div>
        </div>
        <div class="grid grid-cols-3 gap-3 items-center">
          <div class="text-sm font-medium text-text">Bust</div>
          <div><input type="number" id="df2-bbust" class="df2-in w-full px-3 py-2 border border-border rounded-xl text-lg font-bold" value="36" min="20" max="60" step="0.25"></div>
          <div><input type="number" id="df2-fbust" class="df2-in w-full px-3 py-2 border border-border rounded-xl text-lg font-bold" value="34" min="20" max="60" step="0.25"></div>
        </div>
        <div class="grid grid-cols-3 gap-3 items-center">
          <div class="text-sm font-medium text-text">Waist</div>
          <div><input type="number" id="df2-bwaist" class="df2-in w-full px-3 py-2 border border-border rounded-xl text-lg font-bold" value="28" min="18" max="50" step="0.25"></div>
          <div><input type="number" id="df2-fwaist" class="df2-in w-full px-3 py-2 border border-border rounded-xl text-lg font-bold" value="26" min="18" max="50" step="0.25"></div>
        </div>
        <div class="grid grid-cols-3 gap-3 items-center">
          <div class="text-sm font-medium text-text">Hip</div>
          <div><input type="number" id="df2-bhip" class="df2-in w-full px-3 py-2 border border-border rounded-xl text-lg font-bold" value="38" min="24" max="60" step="0.25"></div>
          <div><input type="number" id="df2-fhip" class="df2-in w-full px-3 py-2 border border-border rounded-xl text-lg font-bold" value="36" min="24" max="60" step="0.25"></div>
        </div>
        <div class="grid grid-cols-3 gap-3 items-center">
          <div class="text-sm font-medium text-text">Shoulder</div>
          <div><input type="number" id="df2-bshould" class="df2-in w-full px-3 py-2 border border-border rounded-xl text-lg font-bold" value="15" min="10" max="22" step="0.25"></div>
          <div><input type="number" id="df2-fshould" class="df2-in w-full px-3 py-2 border border-border rounded-xl text-lg font-bold" value="14.5" min="10" max="22" step="0.25"></div>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Total Padding Needed</div>
          <div class="text-4xl font-extrabold font-mono" id="df2-result">--</div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Bust Padding</div><div class="text-xl font-bold font-mono" id="df2-pbust">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Waist Padding</div><div class="text-xl font-bold font-mono" id="df2-pwaist">--</div></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Hip Padding</div><div class="text-xl font-bold font-mono" id="df2-phip">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Shoulder Padding</div><div class="text-xl font-bold font-mono" id="df2-pshould">--</div></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Batting Layers (approx 1/4" each)</div><div class="text-xl font-bold font-mono" id="df2-layers">--</div></div>
      </div>
      <ShareButton calculatorId="dress-form" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcDF2() {
      const bBust = parseFloat((document.getElementById('df2-bbust') as HTMLInputElement).value) || 36;
      const fBust = parseFloat((document.getElementById('df2-fbust') as HTMLInputElement).value) || 34;
      const bWaist = parseFloat((document.getElementById('df2-bwaist') as HTMLInputElement).value) || 28;
      const fWaist = parseFloat((document.getElementById('df2-fwaist') as HTMLInputElement).value) || 26;
      const bHip = parseFloat((document.getElementById('df2-bhip') as HTMLInputElement).value) || 38;
      const fHip = parseFloat((document.getElementById('df2-fhip') as HTMLInputElement).value) || 36;
      const bShould = parseFloat((document.getElementById('df2-bshould') as HTMLInputElement).value) || 15;
      const fShould = parseFloat((document.getElementById('df2-fshould') as HTMLInputElement).value) || 14.5;

      const bustDiff = bBust - fBust;
      const waistDiff = bWaist - fWaist;
      const hipDiff = bHip - fHip;
      const shouldDiff = bShould - fShould;

      // Padding thickness per side = circumference difference / (2 * pi)... simplified:
      // Each layer of quilt batting adds ~0.25" thickness = ~1.57" circumference
      const bustThick = Math.max(0, bustDiff / Math.PI / 2);
      const waistThick = Math.max(0, waistDiff / Math.PI / 2);
      const hipThick = Math.max(0, hipDiff / Math.PI / 2);
      const shouldThick = Math.max(0, shouldDiff / 2);

      const maxPad = Math.max(bustDiff, waistDiff, hipDiff);

      // Batting layers (each ~0.25" thick adds ~1.57" to circumference)
      const bustLayers = Math.ceil(bustThick / 0.25);
      const waistLayers = Math.ceil(waistThick / 0.25);
      const hipLayers = Math.ceil(hipThick / 0.25);

      const formatPad = (diff: number, thick: number) => {
        if (diff <= 0) return 'None needed';
        return '+' + diff.toFixed(1) + '" circ (' + thick.toFixed(2) + '" thick)';
      };

      document.getElementById('df2-result')!.textContent = maxPad > 0 ? maxPad.toFixed(1) + '" max circumference add' : 'Form matches body';
      document.getElementById('df2-pbust')!.textContent = formatPad(bustDiff, bustThick);
      document.getElementById('df2-pwaist')!.textContent = formatPad(waistDiff, waistThick);
      document.getElementById('df2-phip')!.textContent = formatPad(hipDiff, hipThick);
      document.getElementById('df2-pshould')!.textContent = shouldDiff > 0 ? '+' + shouldDiff.toFixed(1) + '" each side' : 'None needed';
      document.getElementById('df2-layers')!.textContent = 'Bust: ' + bustLayers + ' | Waist: ' + waistLayers + ' | Hip: ' + hipLayers;
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.df2-in').forEach(el => { el.addEventListener('input', calcDF2); el.addEventListener('change', calcDF2); });
      calcDF2();
    }, 50);
  </script>
</CalculatorLayout>
