---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Heat Pump Calculator - Savings, COP & BTU Sizing";
const description = "Calculate heat pump sizing, annual savings, payback period, coefficient of performance (COP), and BTU requirements based on your home.";
const relatedCalcs = [
  { name: "Geothermal", url: "/geothermal-calculator", description: "Geothermal systems." },
  { name: "Solar Panel", url: "/solar-panel-calculator", description: "Solar." },
  { name: "BTU Calculator", url: "/btu-calculator", description: "BTU sizing." },
  { name: "Electricity Cost", url: "/electricity-cost-calculator", description: "Electricity." },
  { name: "Carbon Footprint", url: "/carbon-footprint-calculator", description: "Carbon." },
  { name: "Wind Power", url: "/wind-power-calculator", description: "Wind." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Heat Pump Calculator" keywords="heat pump calculator, heat pump sizing, heat pump savings, COP, SEER, HSPF, BTU, heat pump cost" breadcrumbs={[{ name: "Heat Pump", url: "/heat-pump-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Heat Pump Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Size your heat pump and estimate savings over conventional heating.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Home Size (sq ft)</label><input type="number" id="hp-sqft" class="hp-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="2000" min="200" step="100"></div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Climate Zone</label>
            <select id="hp-zone" class="hp-in w-full px-4 py-3 border border-border rounded-xl text-lg">
              <option value="hot">Hot (zones 1-2)</option>
              <option value="mixed" selected>Mixed (zones 3-4)</option>
              <option value="cold">Cold (zones 5-6)</option>
              <option value="verycold">Very Cold (zone 7)</option>
            </select>
          </div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Current Heating Cost ($/yr)</label><input type="number" id="hp-current" class="hp-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="2400" min="0" step="100"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Electricity Rate ($/kWh)</label><input type="number" id="hp-elec" class="hp-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="0.13" min="0.01" step="0.01"></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">SEER Rating</label><input type="number" id="hp-seer" class="hp-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="18" min="13" max="30" step="1"></div>
          <div><label class="block text-xs font-medium text-text mb-1">HSPF Rating</label><input type="number" id="hp-hspf" class="hp-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="10" min="7" max="14" step="0.5"></div>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Annual Savings</div>
          <div class="text-5xl font-extrabold font-mono" id="hp-savings">$0</div>
          <div class="text-sm text-blue-200 mt-1">estimated per year</div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">BTU Required</div><div class="text-xl font-bold" id="hp-btu">0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">System Size (tons)</div><div class="text-xl font-bold" id="hp-tons">0</div></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">COP (Heating)</div><div class="text-xl font-bold" id="hp-cop">0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Payback Period</div><div class="text-xl font-bold" id="hp-payback">0 yrs</div></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Estimated Heat Pump Cost ($/yr)</div>
          <div class="text-xl font-bold" id="hp-opcost">$0</div>
        </div>
      </div>
      <ShareButton calculatorId="heat-pump" />
      <FeedbackWidget />
    </div>
    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">Heat Pump Efficiency</h2>
      <p>Heat pumps move heat rather than generate it, achieving 200-400% efficiency (COP of 2-4). SEER measures cooling efficiency and HSPF measures heating efficiency. COP = HSPF / 3.412. Modern cold-climate heat pumps work effectively down to -15F.</p>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcHP() {
      const sqft = parseFloat((document.getElementById('hp-sqft') as HTMLInputElement).value) || 2000;
      const zone = (document.getElementById('hp-zone') as HTMLSelectElement).value;
      const currentCost = parseFloat((document.getElementById('hp-current') as HTMLInputElement).value) || 2400;
      const elecRate = parseFloat((document.getElementById('hp-elec') as HTMLInputElement).value) || 0.13;
      const seer = parseFloat((document.getElementById('hp-seer') as HTMLInputElement).value) || 18;
      const hspf = parseFloat((document.getElementById('hp-hspf') as HTMLInputElement).value) || 10;
      // BTU per sq ft by climate zone
      const btuPerSqft: Record<string, number> = { hot: 25, mixed: 30, cold: 40, verycold: 50 };
      const btuNeeded = sqft * (btuPerSqft[zone] || 30);
      const tons = btuNeeded / 12000;
      // COP = HSPF / 3.412
      const cop = hspf / 3.412;
      // Annual heating kWh with heat pump
      // Heating BTU needed per year approx: btuNeeded * heating hours
      const heatingHours: Record<string, number> = { hot: 400, mixed: 1200, cold: 2000, verycold: 2800 };
      const annualHeatingBTU = btuNeeded * (heatingHours[zone] || 1200) / 1000;
      const hpKWh = annualHeatingBTU / (hspf / 1000);
      const hpAnnualCost = Math.round(hpKWh * elecRate);
      const annualSavings = Math.max(0, currentCost - hpAnnualCost);
      // Estimated install cost
      const installCost = Math.round(tons * 3500);
      const payback = annualSavings > 0 ? (installCost / annualSavings) : 99;
      document.getElementById('hp-savings')!.textContent = '$' + annualSavings.toLocaleString();
      document.getElementById('hp-btu')!.textContent = btuNeeded.toLocaleString();
      document.getElementById('hp-tons')!.textContent = tons.toFixed(1);
      document.getElementById('hp-cop')!.textContent = cop.toFixed(1);
      document.getElementById('hp-payback')!.textContent = payback.toFixed(1) + ' yrs';
      document.getElementById('hp-opcost')!.textContent = '$' + hpAnnualCost.toLocaleString();
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => { document.querySelectorAll('.hp-in').forEach(el => { el.addEventListener('input', calcHP); el.addEventListener('change', calcHP); }); calcHP(); }, 50);
  </script>
</CalculatorLayout>
