---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Fuel Burn Calculator - Aviation Fuel Consumption & Endurance";
const description = "Calculate aircraft fuel consumption from distance, true airspeed, and fuel flow. Find endurance, reserve requirements, and maximum range.";
const relatedCalcs = [
  { name: "Fuel Efficiency", url: "/fuel-efficiency-converter", description: "Fuel conversions." },
  { name: "Boat Fuel", url: "/boat-fuel-calculator", description: "Marine fuel planning." },
  { name: "Speed Calculator", url: "/speed-calculator", description: "Speed computations." },
  { name: "Fuel Surcharge", url: "/fuel-surcharge-calculator", description: "Fuel cost surcharge." },
  { name: "Flight Time", url: "/flight-time-calculator", description: "Estimate flight time." },
  { name: "Force Calculator", url: "/force-calculator", description: "Force calculations." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Fuel Burn Calculator" keywords="fuel burn, fuel consumption, aircraft endurance, fuel flow, reserve fuel, aviation fuel planning" breadcrumbs={[{ name: "Fuel Burn", url: "/fuel-burn-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Fuel Burn Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate fuel consumption, endurance, and reserve requirements for flight planning.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div>
          <label for="fb2-dist" class="block text-sm font-medium text-text mb-1">Distance (NM)</label>
          <input type="number" id="fb2-dist" class="fb2-in w-full border border-border rounded-lg px-3 py-2" min="0" step="10" />
        </div>
        <div>
          <label for="fb2-tas" class="block text-sm font-medium text-text mb-1">True Airspeed (kts)</label>
          <input type="number" id="fb2-tas" class="fb2-in w-full border border-border rounded-lg px-3 py-2" min="0" step="5" />
        </div>
        <div>
          <label for="fb2-wind" class="block text-sm font-medium text-text mb-1">Headwind (-) / Tailwind (+) (kts)</label>
          <input type="number" id="fb2-wind" class="fb2-in w-full border border-border rounded-lg px-3 py-2" step="5" />
        </div>
        <div>
          <label for="fb2-ff" class="block text-sm font-medium text-text mb-1">Fuel Flow (gal/hr)</label>
          <input type="number" id="fb2-ff" class="fb2-in w-full border border-border rounded-lg px-3 py-2" min="0" step="0.5" />
        </div>
        <div>
          <label for="fb2-cap" class="block text-sm font-medium text-text mb-1">Usable Fuel (gal)</label>
          <input type="number" id="fb2-cap" class="fb2-in w-full border border-border rounded-lg px-3 py-2" min="0" step="1" />
        </div>
        <div>
          <label for="fb2-res" class="block text-sm font-medium text-text mb-1">Reserve Requirement</label>
          <select id="fb2-res" class="fb2-in w-full border border-border rounded-lg px-3 py-2">
            <option value="30">VFR Day - 30 min</option>
            <option value="45" selected>VFR Night - 45 min</option>
            <option value="45">IFR - 45 min</option>
            <option value="60">60 min reserve</option>
          </select>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Fuel Required for Trip</div>
          <div class="text-5xl font-extrabold font-mono" id="fb2-result">--</div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Ground Speed</div>
            <div class="text-xl font-bold font-mono" id="fb2-gs">--</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Flight Time</div>
            <div class="text-xl font-bold font-mono" id="fb2-time">--</div>
          </div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Trip Fuel</div>
            <div class="text-xl font-bold font-mono" id="fb2-trip">--</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Reserve Fuel</div>
            <div class="text-xl font-bold font-mono" id="fb2-rfuel">--</div>
          </div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Total Endurance</div>
            <div class="text-xl font-bold font-mono" id="fb2-endur">--</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Max Range (no reserve)</div>
            <div class="text-xl font-bold font-mono" id="fb2-range">--</div>
          </div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Fuel Status</div>
          <div class="text-lg font-bold font-mono" id="fb2-status">--</div>
        </div>
      </div>
      <ShareButton calculatorId="fuel-burn" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcFB2() {
      const dist = parseFloat((document.getElementById('fb2-dist') as HTMLInputElement).value) || 0;
      const tas = parseFloat((document.getElementById('fb2-tas') as HTMLInputElement).value) || 120;
      const wind = parseFloat((document.getElementById('fb2-wind') as HTMLInputElement).value) || 0;
      const ff = parseFloat((document.getElementById('fb2-ff') as HTMLInputElement).value) || 10;
      const cap = parseFloat((document.getElementById('fb2-cap') as HTMLInputElement).value) || 56;
      const resMins = parseFloat((document.getElementById('fb2-res') as HTMLSelectElement).value) || 45;

      const gs = tas + wind;
      const flightTimeHrs = gs > 0 ? dist / gs : 0;
      const flightTimeMins = flightTimeHrs * 60;
      const tripFuel = flightTimeHrs * ff;
      const reserveFuel = (resMins / 60) * ff;
      const totalRequired = tripFuel + reserveFuel;
      const enduranceHrs = ff > 0 ? cap / ff : 0;
      const maxRange = gs > 0 ? (cap / ff) * gs : 0;

      const hrs = Math.floor(flightTimeHrs);
      const mins = Math.round((flightTimeHrs - hrs) * 60);

      document.getElementById('fb2-result')!.textContent = totalRequired.toFixed(1) + ' gal';
      document.getElementById('fb2-gs')!.textContent = gs.toFixed(0) + ' kts';
      document.getElementById('fb2-time')!.textContent = hrs + 'h ' + mins + 'm';
      document.getElementById('fb2-trip')!.textContent = tripFuel.toFixed(1) + ' gal';
      document.getElementById('fb2-rfuel')!.textContent = reserveFuel.toFixed(1) + ' gal';

      const eHrs = Math.floor(enduranceHrs);
      const eMins = Math.round((enduranceHrs - eHrs) * 60);
      document.getElementById('fb2-endur')!.textContent = eHrs + 'h ' + eMins + 'm';
      document.getElementById('fb2-range')!.textContent = maxRange.toFixed(0) + ' NM';

      let status = '';
      let color = '#16a34a';
      if (totalRequired > cap) { status = 'INSUFFICIENT FUEL - need ' + (totalRequired - cap).toFixed(1) + ' more gal'; color = '#dc2626'; }
      else { const extra = cap - totalRequired; status = 'OK - ' + extra.toFixed(1) + ' gal extra beyond reserves'; }
      document.getElementById('fb2-status')!.textContent = status;
      (document.getElementById('fb2-status')! as HTMLElement).style.color = color;

      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      (document.getElementById('fb2-dist') as HTMLInputElement).value = '250';
      (document.getElementById('fb2-tas') as HTMLInputElement).value = '120';
      (document.getElementById('fb2-wind') as HTMLInputElement).value = '-10';
      (document.getElementById('fb2-ff') as HTMLInputElement).value = '10';
      (document.getElementById('fb2-cap') as HTMLInputElement).value = '56';
      document.querySelectorAll('.fb2-in').forEach(el => { el.addEventListener('input', calcFB2); el.addEventListener('change', calcFB2); });
      calcFB2();
    }, 50);
  </script>
</CalculatorLayout>
