---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';

const title = "Cross Product Calculator - 3D Vector Cross Product";
const description = "Calculate the cross product of two 3D vectors. Find the resultant vector, its magnitude, and the angle between the input vectors.";

const relatedCalcs = [
  { name: "Dot Product Calculator", url: "/dot-product-calculator", description: "Dot product of two vectors." },
  { name: "Polar Coordinates", url: "/polar-coordinates-calculator", description: "Rectangular to polar conversion." },
  { name: "Matrix Determinant", url: "/determinant-calculator", description: "Matrix determinant calculator." },
  { name: "Average Calculator", url: "/average-calculator", description: "Mean, median, mode." },
  { name: "Scientific Calculator", url: "/scientific-calculator", description: "Advanced math operations." },
  { name: "Area Calculator", url: "/area-calculator", description: "Calculate areas of shapes." },
];
---

<CalculatorLayout
  title={title}
  description={description}
  calculatorName="Cross Product Calculator"
  keywords="cross product calculator, vector cross product, 3D vector, resultant vector, magnitude, angle between vectors"
  breadcrumbs={[{ name: "Cross Product Calculator", url: "/cross-product-calculator" }]}
>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Cross Product Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Compute the cross product of two 3D vectors, along with the resultant magnitude and angle between vectors.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <h3 class="font-semibold text-text">Vector A</h3>
        <div class="grid grid-cols-3 gap-3">
          <div>
            <label class="block text-sm font-medium text-text mb-1">A<sub>x</sub></label>
            <input type="number" id="xp-ax" class="xp-in w-full px-4 py-2 border border-border rounded-xl text-lg" value="2" />
          </div>
          <div>
            <label class="block text-sm font-medium text-text mb-1">A<sub>y</sub></label>
            <input type="number" id="xp-ay" class="xp-in w-full px-4 py-2 border border-border rounded-xl text-lg" value="3" />
          </div>
          <div>
            <label class="block text-sm font-medium text-text mb-1">A<sub>z</sub></label>
            <input type="number" id="xp-az" class="xp-in w-full px-4 py-2 border border-border rounded-xl text-lg" value="4" />
          </div>
        </div>

        <h3 class="font-semibold text-text">Vector B</h3>
        <div class="grid grid-cols-3 gap-3">
          <div>
            <label class="block text-sm font-medium text-text mb-1">B<sub>x</sub></label>
            <input type="number" id="xp-bx" class="xp-in w-full px-4 py-2 border border-border rounded-xl text-lg" value="5" />
          </div>
          <div>
            <label class="block text-sm font-medium text-text mb-1">B<sub>y</sub></label>
            <input type="number" id="xp-by" class="xp-in w-full px-4 py-2 border border-border rounded-xl text-lg" value="6" />
          </div>
          <div>
            <label class="block text-sm font-medium text-text mb-1">B<sub>z</sub></label>
            <input type="number" id="xp-bz" class="xp-in w-full px-4 py-2 border border-border rounded-xl text-lg" value="7" />
          </div>
        </div>

        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Cross Product A &times; B</div>
          <div class="text-4xl font-extrabold font-mono" id="xp-result">(0, 0, 0)</div>
        </div>

        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Magnitude |A &times; B|</div>
            <div class="text-xl font-bold" id="xp-mag">0</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Angle Between Vectors</div>
            <div class="text-xl font-bold" id="xp-angle">0&deg;</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">|A|</div>
            <div class="text-xl font-bold" id="xp-maga">0</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">|B|</div>
            <div class="text-xl font-bold" id="xp-magb">0</div>
          </div>
        </div>

        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-2">Formula</h3>
          <div class="text-sm text-text-secondary font-mono" id="xp-formula"></div>
        </div>
      </div>

      <ShareButton calculatorId="cross-product" />
      <FeedbackWidget />
    </div>

    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">What Is the Cross Product?</h2>
      <p>The cross product of two 3D vectors produces a new vector perpendicular to both input vectors. It's computed as:</p>
      <div class="bg-surface-alt rounded-xl p-4 my-4 font-mono text-sm">
        <p><strong>A &times; B</strong> = (A<sub>y</sub>B<sub>z</sub> - A<sub>z</sub>B<sub>y</sub>, A<sub>z</sub>B<sub>x</sub> - A<sub>x</sub>B<sub>z</sub>, A<sub>x</sub>B<sub>y</sub> - A<sub>y</sub>B<sub>x</sub>)</p>
      </div>
      <h3 class="text-xl font-semibold text-text mt-8">Properties</h3>
      <ul>
        <li>The cross product is anti-commutative: A &times; B = -(B &times; A)</li>
        <li>The magnitude equals the area of the parallelogram formed by A and B</li>
        <li>If A &times; B = 0, the vectors are parallel</li>
      </ul>
    </article>

    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    function calcXP() {
      const ax = parseFloat((document.getElementById('xp-ax') as HTMLInputElement).value) || 0;
      const ay = parseFloat((document.getElementById('xp-ay') as HTMLInputElement).value) || 0;
      const az = parseFloat((document.getElementById('xp-az') as HTMLInputElement).value) || 0;
      const bx = parseFloat((document.getElementById('xp-bx') as HTMLInputElement).value) || 0;
      const by = parseFloat((document.getElementById('xp-by') as HTMLInputElement).value) || 0;
      const bz = parseFloat((document.getElementById('xp-bz') as HTMLInputElement).value) || 0;

      const cx = ay * bz - az * by;
      const cy = az * bx - ax * bz;
      const cz = ax * by - ay * bx;

      const magA = Math.sqrt(ax * ax + ay * ay + az * az);
      const magB = Math.sqrt(bx * bx + by * by + bz * bz);
      const magC = Math.sqrt(cx * cx + cy * cy + cz * cz);

      const dot = ax * bx + ay * by + az * bz;
      let angle = 0;
      if (magA > 0 && magB > 0) {
        angle = Math.acos(Math.min(1, Math.max(-1, dot / (magA * magB)))) * (180 / Math.PI);
      }

      const fmt = (n: number) => Number.isInteger(n) ? String(n) : n.toFixed(4);

      document.getElementById('xp-result')!.textContent = `(${fmt(cx)}, ${fmt(cy)}, ${fmt(cz)})`;
      document.getElementById('xp-mag')!.textContent = fmt(magC);
      document.getElementById('xp-angle')!.innerHTML = fmt(angle) + '&deg;';
      document.getElementById('xp-maga')!.textContent = fmt(magA);
      document.getElementById('xp-magb')!.textContent = fmt(magB);
      document.getElementById('xp-formula')!.innerHTML =
        `A &times; B = (${ay}&middot;${bz} - ${az}&middot;${by}, ${az}&middot;${bx} - ${ax}&middot;${bz}, ${ax}&middot;${by} - ${ay}&middot;${bx}) = (${fmt(cx)}, ${fmt(cy)}, ${fmt(cz)})`;

      document.dispatchEvent(new CustomEvent('calc-update'));
    }

    setTimeout(() => {
      document.querySelectorAll('.xp-in').forEach(el => {
        el.addEventListener('input', calcXP);
        el.addEventListener('change', calcXP);
      });
      calcXP();
    }, 50);
  </script>
</CalculatorLayout>
