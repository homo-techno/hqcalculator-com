---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Pottery Pricing Calculator - Materials, Labor & Markup";
const description = "Calculate pottery pricing including materials, labor, kiln costs, overhead, and markup. Set fair prices for your handmade ceramics.";
const relatedCalcs = [
  { name: "Clay Weight Calculator", url: "/clay-weight-calculator", description: "Clay weight for forms." },
  { name: "Kiln Energy Calculator", url: "/kiln-energy-calculator", description: "Firing energy costs." },
  { name: "Glaze Recipe Calculator", url: "/glaze-recipe-calculator", description: "Scale glaze recipes." },
  { name: "Break Even Calculator", url: "/break-even-calculator", description: "Break-even analysis." },
  { name: "Profit Margin Calculator", url: "/profit-margin-calculator", description: "Profit margins." },
  { name: "Kiln Shelf Calculator", url: "/kiln-shelf-calculator", description: "Kiln shelf planning." },
];
---
<CalculatorLayout
  title={title}
  description={description}
  calculatorName="Pottery Pricing Calculator"
  keywords="pottery pricing, ceramic pricing, handmade pottery price, pottery markup, pottery business, ceramic pricing formula, pottery cost"
  breadcrumbs={[{ name: "Pottery Pricing Calculator", url: "/pottery-pricing-calculator" }]}
>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Pottery Pricing Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate a fair price for your pottery by accounting for all costs including materials, labor, firing, overhead, and desired markup.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <h3 class="font-semibold text-text mb-3">Materials Cost</h3>
      <div class="grid grid-cols-2 gap-4 mb-5">
        <div>
          <label class="block text-xs font-medium text-text mb-1">Clay Cost ($)</label>
          <input type="number" id="pp2-clay" class="pp2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="1.50" min="0" step="0.25">
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Glaze Cost ($)</label>
          <input type="number" id="pp2-glaze" class="pp2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="0.75" min="0" step="0.25">
        </div>
      </div>

      <h3 class="font-semibold text-text mb-3">Labor</h3>
      <div class="grid grid-cols-2 gap-4 mb-5">
        <div>
          <label class="block text-xs font-medium text-text mb-1">Hourly Rate ($)</label>
          <input type="number" id="pp2-rate" class="pp2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="25" min="0" step="1">
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Time per Piece (minutes)</label>
          <input type="number" id="pp2-time" class="pp2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="45" min="1" step="5">
          <p class="text-xs text-text-muted mt-0.5">Include throwing, trimming, glazing, loading</p>
        </div>
      </div>

      <h3 class="font-semibold text-text mb-3">Kiln Cost per Piece</h3>
      <div class="grid grid-cols-2 gap-4 mb-5">
        <div>
          <label class="block text-xs font-medium text-text mb-1">Bisque Firing Share ($)</label>
          <input type="number" id="pp2-bisque" class="pp2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="1.00" min="0" step="0.25">
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Glaze Firing Share ($)</label>
          <input type="number" id="pp2-gfire" class="pp2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="1.50" min="0" step="0.25">
        </div>
      </div>

      <h3 class="font-semibold text-text mb-3">Overhead & Pricing</h3>
      <div class="grid grid-cols-2 gap-4 mb-5">
        <div>
          <label class="block text-xs font-medium text-text mb-1">Overhead (%)</label>
          <input type="number" id="pp2-overhead" class="pp2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="20" min="0" max="100" step="5">
          <p class="text-xs text-text-muted mt-0.5">Studio rent, tools, insurance, etc.</p>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Markup (%)</label>
          <input type="number" id="pp2-markup" class="pp2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="100" min="0" max="500" step="10">
          <p class="text-xs text-text-muted mt-0.5">100% = 2x cost (retail); 50% = 1.5x</p>
        </div>
      </div>

      <div class="mb-5">
        <label class="block text-sm font-medium text-text mb-2">Loss Rate (% of pieces lost to defects)</label>
        <input type="number" id="pp2-loss" class="pp2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="10" min="0" max="50" step="5">
      </div>

      <!-- Primary Result -->
      <div class="p-6 bg-primary rounded-2xl text-white text-center mb-4">
        <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Suggested Retail Price</div>
        <div class="text-4xl font-extrabold" id="pp2-price">--</div>
        <div class="text-sm text-blue-200 mt-1" id="pp2-margin-note">--</div>
      </div>

      <div class="grid grid-cols-2 gap-4 mb-4">
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Total Cost</div>
          <div class="text-xl font-bold" id="pp2-cost">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Profit per Piece</div>
          <div class="text-xl font-bold" id="pp2-profit">--</div>
        </div>
      </div>

      <div class="grid grid-cols-2 gap-4 mb-4">
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Wholesale Price (50%)</div>
          <div class="text-xl font-bold" id="pp2-wholesale">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Labor Cost</div>
          <div class="text-xl font-bold" id="pp2-labor">--</div>
        </div>
      </div>

      <!-- Cost breakdown -->
      <div class="p-4 bg-surface-alt rounded-xl mb-4">
        <h3 class="font-semibold text-sm text-text mb-2">Cost Breakdown</h3>
        <div class="space-y-1" id="pp2-breakdown"></div>
      </div>

      <ShareButton calculatorId="pottery-pricing" />
      <FeedbackWidget />
    </div>

    <article class="mt-12 max-w-4xl prose prose-slate">
      <h2 class="text-2xl font-bold text-text">How to Price Handmade Pottery</h2>
      <p>Pricing pottery requires accounting for all direct costs (materials, firing, labor) plus indirect costs (studio overhead, tool depreciation, loss from defects). A common formula is: (Materials + Labor + Firing + Overhead) x Markup = Retail Price.</p>
      <h3 class="text-xl font-semibold text-text mt-8">Pricing Guidelines</h3>
      <ul>
        <li><strong>Retail markup:</strong> 2x-3x total cost is standard for direct-to-consumer sales</li>
        <li><strong>Wholesale:</strong> Typically 50% of retail price (so you need at least 2x markup)</li>
        <li><strong>Gallery/consignment:</strong> Gallery takes 40-50%, so price accordingly</li>
        <li>Always account for your loss rate - not every piece survives both firings</li>
      </ul>
    </article>

    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    function calcPP2() {
      const clayCost = parseFloat((document.getElementById('pp2-clay') as HTMLInputElement).value) || 0;
      const glazeCost = parseFloat((document.getElementById('pp2-glaze') as HTMLInputElement).value) || 0;
      const hourlyRate = parseFloat((document.getElementById('pp2-rate') as HTMLInputElement).value) || 0;
      const timeMin = parseFloat((document.getElementById('pp2-time') as HTMLInputElement).value) || 0;
      const bisqueCost = parseFloat((document.getElementById('pp2-bisque') as HTMLInputElement).value) || 0;
      const gfireCost = parseFloat((document.getElementById('pp2-gfire') as HTMLInputElement).value) || 0;
      const overheadPct = (parseFloat((document.getElementById('pp2-overhead') as HTMLInputElement).value) || 0) / 100;
      const markupPct = (parseFloat((document.getElementById('pp2-markup') as HTMLInputElement).value) || 0) / 100;
      const lossPct = (parseFloat((document.getElementById('pp2-loss') as HTMLInputElement).value) || 0) / 100;

      const materialsCost = clayCost + glazeCost;
      const laborCost = (hourlyRate * timeMin) / 60;
      const firingCost = bisqueCost + gfireCost;
      const subtotal = materialsCost + laborCost + firingCost;
      const overhead = subtotal * overheadPct;
      const totalCost = subtotal + overhead;

      // Adjust for loss rate
      const adjustedCost = totalCost / (1 - lossPct);

      const retailPrice = adjustedCost * (1 + markupPct);
      const profit = retailPrice - adjustedCost;
      const wholesalePrice = retailPrice * 0.5;
      const profitMargin = retailPrice > 0 ? (profit / retailPrice) * 100 : 0;

      document.getElementById('pp2-price')!.textContent = '$' + retailPrice.toFixed(2);
      document.getElementById('pp2-margin-note')!.textContent = 'Profit margin: ' + profitMargin.toFixed(0) + '%';
      document.getElementById('pp2-cost')!.textContent = '$' + adjustedCost.toFixed(2);
      document.getElementById('pp2-profit')!.textContent = '$' + profit.toFixed(2);
      document.getElementById('pp2-wholesale')!.textContent = '$' + wholesalePrice.toFixed(2);
      document.getElementById('pp2-labor')!.textContent = '$' + laborCost.toFixed(2);

      // Breakdown
      const breakdown = document.getElementById('pp2-breakdown')!;
      breakdown.innerHTML = '';
      const items = [
        { name: 'Materials (clay + glaze)', value: materialsCost },
        { name: 'Labor (' + timeMin + ' min @ $' + hourlyRate + '/hr)', value: laborCost },
        { name: 'Firing (bisque + glaze)', value: firingCost },
        { name: 'Overhead (' + (overheadPct * 100) + '%)', value: overhead },
        { name: 'Loss adjustment (' + (lossPct * 100) + '%)', value: adjustedCost - totalCost },
      ];
      items.forEach(item => {
        const div = document.createElement('div');
        div.className = 'flex justify-between text-xs';
        div.innerHTML = '<span class="text-text-muted">' + item.name + '</span><span class="font-bold">$' + item.value.toFixed(2) + '</span>';
        breakdown.appendChild(div);
      });

      document.dispatchEvent(new CustomEvent('calc-update'));
    }

    setTimeout(() => {
      document.querySelectorAll('.pp2-in').forEach(el => {
        el.addEventListener('input', calcPP2);
        el.addEventListener('change', calcPP2);
      });
      calcPP2();
    }, 50);
  </script>
</CalculatorLayout>
