---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Pond Construction Calculator - Volume, Dam & Liner";
const description = "Calculate pond volume from shape and dimensions. Estimate dam volume, liner area, fill time from water source, and construction costs.";
const relatedCalcs = [
  { name: "Pond Stocking", url: "/pond-stocking-calculator", description: "Fish stocking recommendations." },
  { name: "Pool Volume", url: "/pool-volume-calculator", description: "Pool water volume." },
  { name: "Volume Calculator", url: "/volume-calculator", description: "General volume calculations." },
  { name: "Rain Harvest", url: "/rain-harvest-calculator", description: "Rainwater collection estimates." },
  { name: "Area Calculator", url: "/area-calculator", description: "Calculate area of shapes." },
  { name: "Aquaponics", url: "/aquaponics-calculator", description: "Aquaponics system sizing." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Pond Construction Calculator" keywords="pond construction calculator, pond volume, dam volume, pond liner, fill time, farm pond, pond building cost" breadcrumbs={[{ name: "Pond Construction", url: "/pond-construction-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Pond Construction Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Plan your pond with volume, dam, liner, and fill time estimates.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div>
          <label class="block text-xs font-medium text-text mb-1">Pond Shape</label>
          <select id="pc2-shape" class="pc2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
            <option value="rect" selected>Rectangular</option>
            <option value="oval">Oval/Elliptical</option>
            <option value="circle">Circular</option>
          </select>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="block text-xs font-medium text-text mb-1" id="pc2-l-label">Length (feet)</label>
            <input type="number" id="pc2-len" class="pc2-in w-full px-4 py-3 border border-border rounded-xl text-2xl font-bold" value="100" min="10" max="5000" step="5">
          </div>
          <div id="pc2-w-wrap">
            <label class="block text-xs font-medium text-text mb-1" id="pc2-w-label">Width (feet)</label>
            <input type="number" id="pc2-wid" class="pc2-in w-full px-4 py-3 border border-border rounded-xl text-2xl font-bold" value="60" min="10" max="5000" step="5">
          </div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="block text-xs font-medium text-text mb-1">Average Depth (feet)</label>
            <input type="number" id="pc2-depth" class="pc2-in w-full px-4 py-3 border border-border rounded-xl text-2xl font-bold" value="8" min="2" max="30" step="1">
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Side Slope Ratio (H:1V)</label>
            <input type="number" id="pc2-slope" class="pc2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="3" min="1" max="6" step="0.5">
          </div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="block text-xs font-medium text-text mb-1">Dam Height (feet)</label>
            <input type="number" id="pc2-dam" class="pc2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="10" min="0" max="30" step="1">
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Water Source (GPM)</label>
            <input type="number" id="pc2-source" class="pc2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="10" min="1" max="500" step="1">
          </div>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Pond Volume</div>
          <div class="text-5xl font-extrabold font-mono" id="pc2-vol">--</div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Surface Area</div>
            <div class="text-xl font-bold font-mono" id="pc2-surface">--</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Gallons</div>
            <div class="text-xl font-bold font-mono" id="pc2-gal">--</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Acre-Feet</div>
            <div class="text-xl font-bold font-mono" id="pc2-acft">--</div>
          </div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Liner Area (sq ft)</div>
            <div class="text-xl font-bold font-mono" id="pc2-liner">--</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Fill Time</div>
            <div class="text-xl font-bold font-mono" id="pc2-fill">--</div>
          </div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Dam Volume (cu yd)</div>
            <div class="text-xl font-bold font-mono" id="pc2-damvol">--</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Excavation (cu yd)</div>
            <div class="text-xl font-bold font-mono" id="pc2-excav">--</div>
          </div>
        </div>
      </div>
      <ShareButton calculatorId="pond-construction" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcPC2() {
      const shape = (document.getElementById('pc2-shape') as HTMLSelectElement).value;
      const len = parseFloat((document.getElementById('pc2-len') as HTMLInputElement).value) || 100;
      const wid = parseFloat((document.getElementById('pc2-wid') as HTMLInputElement).value) || 60;
      const depth = parseFloat((document.getElementById('pc2-depth') as HTMLInputElement).value) || 8;
      const slopeRatio = parseFloat((document.getElementById('pc2-slope') as HTMLInputElement).value) || 3;
      const damHt = parseFloat((document.getElementById('pc2-dam') as HTMLInputElement).value) || 0;
      const sourceGPM = parseFloat((document.getElementById('pc2-source') as HTMLInputElement).value) || 10;
      const lLabel = document.getElementById('pc2-l-label')!;
      const wWrap = document.getElementById('pc2-w-wrap')!;
      let surfaceArea = 0;
      let volCuFt = 0;
      let linerArea = 0;
      if (shape === 'rect') {
        lLabel.textContent = 'Length (feet)';
        wWrap.style.display = 'block';
        surfaceArea = len * wid;
        const botLen = Math.max(0, len - 2 * slopeRatio * depth);
        const botWid = Math.max(0, wid - 2 * slopeRatio * depth);
        volCuFt = (depth / 6) * (surfaceArea + len * botWid + botLen * wid + 3 * botLen * botWid) / 1;
        volCuFt = depth / 3 * (surfaceArea + botLen * botWid + Math.sqrt(surfaceArea * botLen * botWid));
        const slopeLen = Math.sqrt(depth * depth + (slopeRatio * depth) * (slopeRatio * depth));
        linerArea = (botLen + 2 * slopeLen) * (botWid + 2 * slopeLen);
      } else if (shape === 'oval') {
        lLabel.textContent = 'Major Axis (feet)';
        wWrap.style.display = 'block';
        surfaceArea = Math.PI * (len / 2) * (wid / 2);
        const botLen = Math.max(0, len - 2 * slopeRatio * depth);
        const botWid = Math.max(0, wid - 2 * slopeRatio * depth);
        const botArea = Math.PI * (botLen / 2) * (botWid / 2);
        volCuFt = depth / 3 * (surfaceArea + botArea + Math.sqrt(surfaceArea * botArea));
        const slopeLen = Math.sqrt(depth * depth + (slopeRatio * depth) * (slopeRatio * depth));
        linerArea = Math.PI * ((botLen / 2) + slopeLen) * ((botWid / 2) + slopeLen);
      } else {
        lLabel.textContent = 'Diameter (feet)';
        wWrap.style.display = 'none';
        const radius = len / 2;
        surfaceArea = Math.PI * radius * radius;
        const botRadius = Math.max(0, radius - slopeRatio * depth);
        const botArea = Math.PI * botRadius * botRadius;
        volCuFt = depth / 3 * (surfaceArea + botArea + Math.sqrt(surfaceArea * botArea));
        const slopeLen = Math.sqrt(depth * depth + (slopeRatio * depth) * (slopeRatio * depth));
        linerArea = Math.PI * (botRadius + slopeLen) * (botRadius + slopeLen);
      }
      const gallons = volCuFt * 7.48052;
      const acreFeet = volCuFt / 43560;
      const volCuYd = volCuFt / 27;
      const damTopWidth = 12;
      const damBaseWidth = damTopWidth + 2 * slopeRatio * damHt;
      const damCrossSection = 0.5 * (damTopWidth + damBaseWidth) * damHt;
      const damLength = shape === 'circle' ? len : wid;
      const damVolCuYd = (damCrossSection * damLength) / 27;
      const fillMinutes = sourceGPM > 0 ? gallons / sourceGPM : 0;
      const fillDays = fillMinutes / 1440;
      document.getElementById('pc2-vol')!.textContent = Math.round(volCuYd).toLocaleString() + ' cu yd';
      document.getElementById('pc2-surface')!.textContent = Math.round(surfaceArea).toLocaleString() + ' sqft';
      document.getElementById('pc2-gal')!.textContent = Math.round(gallons).toLocaleString();
      document.getElementById('pc2-acft')!.textContent = acreFeet.toFixed(2);
      document.getElementById('pc2-liner')!.textContent = Math.round(linerArea).toLocaleString();
      document.getElementById('pc2-fill')!.textContent = fillDays.toFixed(1) + ' days';
      document.getElementById('pc2-damvol')!.textContent = Math.round(damVolCuYd).toLocaleString();
      document.getElementById('pc2-excav')!.textContent = Math.round(volCuYd).toLocaleString();
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.pc2-in').forEach(el => { el.addEventListener('input', calcPC2); el.addEventListener('change', calcPC2); });
      calcPC2();
    }, 50);
  </script>
</CalculatorLayout>
