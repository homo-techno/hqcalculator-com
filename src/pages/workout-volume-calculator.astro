---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Workout Volume Calculator - Training Volume & Tonnage";
const description = "Calculate total training volume per exercise and muscle group. Track sets, reps, weight for weekly tonnage and intensity.";
const relatedCalcs = [
  { name: "Calorie Calculator", url: "/calorie-calculator", description: "Daily calorie needs." },
  { name: "Pace Zone Calculator", url: "/pace-zone-calculator", description: "Running zones." },
  { name: "BMI Calculator", url: "/bmi-calculator", description: "Body mass index." },
  { name: "Caloric Deficit Calculator", url: "/caloric-deficit-calculator", description: "Weight loss plan." },
  { name: "Protein Calculator", url: "/protein-calculator", description: "Protein needs." },
  { name: "Metabolic Age Calculator", url: "/metabolic-age-calculator", description: "Metabolic age." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Workout Volume Calculator" keywords="workout volume, training volume, tonnage, sets reps weight, exercise volume, progressive overload" breadcrumbs={[{ name: "Workout Volume", url: "/workout-volume-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Workout Volume Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate your training volume and weekly tonnage for progressive overload.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div>
          <label class="block text-xs font-medium text-text mb-1">Muscle Group</label>
          <select id="wv-group" class="w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="chest" selected>Chest</option>
            <option value="back">Back</option>
            <option value="legs">Legs</option>
            <option value="shoulders">Shoulders</option>
            <option value="arms">Arms</option>
            <option value="core">Core</option>
          </select>
        </div>
        <div class="grid grid-cols-4 gap-3">
          <div class="col-span-1"><label class="block text-xs font-medium text-text mb-1">Sets</label><input type="number" id="wv-sets" class="wv-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="4" min="1" max="20" step="1"></div>
          <div class="col-span-1"><label class="block text-xs font-medium text-text mb-1">Reps</label><input type="number" id="wv-reps" class="wv-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="10" min="1" max="50" step="1"></div>
          <div class="col-span-1"><label class="block text-xs font-medium text-text mb-1">Weight (lbs)</label><input type="number" id="wv-wt" class="wv-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="135" min="0" max="2000" step="5"></div>
          <div class="col-span-1"><label class="block text-xs font-medium text-text mb-1">Exercises</label><input type="number" id="wv-ex" class="wv-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="3" min="1" max="10" step="1"></div>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Sessions per Week</label>
          <input type="number" id="wv-freq" class="wv-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="2" min="1" max="7" step="1">
        </div>
        <button id="wv-add" class="w-full py-3 bg-primary text-white rounded-xl font-bold text-lg hover:bg-blue-700 transition">Add Exercise to Log</button>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Session Volume</div>
          <div class="text-5xl font-extrabold font-mono" id="wv-vol">0</div>
          <div class="text-sm text-blue-200 mt-1">lbs total volume</div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Weekly Tonnage</div><div class="text-xl font-bold" id="wv-weekly">0 lbs</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Total Sets</div><div class="text-xl font-bold" id="wv-tsets">0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Avg Intensity</div><div class="text-xl font-bold" id="wv-int">0 lbs</div></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-3">Exercise Log</h3>
          <div class="space-y-1 text-sm" id="wv-log"><div class="text-text-muted">No exercises logged yet</div></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-3">Volume Guidelines (sets/muscle/week)</h3>
          <div class="grid grid-cols-2 gap-2 text-sm">
            <div class="flex justify-between"><span>Beginner</span><span class="font-bold">10-12 sets</span></div>
            <div class="flex justify-between"><span>Intermediate</span><span class="font-bold">12-18 sets</span></div>
            <div class="flex justify-between"><span>Advanced</span><span class="font-bold">18-24 sets</span></div>
            <div class="flex justify-between"><span>Maximum recoverable</span><span class="font-bold">~20-25 sets</span></div>
          </div>
        </div>
      </div>
      <ShareButton calculatorId="workout-volume" />
      <FeedbackWidget />
    </div>
    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">Training Volume</h2>
      <p>Training volume = sets x reps x weight. Progressive overload requires gradually increasing volume over time. Research suggests 10-20 sets per muscle group per week is optimal for most trainees. Track your tonnage weekly to ensure continued progress and avoid overtraining.</p>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    interface WvExercise { group: string; sets: number; reps: number; weight: number; vol: number; }
    const wvLog: WvExercise[] = [];
    function calcWV() {
      const sets = parseInt((document.getElementById('wv-sets') as HTMLInputElement).value) || 0;
      const reps = parseInt((document.getElementById('wv-reps') as HTMLInputElement).value) || 0;
      const wt = parseFloat((document.getElementById('wv-wt') as HTMLInputElement).value) || 0;
      const ex = parseInt((document.getElementById('wv-ex') as HTMLInputElement).value) || 1;
      const freq = parseInt((document.getElementById('wv-freq') as HTMLInputElement).value) || 1;
      const sessionVol = sets * reps * wt * ex;
      const weeklyVol = sessionVol * freq;
      const totalSets = sets * ex * freq;
      const avgInt = totalSets > 0 ? weeklyVol / (totalSets * reps) : 0;
      document.getElementById('wv-vol')!.textContent = sessionVol.toLocaleString();
      document.getElementById('wv-weekly')!.textContent = weeklyVol.toLocaleString() + ' lbs';
      document.getElementById('wv-tsets')!.textContent = totalSets.toString();
      document.getElementById('wv-int')!.textContent = Math.round(avgInt) + ' lbs';
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    function renderLog() {
      const el = document.getElementById('wv-log')!;
      if (wvLog.length === 0) {
        el.innerHTML = '<div class="text-text-muted">No exercises logged yet</div>';
        return;
      }
      el.innerHTML = wvLog.map((e, i) =>
        '<div class="flex justify-between items-center py-1 border-b border-border"><span>' + e.group + ': ' + e.sets + 'x' + e.reps + ' @ ' + e.weight + 'lbs</span><span class="font-bold">' + e.vol.toLocaleString() + ' lbs <button class="wv-rm ml-2 text-red-500 text-xs" data-idx="' + i + '">Remove</button></span></div>'
      ).join('');
      el.querySelectorAll('.wv-rm').forEach(btn => {
        btn.addEventListener('click', (ev) => {
          const idx = parseInt((ev.target as HTMLElement).getAttribute('data-idx') || '0');
          wvLog.splice(idx, 1);
          renderLog();
        });
      });
    }
    setTimeout(() => {
      document.querySelectorAll('.wv-in').forEach(el => { el.addEventListener('input', calcWV); el.addEventListener('change', calcWV); });
      document.getElementById('wv-add')!.addEventListener('click', () => {
        const group = (document.getElementById('wv-group') as HTMLSelectElement).value;
        const sets = parseInt((document.getElementById('wv-sets') as HTMLInputElement).value) || 0;
        const reps = parseInt((document.getElementById('wv-reps') as HTMLInputElement).value) || 0;
        const wt = parseFloat((document.getElementById('wv-wt') as HTMLInputElement).value) || 0;
        const vol = sets * reps * wt;
        if (vol > 0) {
          wvLog.push({ group, sets, reps, weight: wt, vol });
          renderLog();
        }
      });
      calcWV();
    }, 50);
  </script>
</CalculatorLayout>
