---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Catering Quantity Calculator - Food & Drink Per Guest";
const description = "Calculate exactly how much food and drink you need per guest for your event. Covers appetizers, mains, desserts, and beverages with portion sizes.";
const relatedCalcs = [
  { name: "Event Budget Calculator", url: "/event-budget-calculator", description: "Total event cost breakdown." },
  { name: "Bartender Calculator", url: "/bartender-calculator", description: "Bar service quantities." },
  { name: "Cake Serving Calculator", url: "/cake-serving-calculator", description: "Cake size by guest count." },
  { name: "Party Supplies Calculator", url: "/party-supplies-calculator", description: "Plates, cups, napkins." },
  { name: "Event Staffing Calculator", url: "/event-staffing-calculator", description: "Staff needed for events." },
  { name: "Banquet Room Calculator", url: "/banquet-room-calculator", description: "Room size for guests." },
];
---

<CalculatorLayout
  title={title}
  description={description}
  calculatorName="Catering Quantity Calculator"
  keywords="catering calculator, food quantity per guest, event catering, party food calculator, catering portions"
  breadcrumbs={[{ name: "Catering Quantity", url: "/catering-quantity-calculator" }]}
>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Catering Quantity Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Figure out exactly how much food and drink to order for your event.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4 mb-6">
        <div>
          <label class="block text-sm font-medium text-text mb-1">Number of Guests</label>
          <input type="number" id="cq2-guests" class="cq2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="100" min="1" step="1">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Event Duration (hours)</label>
          <input type="number" id="cq2-hours" class="cq2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="4" min="1" max="12" step="0.5">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Meal Type</label>
          <select id="cq2-meal" class="cq2-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="full">Full Dinner (appetizers + main + dessert)</option>
            <option value="buffet">Buffet Style</option>
            <option value="cocktail">Cocktail / Heavy Appetizers</option>
            <option value="light">Light Lunch / Brunch</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Appetizer Varieties</label>
          <input type="number" id="cq2-appvar" class="cq2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="4" min="1" max="20" step="1">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Include Beverages?</label>
          <select id="cq2-bev" class="cq2-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="yes">Yes (non-alcoholic + alcoholic)</option>
            <option value="nonalc">Non-alcoholic only</option>
            <option value="no">No beverages</option>
          </select>
        </div>
      </div>

      <div class="p-6 bg-primary rounded-2xl text-white text-center mb-4">
        <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Total Appetizer Pieces</div>
        <div class="text-5xl font-extrabold" id="cq2-totalapp">--</div>
        <div class="text-sm mt-1" id="cq2-pervar">--</div>
      </div>

      <div class="grid grid-cols-2 gap-4 mb-4">
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Main Courses</div>
          <div class="text-xl font-bold" id="cq2-mains">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Dessert Servings</div>
          <div class="text-xl font-bold" id="cq2-desserts">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Total Beverages</div>
          <div class="text-xl font-bold" id="cq2-drinks">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Lbs of Food (est.)</div>
          <div class="text-xl font-bold" id="cq2-weight">--</div>
        </div>
      </div>

      <div class="p-4 bg-surface-alt rounded-xl mb-4" id="cq2-details"></div>

      <ShareButton calculatorId="catering-quantity" />
      <FeedbackWidget />
    </div>

    <article class="mt-12 max-w-4xl prose prose-slate">
      <h2 class="text-2xl font-bold text-text">Catering Quantity Guidelines</h2>
      <p>A common rule is 6-8 appetizer pieces per guest for a cocktail hour, 1 main course serving, and 1 dessert. For beverages, plan 2 drinks for the first hour and 1 per hour after.</p>
      <h3 class="text-xl font-semibold text-text mt-6">Per-Guest Estimates</h3>
      <ul>
        <li><strong>Appetizers:</strong> 6-8 pieces per person (cocktail hour), 12-15 for heavy apps</li>
        <li><strong>Main course:</strong> 6-8 oz protein, 4-6 oz starch, 3-4 oz vegetable</li>
        <li><strong>Dessert:</strong> 1-1.5 servings per person</li>
        <li><strong>Beverages:</strong> 2 drinks first hour, 1 per hour after</li>
      </ul>
    </article>

    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    function calcCQ2() {
      const guests = parseInt((document.getElementById('cq2-guests') as HTMLInputElement).value) || 1;
      const hours = parseFloat((document.getElementById('cq2-hours') as HTMLInputElement).value) || 4;
      const meal = (document.getElementById('cq2-meal') as HTMLSelectElement).value;
      const appVar = parseInt((document.getElementById('cq2-appvar') as HTMLInputElement).value) || 4;
      const bev = (document.getElementById('cq2-bev') as HTMLSelectElement).value;

      let appPerGuest = 6;
      let mainServings = guests;
      let dessertServings = guests;
      let lbsPerGuest = 1.5;

      if (meal === 'full') { appPerGuest = 6; mainServings = guests; dessertServings = guests; lbsPerGuest = 1.5; }
      else if (meal === 'buffet') { appPerGuest = 8; mainServings = Math.ceil(guests * 1.15); dessertServings = Math.ceil(guests * 1.1); lbsPerGuest = 1.75; }
      else if (meal === 'cocktail') { appPerGuest = 14; mainServings = 0; dessertServings = Math.ceil(guests * 0.75); lbsPerGuest = 1.25; }
      else if (meal === 'light') { appPerGuest = 4; mainServings = guests; dessertServings = Math.ceil(guests * 0.8); lbsPerGuest = 1.0; }

      const totalApp = appPerGuest * guests;
      const perVariety = Math.ceil(totalApp / appVar);

      let totalDrinks = 0;
      if (bev === 'yes' || bev === 'nonalc') {
        totalDrinks = guests * (2 + Math.max(0, hours - 1));
      }
      const totalWeight = Math.round(guests * lbsPerGuest);

      document.getElementById('cq2-totalapp')!.textContent = totalApp.toLocaleString();
      document.getElementById('cq2-pervar')!.textContent = perVariety + ' pieces per variety (' + appVar + ' varieties)';
      document.getElementById('cq2-mains')!.textContent = mainServings > 0 ? mainServings.toLocaleString() : 'N/A';
      document.getElementById('cq2-desserts')!.textContent = dessertServings.toLocaleString();
      document.getElementById('cq2-drinks')!.textContent = totalDrinks > 0 ? totalDrinks.toLocaleString() : 'N/A';
      document.getElementById('cq2-weight')!.textContent = totalWeight.toLocaleString();

      let details = '<h3 class="font-semibold text-sm text-text mb-2">Detailed Breakdown</h3><ul class="text-sm text-text-secondary space-y-1">';
      details += '<li>Appetizers: ' + appPerGuest + ' pieces/guest x ' + guests + ' guests = ' + totalApp + ' pieces</li>';
      if (mainServings > 0) details += '<li>Main courses: ' + mainServings + ' servings (6-8 oz protein each)</li>';
      details += '<li>Desserts: ' + dessertServings + ' servings</li>';
      if (totalDrinks > 0) {
        const softDrinks = Math.ceil(totalDrinks * 0.35);
        const water = Math.ceil(totalDrinks * 0.25);
        const alcDrinks = bev === 'yes' ? totalDrinks - softDrinks - water : 0;
        details += '<li>Beverages: ' + totalDrinks + ' total';
        if (bev === 'yes') details += ' (Alcoholic: ' + alcDrinks + ', Soft: ' + softDrinks + ', Water: ' + water + ')';
        details += '</li>';
      }
      details += '<li>Total food weight: ~' + totalWeight + ' lbs</li>';
      details += '</ul>';
      document.getElementById('cq2-details')!.innerHTML = details;

      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.cq2-in').forEach(el => { el.addEventListener('input', calcCQ2); el.addEventListener('change', calcCQ2); });
      calcCQ2();
    }, 50);
  </script>
</CalculatorLayout>
