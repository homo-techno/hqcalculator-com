---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Patent Cost Calculator - Application & Maintenance Fees";
const description = "Calculate patent application costs for provisional, utility, and design patents including USPTO fees, attorney costs, and 20-year maintenance fees.";
const relatedCalcs = [
  { name: "Trademark Cost Calculator", url: "/trademark-cost-calculator", description: "Trademark registration." },
  { name: "Legal Fee Calculator", url: "/legal-fee-calculator", description: "Lawyer cost estimates." },
  { name: "Incorporation Calculator", url: "/incorporation-calculator", description: "Business formation." },
  { name: "Compliance Cost Calculator", url: "/compliance-cost-calculator", description: "Compliance budgeting." },
  { name: "Contract Value Calculator", url: "/contract-value-calculator", description: "Contract valuation." },
  { name: "Litigation Cost Calculator", url: "/litigation-cost-calculator", description: "IP litigation costs." },
];
---

<CalculatorLayout title={title} description={description} calculatorName="Patent Cost Calculator" keywords="patent cost calculator, USPTO fees, patent attorney, provisional patent, utility patent, design patent, maintenance fees, patent application" breadcrumbs={[{ name: "Patent Cost", url: "/patent-cost-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Patent Cost Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Estimate total patent costs from filing through 20 years of maintenance.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-text mb-1">Patent Type</label>
          <select id="pac-type" class="pac-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="provisional">Provisional Patent Application</option>
            <option value="utility" selected>Utility Patent (non-provisional)</option>
            <option value="design">Design Patent</option>
            <option value="plant">Plant Patent</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Entity Size</label>
          <select id="pac-entity" class="pac-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="micro">Micro Entity (75% discount)</option>
            <option value="small" selected>Small Entity (50% discount)</option>
            <option value="large">Large Entity (full fees)</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Invention Complexity</label>
          <select id="pac-complexity" class="pac-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="simple">Simple (mechanical, basic)</option>
            <option value="moderate" selected>Moderate (electronics, software)</option>
            <option value="complex">Complex (biotech, semiconductor)</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Number of Claims</label>
          <input type="number" id="pac-claims" class="pac-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="20" min="1" max="100" step="1">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Patent Attorney</label>
          <select id="pac-atty" class="pac-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="none">DIY (no attorney)</option>
            <option value="standard" selected>Standard patent attorney</option>
            <option value="premium">Premium / specialized firm</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Include 20-Year Maintenance?</label>
          <select id="pac-maint" class="pac-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="no">No - Filing only</option>
            <option value="yes" selected>Yes - Include maintenance fees</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Patent Search</label>
          <select id="pac-search" class="pac-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="none">No search</option>
            <option value="basic" selected>Basic prior art search</option>
            <option value="comprehensive">Comprehensive patentability search</option>
          </select>
        </div>
      </div>

      <div class="mt-6 space-y-3">
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Estimated Total Cost</div>
          <div class="text-5xl font-extrabold font-mono" id="pac-total"></div>
        </div>
        <div class="grid grid-cols-2 gap-4">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">USPTO Filing Fees</div>
            <div class="text-xl font-bold text-secondary" id="pac-uspto"></div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Attorney Fees</div>
            <div class="text-xl font-bold" id="pac-atty-cost"></div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Search & Drawings</div>
            <div class="text-xl font-bold text-orange-600" id="pac-search-cost"></div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Maintenance Fees</div>
            <div class="text-xl font-bold" id="pac-maint-cost"></div>
          </div>
        </div>
      </div>
      <ShareButton calculatorId="patent-cost" />
      <FeedbackWidget />
    </div>

    <article class="mt-12 max-w-4xl prose prose-slate">
      <h2 class="text-2xl font-bold text-text">Understanding Patent Costs</h2>
      <p>A utility patent typically costs $5,000-$15,000+ to file and $15,000-$40,000+ over 20 years including maintenance. Provisional patents are cheaper ($1,500-$5,000) but expire after 12 months. Small and micro entities receive significant fee reductions from the USPTO. The complexity of the invention and number of claims significantly affect attorney costs.</p>
      <h3 class="text-xl font-semibold text-text mt-8">Maintenance Fee Schedule</h3>
      <p>Utility patents require maintenance fees at 3.5, 7.5, and 11.5 years after grant. Missing a maintenance payment results in patent expiration, though a 6-month grace period is available with a surcharge.</p>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    const fmt = (n: number) => '$' + Math.round(n).toLocaleString();

    function calcPAC() {
      const patentType = (document.getElementById('pac-type') as HTMLSelectElement).value;
      const entity = (document.getElementById('pac-entity') as HTMLSelectElement).value;
      const complexity = (document.getElementById('pac-complexity') as HTMLSelectElement).value;
      const claims = parseInt((document.getElementById('pac-claims') as HTMLInputElement).value) || 20;
      const atty = (document.getElementById('pac-atty') as HTMLSelectElement).value;
      const inclMaint = (document.getElementById('pac-maint') as HTMLSelectElement).value;
      const search = (document.getElementById('pac-search') as HTMLSelectElement).value;

      const entityDiscount: Record<string, number> = { micro: 0.25, small: 0.5, large: 1.0 };
      const discount = entityDiscount[entity] || 1;

      // USPTO filing fees (large entity base)
      let filingFee = 0;
      let issuanceFee = 0;
      if (patentType === 'provisional') {
        filingFee = 320 * discount;
      } else if (patentType === 'utility') {
        filingFee = (320 + 800 + 260) * discount; // filing + search + examination
        if (claims > 20) filingFee += (claims - 20) * 100 * discount;
        if (claims > 3) filingFee += 0; // independent claims over 3 extra
        issuanceFee = 1200 * discount;
      } else if (patentType === 'design') {
        filingFee = (220 + 680 + 200) * discount;
        issuanceFee = 700 * discount;
      } else {
        filingFee = (320 + 800 + 260) * discount;
        issuanceFee = 1200 * discount;
      }

      const usptoTotal = filingFee + issuanceFee;

      // Attorney fees
      const attyBase: Record<string, Record<string, number>> = {
        simple: { none: 0, standard: 5000, premium: 8000 },
        moderate: { none: 0, standard: 8000, premium: 14000 },
        complex: { none: 0, standard: 12000, premium: 22000 }
      };
      let attyCost = (attyBase[complexity] && attyBase[complexity][atty]) || 0;
      if (patentType === 'provisional') attyCost *= 0.3;
      if (patentType === 'design') attyCost *= 0.4;

      // Search & drawings
      const searchCosts: Record<string, number> = { none: 0, basic: 800, comprehensive: 2500 };
      let searchCost = searchCosts[search] || 0;
      const drawingCost = patentType === 'design' ? 600 : (complexity === 'simple' ? 400 : complexity === 'complex' ? 1200 : 700);
      searchCost += drawingCost;

      // Maintenance fees (utility only, large entity)
      let maintCost = 0;
      if (inclMaint === 'yes' && (patentType === 'utility' || patentType === 'plant')) {
        maintCost = (2000 + 3760 + 7700) * discount; // 3.5yr + 7.5yr + 11.5yr
      }

      const total = usptoTotal + attyCost + searchCost + maintCost;

      document.getElementById('pac-total')!.textContent = fmt(total);
      document.getElementById('pac-uspto')!.textContent = fmt(usptoTotal);
      document.getElementById('pac-atty-cost')!.textContent = fmt(attyCost);
      document.getElementById('pac-search-cost')!.textContent = fmt(searchCost);
      document.getElementById('pac-maint-cost')!.textContent = fmt(maintCost);

      document.dispatchEvent(new CustomEvent('calc-update'));
    }

    setTimeout(() => {
      document.querySelectorAll('.pac-in').forEach(el => {
        el.addEventListener('input', calcPAC);
        el.addEventListener('change', calcPAC);
      });
      calcPAC();
    }, 50);
  </script>
</CalculatorLayout>
