---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Reading Time Calculator - Estimate Reading Duration";
const description = "Calculate how long it takes to read text based on word count, reading speed, and content type.";
const relatedCalcs = [
  { name: "Typing Speed", url: "/typing-speed-calculator", description: "Typing speed." },
  { name: "Time Calculator", url: "/time-calculator", description: "Time." },
  { name: "Percentage Calculator", url: "/percentage-calculator", description: "Percentages." },
  { name: "GPA Calculator", url: "/gpa-calculator", description: "GPA." },
  { name: "Age Calculator", url: "/age-calculator", description: "Age." },
  { name: "Date Calculator", url: "/date-calculator", description: "Dates." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Reading Time Calculator" keywords="reading time calculator, reading speed, words per minute, reading duration, book reading time" breadcrumbs={[{ name: "Reading Time", url: "/reading-time-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Reading Time Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Estimate how long it takes to read any text.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="flex gap-2 mb-2">
          <button id="rt-paste" class="px-4 py-2 rounded-lg text-sm font-semibold border-2 border-primary bg-blue-50 text-primary">Paste Text</button>
          <button id="rt-count" class="px-4 py-2 rounded-lg text-sm font-semibold border-2 border-border text-text-muted">Word Count</button>
        </div>
        <div id="rt-paste-panel">
          <textarea id="rt-text" class="w-full px-4 py-3 border border-border rounded-xl text-sm resize-none" rows="5" placeholder="Paste your text here...">The quick brown fox jumps over the lazy dog. This is a sample text to demonstrate the reading time calculator. You can paste any text here and it will calculate approximately how long it would take to read at your chosen reading speed.</textarea>
        </div>
        <div id="rt-count-panel" class="hidden">
          <div><label class="block text-xs font-medium text-text mb-1">Word Count</label><input type="number" id="rt-words" class="rt-in w-full px-4 py-3 border border-border rounded-xl text-2xl font-bold" value="1000" min="0" step="100"></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="block text-xs font-medium text-text mb-1">Reading Speed (WPM)</label>
            <input type="number" id="rt-speed" class="rt-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="238" min="50" max="1000" step="10">
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Content Type</label>
            <select id="rt-type" class="w-full px-4 py-3 border border-border rounded-xl text-lg">
              <option value="1.0">General/Blog</option>
              <option value="0.7">Technical/Academic</option>
              <option value="1.2">Fiction/Easy</option>
              <option value="0.5">Dense/Legal</option>
            </select>
          </div>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Reading Time</div>
          <div class="text-4xl font-extrabold" id="rt-time">0 min</div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Word Count</div><div class="text-xl font-bold" id="rt-wc">0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Characters</div><div class="text-xl font-bold" id="rt-chars">0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Sentences</div><div class="text-xl font-bold" id="rt-sents">0</div></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-3">At Different Speeds</h3>
          <div class="space-y-1 text-sm" id="rt-speeds"></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Speaking Time</div><div class="text-xl font-bold" id="rt-speak">0 min</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Pages (250 w/p)</div><div class="text-xl font-bold" id="rt-pages">0</div></div>
        </div>
      </div>
      <ShareButton calculatorId="reading-time" />
      <FeedbackWidget />
    </div>
    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">Reading Speed</h2>
      <p>The average adult reads at 238 WPM (words per minute). Speed reading techniques can push this to 400-700 WPM.</p>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    let inputMode = 'paste';
    function setMode(mode: string) {
      inputMode = mode;
      document.getElementById('rt-paste')!.className = `px-4 py-2 rounded-lg text-sm font-semibold border-2 ${mode==='paste' ? 'border-primary bg-blue-50 text-primary' : 'border-border text-text-muted'}`;
      document.getElementById('rt-count')!.className = `px-4 py-2 rounded-lg text-sm font-semibold border-2 ${mode==='count' ? 'border-primary bg-blue-50 text-primary' : 'border-border text-text-muted'}`;
      document.getElementById('rt-paste-panel')!.classList.toggle('hidden', mode !== 'paste');
      document.getElementById('rt-count-panel')!.classList.toggle('hidden', mode !== 'count');
      calcRT();
    }
    function fmtTime(minutes: number): string {
      if (minutes < 1) return Math.round(minutes * 60) + ' sec';
      if (minutes < 60) return Math.round(minutes) + ' min';
      const h = Math.floor(minutes / 60); const m = Math.round(minutes % 60);
      return h + 'h ' + m + 'min';
    }
    function calcRT() {
      let wordCount: number, chars = 0, sents = 0;
      if (inputMode === 'paste') {
        const text = (document.getElementById('rt-text') as HTMLTextAreaElement).value.trim();
        const words = text.split(/\s+/).filter(w => w.length > 0);
        wordCount = words.length;
        chars = text.length;
        sents = (text.match(/[.!?]+/g) || []).length || (text.length > 0 ? 1 : 0);
      } else {
        wordCount = parseFloat((document.getElementById('rt-words') as HTMLInputElement).value) || 0;
        chars = wordCount * 5;
        sents = Math.ceil(wordCount / 15);
      }
      const speed = parseFloat((document.getElementById('rt-speed') as HTMLInputElement).value) || 238;
      const typeMul = parseFloat((document.getElementById('rt-type') as HTMLSelectElement).value);
      const effectiveSpeed = speed * typeMul;
      const minutes = wordCount / effectiveSpeed;
      document.getElementById('rt-time')!.textContent = fmtTime(minutes);
      document.getElementById('rt-wc')!.textContent = wordCount.toLocaleString();
      document.getElementById('rt-chars')!.textContent = chars.toLocaleString();
      document.getElementById('rt-sents')!.textContent = String(sents);
      document.getElementById('rt-speak')!.textContent = fmtTime(wordCount / 150);
      document.getElementById('rt-pages')!.textContent = (wordCount / 250).toFixed(1);
      const speeds = [
        { label: 'Slow (150 WPM)', wpm: 150 },
        { label: 'Average (238 WPM)', wpm: 238 },
        { label: 'Fast (350 WPM)', wpm: 350 },
        { label: 'Speed Read (600 WPM)', wpm: 600 },
      ];
      document.getElementById('rt-speeds')!.innerHTML = speeds.map(s =>
        `<div class="flex justify-between"><span>${s.label}</span><span class="font-bold">${fmtTime(wordCount / (s.wpm * typeMul))}</span></div>`
      ).join('');
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.getElementById('rt-text')!.addEventListener('input', calcRT);
      document.getElementById('rt-speed')!.addEventListener('input', calcRT);
      document.getElementById('rt-type')!.addEventListener('change', calcRT);
      document.querySelectorAll('.rt-in').forEach(el => el.addEventListener('input', calcRT));
      document.getElementById('rt-paste')!.addEventListener('click', () => setMode('paste'));
      document.getElementById('rt-count')!.addEventListener('click', () => setMode('count'));
      calcRT();
    }, 50);
  </script>
</CalculatorLayout>
