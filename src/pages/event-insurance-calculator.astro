---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Event Insurance Calculator - Liability Insurance Estimate";
const description = "Estimate event liability insurance costs based on event type, size, alcohol service, venue requirements, and coverage level needed.";
const relatedCalcs = [
  { name: "Event Budget Calculator", url: "/event-budget-calculator", description: "Total event cost breakdown." },
  { name: "Hotel Block Calculator", url: "/hotel-block-calculator", description: "Hotel room block planning." },
  { name: "Event Parking Calculator", url: "/event-parking-calculator", description: "Parking space planning." },
  { name: "Event Staffing Calculator", url: "/event-staffing-calculator", description: "Staff needed for events." },
  { name: "Bartender Calculator", url: "/bartender-calculator", description: "Bar service quantities." },
  { name: "Conference Calculator", url: "/conference-calculator", description: "Conference planning." },
];
---

<CalculatorLayout
  title={title}
  description={description}
  calculatorName="Event Insurance Calculator"
  keywords="event insurance calculator, event liability, wedding insurance, party insurance, event coverage, liability insurance cost"
  breadcrumbs={[{ name: "Event Insurance", url: "/event-insurance-calculator" }]}
>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Event Insurance Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Estimate event liability insurance costs for your event.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4 mb-6">
        <div>
          <label class="block text-sm font-medium text-text mb-1">Event Type</label>
          <select id="ei2-type" class="ei2-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="wedding">Wedding / Reception</option>
            <option value="corporate">Corporate Event</option>
            <option value="birthday">Birthday / Anniversary Party</option>
            <option value="gala">Gala / Fundraiser</option>
            <option value="festival">Festival / Large Outdoor Event</option>
            <option value="conference">Conference / Trade Show</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Number of Guests</label>
          <input type="number" id="ei2-guests" class="ei2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="150" min="10" step="10">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Alcohol Served?</label>
          <select id="ei2-alcohol" class="ei2-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="none">No alcohol</option>
            <option value="beerWine">Beer & wine only</option>
            <option value="full" selected>Full bar (liquor)</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Venue Type</label>
          <select id="ei2-venue" class="ei2-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="indoor">Indoor venue</option>
            <option value="outdoor">Outdoor / Park</option>
            <option value="private">Private residence</option>
            <option value="public">Public / Government space</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Coverage Level</label>
          <select id="ei2-coverage" class="ei2-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="basic">Basic ($1M general liability)</option>
            <option value="standard" selected>Standard ($1M liability + host liquor)</option>
            <option value="premium">Premium ($2M liability + cancellation)</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Total Event Investment ($)</label>
          <input type="number" id="ei2-investment" class="ei2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="25000" min="0" step="1000">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Include Cancellation Coverage?</label>
          <select id="ei2-cancel" class="ei2-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="no">No</option>
            <option value="yes" selected>Yes</option>
          </select>
        </div>
      </div>

      <div class="p-6 bg-primary rounded-2xl text-white text-center mb-4">
        <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Estimated Insurance Cost</div>
        <div class="text-5xl font-extrabold" id="ei2-cost">--</div>
        <div class="text-sm mt-1" id="ei2-note">--</div>
      </div>

      <div class="grid grid-cols-2 gap-4 mb-4">
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Liability Coverage</div>
          <div class="text-xl font-bold" id="ei2-liability">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Liquor Liability</div>
          <div class="text-xl font-bold" id="ei2-liquor">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Cancellation Coverage</div>
          <div class="text-xl font-bold" id="ei2-cancelcov">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Cost per Guest</div>
          <div class="text-xl font-bold" id="ei2-perguest">--</div>
        </div>
      </div>

      <div class="p-4 bg-surface-alt rounded-xl mb-4" id="ei2-details"></div>

      <ShareButton calculatorId="event-insurance" />
      <FeedbackWidget />
    </div>

    <article class="mt-12 max-w-4xl prose prose-slate">
      <h2 class="text-2xl font-bold text-text">Event Insurance Guide</h2>
      <p>Most venues require a minimum $1 million general liability policy. If serving alcohol, host liquor liability is essential. Cancellation insurance typically covers 80-90% of non-recoverable costs. Event insurance typically costs $75-$500+ depending on size and coverage.</p>
    </article>

    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    function calcEI2() {
      const eventType = (document.getElementById('ei2-type') as HTMLSelectElement).value;
      const guests = parseInt((document.getElementById('ei2-guests') as HTMLInputElement).value) || 100;
      const alcohol = (document.getElementById('ei2-alcohol') as HTMLSelectElement).value;
      const venue = (document.getElementById('ei2-venue') as HTMLSelectElement).value;
      const coverage = (document.getElementById('ei2-coverage') as HTMLSelectElement).value;
      const investment = parseFloat((document.getElementById('ei2-investment') as HTMLInputElement).value) || 0;
      const includeCancel = (document.getElementById('ei2-cancel') as HTMLSelectElement).value;

      let baseCost = 95;

      if (eventType === 'wedding') baseCost = 120;
      else if (eventType === 'corporate') baseCost = 100;
      else if (eventType === 'gala') baseCost = 150;
      else if (eventType === 'festival') baseCost = 250;
      else if (eventType === 'conference') baseCost = 110;
      else baseCost = 85;

      if (guests > 300) baseCost *= 1.8;
      else if (guests > 200) baseCost *= 1.4;
      else if (guests > 100) baseCost *= 1.15;

      let liquorCost = 0;
      if (alcohol === 'beerWine') liquorCost = 45;
      else if (alcohol === 'full') liquorCost = 85;

      if (venue === 'outdoor') baseCost *= 1.15;
      else if (venue === 'public') baseCost *= 1.1;

      if (coverage === 'standard') baseCost *= 1.0;
      else if (coverage === 'premium') baseCost *= 1.6;

      let cancelCost = 0;
      if (includeCancel === 'yes' && investment > 0) {
        cancelCost = Math.max(50, investment * 0.02);
      }

      const totalCost = Math.round(baseCost + liquorCost + cancelCost);

      let liabilityAmt = '$1,000,000';
      if (coverage === 'premium') liabilityAmt = '$2,000,000';

      const fmt = (n: number) => '$' + Math.round(n).toLocaleString();
      document.getElementById('ei2-cost')!.textContent = fmt(totalCost);
      document.getElementById('ei2-note')!.textContent = 'One-time premium for event day';
      document.getElementById('ei2-liability')!.textContent = liabilityAmt;
      document.getElementById('ei2-liquor')!.textContent = alcohol !== 'none' ? 'Included' : 'Not needed';
      document.getElementById('ei2-cancelcov')!.textContent = includeCancel === 'yes' ? fmt(investment * 0.8) + ' max' : 'Not included';
      document.getElementById('ei2-perguest')!.textContent = fmt(totalCost / guests);

      let details = '<h3 class="font-semibold text-sm text-text mb-2">Coverage Breakdown</h3><ul class="text-sm text-text-secondary space-y-1">';
      details += '<li>General liability: ' + liabilityAmt + ' coverage - ' + fmt(baseCost) + '</li>';
      if (liquorCost > 0) details += '<li>Host liquor liability: ' + fmt(liquorCost) + '</li>';
      if (cancelCost > 0) details += '<li>Cancellation coverage (up to ' + fmt(investment * 0.8) + '): ' + fmt(cancelCost) + '</li>';
      details += '<li>Event type: ' + eventType + '</li>';
      details += '<li>Guest count factor: ' + guests + ' guests</li>';
      details += '<li>Venue: ' + venue + '</li>';
      details += '</ul>';
      details += '<h3 class="font-semibold text-sm text-text mt-3 mb-2">What Is Typically Covered</h3><ul class="text-sm text-text-secondary space-y-1">';
      details += '<li>Bodily injury to guests</li>';
      details += '<li>Property damage to venue</li>';
      if (alcohol !== 'none') details += '<li>Alcohol-related incidents (host liquor liability)</li>';
      if (includeCancel === 'yes') details += '<li>Event cancellation due to weather, illness, vendor no-show</li>';
      details += '</ul>';
      document.getElementById('ei2-details')!.innerHTML = details;

      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.ei2-in').forEach(el => { el.addEventListener('input', calcEI2); el.addEventListener('change', calcEI2); });
      calcEI2();
    }, 50);
  </script>
</CalculatorLayout>
