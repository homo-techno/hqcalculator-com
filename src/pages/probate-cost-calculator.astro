---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Probate Cost Calculator - Court, Executor & Attorney Fees";
const description = "Calculate probate costs including court filing fees, executor compensation, attorney fees, and other expenses based on estate size and state laws.";
const relatedCalcs = [
  { name: "Legal Fee Calculator", url: "/legal-fee-calculator", description: "Attorney fee estimates." },
  { name: "Court Fee Calculator", url: "/court-fee-calculator", description: "Court filing fees." },
  { name: "Power of Attorney", url: "/power-of-attorney-calculator", description: "POA costs." },
  { name: "Contract Value Calculator", url: "/contract-value-calculator", description: "Asset valuation." },
  { name: "Tax Penalty Calculator", url: "/tax-penalty-calculator", description: "Estate tax issues." },
  { name: "Notary Fee Calculator", url: "/notary-fee-calculator", description: "Document notarization." },
];
---

<CalculatorLayout title={title} description={description} calculatorName="Probate Cost Calculator" keywords="probate cost calculator, probate fees, executor compensation, probate attorney, estate administration, court costs, estate settlement" breadcrumbs={[{ name: "Probate Cost", url: "/probate-cost-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Probate Cost Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Estimate total probate expenses including court fees, executor compensation, and attorney fees.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-text mb-1">Gross Estate Value ($)</label>
          <input type="number" id="pbc-estate" class="pbc-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="500000" min="0" step="10000">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Fee Structure</label>
          <select id="pbc-structure" class="pbc-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="statutory" selected>Statutory fee schedule (CA, FL, etc.)</option>
            <option value="reasonable">Reasonable fee (most states)</option>
            <option value="flat">Flat fee arrangement</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Estate Complexity</label>
          <select id="pbc-complexity" class="pbc-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="simple">Simple (few assets, no disputes)</option>
            <option value="moderate" selected>Moderate (multiple assets, some complexity)</option>
            <option value="complex">Complex (business interests, disputes, taxes)</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Probate Type</label>
          <select id="pbc-type" class="pbc-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="full" selected>Full formal probate</option>
            <option value="summary">Summary / simplified probate</option>
            <option value="affidavit">Small estate affidavit</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Will Contest Expected?</label>
          <select id="pbc-contest" class="pbc-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="no" selected>No</option>
            <option value="minor">Minor dispute (mediation)</option>
            <option value="major">Major contest (litigation)</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Real Property to Transfer?</label>
          <select id="pbc-property" class="pbc-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="no">No real property</option>
            <option value="1" selected>1 property</option>
            <option value="2">2+ properties</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Executor/Administrator Type</label>
          <select id="pbc-executor" class="pbc-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="family" selected>Family member</option>
            <option value="professional">Professional fiduciary</option>
            <option value="bank">Bank / trust company</option>
          </select>
        </div>
      </div>

      <div class="mt-6 space-y-3">
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Estimated Total Probate Cost</div>
          <div class="text-5xl font-extrabold font-mono" id="pbc-total"></div>
        </div>
        <div class="grid grid-cols-2 gap-4">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Attorney Fees</div>
            <div class="text-xl font-bold text-secondary" id="pbc-atty"></div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Executor Fees</div>
            <div class="text-xl font-bold" id="pbc-executor-fee"></div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Court / Filing Fees</div>
            <div class="text-xl font-bold text-orange-600" id="pbc-court"></div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">% of Estate</div>
            <div class="text-xl font-bold" id="pbc-pct"></div>
          </div>
        </div>
      </div>
      <ShareButton calculatorId="probate-cost" />
      <FeedbackWidget />
    </div>

    <article class="mt-12 max-w-4xl prose prose-slate">
      <h2 class="text-2xl font-bold text-text">Understanding Probate Costs</h2>
      <p>Probate typically costs 3-8% of the estate value. In statutory fee states like California, both the executor and attorney are entitled to fees based on a sliding scale: 4% of the first $100,000, 3% of the next $100,000, 2% of the next $800,000, and so on. In "reasonable fee" states, the court determines fair compensation based on time and complexity.</p>
      <h3 class="text-xl font-semibold text-text mt-8">Avoiding Probate</h3>
      <p>Many assets can pass outside probate through beneficiary designations, joint ownership, transfer-on-death deeds, and living trusts. While establishing a trust costs $1,500-$5,000 upfront, it can save significant probate costs and provide privacy for larger estates.</p>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    const fmt = (n: number) => '$' + Math.round(n).toLocaleString();

    function calcPBC() {
      const estate = parseFloat((document.getElementById('pbc-estate') as HTMLInputElement).value) || 0;
      const structure = (document.getElementById('pbc-structure') as HTMLSelectElement).value;
      const complexity = (document.getElementById('pbc-complexity') as HTMLSelectElement).value;
      const probateType = (document.getElementById('pbc-type') as HTMLSelectElement).value;
      const contest = (document.getElementById('pbc-contest') as HTMLSelectElement).value;
      const property = (document.getElementById('pbc-property') as HTMLSelectElement).value;
      const executorType = (document.getElementById('pbc-executor') as HTMLSelectElement).value;

      // Attorney fees
      let attyFee = 0;
      if (structure === 'statutory') {
        // California-style statutory schedule
        if (estate > 0) attyFee += Math.min(estate, 100000) * 0.04;
        if (estate > 100000) attyFee += Math.min(estate - 100000, 100000) * 0.03;
        if (estate > 200000) attyFee += Math.min(estate - 200000, 800000) * 0.02;
        if (estate > 1000000) attyFee += Math.min(estate - 1000000, 9000000) * 0.01;
        if (estate > 10000000) attyFee += (estate - 10000000) * 0.005;
      } else if (structure === 'reasonable') {
        const basePct = complexity === 'simple' ? 0.025 : complexity === 'complex' ? 0.05 : 0.035;
        attyFee = estate * basePct;
        attyFee = Math.max(attyFee, 1500);
      } else {
        attyFee = complexity === 'simple' ? 3000 : complexity === 'complex' ? 8000 : 5000;
      }

      // Probate type reductions
      if (probateType === 'summary') attyFee *= 0.5;
      if (probateType === 'affidavit') attyFee = Math.min(attyFee, 1000);

      // Contest costs
      if (contest === 'minor') attyFee += 5000;
      if (contest === 'major') attyFee += 25000;

      // Executor fees (similar to attorney in statutory states)
      let executorFee = 0;
      if (executorType === 'family') {
        // Family may waive or take reduced fee
        executorFee = attyFee * 0.3;
      } else if (executorType === 'professional') {
        executorFee = attyFee * 1.0; // similar to attorney fee
      } else {
        executorFee = estate * 0.015; // bank typically 1-2%
        executorFee = Math.max(executorFee, 3000);
      }

      // Court filing fees
      let courtFee = 465; // typical probate filing
      if (probateType === 'summary') courtFee = 250;
      if (probateType === 'affidavit') courtFee = 50;
      if (property !== 'no') courtFee += parseInt(property) * 200; // property transfer costs

      // Bond, appraisals, publication
      let otherCosts = 200; // publication notice
      if (estate > 100000) otherCosts += 500; // appraisal
      courtFee += otherCosts;

      const total = attyFee + executorFee + courtFee;
      const pctEstate = estate > 0 ? ((total / estate) * 100).toFixed(1) + '%' : 'N/A';

      document.getElementById('pbc-total')!.textContent = fmt(total);
      document.getElementById('pbc-atty')!.textContent = fmt(attyFee);
      document.getElementById('pbc-executor-fee')!.textContent = fmt(executorFee);
      document.getElementById('pbc-court')!.textContent = fmt(courtFee);
      document.getElementById('pbc-pct')!.textContent = pctEstate;

      document.dispatchEvent(new CustomEvent('calc-update'));
    }

    setTimeout(() => {
      document.querySelectorAll('.pbc-in').forEach(el => {
        el.addEventListener('input', calcPBC);
        el.addEventListener('change', calcPBC);
      });
      calcPBC();
    }, 50);
  </script>
</CalculatorLayout>
