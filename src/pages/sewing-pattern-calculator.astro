---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Sewing Pattern Calculator - Pattern Scaling & Ease Allowance";
const description = "Scale sewing patterns from body measurements with ease allowance, seam allowance, and grain line calculations for perfect garment fit.";
const relatedCalcs = [
  { name: "Fabric Calculator", url: "/fabric-calculator", description: "Fabric yardage needs." },
  { name: "Yarn Calculator", url: "/yarn-calculator", description: "Yarn yardage calculator." },
  { name: "Quilt Calculator", url: "/quilt-calculator", description: "Quilt sizing math." },
  { name: "Percentage Calculator", url: "/percentage-calculator", description: "Percentage calculations." },
  { name: "Area Calculator", url: "/area-calculator", description: "Area calculations." },
  { name: "Unit Price Calculator", url: "/unit-price-calculator", description: "Unit price comparison." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Sewing Pattern Calculator" keywords="sewing pattern calculator, pattern scaling, ease allowance, seam allowance, grain line, garment fit" breadcrumbs={[{ name: "Sewing Pattern", url: "/sewing-pattern-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Sewing Pattern Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Scale patterns from body measurements with ease, seam allowance, and grain line adjustments.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div>
          <label class="block text-xs font-medium text-text mb-1">Garment Type</label>
          <select id="sp-type" class="sp-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
            <option value="fitted">Fitted (Close-fitting)</option>
            <option value="semifitted" selected>Semi-fitted (Standard)</option>
            <option value="loose">Loose (Relaxed)</option>
            <option value="oversized">Oversized</option>
          </select>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Bust (inches)</label><input type="number" id="sp-bust" class="sp-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="36" min="20" max="70" step="0.25"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Waist (inches)</label><input type="number" id="sp-waist" class="sp-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="28" min="18" max="60" step="0.25"></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Hip (inches)</label><input type="number" id="sp-hip" class="sp-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="38" min="24" max="70" step="0.25"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Garment Length (inches)</label><input type="number" id="sp-length" class="sp-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="28" min="6" max="72" step="0.5"></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Seam Allowance (inches)</label><input type="number" id="sp-seam" class="sp-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="0.625" min="0.25" max="2" step="0.125"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Hem Allowance (inches)</label><input type="number" id="sp-hem" class="sp-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="1.5" min="0.5" max="4" step="0.25"></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Pattern Size (original)</label><input type="number" id="sp-origbust" class="sp-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="34" min="20" max="70" step="0.25"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Fabric Width (inches)</label><input type="number" id="sp-fabw" class="sp-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="45" min="36" max="120" step="1"></div>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Pattern Bust with Ease</div>
          <div class="text-4xl font-extrabold font-mono" id="sp-result">--</div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Waist + Ease</div><div class="text-xl font-bold font-mono" id="sp-waistease">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Hip + Ease</div><div class="text-xl font-bold font-mono" id="sp-hipease">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Scale Factor</div><div class="text-xl font-bold font-mono" id="sp-scale">--</div></div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Cut Width</div><div class="text-xl font-bold font-mono" id="sp-cutw">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Cut Length</div><div class="text-xl font-bold font-mono" id="sp-cutl">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Fabric Needed</div><div class="text-xl font-bold font-mono" id="sp-fabric">--</div></div>
        </div>
      </div>
      <ShareButton calculatorId="sewing-pattern" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcSP() {
      const gtype = (document.getElementById('sp-type') as HTMLSelectElement).value;
      const bust = parseFloat((document.getElementById('sp-bust') as HTMLInputElement).value) || 36;
      const waist = parseFloat((document.getElementById('sp-waist') as HTMLInputElement).value) || 28;
      const hip = parseFloat((document.getElementById('sp-hip') as HTMLInputElement).value) || 38;
      const length = parseFloat((document.getElementById('sp-length') as HTMLInputElement).value) || 28;
      const seam = parseFloat((document.getElementById('sp-seam') as HTMLInputElement).value) || 0.625;
      const hem = parseFloat((document.getElementById('sp-hem') as HTMLInputElement).value) || 1.5;
      const origBust = parseFloat((document.getElementById('sp-origbust') as HTMLInputElement).value) || 34;
      const fabW = parseFloat((document.getElementById('sp-fabw') as HTMLInputElement).value) || 45;

      const easeMap: Record<string, number[]> = {
        fitted: [1.5, 0.75, 1.5],
        semifitted: [3, 1.5, 2.5],
        loose: [5, 3, 4],
        oversized: [8, 5, 6]
      };
      const ease = easeMap[gtype] || easeMap['semifitted'];

      const bustEased = bust + ease[0];
      const waistEased = waist + ease[1];
      const hipEased = hip + ease[2];

      const scaleFactor = bust / origBust;

      const cutWidthHalf = (bustEased / 4) + (seam * 2);
      const cutLength = length + hem + seam;

      const piecesAcross = Math.floor(fabW / cutWidthHalf);
      const mainPieces = 4;
      const rows = Math.ceil(mainPieces / Math.max(piecesAcross, 1));
      const fabricYards = ((rows * cutLength) + 6) / 36;

      document.getElementById('sp-result')!.textContent = bustEased.toFixed(1) + '"';
      document.getElementById('sp-waistease')!.textContent = waistEased.toFixed(1) + '"';
      document.getElementById('sp-hipease')!.textContent = hipEased.toFixed(1) + '"';
      document.getElementById('sp-scale')!.textContent = (scaleFactor * 100).toFixed(1) + '%';
      document.getElementById('sp-cutw')!.textContent = cutWidthHalf.toFixed(1) + '"';
      document.getElementById('sp-cutl')!.textContent = cutLength.toFixed(1) + '"';
      document.getElementById('sp-fabric')!.textContent = fabricYards.toFixed(2) + ' yd';
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.sp-in').forEach(el => { el.addEventListener('input', calcSP); el.addEventListener('change', calcSP); });
      calcSP();
    }, 50);
  </script>
</CalculatorLayout>
