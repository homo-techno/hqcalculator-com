---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Candle Making Calculator - Wax, Fragrance & Wick";
const description = "Calculate wax weight from container volume, fragrance load percentage, wick size recommendation, and pour temperature for candle making.";
const relatedCalcs = [
  { name: "Candle Burn Time", url: "/candle-burn-time-calculator", description: "Burn time estimate." },
  { name: "Volume Calculator", url: "/volume-calculator", description: "Volume calculations." },
  { name: "Weight Converter", url: "/weight-converter", description: "Weight conversion." },
  { name: "Percentage Calculator", url: "/percentage-calculator", description: "Percentages." },
  { name: "Unit Price", url: "/unit-price-calculator", description: "Unit price." },
  { name: "Budget Calculator", url: "/budget-calculator", description: "Budget planning." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Candle Making Calculator" keywords="candle making calculator, wax weight, fragrance load, wick size, pour temperature, candle crafting" breadcrumbs={[{ name: "Candle Making", url: "/candle-making-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Candle Making Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate wax weight, fragrance oil, and wick size for your container candles.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Container Volume (fl oz)</label><input type="number" id="cm-vol" class="cm-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="8" min="0.5" step="0.5"></div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Wax Type</label>
            <select id="cm-wax" class="cm-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
              <option value="soy" selected>Soy Wax</option>
              <option value="paraffin">Paraffin Wax</option>
              <option value="beeswax">Beeswax</option>
              <option value="coconut">Coconut Wax</option>
              <option value="palm">Palm Wax</option>
            </select>
          </div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Fragrance Load (%)</label><input type="number" id="cm-frag" class="cm-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="8" min="0" max="15" step="0.5"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Number of Candles</label><input type="number" id="cm-qty" class="cm-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="1" min="1" step="1"></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Container Diameter (inches)</label><input type="number" id="cm-dia" class="cm-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="3" min="1" max="10" step="0.25"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Wax Cost ($/lb)</label><input type="number" id="cm-cost" class="cm-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="8" min="0" step="0.5"></div>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Wax Needed per Candle</div>
          <div class="text-4xl font-extrabold font-mono" id="cm-result">0 oz</div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Fragrance Oil</div><div class="text-xl font-bold font-mono" id="cm-fo">0 oz</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Wick Size</div><div class="text-xl font-bold font-mono" id="cm-wick">--</div></div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Pour Temp</div><div class="text-xl font-bold font-mono" id="cm-pour">0Â°F</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Total Wax</div><div class="text-xl font-bold font-mono" id="cm-total">0 lbs</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Material Cost</div><div class="text-xl font-bold font-mono" id="cm-mcost">$0</div></div>
        </div>
      </div>
      <ShareButton calculatorId="candle-making" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcCM() {
      const vol = parseFloat((document.getElementById('cm-vol') as HTMLInputElement).value) || 8;
      const waxType = (document.getElementById('cm-wax') as HTMLSelectElement).value;
      const fragPct = parseFloat((document.getElementById('cm-frag') as HTMLInputElement).value) || 0;
      const qty = parseInt((document.getElementById('cm-qty') as HTMLInputElement).value) || 1;
      const dia = parseFloat((document.getElementById('cm-dia') as HTMLInputElement).value) || 3;
      const waxCost = parseFloat((document.getElementById('cm-cost') as HTMLInputElement).value) || 0;

      // Wax density (oz per fl oz) varies by type
      const densities: Record<string, number> = { soy: 0.86, paraffin: 0.9, beeswax: 0.96, coconut: 0.82, palm: 0.88 };
      const pourTemps: Record<string, number> = { soy: 135, paraffin: 180, beeswax: 160, coconut: 125, palm: 200 };
      const density = densities[waxType] || 0.86;
      const pourTemp = pourTemps[waxType] || 135;

      const totalWeightPerCandle = vol * density; // oz of wax+fragrance per candle
      const fragOz = totalWeightPerCandle * (fragPct / 100);
      const waxOz = totalWeightPerCandle - fragOz;

      // Wick size recommendation based on container diameter
      let wickSize = 'Small (ECO-6)';
      if (dia >= 2 && dia < 2.5) wickSize = 'ECO-6 / CD-5';
      else if (dia >= 2.5 && dia < 3) wickSize = 'ECO-8 / CD-8';
      else if (dia >= 3 && dia < 3.5) wickSize = 'ECO-10 / CD-10';
      else if (dia >= 3.5 && dia < 4) wickSize = 'ECO-12 / CD-12';
      else if (dia >= 4 && dia < 4.5) wickSize = 'ECO-14 / CD-14';
      else if (dia >= 4.5) wickSize = 'ECO-16+ / CD-18';

      const totalWaxOz = waxOz * qty;
      const totalWaxLbs = totalWaxOz / 16;
      const materialCost = totalWaxLbs * waxCost;

      document.getElementById('cm-result')!.textContent = waxOz.toFixed(1) + ' oz';
      document.getElementById('cm-fo')!.textContent = fragOz.toFixed(2) + ' oz';
      document.getElementById('cm-wick')!.textContent = wickSize;
      document.getElementById('cm-pour')!.textContent = pourTemp + '\u00B0F';
      document.getElementById('cm-total')!.textContent = totalWaxLbs.toFixed(2) + ' lbs';
      document.getElementById('cm-mcost')!.textContent = '$' + materialCost.toFixed(2);
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.cm-in').forEach(el => { el.addEventListener('input', calcCM); el.addEventListener('change', calcCM); });
      calcCM();
    }, 50);
  </script>
</CalculatorLayout>
