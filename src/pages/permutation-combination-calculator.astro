---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Permutation & Combination Calculator - nPr and nCr";
const description = "Calculate permutations (nPr) and combinations (nCr). Find how many ways to arrange or choose items from a set.";
const relatedCalcs = [
  { name: "Probability", url: "/probability-calculator", description: "Probability." },
  { name: "Factorial", url: "/scientific-calculator", description: "Scientific calc." },
  { name: "Statistics", url: "/standard-deviation-calculator", description: "Statistics." },
  { name: "Percentage Calculator", url: "/percentage-calculator", description: "Percentages." },
  { name: "Average Calculator", url: "/average-calculator", description: "Averages." },
  { name: "Random Number", url: "/random-number-generator", description: "Random numbers." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Permutation & Combination Calculator" keywords="permutation calculator, combination calculator, nPr, nCr, factorial, counting" breadcrumbs={[{ name: "Permutations & Combinations", url: "/permutation-combination-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Permutation & Combination Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate nPr (permutations) and nCr (combinations).</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium text-text mb-1">n (total items)</label>
            <input type="number" id="pc-n" class="w-full px-4 py-3 border border-border rounded-xl text-2xl font-bold text-center" value="10" min="0" max="170" step="1">
          </div>
          <div>
            <label class="block text-sm font-medium text-text mb-1">r (items chosen)</label>
            <input type="number" id="pc-r" class="w-full px-4 py-3 border border-border rounded-xl text-2xl font-bold text-center" value="3" min="0" max="170" step="1">
          </div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-6 bg-primary rounded-2xl text-white text-center">
            <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Permutations (nPr)</div>
            <div class="text-3xl font-extrabold font-mono" id="pc-perm">0</div>
            <div class="text-xs text-blue-200 mt-1">Order matters</div>
          </div>
          <div class="p-6 bg-secondary rounded-2xl text-white text-center">
            <div class="text-sm uppercase tracking-wide mb-1 opacity-80">Combinations (nCr)</div>
            <div class="text-3xl font-extrabold font-mono" id="pc-comb">0</div>
            <div class="text-xs mt-1 opacity-80">Order doesn't matter</div>
          </div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">n!</div>
            <div class="text-lg font-bold font-mono" id="pc-nfact">0</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">r!</div>
            <div class="text-lg font-bold font-mono" id="pc-rfact">0</div>
          </div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-3">Formulas</h3>
          <div class="space-y-1 font-mono text-sm" id="pc-formulas"></div>
        </div>
      </div>
      <ShareButton calculatorId="perm-comb" />
      <FeedbackWidget />
    </div>
    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">Permutations vs Combinations</h2>
      <p><strong>Permutations</strong> (nPr): Order matters. "ABC" ≠ "CBA". Formula: n! / (n−r)!</p>
      <p><strong>Combinations</strong> (nCr): Order doesn't matter. Formula: n! / (r! × (n−r)!)</p>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function factorial(n: number): number { if (n <= 1) return 1; let r = 1; for (let i = 2; i <= n; i++) r *= i; return r; }
    function fmtBig(n: number): string { return n > 1e15 ? n.toExponential(4) : n.toLocaleString(); }
    function calcPC() {
      const n = Math.max(0, Math.round(parseFloat((document.getElementById('pc-n') as HTMLInputElement).value) || 0));
      const r = Math.max(0, Math.min(n, Math.round(parseFloat((document.getElementById('pc-r') as HTMLInputElement).value) || 0)));
      const nFact = factorial(n);
      const rFact = factorial(r);
      const nrFact = factorial(n - r);
      const perm = nFact / nrFact;
      const comb = nFact / (rFact * nrFact);
      document.getElementById('pc-perm')!.textContent = fmtBig(perm);
      document.getElementById('pc-comb')!.textContent = fmtBig(comb);
      document.getElementById('pc-nfact')!.textContent = fmtBig(nFact);
      document.getElementById('pc-rfact')!.textContent = fmtBig(rFact);
      document.getElementById('pc-formulas')!.innerHTML = `
        <div>P(${n},${r}) = ${n}! / ${n-r}! = ${fmtBig(nFact)} / ${fmtBig(nrFact)} = <strong>${fmtBig(perm)}</strong></div>
        <div>C(${n},${r}) = ${n}! / (${r}! × ${n-r}!) = ${fmtBig(nFact)} / (${fmtBig(rFact)} × ${fmtBig(nrFact)}) = <strong>${fmtBig(comb)}</strong></div>`;
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      ['pc-n','pc-r'].forEach(id => document.getElementById(id)!.addEventListener('input', calcPC));
      calcPC();
    }, 50);
  </script>
</CalculatorLayout>
