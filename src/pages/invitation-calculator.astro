---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Invitation Calculator - Invitations, RSVPs & Postage Costs";
const description = "Calculate the number of invitations needed, RSVP response tracking, postage costs, and extra quantities for your event. Includes save-the-dates and thank you cards.";
const relatedCalcs = [
  { name: "Event Budget Calculator", url: "/event-budget-calculator", description: "Total event cost breakdown." },
  { name: "Wedding Timeline Calculator", url: "/wedding-timeline-calculator", description: "Wedding day schedule." },
  { name: "Catering Quantity Calculator", url: "/catering-quantity-calculator", description: "Food quantities per guest." },
  { name: "Seating Chart Calculator", url: "/seating-chart-calculator", description: "Table layout planner." },
  { name: "Hotel Block Calculator", url: "/hotel-block-calculator", description: "Hotel room blocks." },
  { name: "Event Parking Calculator", url: "/event-parking-calculator", description: "Parking planning." },
];
---

<CalculatorLayout
  title={title}
  description={description}
  calculatorName="Invitation Calculator"
  keywords="invitation calculator, wedding invitations, RSVP tracking, postage cost, event invitations, save the date"
  breadcrumbs={[{ name: "Invitation", url: "/invitation-calculator" }]}
>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Invitation Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate invitations, RSVP cards, and postage for your event.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4 mb-6">
        <div>
          <label class="block text-sm font-medium text-text mb-1">Total Guest List (individuals)</label>
          <input type="number" id="inv-guests" class="inv-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="150" min="1" step="1">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Households / Couples on List</label>
          <input type="number" id="inv-households" class="inv-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="85" min="1" step="1">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Expected RSVP Rate (%)</label>
          <input type="number" id="inv-rsvp" class="inv-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="80" min="0" max="100" step="5">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Invitation Cost per Unit ($)</label>
          <input type="number" id="inv-cost" class="inv-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="3.50" min="0" step="0.25">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Postage per Invitation ($)</label>
          <input type="number" id="inv-postage" class="inv-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="0.73" min="0" step="0.01">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Include RSVP Return Envelope?</label>
          <select id="inv-return" class="inv-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="yes" selected>Yes (stamped return envelope)</option>
            <option value="online">No (online RSVP only)</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Include Save-the-Dates?</label>
          <select id="inv-save" class="inv-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="yes" selected>Yes</option>
            <option value="no">No</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Extra Buffer (%)</label>
          <input type="number" id="inv-buffer" class="inv-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="10" min="0" max="30" step="5">
        </div>
      </div>

      <div class="p-6 bg-primary rounded-2xl text-white text-center mb-4">
        <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Total Stationery Cost</div>
        <div class="text-5xl font-extrabold" id="inv-total">--</div>
        <div class="text-sm mt-1" id="inv-note">--</div>
      </div>

      <div class="grid grid-cols-2 gap-4 mb-4">
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Invitations to Print</div>
          <div class="text-xl font-bold" id="inv-count">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Postage Cost</div>
          <div class="text-xl font-bold" id="inv-postagecost">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Expected Attendees</div>
          <div class="text-xl font-bold" id="inv-expected">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Thank You Cards</div>
          <div class="text-xl font-bold" id="inv-thanks">--</div>
        </div>
      </div>

      <div class="p-4 bg-surface-alt rounded-xl mb-4" id="inv-details"></div>

      <ShareButton calculatorId="invitation" />
      <FeedbackWidget />
    </div>

    <article class="mt-12 max-w-4xl prose prose-slate">
      <h2 class="text-2xl font-bold text-text">Invitation Planning Guide</h2>
      <p>Send one invitation per household, not per guest. Mail invitations 6-8 weeks before the event (save-the-dates 6-8 months before). Always order 10-15% extra for mistakes, keepsakes, and late additions.</p>
    </article>

    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    function calcINV() {
      const guests = parseInt((document.getElementById('inv-guests') as HTMLInputElement).value) || 1;
      const households = parseInt((document.getElementById('inv-households') as HTMLInputElement).value) || 1;
      const rsvpRate = parseFloat((document.getElementById('inv-rsvp') as HTMLInputElement).value) || 80;
      const costPer = parseFloat((document.getElementById('inv-cost') as HTMLInputElement).value) || 3.50;
      const postagePer = parseFloat((document.getElementById('inv-postage') as HTMLInputElement).value) || 0.73;
      const returnEnv = (document.getElementById('inv-return') as HTMLSelectElement).value;
      const saveDates = (document.getElementById('inv-save') as HTMLSelectElement).value;
      const bufferPct = parseFloat((document.getElementById('inv-buffer') as HTMLInputElement).value) || 10;

      const mult = 1 + bufferPct / 100;
      const invCount = Math.ceil(households * mult);
      const expectedAttendees = Math.ceil(guests * rsvpRate / 100);
      const thankYouCards = Math.ceil(households * mult);

      let invCost = invCount * costPer;
      let postageCost = invCount * postagePer;

      if (returnEnv === 'yes') {
        postageCost += invCount * postagePer;
      }

      let saveDateCost = 0;
      if (saveDates === 'yes') {
        saveDateCost = invCount * 1.50 + invCount * postagePer;
      }

      const thankYouCost = thankYouCards * 1.25 + thankYouCards * postagePer;
      const totalCost = invCost + postageCost + saveDateCost + thankYouCost;

      const fmt = (n: number) => '$' + n.toFixed(2);
      document.getElementById('inv-total')!.textContent = '$' + Math.round(totalCost).toLocaleString();
      document.getElementById('inv-note')!.textContent = 'Invitations + postage + save-the-dates + thank yous';
      document.getElementById('inv-count')!.textContent = invCount.toString();
      document.getElementById('inv-postagecost')!.textContent = '$' + Math.round(postageCost).toLocaleString();
      document.getElementById('inv-expected')!.textContent = expectedAttendees.toString();
      document.getElementById('inv-thanks')!.textContent = thankYouCards.toString();

      let details = '<h3 class="font-semibold text-sm text-text mb-2">Cost Breakdown</h3><ul class="text-sm text-text-secondary space-y-1">';
      details += '<li>Invitations: ' + invCount + ' x ' + fmt(costPer) + ' = ' + fmt(invCost) + '</li>';
      details += '<li>Outgoing postage: ' + invCount + ' x ' + fmt(postagePer) + ' = ' + fmt(invCount * postagePer) + '</li>';
      if (returnEnv === 'yes') details += '<li>RSVP return postage: ' + invCount + ' x ' + fmt(postagePer) + ' = ' + fmt(invCount * postagePer) + '</li>';
      if (saveDates === 'yes') details += '<li>Save-the-dates: ' + invCount + ' x $1.50 + postage = ' + fmt(saveDateCost) + '</li>';
      details += '<li>Thank you cards: ' + thankYouCards + ' x $1.25 + postage = ' + fmt(thankYouCost) + '</li>';
      details += '<li>Buffer: ' + bufferPct + '% extra (' + (invCount - households) + ' extra invitations)</li>';
      details += '<li>Expected attendees: ' + expectedAttendees + ' of ' + guests + ' invited (' + rsvpRate + '% acceptance)</li>';
      details += '</ul>';
      document.getElementById('inv-details')!.innerHTML = details;

      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.inv-in').forEach(el => { el.addEventListener('input', calcINV); el.addEventListener('change', calcINV); });
      calcINV();
    }, 50);
  </script>
</CalculatorLayout>
