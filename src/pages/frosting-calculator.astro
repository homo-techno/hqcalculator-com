---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Frosting Calculator - Icing Quantity for Cakes & Cupcakes";
const description = "Calculate the exact amount of frosting needed for layer cakes, sheet cakes, and cupcakes. Get ingredient quantities for buttercream and cream cheese frosting.";
const relatedCalcs = [
  { name: "Cake Pan Converter", url: "/cake-pan-converter-calculator", description: "Convert recipes between pan sizes." },
  { name: "Cookie Batch Calculator", url: "/cookie-batch-calculator", description: "Scale cookie recipes by count." },
  { name: "Baking Conversion Calculator", url: "/baking-conversion-calculator", description: "Convert between baking units." },
  { name: "Recipe Scaler", url: "/recipe-scaler", description: "Scale any recipe." },
  { name: "Chocolate Tempering Calculator", url: "/chocolate-tempering-calculator", description: "Chocolate tempering temperatures." },
  { name: "Sugar Syrup Calculator", url: "/sugar-syrup-calculator", description: "Sugar syrup concentrations." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Frosting Calculator" keywords="frosting calculator, icing quantity, buttercream amount, cake frosting, cupcake frosting, cream cheese frosting" breadcrumbs={[{ name: "Frosting", url: "/frosting-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Frosting Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate how much frosting you need for your cake or cupcakes, with ingredient quantities for popular frosting types.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div>
          <label class="block text-xs font-medium text-text mb-1">Cake Type</label>
          <select id="fro-type" class="fro-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="layer2">2-Layer Round Cake</option>
            <option value="layer3">3-Layer Round Cake</option>
            <option value="sheet">Sheet Cake (9x13)</option>
            <option value="cupcakes">Cupcakes</option>
          </select>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="block text-xs font-medium text-text mb-1">Cake Diameter / Count</label>
            <input type="number" id="fro-size" class="fro-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="9" min="1" step="1">
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Frosting Style</label>
            <select id="fro-style" class="fro-in w-full px-4 py-3 border border-border rounded-xl text-lg">
              <option value="thin">Thin coat</option>
              <option value="medium" selected>Medium</option>
              <option value="thick">Thick / Decorative</option>
            </select>
          </div>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Frosting Type</label>
          <select id="fro-recipe" class="fro-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="buttercream">American Buttercream</option>
            <option value="cream">Cream Cheese Frosting</option>
            <option value="swiss">Swiss Meringue Buttercream</option>
            <option value="ganache">Chocolate Ganache</option>
          </select>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Frosting Needed</div>
          <div class="text-5xl font-extrabold font-mono" id="fro-result">--</div>
        </div>
        <div class="grid grid-cols-2 gap-4">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Butter / Fat</div>
            <div class="text-xl font-bold font-mono" id="fro-butter">--</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Powdered Sugar</div>
            <div class="text-xl font-bold font-mono" id="fro-sugar">--</div>
          </div>
        </div>
        <div class="grid grid-cols-2 gap-4">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Liquid (milk/cream)</div>
            <div class="text-xl font-bold font-mono" id="fro-liquid">--</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Serves</div>
            <div class="text-xl font-bold font-mono" id="fro-serves">--</div>
          </div>
        </div>
      </div>
      <ShareButton calculatorId="frosting" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcFRO() {
      const type = (document.getElementById('fro-type') as HTMLSelectElement).value;
      const size = parseFloat((document.getElementById('fro-size') as HTMLInputElement).value) || 9;
      const style = (document.getElementById('fro-style') as HTMLSelectElement).value;
      const recipe = (document.getElementById('fro-recipe') as HTMLSelectElement).value;

      // Calculate cups of frosting needed
      let cups = 0;
      if (type === 'cupcakes') {
        const perCupcake = style === 'thin' ? 0.12 : style === 'medium' ? 0.17 : 0.25;
        cups = size * perCupcake;
      } else if (type === 'sheet') {
        cups = style === 'thin' ? 3 : style === 'medium' ? 4 : 5.5;
      } else {
        // Layer cakes: calculate surface area
        const layers = type === 'layer3' ? 3 : 2;
        const diameter = size;
        const topArea = Math.PI * Math.pow(diameter / 2, 2);
        const sideArea = Math.PI * diameter * (layers * 1.5); // ~1.5 inches per layer
        const betweenLayers = topArea * (layers - 1);
        const totalSqIn = topArea + sideArea + betweenLayers;
        // ~0.02 cups per sq inch for medium
        const factor = style === 'thin' ? 0.014 : style === 'medium' ? 0.02 : 0.028;
        cups = totalSqIn * factor;
      }

      // Ingredient ratios per cup of frosting
      let butterOz = 0, sugarOz = 0, liquidTbsp = 0, label2 = 'Powdered Sugar';
      if (recipe === 'buttercream') {
        butterOz = cups * 2; sugarOz = cups * 4; liquidTbsp = cups * 1;
      } else if (recipe === 'cream') {
        butterOz = cups * 1.5; sugarOz = cups * 3; liquidTbsp = cups * 0.5;
        // Add cream cheese
      } else if (recipe === 'swiss') {
        butterOz = cups * 3; sugarOz = cups * 1.5; liquidTbsp = cups * 0; // egg whites
        label2 = 'Sugar (granulated)';
      } else { // ganache
        butterOz = cups * 0; sugarOz = cups * 4; liquidTbsp = cups * 2;
        label2 = 'Chocolate (oz)';
      }

      const serves = type === 'cupcakes' ? Math.round(size) : type === 'sheet' ? 24 : (type === 'layer3' ? 16 : 12);

      document.getElementById('fro-result')!.textContent = cups.toFixed(1) + ' cups';
      document.getElementById('fro-butter')!.textContent = (recipe === 'ganache' ? 'N/A (use cream)' : (butterOz * 28.35).toFixed(0) + ' g / ' + butterOz.toFixed(1) + ' oz');
      document.getElementById('fro-sugar')!.textContent = (sugarOz * 28.35).toFixed(0) + ' g / ' + sugarOz.toFixed(1) + ' oz';
      document.getElementById('fro-liquid')!.textContent = liquidTbsp.toFixed(1) + ' tbsp';
      document.getElementById('fro-serves')!.textContent = serves + ' servings';

      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.fro-in').forEach(el => { el.addEventListener('input', calcFRO); el.addEventListener('change', calcFRO); });
      calcFRO();
    }, 50);
  </script>
</CalculatorLayout>
