---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "UV Index Calculator - Sun Exposure & Protection";
const description = "Estimate UV index based on location and conditions, with sunburn time and SPF recommendations.";
const relatedCalcs = [
  { name: "Sunrise & Sunset", url: "/sunrise-sunset-calculator", description: "Sunrise." },
  { name: "Heat Index", url: "/heat-index-calculator", description: "Heat index." },
  { name: "Air Quality Index", url: "/air-quality-index-calculator", description: "AQI." },
  { name: "Dew Point", url: "/dew-point-calculator", description: "Dew point." },
  { name: "Temperature Converter", url: "/temperature-converter", description: "Temperature." },
  { name: "Calories Burned", url: "/calories-burned-calculator", description: "Calories." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="UV Index Calculator" keywords="UV index calculator, sun exposure, sunburn time, SPF recommendation, UV radiation, skin protection" breadcrumbs={[{ name: "UV Index", url: "/uv-index-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">UV Index Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Estimate UV exposure and get sun protection recommendations.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="block text-xs font-medium text-text mb-1">UV Index (0-15)</label>
            <input type="number" id="uv-idx" class="uv-in w-full px-4 py-3 border border-border rounded-xl text-2xl font-bold" value="6" min="0" max="15" step="1">
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Skin Type</label>
            <select id="uv-skin" class="uv-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
              <option value="1">I - Very Fair</option>
              <option value="2" selected>II - Fair</option>
              <option value="3">III - Medium</option>
              <option value="4">IV - Olive</option>
              <option value="5">V - Brown</option>
              <option value="6">VI - Dark</option>
            </select>
          </div>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">SPF Applied</label>
          <select id="uv-spf" class="uv-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
            <option value="0">None</option>
            <option value="15">SPF 15</option>
            <option value="30" selected>SPF 30</option>
            <option value="50">SPF 50</option>
            <option value="70">SPF 70</option>
            <option value="100">SPF 100</option>
          </select>
        </div>
        <div class="p-6 rounded-2xl text-white text-center" id="uv-display">
          <div class="text-sm uppercase tracking-wide mb-1 opacity-80">UV Exposure Level</div>
          <div class="text-5xl font-extrabold font-mono" id="uv-result">6</div>
          <div class="text-sm mt-1 opacity-80 font-bold" id="uv-cat">High</div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Sunburn Time (no SPF)</div><div class="text-xl font-bold font-mono" id="uv-burn">0 min</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Protected Time</div><div class="text-xl font-bold font-mono" id="uv-prot">0 min</div></div>
        </div>
        <div class="p-4 rounded-xl text-center" id="uv-rec-box">
          <div class="font-bold text-sm" id="uv-rec">-</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-2">UV Index Scale (WHO)</h3>
          <div class="text-xs space-y-1">
            <div class="flex gap-2"><span class="w-3 h-3 rounded flex-shrink-0 mt-0.5" style="background:#4eb400"></span>0-2: Low — No protection needed</div>
            <div class="flex gap-2"><span class="w-3 h-3 rounded flex-shrink-0 mt-0.5" style="background:#f7e400"></span>3-5: Moderate — Wear hat, sunscreen</div>
            <div class="flex gap-2"><span class="w-3 h-3 rounded flex-shrink-0 mt-0.5" style="background:#f85900"></span>6-7: High — Reduce sun exposure 10am-4pm</div>
            <div class="flex gap-2"><span class="w-3 h-3 rounded flex-shrink-0 mt-0.5" style="background:#d8001d"></span>8-10: Very High — Extra protection essential</div>
            <div class="flex gap-2"><span class="w-3 h-3 rounded flex-shrink-0 mt-0.5" style="background:#6b49c8"></span>11+: Extreme — Avoid midday sun</div>
          </div>
        </div>
      </div>
      <ShareButton calculatorId="uv-index" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    const SKIN_MED: Record<string, number> = { '1': 67, '2': 100, '3': 200, '4': 300, '5': 450, '6': 600 };
    function calcUV() {
      const uvi = parseFloat((document.getElementById('uv-idx') as HTMLInputElement).value) || 0;
      const skin = (document.getElementById('uv-skin') as HTMLSelectElement).value;
      const spf = parseInt((document.getElementById('uv-spf') as HTMLSelectElement).value) || 0;
      const med = SKIN_MED[skin] || 200;
      const burnTime = uvi > 0 ? med / (uvi * 2.5) : 999;
      const protTime = spf > 0 ? burnTime * spf : burnTime;
      document.getElementById('uv-result')!.textContent = String(uvi);
      document.getElementById('uv-burn')!.textContent = burnTime > 300 ? '300+ min' : Math.round(burnTime) + ' min';
      document.getElementById('uv-prot')!.textContent = protTime > 600 ? '10+ hrs' : Math.round(protTime) + ' min';
      let cat: string, color: string, rec: string, boxColor: string;
      if (uvi <= 2) { cat = 'Low'; color = '#4eb400'; rec = 'Minimal protection needed. Sunglasses on bright days.'; boxColor = 'bg-green-50 text-green-800'; }
      else if (uvi <= 5) { cat = 'Moderate'; color = '#f7e400'; rec = 'Wear sunscreen SPF 30+, hat, and sunglasses.'; boxColor = 'bg-yellow-50 text-yellow-800'; }
      else if (uvi <= 7) { cat = 'High'; color = '#f85900'; rec = 'Reduce sun exposure 10am-4pm. SPF 30+ required.'; boxColor = 'bg-orange-50 text-orange-800'; }
      else if (uvi <= 10) { cat = 'Very High'; color = '#d8001d'; rec = 'Extra protection essential. Seek shade, SPF 50+ recommended.'; boxColor = 'bg-red-50 text-red-800'; }
      else { cat = 'Extreme'; color = '#6b49c8'; rec = 'Avoid sun exposure. Stay indoors or in full shade.'; boxColor = 'bg-purple-50 text-purple-800'; }
      document.getElementById('uv-cat')!.textContent = cat;
      document.getElementById('uv-display')!.style.background = color;
      document.getElementById('uv-display')!.style.color = uvi <= 5 ? '#000' : '#fff';
      document.getElementById('uv-rec')!.textContent = rec;
      document.getElementById('uv-rec-box')!.className = `p-4 rounded-xl text-center ${boxColor}`;
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.uv-in').forEach(el => { el.addEventListener('input', calcUV); el.addEventListener('change', calcUV); });
      calcUV();
    }, 50);
  </script>
</CalculatorLayout>
