---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Pallet Calculator";
const description = "Calculate how many boxes fit per pallet layer, total layers, pallet utilization percentage, and weight distribution for optimal pallet loading.";
const relatedCalcs = [
  { name: "Inventory Turnover", url: "/inventory-turnover-calculator", description: "Inventory efficiency." },
  { name: "Break Even", url: "/break-even-calculator", description: "Find break-even point." },
  { name: "Area", url: "/area-calculator", description: "Calculate area." },
  { name: "Moving Cost", url: "/moving-cost-calculator", description: "Estimate moving expenses." },
  { name: "Profit Margin", url: "/profit-margin-calculator", description: "Calculate profit margins." },
  { name: "ROI", url: "/roi-calculator", description: "Return on investment." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Pallet Calculator" keywords="pallet calculator, boxes per pallet, pallet loading, pallet utilization, layer count, weight distribution" breadcrumbs={[{ name: "Pallet", url: "/pallet-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Pallet Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Determine how many boxes fit on a pallet, total layers, utilization rate, and weight distribution.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="text-sm font-semibold text-text uppercase tracking-wide">Pallet Dimensions</div>
        <div class="grid grid-cols-3 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Pallet L (in)</label><input type="number" id="pa-pl" class="pa-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="1" step="1"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Pallet W (in)</label><input type="number" id="pa-pw" class="pa-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="1" step="1"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Max Height (in)</label><input type="number" id="pa-ph" class="pa-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="1" step="1"></div>
        </div>
        <div class="text-sm font-semibold text-text uppercase tracking-wide">Box Dimensions</div>
        <div class="grid grid-cols-3 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Box L (in)</label><input type="number" id="pa-bl" class="pa-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="1" step="0.5"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Box W (in)</label><input type="number" id="pa-bw" class="pa-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="1" step="0.5"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Box H (in)</label><input type="number" id="pa-bh" class="pa-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="1" step="0.5"></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Box Weight (lbs)</label><input type="number" id="pa-bwt" class="pa-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="0.1" step="0.1"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Max Pallet Weight (lbs)</label><input type="number" id="pa-maxwt" class="pa-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="1" step="1"></div>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Total Boxes on Pallet</div>
          <div class="text-5xl font-extrabold font-mono" id="pa-result">--</div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Boxes per Layer</div><div class="text-xl font-bold font-mono" id="pa-layer">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Total Layers</div><div class="text-xl font-bold font-mono" id="pa-layers">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Utilization</div><div class="text-xl font-bold font-mono" id="pa-util">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Total Weight</div><div class="text-xl font-bold font-mono" id="pa-totalwt">--</div></div>
        </div>
      </div>
      <ShareButton calculatorId="pallet" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcPA() {
      const pl = parseFloat((document.getElementById('pa-pl') as HTMLInputElement).value) || 0;
      const pw = parseFloat((document.getElementById('pa-pw') as HTMLInputElement).value) || 0;
      const ph = parseFloat((document.getElementById('pa-ph') as HTMLInputElement).value) || 0;
      const bl = parseFloat((document.getElementById('pa-bl') as HTMLInputElement).value) || 0;
      const bw = parseFloat((document.getElementById('pa-bw') as HTMLInputElement).value) || 0;
      const bh = parseFloat((document.getElementById('pa-bh') as HTMLInputElement).value) || 0;
      const bwt = parseFloat((document.getElementById('pa-bwt') as HTMLInputElement).value) || 0;
      const maxwt = parseFloat((document.getElementById('pa-maxwt') as HTMLInputElement).value) || 0;

      if (bl <= 0 || bw <= 0 || bh <= 0) return;

      const orient1 = Math.floor(pl / bl) * Math.floor(pw / bw);
      const orient2 = Math.floor(pl / bw) * Math.floor(pw / bl);
      const boxesPerLayer = Math.max(orient1, orient2);
      const totalLayers = Math.floor(ph / bh);
      let totalBoxes = boxesPerLayer * totalLayers;

      if (maxwt > 0 && bwt > 0) {
        const maxByWeight = Math.floor(maxwt / bwt);
        totalBoxes = Math.min(totalBoxes, maxByWeight);
      }

      const palletVolume = pl * pw * ph;
      const usedVolume = totalBoxes * bl * bw * bh;
      const utilization = palletVolume > 0 ? (usedVolume / palletVolume) * 100 : 0;
      const totalWeight = totalBoxes * bwt;

      document.getElementById('pa-result')!.textContent = totalBoxes.toString();
      document.getElementById('pa-layer')!.textContent = boxesPerLayer.toString();
      document.getElementById('pa-layers')!.textContent = totalLayers.toString();
      document.getElementById('pa-util')!.textContent = utilization.toFixed(1) + '%';
      document.getElementById('pa-totalwt')!.textContent = totalWeight.toLocaleString(undefined, {maximumFractionDigits: 0}) + ' lbs';
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      (document.getElementById('pa-pl') as HTMLInputElement).value = '48';
      (document.getElementById('pa-pw') as HTMLInputElement).value = '40';
      (document.getElementById('pa-ph') as HTMLInputElement).value = '60';
      (document.getElementById('pa-bl') as HTMLInputElement).value = '12';
      (document.getElementById('pa-bw') as HTMLInputElement).value = '10';
      (document.getElementById('pa-bh') as HTMLInputElement).value = '8';
      (document.getElementById('pa-bwt') as HTMLInputElement).value = '15';
      (document.getElementById('pa-maxwt') as HTMLInputElement).value = '2500';
      document.querySelectorAll('.pa-in').forEach(el => { el.addEventListener('input', calcPA); el.addEventListener('change', calcPA); });
      calcPA();
    }, 50);
  </script>
</CalculatorLayout>
