---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Print Resolution Calculator - DPI/PPI & Minimum Resolution";
const description = "Calculate DPI, PPI, minimum image resolution for print sizes, and maximum print size from image dimensions. Essential for prepress.";
const relatedCalcs = [
  { name: "Poster Size Calculator", url: "/poster-size-calculator", description: "Poster dimensions and DPI." },
  { name: "Bleed Margin Calculator", url: "/bleed-margin-calculator", description: "Print bleed calculations." },
  { name: "Ink Coverage Calculator", url: "/ink-coverage-calculator", description: "Ink usage estimator." },
  { name: "Print Cost Calculator", url: "/print-cost-calculator", description: "Print job cost estimator." },
  { name: "Font Size Calculator", url: "/font-size-calculator", description: "Font size converter." },
  { name: "Color Separation Calculator", url: "/color-separation-calculator", description: "CMYK color separation." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Print Resolution Calculator" keywords="DPI calculator, PPI, print resolution, minimum resolution, image size, print size, pixels per inch" breadcrumbs={[{ name: "Print Resolution Calculator", url: "/print-resolution-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Print Resolution Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate required image resolution for print, find maximum print size from image dimensions, and convert between DPI and pixel dimensions.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div><label class="block text-xs font-medium text-text mb-1">Calculation Mode</label>
          <select id="prr-mode" class="prr-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="size2px">Print Size to Pixels (min resolution)</option>
            <option value="px2size">Pixels to Max Print Size</option>
          </select>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Width</label><input type="number" id="prr-width" class="prr-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="0" step="0.5"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Height</label><input type="number" id="prr-height" class="prr-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="0" step="0.5"></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Width/Height Unit</label>
            <select id="prr-unit" class="prr-in w-full px-4 py-3 border border-border rounded-xl text-lg">
              <option value="in">Inches</option>
              <option value="cm">Centimeters</option>
              <option value="mm">Millimeters</option>
              <option value="px">Pixels</option>
            </select>
          </div>
          <div><label class="block text-xs font-medium text-text mb-1">Target DPI</label><input type="number" id="prr-dpi" class="prr-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="1" step="1"></div>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1" id="prr-label">Result</div>
          <div class="text-3xl font-extrabold font-mono" id="prr-result">--</div>
          <div class="text-sm text-blue-200 mt-1" id="prr-subtitle"></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Megapixels</div><div class="text-xl font-bold" id="prr-mp">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">File Size (RGB 8-bit)</div><div class="text-xl font-bold" id="prr-filesize">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">File Size (CMYK 8-bit)</div><div class="text-xl font-bold" id="prr-cmyk">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Aspect Ratio</div><div class="text-xl font-bold" id="prr-ratio">--</div></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-2">DPI Quality Guide</h3>
          <div class="font-mono text-sm space-y-1" id="prr-steps"></div>
        </div>
      </div>
      <ShareButton calculatorId="print-resolution" />
      <FeedbackWidget />
    </div>
    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">Understanding Print Resolution</h2>
      <div class="bg-surface-alt rounded-xl p-4 my-4 font-mono text-sm space-y-1">
        <p>Pixels = Print Size (in) x DPI</p>
        <p>Print Size (in) = Pixels / DPI</p>
        <p>72 DPI: Screen display only</p>
        <p>150 DPI: Minimum for print (large format/distance)</p>
        <p>300 DPI: Standard high-quality print</p>
        <p>600 DPI: Professional/fine art reproduction</p>
      </div>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcPrr() {
      const mode = (document.getElementById('prr-mode') as HTMLSelectElement).value;
      const w = parseFloat((document.getElementById('prr-width') as HTMLInputElement).value) || 0;
      const h = parseFloat((document.getElementById('prr-height') as HTMLInputElement).value) || 0;
      const unit = (document.getElementById('prr-unit') as HTMLSelectElement).value;
      const dpi = parseFloat((document.getElementById('prr-dpi') as HTMLInputElement).value) || 300;
      let widthIn = w, heightIn = h;
      let pixW = 0, pixH = 0;
      if (mode === 'size2px') {
        if (unit === 'cm') { widthIn = w / 2.54; heightIn = h / 2.54; }
        else if (unit === 'mm') { widthIn = w / 25.4; heightIn = h / 25.4; }
        else if (unit === 'px') { widthIn = w / dpi; heightIn = h / dpi; }
        pixW = Math.ceil(widthIn * dpi);
        pixH = Math.ceil(heightIn * dpi);
        document.getElementById('prr-label')!.textContent = 'Required Image Resolution';
        document.getElementById('prr-result')!.textContent = pixW + ' x ' + pixH + ' px';
        document.getElementById('prr-subtitle')!.textContent = 'at ' + dpi + ' DPI for ' + widthIn.toFixed(2) + ' x ' + heightIn.toFixed(2) + ' in print';
      } else {
        if (unit === 'px') { pixW = w; pixH = h; }
        else if (unit === 'in') { pixW = w * dpi; pixH = h * dpi; }
        else if (unit === 'cm') { pixW = (w / 2.54) * dpi; pixH = (h / 2.54) * dpi; }
        else if (unit === 'mm') { pixW = (w / 25.4) * dpi; pixH = (h / 25.4) * dpi; }
        widthIn = pixW / dpi;
        heightIn = pixH / dpi;
        document.getElementById('prr-label')!.textContent = 'Maximum Print Size at ' + dpi + ' DPI';
        document.getElementById('prr-result')!.textContent = widthIn.toFixed(2) + ' x ' + heightIn.toFixed(2) + ' in';
        document.getElementById('prr-subtitle')!.textContent = (widthIn * 2.54).toFixed(1) + ' x ' + (heightIn * 2.54).toFixed(1) + ' cm';
      }
      const mp = (pixW * pixH) / 1000000;
      const rgbBytes = pixW * pixH * 3;
      const cmykBytes = pixW * pixH * 4;
      const rgbMB = rgbBytes / (1024 * 1024);
      const cmykMB = cmykBytes / (1024 * 1024);
      function gcd(a: number, b: number): number { return b === 0 ? a : gcd(b, a % b); }
      const g = pixW > 0 && pixH > 0 ? gcd(Math.round(pixW), Math.round(pixH)) : 1;
      const steps: string[] = [];
      const dpiLevels = [72, 150, 200, 300, 600];
      for (const d of dpiLevels) {
        if (mode === 'size2px') {
          const pw = Math.ceil(widthIn * d);
          const ph = Math.ceil(heightIn * d);
          steps.push(d + ' DPI: ' + pw + ' x ' + ph + ' px (' + ((pw*ph)/1000000).toFixed(1) + ' MP)');
        } else {
          const mw = pixW / d;
          const mh = pixH / d;
          steps.push(d + ' DPI: ' + mw.toFixed(2) + ' x ' + mh.toFixed(2) + ' in');
        }
      }
      document.getElementById('prr-mp')!.textContent = mp.toFixed(1) + ' MP';
      document.getElementById('prr-filesize')!.textContent = rgbMB > 1024 ? (rgbMB / 1024).toFixed(1) + ' GB' : rgbMB.toFixed(0) + ' MB';
      document.getElementById('prr-cmyk')!.textContent = cmykMB > 1024 ? (cmykMB / 1024).toFixed(1) + ' GB' : cmykMB.toFixed(0) + ' MB';
      document.getElementById('prr-ratio')!.textContent = g > 0 ? Math.round(pixW/g) + ':' + Math.round(pixH/g) : '--';
      document.getElementById('prr-steps')!.innerHTML = steps.map(s => '<div>' + s + '</div>').join('');
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      (document.getElementById('prr-width') as HTMLInputElement).value = '8.5';
      (document.getElementById('prr-height') as HTMLInputElement).value = '11';
      (document.getElementById('prr-dpi') as HTMLInputElement).value = '300';
      document.querySelectorAll('.prr-in').forEach(el => { el.addEventListener('input', calcPrr); el.addEventListener('change', calcPrr); });
      calcPrr();
    }, 50);
  </script>
</CalculatorLayout>
