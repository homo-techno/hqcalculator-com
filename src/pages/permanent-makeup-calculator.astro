---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Permanent Makeup Calculator - Session Cost & Touch-Up Timeline";
const description = "Calculate permanent makeup (PMU) session costs, number of sessions needed, and touch-up timeline for brows, lips, eyeliner, and more.";
const relatedCalcs = [
  { name: "Botox Unit Calculator", url: "/botox-unit-calculator", description: "Botox units by area." },
  { name: "Dermal Filler Calculator", url: "/dermal-filler-calculator", description: "Filler volume by area." },
  { name: "Eyelash Extension Calculator", url: "/eyelash-extension-calculator", description: "Lash extension selection." },
  { name: "Facial Proportion Calculator", url: "/facial-proportion-calculator", description: "Golden ratio measurements." },
  { name: "Beauty Budget Calculator", url: "/beauty-budget-calculator", description: "Beauty spending breakdown." },
  { name: "Skin Type Calculator", url: "/skin-type-calculator", description: "Determine your skin type." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Permanent Makeup Calculator" keywords="permanent makeup, PMU, microblading, lip blush, permanent eyeliner, powder brows, cosmetic tattoo, touch-up" breadcrumbs={[{ name: "Permanent Makeup", url: "/permanent-makeup-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Permanent Makeup Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Estimate PMU session costs and plan your touch-up schedule.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div>
          <label class="block text-xs font-medium text-text mb-2">Select Procedures</label>
          <div class="space-y-2">
            <label class="flex items-center gap-2"><input type="checkbox" id="pmk-microblade" class="pmk-in" checked><span class="text-sm">Microblading Brows ($300-800)</span></label>
            <label class="flex items-center gap-2"><input type="checkbox" id="pmk-powder" class="pmk-in"><span class="text-sm">Powder / Ombre Brows ($400-900)</span></label>
            <label class="flex items-center gap-2"><input type="checkbox" id="pmk-combo" class="pmk-in"><span class="text-sm">Combo Brows (Micro + Powder) ($500-1000)</span></label>
            <label class="flex items-center gap-2"><input type="checkbox" id="pmk-lipblush" class="pmk-in"><span class="text-sm">Lip Blush ($400-800)</span></label>
            <label class="flex items-center gap-2"><input type="checkbox" id="pmk-fulllip" class="pmk-in"><span class="text-sm">Full Lip Color ($500-1000)</span></label>
            <label class="flex items-center gap-2"><input type="checkbox" id="pmk-eyeliner-top" class="pmk-in"><span class="text-sm">Eyeliner - Top ($300-600)</span></label>
            <label class="flex items-center gap-2"><input type="checkbox" id="pmk-eyeliner-bot" class="pmk-in"><span class="text-sm">Eyeliner - Bottom ($250-500)</span></label>
            <label class="flex items-center gap-2"><input type="checkbox" id="pmk-lashline" class="pmk-in"><span class="text-sm">Lash Line Enhancement ($250-450)</span></label>
            <label class="flex items-center gap-2"><input type="checkbox" id="pmk-beauty-mark" class="pmk-in"><span class="text-sm">Beauty Mark ($100-200)</span></label>
            <label class="flex items-center gap-2"><input type="checkbox" id="pmk-scalp" class="pmk-in"><span class="text-sm">Scalp Micropigmentation ($400-1000)</span></label>
          </div>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Provider Experience Level</label>
          <select id="pmk-level" class="pmk-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="0.7">Apprentice / New artist</option>
            <option value="1.0" selected>Experienced artist</option>
            <option value="1.4">Master / Celebrity artist</option>
          </select>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Location Cost Factor</label>
          <select id="pmk-location" class="pmk-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="0.7">Rural / Low cost area</option>
            <option value="1.0" selected>Average metro area</option>
            <option value="1.3">Major city (NYC, LA, etc.)</option>
            <option value="1.5">Luxury / Upscale market</option>
          </select>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Skin Type (Affects Retention)</label>
          <select id="pmk-skin" class="pmk-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="1.2">Dry skin (pigment holds well)</option>
            <option value="1.0" selected>Normal / Combination</option>
            <option value="0.8">Oily skin (fades faster)</option>
          </select>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Total Initial Investment</div>
          <div class="text-5xl font-extrabold font-mono" id="pmk-total">$0</div>
          <div class="text-sm text-blue-200 mt-1">initial session + first touch-up</div>
        </div>
        <div class="grid grid-cols-2 gap-4">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Initial Session</div><div class="text-xl font-bold" id="pmk-initial">$0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Touch-Up (6-8 wk)</div><div class="text-xl font-bold" id="pmk-touchup">$0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Annual Refresh</div><div class="text-xl font-bold" id="pmk-refresh">$0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Procedures Selected</div><div class="text-xl font-bold" id="pmk-count">0</div></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-3">Procedure Details</h3>
          <div class="text-sm space-y-1" id="pmk-details"></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-3">Timeline</h3>
          <div class="text-sm space-y-1" id="pmk-timeline"></div>
        </div>
      </div>
      <ShareButton calculatorId="permanent-makeup" />
      <FeedbackWidget />
    </div>
    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">Permanent Makeup Guide</h2>
      <p>Permanent makeup (cosmetic tattooing) uses specialized pigments deposited into the skin to create lasting enhancement. Microblading creates hair-like strokes for natural brows, while powder brows give a filled-in look. Lip blush adds color and definition. Permanent eyeliner eliminates daily application. Most procedures require an initial session plus a touch-up at 6-8 weeks. Results last 1-3 years depending on skin type, sun exposure, and aftercare. Annual refreshes maintain color vibrancy. Oily skin tends to fade faster than dry skin.</p>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcPMK() {
      const levelMult = parseFloat((document.getElementById('pmk-level') as HTMLSelectElement).value);
      const locationMult = parseFloat((document.getElementById('pmk-location') as HTMLSelectElement).value);
      const skinRetention = parseFloat((document.getElementById('pmk-skin') as HTMLSelectElement).value);

      const procedures: {id:string, name:string, baseCost:number, touchupPct:number, durationMonths:number, sessionTime:string}[] = [
        {id:'pmk-microblade', name:'Microblading Brows', baseCost:500, touchupPct:0.4, durationMonths:14, sessionTime:'2-3 hours'},
        {id:'pmk-powder', name:'Powder/Ombre Brows', baseCost:600, touchupPct:0.4, durationMonths:18, sessionTime:'2-3 hours'},
        {id:'pmk-combo', name:'Combo Brows', baseCost:700, touchupPct:0.4, durationMonths:16, sessionTime:'2.5-3.5 hours'},
        {id:'pmk-lipblush', name:'Lip Blush', baseCost:550, touchupPct:0.5, durationMonths:18, sessionTime:'2-3 hours'},
        {id:'pmk-fulllip', name:'Full Lip Color', baseCost:700, touchupPct:0.5, durationMonths:24, sessionTime:'2.5-3.5 hours'},
        {id:'pmk-eyeliner-top', name:'Eyeliner (Top)', baseCost:400, touchupPct:0.35, durationMonths:24, sessionTime:'1.5-2 hours'},
        {id:'pmk-eyeliner-bot', name:'Eyeliner (Bottom)', baseCost:350, touchupPct:0.35, durationMonths:24, sessionTime:'1-1.5 hours'},
        {id:'pmk-lashline', name:'Lash Line Enhancement', baseCost:325, touchupPct:0.35, durationMonths:24, sessionTime:'1-1.5 hours'},
        {id:'pmk-beauty-mark', name:'Beauty Mark', baseCost:150, touchupPct:0.5, durationMonths:24, sessionTime:'30 min'},
        {id:'pmk-scalp', name:'Scalp Micropigmentation', baseCost:700, touchupPct:0.3, durationMonths:36, sessionTime:'3-5 hours'},
      ];

      let totalInitial = 0;
      let totalTouchup = 0;
      let totalRefresh = 0;
      let count = 0;
      const details: string[] = [];
      const timeline: string[] = [];

      procedures.forEach(p => {
        if ((document.getElementById(p.id) as HTMLInputElement).checked) {
          const cost = Math.round(p.baseCost * levelMult * locationMult);
          const touchup = Math.round(cost * p.touchupPct);
          const adjustedDuration = Math.round(p.durationMonths * skinRetention);
          const annualRefresh = Math.round(cost * 0.35);

          totalInitial += cost;
          totalTouchup += touchup;
          totalRefresh += annualRefresh;
          count++;

          details.push('<div class="flex justify-between"><span>' + p.name + '</span><span class="font-bold">$' + cost + ' (session: ' + p.sessionTime + ')</span></div>');
          timeline.push('<div class="flex justify-between"><span>' + p.name + '</span><span class="font-bold">Lasts ~' + adjustedDuration + ' months, refresh $' + annualRefresh + '</span></div>');
        }
      });

      const totalInvestment = totalInitial + totalTouchup;

      document.getElementById('pmk-total')!.textContent = '$' + totalInvestment.toLocaleString();
      document.getElementById('pmk-initial')!.textContent = '$' + totalInitial.toLocaleString();
      document.getElementById('pmk-touchup')!.textContent = '$' + totalTouchup.toLocaleString();
      document.getElementById('pmk-refresh')!.textContent = '$' + totalRefresh.toLocaleString() + '/yr';
      document.getElementById('pmk-count')!.textContent = count.toString();
      document.getElementById('pmk-details')!.innerHTML = details.length > 0 ? details.join('') : '<p class="text-text-muted">Select procedures above.</p>';
      document.getElementById('pmk-timeline')!.innerHTML = timeline.length > 0 ? timeline.join('') : '<p class="text-text-muted">Select procedures above.</p>';
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.pmk-in').forEach(el => { el.addEventListener('input', calcPMK); el.addEventListener('change', calcPMK); });
      calcPMK();
    }, 50);
  </script>
</CalculatorLayout>
