---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Linear Actuator Calculator - Force, Stroke & Speed Selection";
const description = "Calculate linear actuator force, stroke length, speed, and power requirements. Select the right electric linear actuator for your application.";
const relatedCalcs = [
  { name: "Ball Screw Calculator", url: "/ball-screw-calculator", description: "Calculate ball screw lead, speed, and thrust." },
  { name: "Pneumatic Cylinder Calculator", url: "/pneumatic-cylinder-calculator", description: "Calculate pneumatic cylinder force and air usage." },
  { name: "Servo Motor Calculator", url: "/servo-motor-calculator", description: "Size servo motors for actuator drive systems." },
  { name: "Motion Profile Calculator", url: "/motion-profile-calculator", description: "Design trapezoidal motion profiles." },
  { name: "Stepper Motor Calculator", url: "/stepper-motor-calculator", description: "Calculate stepper motor torque and speed." },
  { name: "Gearbox Ratio Calculator", url: "/gearbox-ratio-calculator", description: "Select gearbox ratio for motor matching." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Linear Actuator Calculator" keywords="linear actuator calculator, actuator force, stroke length, actuator speed, electric actuator, linear motion, actuator selection" breadcrumbs={[{ name: "Linear Actuator Calculator", url: "/linear-actuator-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Linear Actuator Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate force, speed, and power for electric linear actuators. Accounts for load angle, friction, and acceleration forces.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-6">
        <div>
          <label class="block text-sm font-semibold text-text mb-2">Load Mass (kg)</label>
          <input type="number" id="la2-mass" class="la2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="50" min="0.1" step="1">
        </div>
        <div>
          <label class="block text-sm font-semibold text-text mb-2">Mounting Angle from Horizontal (degrees)</label>
          <input type="number" id="la2-angle" class="la2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="90" min="0" max="90" step="1">
        </div>
        <div>
          <label class="block text-sm font-semibold text-text mb-2">Stroke Length (mm)</label>
          <input type="number" id="la2-stroke" class="la2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="200" min="10" step="10">
        </div>
        <div>
          <label class="block text-sm font-semibold text-text mb-2">Desired Speed (mm/s)</label>
          <input type="number" id="la2-speed" class="la2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="50" min="1" step="5">
        </div>
        <div>
          <label class="block text-sm font-semibold text-text mb-2">Screw Lead (mm/rev)</label>
          <input type="number" id="la2-lead" class="la2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="5" min="1" step="1">
        </div>
        <div>
          <label class="block text-sm font-semibold text-text mb-2">Screw Efficiency (%)</label>
          <input type="number" id="la2-eff" class="la2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="90" min="10" max="100" step="5">
        </div>
        <div>
          <label class="block text-sm font-semibold text-text mb-2">Friction Coefficient</label>
          <input type="number" id="la2-friction" class="la2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="0.1" min="0" step="0.01">
        </div>

        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm font-medium opacity-80 mb-1">Required Actuator Force</div>
          <div id="la2-result-force" class="text-3xl sm:text-4xl font-extrabold">--</div>
          <div class="text-sm opacity-80 mt-1">N (Newtons)</div>
        </div>

        <div class="grid grid-cols-2 gap-4">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-secondary mb-1">Gravity Component</div>
            <div id="la2-gravity" class="text-lg font-bold text-text">--</div>
            <div class="text-xs text-text-secondary">N</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-secondary mb-1">Friction Component</div>
            <div id="la2-fric-force" class="text-lg font-bold text-text">--</div>
            <div class="text-xs text-text-secondary">N</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-secondary mb-1">Motor Torque</div>
            <div id="la2-torque" class="text-lg font-bold text-text">--</div>
            <div class="text-xs text-text-secondary">N*m</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-secondary mb-1">Motor Power</div>
            <div id="la2-power" class="text-lg font-bold text-text">--</div>
            <div class="text-xs text-text-secondary">W</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-secondary mb-1">Motor Speed</div>
            <div id="la2-rpm" class="text-lg font-bold text-text">--</div>
            <div class="text-xs text-text-secondary">RPM</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-secondary mb-1">Stroke Time</div>
            <div id="la2-time" class="text-lg font-bold text-text">--</div>
            <div class="text-xs text-text-secondary">seconds</div>
          </div>
        </div>

        <ShareButton />
        <FeedbackWidget />
      </div>
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    function calcLA2() {
      const mass = parseFloat((document.getElementById('la2-mass') as HTMLInputElement).value) || 50;
      const angle = parseFloat((document.getElementById('la2-angle') as HTMLInputElement).value) || 90;
      const stroke = parseFloat((document.getElementById('la2-stroke') as HTMLInputElement).value) || 200;
      const speed = parseFloat((document.getElementById('la2-speed') as HTMLInputElement).value) || 50;
      const lead = parseFloat((document.getElementById('la2-lead') as HTMLInputElement).value) || 5;
      const eff = parseFloat((document.getElementById('la2-eff') as HTMLInputElement).value) / 100 || 0.9;
      const friction = parseFloat((document.getElementById('la2-friction') as HTMLInputElement).value) || 0.1;

      const g = 9.81;
      const angleRad = angle * Math.PI / 180;
      const gravityForce = mass * g * Math.sin(angleRad);
      const normalForce = mass * g * Math.cos(angleRad);
      const frictionForce = friction * normalForce;
      const totalForce = gravityForce + frictionForce;

      const motorRPM = (speed / lead) * 60;
      const motorTorque = (totalForce * lead / 1000) / (2 * Math.PI * eff);
      const motorPower = motorTorque * motorRPM * 2 * Math.PI / 60;
      const strokeTime = stroke / speed;

      document.getElementById('la2-result-force')!.textContent = totalForce.toFixed(1);
      document.getElementById('la2-gravity')!.textContent = gravityForce.toFixed(1);
      document.getElementById('la2-fric-force')!.textContent = frictionForce.toFixed(1);
      document.getElementById('la2-torque')!.textContent = motorTorque.toFixed(4);
      document.getElementById('la2-power')!.textContent = motorPower.toFixed(1);
      document.getElementById('la2-rpm')!.textContent = motorRPM.toFixed(0);
      document.getElementById('la2-time')!.textContent = strokeTime.toFixed(2);
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.la2-in').forEach(el => { el.addEventListener('input', calcLA2); el.addEventListener('change', calcLA2); });
      calcLA2();
    }, 50);
  </script>
</CalculatorLayout>
