---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Tornado Scale Calculator - Enhanced Fujita (EF) Scale";
const description = "Determine Enhanced Fujita tornado scale rating from wind speed, with damage descriptions and probability estimates.";
const relatedCalcs = [
  { name: "Hurricane Category", url: "/hurricane-category-calculator", description: "Hurricane scale." },
  { name: "Wind Speed Converter", url: "/wind-speed-converter", description: "Wind speed units." },
  { name: "Wind Chill", url: "/wind-chill-calculator", description: "Wind chill factor." },
  { name: "Lightning Distance", url: "/lightning-distance-calculator", description: "Lightning distance." },
  { name: "Barometric Pressure", url: "/barometric-pressure-calculator", description: "Pressure readings." },
  { name: "Wind Power", url: "/wind-power-calculator", description: "Wind energy." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Tornado Scale Calculator" keywords="tornado scale, Enhanced Fujita scale, EF scale, tornado wind speed, tornado damage, tornado rating" breadcrumbs={[{ name: "Tornado Scale", url: "/tornado-scale-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Tornado Scale Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Determine the Enhanced Fujita (EF) scale rating from estimated wind speed with damage descriptions.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Wind Speed (mph)</label><input type="number" id="to-wind" class="to-in w-full px-4 py-3 border border-border rounded-xl text-2xl font-bold" value="130" min="0" step="5"></div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Wind Unit</label>
            <select id="to-unit" class="to-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
              <option value="mph">mph</option>
              <option value="kmh">km/h</option>
              <option value="ms">m/s</option>
              <option value="kn">knots</option>
            </select>
          </div>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Enhanced Fujita Rating</div>
          <div class="text-5xl font-extrabold font-mono" id="to-result">--</div>
        </div>
        <div class="p-4 rounded-xl text-center" id="to-dmg-box">
          <div class="font-bold text-sm" id="to-dmg">--</div>
          <div class="text-xs mt-1" id="to-desc">--</div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Wind (mph)</div><div class="text-xl font-bold font-mono" id="to-mph">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Wind (km/h)</div><div class="text-xl font-bold font-mono" id="to-kmh">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Wind (m/s)</div><div class="text-xl font-bold font-mono" id="to-ms">--</div></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">EF Range</div><div class="text-xl font-bold font-mono" id="to-range">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Annual US Frequency</div><div class="text-xl font-bold font-mono" id="to-freq">--</div></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-2">Enhanced Fujita Scale</h3>
          <div class="text-xs space-y-1">
            <div>EF0: 65-85 mph - Light damage</div>
            <div>EF1: 86-110 mph - Moderate damage</div>
            <div>EF2: 111-135 mph - Considerable damage</div>
            <div>EF3: 136-165 mph - Severe damage</div>
            <div>EF4: 166-200 mph - Devastating damage</div>
            <div>EF5: 200+ mph - Incredible destruction</div>
          </div>
        </div>
      </div>
      <ShareButton calculatorId="tornado-scale" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcTO() {
      const wind = parseFloat((document.getElementById('to-wind') as HTMLInputElement).value) || 130;
      const unit = (document.getElementById('to-unit') as HTMLSelectElement).value;
      let mph: number;
      if (unit === 'kmh') mph = wind * 0.621371;
      else if (unit === 'ms') mph = wind * 2.23694;
      else if (unit === 'kn') mph = wind * 1.15078;
      else mph = wind;
      const kmh = mph * 1.60934;
      const ms = mph * 0.44704;
      document.getElementById('to-mph')!.textContent = mph.toFixed(0);
      document.getElementById('to-kmh')!.textContent = kmh.toFixed(0);
      document.getElementById('to-ms')!.textContent = ms.toFixed(1);
      const scales = [
        { ef: 'EF0', min: 65, max: 85, dmg: 'Light Damage', desc: 'Peels surface off roofs, branches broken, shallow-rooted trees pushed over', range: '65-85 mph', freq: '~53% of tornadoes', color: 'bg-yellow-50 text-yellow-800' },
        { ef: 'EF1', min: 86, max: 110, dmg: 'Moderate Damage', desc: 'Roofs stripped, mobile homes overturned, moving autos pushed off road', range: '86-110 mph', freq: '~31% of tornadoes', color: 'bg-yellow-100 text-yellow-900' },
        { ef: 'EF2', min: 111, max: 135, dmg: 'Considerable Damage', desc: 'Roofs torn off houses, large trees snapped, light objects become missiles', range: '111-135 mph', freq: '~10% of tornadoes', color: 'bg-orange-50 text-orange-800' },
        { ef: 'EF3', min: 136, max: 165, dmg: 'Severe Damage', desc: 'Entire stories of houses destroyed, heavy cars thrown, trees debarked', range: '136-165 mph', freq: '~4% of tornadoes', color: 'bg-orange-100 text-orange-900' },
        { ef: 'EF4', min: 166, max: 200, dmg: 'Devastating Damage', desc: 'Well-built houses leveled, structures blown off foundations, cars thrown', range: '166-200 mph', freq: '~1.5% of tornadoes', color: 'bg-red-50 text-red-800' },
        { ef: 'EF5', min: 201, max: 9999, dmg: 'Incredible Destruction', desc: 'Strong frame houses swept away, steel-reinforced concrete badly damaged', range: '200+ mph', freq: '~0.1% of tornadoes', color: 'bg-red-100 text-red-900' },
      ];
      let s = scales[0];
      if (mph < 65) {
        document.getElementById('to-result')!.textContent = 'Below EF0';
        document.getElementById('to-dmg')!.textContent = 'Not tornado-strength winds';
        document.getElementById('to-desc')!.textContent = 'Wind speed below tornado threshold (65 mph)';
        document.getElementById('to-dmg-box')!.className = 'p-4 rounded-xl text-center bg-green-50 text-green-800';
        document.getElementById('to-range')!.textContent = '< 65 mph';
        document.getElementById('to-freq')!.textContent = 'N/A';
      } else {
        for (const sc of scales) { if (mph >= sc.min && mph <= sc.max) { s = sc; break; } }
        document.getElementById('to-result')!.textContent = s.ef;
        document.getElementById('to-dmg')!.textContent = s.dmg;
        document.getElementById('to-desc')!.textContent = s.desc;
        document.getElementById('to-dmg-box')!.className = 'p-4 rounded-xl text-center ' + s.color;
        document.getElementById('to-range')!.textContent = s.range;
        document.getElementById('to-freq')!.textContent = s.freq;
      }
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => { document.querySelectorAll('.to-in').forEach(el => { el.addEventListener('input', calcTO); el.addEventListener('change', calcTO); }); calcTO(); }, 50);
  </script>
</CalculatorLayout>
