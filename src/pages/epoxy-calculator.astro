---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Epoxy Calculator - Resin & Hardener Mix";
const description = "Calculate resin and hardener mix ratio by volume or weight, coverage area, and pot life at different temperatures.";
const relatedCalcs = [
  { name: "Concrete Calculator", url: "/concrete-calculator", description: "Concrete volume." },
  { name: "Paint Calculator", url: "/paint-calculator", description: "Paint coverage." },
  { name: "Area Calculator", url: "/area-calculator", description: "Calculate area." },
  { name: "Volume Calculator", url: "/volume-calculator", description: "Volume calculations." },
  { name: "Flooring Calculator", url: "/flooring-calculator", description: "Flooring materials." },
  { name: "Tile Calculator", url: "/tile-calculator", description: "Tile coverage." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Epoxy Calculator" keywords="epoxy calculator, resin hardener ratio, epoxy coverage, pot life, epoxy mixing" breadcrumbs={[{ name: "Epoxy Calculator", url: "/epoxy-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Epoxy Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate resin/hardener volumes, coverage area, and pot life for epoxy projects.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Surface Length (inches)</label><input type="number" id="ep-len" class="ep-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="48" min="0" step="1"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Surface Width (inches)</label><input type="number" id="ep-wid" class="ep-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="24" min="0" step="1"></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Desired Thickness (inches)</label><input type="number" id="ep-thk" class="ep-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="0.125" min="0.01" step="0.01"></div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Mix Ratio (Resin:Hardener)</label>
            <select id="ep-ratio" class="ep-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
              <option value="1" selected>1:1</option>
              <option value="2">2:1</option>
              <option value="3">3:1</option>
              <option value="4">4:1</option>
              <option value="5">5:1</option>
            </select>
          </div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Number of Coats</label><input type="number" id="ep-coats" class="ep-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="1" min="1" max="10" step="1"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Temperature (째F)</label><input type="number" id="ep-temp" class="ep-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="72" min="40" max="120" step="1"></div>
        </div>
        <div><label class="block text-xs font-medium text-text mb-1">Waste Factor (%)</label><input type="number" id="ep-waste" class="ep-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="10" min="0" max="50" step="1"></div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Total Mixed Epoxy</div>
          <div class="text-4xl font-extrabold font-mono" id="ep-result">0 fl oz</div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Resin Needed</div><div class="text-xl font-bold font-mono" id="ep-resin">0 fl oz</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Hardener Needed</div><div class="text-xl font-bold font-mono" id="ep-hard">0 fl oz</div></div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Coverage</div><div class="text-xl font-bold font-mono" id="ep-area">0 sq ft</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Pot Life</div><div class="text-xl font-bold font-mono" id="ep-pot">0 min</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Cure Time</div><div class="text-xl font-bold font-mono" id="ep-cure">0 hrs</div></div>
        </div>
      </div>
      <ShareButton calculatorId="epoxy" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcEP() {
      const len = parseFloat((document.getElementById('ep-len') as HTMLInputElement).value) || 0;
      const wid = parseFloat((document.getElementById('ep-wid') as HTMLInputElement).value) || 0;
      const thk = parseFloat((document.getElementById('ep-thk') as HTMLInputElement).value) || 0.125;
      const ratio = parseFloat((document.getElementById('ep-ratio') as HTMLSelectElement).value) || 1;
      const coats = parseInt((document.getElementById('ep-coats') as HTMLInputElement).value) || 1;
      const temp = parseFloat((document.getElementById('ep-temp') as HTMLInputElement).value) || 72;
      const waste = parseFloat((document.getElementById('ep-waste') as HTMLInputElement).value) || 10;

      const areaSqIn = len * wid;
      const areaSqFt = areaSqIn / 144;
      const volumeCuIn = areaSqIn * thk * coats;
      // 1 cubic inch = 0.554113 fl oz
      const totalFlOz = volumeCuIn * 0.554113 * (1 + waste / 100);

      const resinPart = ratio / (ratio + 1);
      const hardenerPart = 1 / (ratio + 1);
      const resinFlOz = totalFlOz * resinPart;
      const hardenerFlOz = totalFlOz * hardenerPart;

      // Pot life estimation: base 45 min at 72째F, decreases ~50% per 18째F increase
      const tempDiffF = temp - 72;
      const potLifeMin = 45 * Math.pow(0.5, tempDiffF / 18);

      // Cure time: base 24 hrs at 72째F
      const cureHrs = 24 * Math.pow(0.5, tempDiffF / 18);

      document.getElementById('ep-result')!.textContent = totalFlOz.toFixed(1) + ' fl oz';
      document.getElementById('ep-resin')!.textContent = resinFlOz.toFixed(1) + ' fl oz';
      document.getElementById('ep-hard')!.textContent = hardenerFlOz.toFixed(1) + ' fl oz';
      document.getElementById('ep-area')!.textContent = areaSqFt.toFixed(1) + ' sq ft';
      document.getElementById('ep-pot')!.textContent = Math.round(potLifeMin) + ' min';
      document.getElementById('ep-cure')!.textContent = cureHrs.toFixed(0) + ' hrs';
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.ep-in').forEach(el => { el.addEventListener('input', calcEP); el.addEventListener('change', calcEP); });
      calcEP();
    }, 50);
  </script>
</CalculatorLayout>
