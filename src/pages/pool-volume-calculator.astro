---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Pool Volume Calculator - Calculate Water Volume";
const description = "Calculate the volume of water in your swimming pool based on shape, dimensions, and depth.";
const relatedCalcs = [
  { name: "Volume Calculator", url: "/volume-calculator", description: "3D volumes." },
  { name: "Area Calculator", url: "/area-calculator", description: "2D areas." },
  { name: "Concrete Calculator", url: "/concrete-calculator", description: "Concrete." },
  { name: "Square Footage", url: "/square-footage-calculator", description: "Square footage." },
  { name: "Length Converter", url: "/length-converter", description: "Length units." },
  { name: "Circle Calculator", url: "/circle-calculator", description: "Circles." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Pool Volume Calculator" keywords="pool volume calculator, swimming pool gallons, pool water volume, pool size calculator" breadcrumbs={[{ name: "Pool Volume", url: "/pool-volume-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Pool Volume Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate how many gallons of water your pool holds.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div>
          <label class="block text-xs font-medium text-text mb-1">Pool Shape</label>
          <select id="pv-shape" class="w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="rect" selected>Rectangular</option>
            <option value="round">Round/Circular</option>
            <option value="oval">Oval</option>
            <option value="kidney">Kidney/Freeform (approx)</option>
          </select>
        </div>
        <div id="pv-dims" class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Length (ft)</label><input type="number" id="pv-l" class="pv-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="30" min="1" step="1"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Width (ft)</label><input type="number" id="pv-w" class="pv-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="15" min="1" step="1"></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Shallow End Depth (ft)</label><input type="number" id="pv-d1" class="pv-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="3.5" min="0.5" step="0.5"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Deep End Depth (ft)</label><input type="number" id="pv-d2" class="pv-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="8" min="0.5" step="0.5"></div>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Pool Volume</div>
          <div class="text-4xl font-extrabold" id="pv-gallons">0 gallons</div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Cubic Feet</div><div class="text-xl font-bold" id="pv-cuft">0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Liters</div><div class="text-xl font-bold" id="pv-liters">0</div></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Avg. Depth</div><div class="text-xl font-bold" id="pv-avgd">0 ft</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Water Weight</div><div class="text-xl font-bold" id="pv-weight">0 lbs</div></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-3">Chemical Estimates (for reference)</h3>
          <div class="grid grid-cols-2 gap-2 text-sm">
            <div class="flex justify-between"><span>Chlorine (initial)</span><span class="font-bold" id="pv-chlorine">0 oz</span></div>
            <div class="flex justify-between"><span>Fill Time (garden hose)</span><span class="font-bold" id="pv-fill">0 hours</span></div>
          </div>
        </div>
      </div>
      <ShareButton calculatorId="pool-volume" />
      <FeedbackWidget />
    </div>
    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">Pool Volume Formulas</h2>
      <div class="bg-surface-alt rounded-xl p-4 my-4 font-mono text-sm space-y-1">
        <p>Rectangular: L × W × avg depth × 7.48</p>
        <p>Round: π × r² × avg depth × 7.48</p>
        <p>Oval: π × (L/2) × (W/2) × avg depth × 7.48</p>
      </div>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcPool() {
      const shape = (document.getElementById('pv-shape') as HTMLSelectElement).value;
      const l = parseFloat((document.getElementById('pv-l') as HTMLInputElement).value) || 0;
      const w = parseFloat((document.getElementById('pv-w') as HTMLInputElement).value) || 0;
      const d1 = parseFloat((document.getElementById('pv-d1') as HTMLInputElement).value) || 0;
      const d2 = parseFloat((document.getElementById('pv-d2') as HTMLInputElement).value) || 0;
      const avgD = (d1 + d2) / 2;
      let cuft = 0;
      if (shape === 'rect') cuft = l * w * avgD;
      else if (shape === 'round') cuft = Math.PI * Math.pow(l / 2, 2) * avgD;
      else if (shape === 'oval') cuft = Math.PI * (l / 2) * (w / 2) * avgD;
      else cuft = l * w * avgD * 0.85;
      const gallons = cuft * 7.48052;
      const liters = gallons * 3.78541;
      const weight = gallons * 8.34;
      document.getElementById('pv-gallons')!.textContent = Math.round(gallons).toLocaleString() + ' gallons';
      document.getElementById('pv-cuft')!.textContent = cuft.toFixed(1);
      document.getElementById('pv-liters')!.textContent = Math.round(liters).toLocaleString();
      document.getElementById('pv-avgd')!.textContent = avgD.toFixed(1) + ' ft';
      document.getElementById('pv-weight')!.textContent = Math.round(weight).toLocaleString() + ' lbs';
      document.getElementById('pv-chlorine')!.textContent = (gallons / 10000 * 2).toFixed(1) + ' oz';
      document.getElementById('pv-fill')!.textContent = (gallons / 540).toFixed(1) + ' hrs';
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.pv-in').forEach(el => el.addEventListener('input', calcPool));
      document.getElementById('pv-shape')!.addEventListener('change', calcPool);
      calcPool();
    }, 50);
  </script>
</CalculatorLayout>
