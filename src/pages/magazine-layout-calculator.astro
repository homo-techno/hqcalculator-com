---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Magazine Layout Calculator - Columns, Gutters, Margins & Text Area";
const description = "Plan magazine page layouts with columns, gutters, margins, and text area calculations. Optimize your grid system for professional publishing.";
const relatedCalcs = [
  { name: "Typesetting Calculator", url: "/typesetting-calculator", description: "Characters per page." },
  { name: "Font Size Calculator", url: "/font-size-calculator", description: "Font size converter." },
  { name: "Typography Scale Calculator", url: "/typography-scale-calculator", description: "Modular type scales." },
  { name: "Bleed Margin Calculator", url: "/bleed-margin-calculator", description: "Print bleed calculations." },
  { name: "Paper Fold Calculator", url: "/paper-fold-calculator", description: "Fold types and panels." },
  { name: "Print Cost Calculator", url: "/print-cost-calculator", description: "Print job cost estimator." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Magazine Layout Calculator" keywords="magazine layout, column width, gutter, margins, text area, grid system, page layout, publishing design" breadcrumbs={[{ name: "Magazine Layout Calculator", url: "/magazine-layout-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Magazine Layout Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Design your magazine page grid by setting page size, margins, columns, and gutters. Get precise column widths and text area dimensions.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div><label class="block text-xs font-medium text-text mb-1">Page Size Preset</label>
          <select id="ml2-preset" class="ml2-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="custom">Custom</option>
            <option value="8.375x10.875">US Magazine (8.375 x 10.875 in)</option>
            <option value="8.5x11">Letter (8.5 x 11 in)</option>
            <option value="5.5x8.5">Digest (5.5 x 8.5 in)</option>
            <option value="8.268x11.693">A4 (210 x 297 mm)</option>
            <option value="5.827x8.268">A5 (148 x 210 mm)</option>
          </select>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Page Width (inches)</label><input type="number" id="ml2-width" class="ml2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="1" step="0.125"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Page Height (inches)</label><input type="number" id="ml2-height" class="ml2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="1" step="0.125"></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Inside Margin (in)</label><input type="number" id="ml2-inside" class="ml2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="0" step="0.0625"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Outside Margin (in)</label><input type="number" id="ml2-outside" class="ml2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="0" step="0.0625"></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Top Margin (in)</label><input type="number" id="ml2-top" class="ml2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="0" step="0.0625"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Bottom Margin (in)</label><input type="number" id="ml2-bottom" class="ml2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="0" step="0.0625"></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Number of Columns</label><input type="number" id="ml2-cols" class="ml2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="1" max="12" step="1"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Gutter Width (in)</label><input type="number" id="ml2-gutter" class="ml2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="0" step="0.0625"></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Font Size (pt)</label><input type="number" id="ml2-font" class="ml2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="4" step="0.5"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Leading (pt)</label><input type="number" id="ml2-leading" class="ml2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="4" step="0.5"></div>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Column Width</div>
          <div class="text-5xl font-extrabold font-mono" id="ml2-result">0 in</div>
          <div class="text-sm text-blue-200 mt-1" id="ml2-subtitle"></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Text Area Width</div><div class="text-xl font-bold" id="ml2-textw">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Text Area Height</div><div class="text-xl font-bold" id="ml2-texth">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Lines per Column</div><div class="text-xl font-bold" id="ml2-lines">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Chars per Line</div><div class="text-xl font-bold" id="ml2-chars">--</div></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-2">Grid Details</h3>
          <div class="font-mono text-sm space-y-1" id="ml2-steps"></div>
        </div>
      </div>
      <ShareButton calculatorId="magazine-layout" />
      <FeedbackWidget />
    </div>
    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">Magazine Grid Layout</h2>
      <div class="bg-surface-alt rounded-xl p-4 my-4 font-mono text-sm space-y-1">
        <p>Text Area Width = Page Width - Inside Margin - Outside Margin</p>
        <p>Column Width = (Text Area - Gutters) / Columns</p>
        <p>Total Gutters = (Columns - 1) x Gutter Width</p>
        <p>Optimal line length: 45-75 characters per line</p>
      </div>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcMl2() {
      const preset = (document.getElementById('ml2-preset') as HTMLSelectElement).value;
      if (preset !== 'custom') {
        const parts = preset.split('x');
        (document.getElementById('ml2-width') as HTMLInputElement).value = parts[0];
        (document.getElementById('ml2-height') as HTMLInputElement).value = parts[1];
      }
      const pageW = parseFloat((document.getElementById('ml2-width') as HTMLInputElement).value) || 0;
      const pageH = parseFloat((document.getElementById('ml2-height') as HTMLInputElement).value) || 0;
      const inside = parseFloat((document.getElementById('ml2-inside') as HTMLInputElement).value) || 0;
      const outside = parseFloat((document.getElementById('ml2-outside') as HTMLInputElement).value) || 0;
      const top = parseFloat((document.getElementById('ml2-top') as HTMLInputElement).value) || 0;
      const bottom = parseFloat((document.getElementById('ml2-bottom') as HTMLInputElement).value) || 0;
      const cols = parseFloat((document.getElementById('ml2-cols') as HTMLInputElement).value) || 1;
      const gutter = parseFloat((document.getElementById('ml2-gutter') as HTMLInputElement).value) || 0;
      const fontSize = parseFloat((document.getElementById('ml2-font') as HTMLInputElement).value) || 10;
      const leading = parseFloat((document.getElementById('ml2-leading') as HTMLInputElement).value) || 12;
      const textW = pageW - inside - outside;
      const textH = pageH - top - bottom;
      const totalGutters = (cols - 1) * gutter;
      const colWidth = cols > 0 ? (textW - totalGutters) / cols : 0;
      const colWidthPt = colWidth * 72;
      const textHpt = textH * 72;
      const linesPerCol = leading > 0 ? Math.floor(textHpt / leading) : 0;
      const charsPerLine = fontSize > 0 ? Math.floor(colWidthPt / (fontSize * 0.55)) : 0;
      const wordsPerCol = Math.floor(charsPerLine * linesPerCol / 5);
      let lineQuality = 'Too narrow';
      if (charsPerLine >= 45 && charsPerLine <= 75) lineQuality = 'Optimal';
      else if (charsPerLine > 75) lineQuality = 'Too wide';
      else if (charsPerLine >= 35) lineQuality = 'Acceptable';
      const steps: string[] = [];
      steps.push('Page: ' + pageW + ' x ' + pageH + ' in');
      steps.push('Margins: Inside ' + inside + ', Outside ' + outside + ', Top ' + top + ', Bottom ' + bottom);
      steps.push('Text area: ' + textW.toFixed(3) + ' x ' + textH.toFixed(3) + ' in');
      steps.push('Gutters: ' + (cols - 1) + ' x ' + gutter + ' = ' + totalGutters.toFixed(3) + ' in');
      steps.push('Column width: (' + textW.toFixed(3) + ' - ' + totalGutters.toFixed(3) + ') / ' + cols + ' = ' + colWidth.toFixed(3) + ' in');
      steps.push('Column width: ' + colWidthPt.toFixed(1) + ' pt (' + (colWidth * 25.4).toFixed(1) + ' mm)');
      steps.push('Lines/column: ' + linesPerCol + ' at ' + leading + 'pt leading');
      steps.push('Chars/line: ~' + charsPerLine + ' at ' + fontSize + 'pt (' + lineQuality + ')');
      steps.push('Words/column: ~' + wordsPerCol);
      steps.push('Words/page (' + cols + ' cols): ~' + (wordsPerCol * cols));
      document.getElementById('ml2-result')!.textContent = colWidth.toFixed(3) + ' in';
      document.getElementById('ml2-subtitle')!.textContent = colWidthPt.toFixed(1) + ' pt | ' + charsPerLine + ' chars/line (' + lineQuality + ')';
      document.getElementById('ml2-textw')!.textContent = textW.toFixed(3) + ' in';
      document.getElementById('ml2-texth')!.textContent = textH.toFixed(3) + ' in';
      document.getElementById('ml2-lines')!.textContent = linesPerCol.toString();
      document.getElementById('ml2-chars')!.textContent = charsPerLine + ' (' + lineQuality + ')';
      document.getElementById('ml2-steps')!.innerHTML = steps.map(s => '<div>' + s + '</div>').join('');
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      (document.getElementById('ml2-width') as HTMLInputElement).value = '8.375';
      (document.getElementById('ml2-height') as HTMLInputElement).value = '10.875';
      (document.getElementById('ml2-inside') as HTMLInputElement).value = '0.75';
      (document.getElementById('ml2-outside') as HTMLInputElement).value = '0.5';
      (document.getElementById('ml2-top') as HTMLInputElement).value = '0.625';
      (document.getElementById('ml2-bottom') as HTMLInputElement).value = '0.75';
      (document.getElementById('ml2-cols') as HTMLInputElement).value = '3';
      (document.getElementById('ml2-gutter') as HTMLInputElement).value = '0.1875';
      (document.getElementById('ml2-font') as HTMLInputElement).value = '10';
      (document.getElementById('ml2-leading') as HTMLInputElement).value = '12';
      document.querySelectorAll('.ml2-in').forEach(el => { el.addEventListener('input', calcMl2); el.addEventListener('change', calcMl2); });
      calcMl2();
    }, 50);
  </script>
</CalculatorLayout>
