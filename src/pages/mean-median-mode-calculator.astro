---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Mean, Median, Mode Calculator - Central Tendency";
const description = "Calculate mean, median, mode, range, and other descriptive statistics from any data set.";
const relatedCalcs = [
  { name: "Standard Deviation", url: "/standard-deviation-calculator", description: "Statistics." },
  { name: "Average Calculator", url: "/average-calculator", description: "Averages." },
  { name: "Percentage Calculator", url: "/percentage-calculator", description: "Percentages." },
  { name: "Z-Score", url: "/z-score-calculator", description: "Z-scores." },
  { name: "Probability", url: "/probability-calculator", description: "Probability." },
  { name: "Sample Size", url: "/sample-size-calculator", description: "Sample size." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Mean, Median, Mode Calculator" keywords="mean median mode, central tendency, descriptive statistics, average, range, data analysis" breadcrumbs={[{ name: "Mean Median Mode", url: "/mean-median-mode-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Mean, Median, Mode Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Enter your data set to find central tendency measures.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-text mb-1">Data Set (comma or space separated)</label>
          <textarea id="mm-data" class="w-full px-4 py-3 border border-border rounded-xl text-lg font-mono" rows="3" placeholder="e.g. 5, 10, 15, 20, 25">12, 15, 20, 20, 25, 30, 35, 40, 20, 18</textarea>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-5 bg-primary rounded-2xl text-white text-center">
            <div class="text-xs uppercase tracking-wide mb-1 opacity-80">Mean</div>
            <div class="text-2xl font-extrabold" id="mm-mean">0</div>
          </div>
          <div class="p-5 bg-secondary rounded-2xl text-white text-center">
            <div class="text-xs uppercase tracking-wide mb-1 opacity-80">Median</div>
            <div class="text-2xl font-extrabold" id="mm-median">0</div>
          </div>
          <div class="p-5 bg-green-500 rounded-2xl text-white text-center">
            <div class="text-xs uppercase tracking-wide mb-1 opacity-80">Mode</div>
            <div class="text-2xl font-extrabold" id="mm-mode">0</div>
          </div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Range</div><div class="text-xl font-bold" id="mm-range">0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Count</div><div class="text-xl font-bold" id="mm-count">0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Sum</div><div class="text-xl font-bold" id="mm-sum">0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Std Dev</div><div class="text-xl font-bold" id="mm-std">0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Min</div><div class="text-xl font-bold" id="mm-min">0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Max</div><div class="text-xl font-bold" id="mm-max">0</div></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-2">Sorted Data</h3>
          <div class="text-sm font-mono" id="mm-sorted"></div>
        </div>
      </div>
      <ShareButton calculatorId="mean-median-mode" />
      <FeedbackWidget />
    </div>
    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">Mean, Median, and Mode</h2>
      <p><strong>Mean</strong>: Sum of values รท count. <strong>Median</strong>: Middle value when sorted. <strong>Mode</strong>: Most frequent value(s).</p>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcMMM() {
      const raw = (document.getElementById('mm-data') as HTMLTextAreaElement).value;
      const nums = raw.split(/[\s,;]+/).map(Number).filter(n => !isNaN(n));
      if (nums.length === 0) return;
      const sorted = [...nums].sort((a,b) => a-b);
      const n = nums.length;
      const sum = nums.reduce((a,b) => a+b, 0);
      const mean = sum / n;
      const median = n % 2 === 1 ? sorted[Math.floor(n/2)] : (sorted[n/2-1] + sorted[n/2]) / 2;
      const freq: Record<number, number> = {};
      nums.forEach(v => freq[v] = (freq[v] || 0) + 1);
      const maxFreq = Math.max(...Object.values(freq));
      const modes = Object.entries(freq).filter(([,f]) => f === maxFreq).map(([v]) => Number(v));
      const modeStr = maxFreq === 1 ? 'No mode' : modes.join(', ');
      const variance = nums.reduce((s,v) => s + (v-mean)**2, 0) / n;
      const std = Math.sqrt(variance);
      document.getElementById('mm-mean')!.textContent = mean.toFixed(2);
      document.getElementById('mm-median')!.textContent = median.toFixed(2);
      document.getElementById('mm-mode')!.textContent = modeStr;
      document.getElementById('mm-range')!.textContent = (sorted[n-1] - sorted[0]).toFixed(2);
      document.getElementById('mm-count')!.textContent = n.toString();
      document.getElementById('mm-sum')!.textContent = sum.toFixed(2);
      document.getElementById('mm-std')!.textContent = std.toFixed(4);
      document.getElementById('mm-min')!.textContent = sorted[0].toString();
      document.getElementById('mm-max')!.textContent = sorted[n-1].toString();
      document.getElementById('mm-sorted')!.textContent = sorted.join(', ');
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => { document.getElementById('mm-data')!.addEventListener('input', calcMMM); calcMMM(); }, 50);
  </script>
</CalculatorLayout>
