---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';

const title = "Baby Cost Calculator - First Year Expenses Estimate";
const description = "Estimate first-year baby costs including diapers, formula, childcare, clothing, and gear with a detailed category breakdown.";

const relatedCalcs = [
  { name: "Budget Calculator", url: "/budget-calculator", description: "Budget planning." },
  { name: "Child Support", url: "/child-support-calculator", description: "Child support." },
  { name: "College Savings", url: "/college-savings-calculator", description: "College savings." },
  { name: "Life Insurance", url: "/life-insurance-calculator", description: "Life coverage." },
  { name: "Emergency Fund", url: "/emergency-fund-calculator", description: "Emergency savings." },
  { name: "Health Insurance", url: "/health-insurance-calculator", description: "Health plan costs." },
];
---

<CalculatorLayout title={title} description={description} calculatorName="Baby Cost Calculator" keywords="baby cost calculator, first year baby expenses, newborn costs, diapers, formula, childcare, baby budget" breadcrumbs={[{ name: "Baby Cost", url: "/baby-cost-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Baby Cost Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Estimate the first-year costs of having a baby with detailed category breakdowns.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8">
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
        <div class="space-y-4">
          <div>
            <label class="block text-sm font-medium text-text mb-1">Feeding Method</label>
            <select id="bc2-feeding" class="w-full px-4 py-3 border border-border rounded-xl text-lg">
              <option value="breast">Breastfeeding (pump + supplies)</option>
              <option value="formula" selected>Formula</option>
              <option value="combo">Combination</option>
            </select>
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Diaper Type</label>
            <select id="bc2-diapers" class="w-full px-4 py-3 border border-border rounded-xl text-lg">
              <option value="disposable" selected>Disposable</option>
              <option value="cloth">Cloth Diapers</option>
              <option value="eco">Eco-Friendly Disposable</option>
            </select>
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Monthly Childcare Cost</label>
            <div class="relative"><span class="absolute left-3 top-1/2 -translate-y-1/2 text-text-muted">$</span>
              <input type="number" id="bc2-childcare" class="w-full pl-7 pr-3 py-3 border border-border rounded-xl text-lg" value="1200" min="0" step="100">
            </div>
            <p class="text-xs text-text-muted mt-1">$0 if parent stays home; avg daycare: $800-$2,000/mo</p>
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Clothing Budget (monthly)</label>
            <div class="relative"><span class="absolute left-3 top-1/2 -translate-y-1/2 text-text-muted">$</span>
              <input type="number" id="bc2-clothing" class="w-full pl-7 pr-3 py-3 border border-border rounded-xl text-lg" value="75" min="0" step="10">
            </div>
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">One-Time Gear Budget</label>
            <div class="relative"><span class="absolute left-3 top-1/2 -translate-y-1/2 text-text-muted">$</span>
              <input type="number" id="bc2-gear" class="w-full pl-7 pr-3 py-3 border border-border rounded-xl text-lg" value="2500" min="0" step="100">
            </div>
            <p class="text-xs text-text-muted mt-1">Crib, stroller, car seat, high chair, etc.</p>
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Monthly Medical (copays, supplies)</label>
            <div class="relative"><span class="absolute left-3 top-1/2 -translate-y-1/2 text-text-muted">$</span>
              <input type="number" id="bc2-medical" class="w-full pl-7 pr-3 py-3 border border-border rounded-xl text-lg" value="100" min="0" step="25">
            </div>
          </div>
        </div>

        <div class="space-y-3">
          <div class="p-6 bg-primary rounded-2xl text-white text-center">
            <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Estimated First Year Total</div>
            <div class="text-5xl font-extrabold font-mono" id="bc2-total">$0</div>
          </div>
          <div class="grid grid-cols-2 gap-3">
            <div class="p-4 bg-surface-alt rounded-xl text-center">
              <div class="text-xs text-text-muted uppercase">Monthly Average</div>
              <div class="text-xl font-bold text-secondary" id="bc2-monthly">$0</div>
            </div>
            <div class="p-4 bg-surface-alt rounded-xl text-center">
              <div class="text-xs text-text-muted uppercase">Feeding Cost</div>
              <div class="text-xl font-bold" id="bc2-feeding-cost">$0/yr</div>
            </div>
            <div class="p-4 bg-surface-alt rounded-xl text-center">
              <div class="text-xs text-text-muted uppercase">Diaper Cost</div>
              <div class="text-xl font-bold" id="bc2-diaper-cost">$0/yr</div>
            </div>
            <div class="p-4 bg-surface-alt rounded-xl text-center">
              <div class="text-xs text-text-muted uppercase">Childcare</div>
              <div class="text-xl font-bold text-orange-600" id="bc2-childcare-total">$0/yr</div>
            </div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Savings Tip</div>
            <div class="text-sm font-medium" id="bc2-tip">--</div>
          </div>
        </div>
      </div>
      <ShareButton calculatorId="baby-cost" />
      <FeedbackWidget />
    </div>

    <article class="mt-12 max-w-4xl prose prose-slate">
      <h2 class="text-2xl font-bold text-text">First Year Baby Costs Breakdown</h2>
      <p>The USDA estimates families spend an average of $12,000-$15,000 in a baby's first year. The biggest expenses are childcare (if applicable), followed by housing adjustments, food, and diapers.</p>
      <h3 class="text-xl font-semibold text-text mt-8">Ways to Save</h3>
      <p>Buy secondhand gear, accept hand-me-downs, use cloth diapers (saves ~$1,000/year), breastfeed if possible, and take advantage of baby registries and cashback programs.</p>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    const fmt = (n: number) => '$' + Math.round(n).toLocaleString();

    function calcBC2() {
      const feeding = (document.getElementById('bc2-feeding') as HTMLSelectElement).value;
      const diaperType = (document.getElementById('bc2-diapers') as HTMLSelectElement).value;
      const childcareMonthly = parseFloat((document.getElementById('bc2-childcare') as HTMLInputElement).value) || 0;
      const clothingMonthly = parseFloat((document.getElementById('bc2-clothing') as HTMLInputElement).value) || 0;
      const gear = parseFloat((document.getElementById('bc2-gear') as HTMLInputElement).value) || 0;
      const medicalMonthly = parseFloat((document.getElementById('bc2-medical') as HTMLInputElement).value) || 0;

      // Feeding annual cost
      const feedingCosts: Record<string, number> = {
        breast: 600,   // pump, bags, supplies
        formula: 2400,  // ~$200/mo
        combo: 1500
      };
      const feedingAnnual = feedingCosts[feeding] || 2400;

      // Diaper annual cost (~8 diapers/day = 2920/year)
      const diaperCosts: Record<string, number> = {
        disposable: 900,  // ~$0.30 each
        cloth: 400,       // upfront + washing
        eco: 1200         // ~$0.40 each
      };
      const diaperAnnual = diaperCosts[diaperType] || 900;

      const childcareAnnual = childcareMonthly * 12;
      const clothingAnnual = clothingMonthly * 12;
      const medicalAnnual = medicalMonthly * 12;

      const total = feedingAnnual + diaperAnnual + childcareAnnual + clothingAnnual + gear + medicalAnnual;
      const monthlyAvg = total / 12;

      // Savings tip
      let tip = '';
      if (feeding === 'formula') tip = 'Breastfeeding could save ~$1,800/year on formula costs.';
      else if (diaperType === 'disposable') tip = 'Cloth diapers could save ~$500/year over disposables.';
      else if (childcareMonthly > 1500) tip = 'Consider nanny-sharing or family daycare to reduce childcare costs.';
      else tip = 'Buy gear secondhand (strollers, clothes) to save 50-70% on retail prices.';

      document.getElementById('bc2-total')!.textContent = fmt(total);
      document.getElementById('bc2-monthly')!.textContent = fmt(monthlyAvg) + '/mo';
      document.getElementById('bc2-feeding-cost')!.textContent = fmt(feedingAnnual) + '/yr';
      document.getElementById('bc2-diaper-cost')!.textContent = fmt(diaperAnnual) + '/yr';
      document.getElementById('bc2-childcare-total')!.textContent = fmt(childcareAnnual) + '/yr';
      document.getElementById('bc2-tip')!.textContent = tip;

      document.dispatchEvent(new CustomEvent('calc-update'));
    }

    setTimeout(() => {
      ['bc2-childcare', 'bc2-clothing', 'bc2-gear', 'bc2-medical'].forEach(id => {
        const el = document.getElementById(id);
        if (el) { el.addEventListener('input', calcBC2); el.addEventListener('change', calcBC2); }
      });
      ['bc2-feeding', 'bc2-diapers'].forEach(id => {
        const el = document.getElementById(id);
        if (el) { el.addEventListener('change', calcBC2); }
      });
      calcBC2();
    }, 50);
  </script>
</CalculatorLayout>
