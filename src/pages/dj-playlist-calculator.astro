---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "DJ Playlist Calculator - Song Count & BPM Mix for Events";
const description = "Calculate how many songs you need, playlist duration, and BPM progression for different event time slots. Perfect for DJs and event planners.";
const relatedCalcs = [
  { name: "Sound System Calculator", url: "/sound-system-calculator", description: "Speaker wattage needed." },
  { name: "Event Timeline Calculator", url: "/event-timeline-calculator", description: "Event schedule planner." },
  { name: "Wedding Timeline Calculator", url: "/wedding-timeline-calculator", description: "Wedding day schedule." },
  { name: "Event Budget Calculator", url: "/event-budget-calculator", description: "Total event cost breakdown." },
  { name: "Event Lighting Calculator", url: "/event-lighting-calculator", description: "Venue lighting plan." },
  { name: "Photo Booth Calculator", url: "/photo-booth-calculator", description: "Photo booth planning." },
];
---

<CalculatorLayout
  title={title}
  description={description}
  calculatorName="DJ Playlist Calculator"
  keywords="dj playlist calculator, song count, event music, bpm mix, wedding playlist, party music planner"
  breadcrumbs={[{ name: "DJ Playlist", url: "/dj-playlist-calculator" }]}
>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">DJ Playlist Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Plan your event music with the right song count and BPM progression.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4 mb-6">
        <div>
          <label class="block text-sm font-medium text-text mb-1">Total Music Time (hours)</label>
          <input type="number" id="djp-hours" class="djp-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="5" min="1" max="12" step="0.5">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Cocktail / Background Music (hours)</label>
          <input type="number" id="djp-bg" class="djp-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="1" min="0" max="6" step="0.5">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Dinner Music (hours)</label>
          <input type="number" id="djp-dinner" class="djp-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="1" min="0" max="4" step="0.5">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Dance Music (hours)</label>
          <input type="number" id="djp-dance" class="djp-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="3" min="0" max="8" step="0.5">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Average Song Length (minutes)</label>
          <input type="number" id="djp-songlength" class="djp-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="3.5" min="2" max="7" step="0.5">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Event Vibe</label>
          <select id="djp-vibe" class="djp-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="wedding">Wedding / Formal</option>
            <option value="party">Party / Celebration</option>
            <option value="club">Club / High Energy</option>
            <option value="corporate">Corporate / Background</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Must-Play Requests</label>
          <input type="number" id="djp-requests" class="djp-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="15" min="0" step="1">
        </div>
      </div>

      <div class="p-6 bg-primary rounded-2xl text-white text-center mb-4">
        <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Total Songs Needed</div>
        <div class="text-5xl font-extrabold" id="djp-total">--</div>
        <div class="text-sm mt-1" id="djp-duration">--</div>
      </div>

      <div class="grid grid-cols-2 gap-4 mb-4">
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Background Songs</div>
          <div class="text-xl font-bold" id="djp-bgsongs">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Dinner Songs</div>
          <div class="text-xl font-bold" id="djp-dinnersongs">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">Dance Songs</div>
          <div class="text-xl font-bold" id="djp-dancesongs">--</div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center">
          <div class="text-xs text-text-muted uppercase">DJ-Selected</div>
          <div class="text-xl font-bold" id="djp-djselected">--</div>
        </div>
      </div>

      <div class="p-4 bg-surface-alt rounded-xl mb-4" id="djp-details"></div>

      <ShareButton calculatorId="dj-playlist" />
      <FeedbackWidget />
    </div>

    <article class="mt-12 max-w-4xl prose prose-slate">
      <h2 class="text-2xl font-bold text-text">DJ Playlist Planning Guide</h2>
      <p>Average 3.5 minutes per song means about 17 songs per hour. Always prepare 20-30% more songs than needed for flexibility. Gradually increase BPM: cocktail hour at 90-110 BPM, dinner at 80-100 BPM, dancing ramps from 110 to 130+ BPM.</p>
    </article>

    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    function calcDJP() {
      const totalHours = parseFloat((document.getElementById('djp-hours') as HTMLInputElement).value) || 5;
      const bgHours = parseFloat((document.getElementById('djp-bg') as HTMLInputElement).value) || 1;
      const dinnerHours = parseFloat((document.getElementById('djp-dinner') as HTMLInputElement).value) || 1;
      const danceHours = parseFloat((document.getElementById('djp-dance') as HTMLInputElement).value) || 3;
      const songLen = parseFloat((document.getElementById('djp-songlength') as HTMLInputElement).value) || 3.5;
      const vibe = (document.getElementById('djp-vibe') as HTMLSelectElement).value;
      const requests = parseInt((document.getElementById('djp-requests') as HTMLInputElement).value) || 0;

      const songsPerHour = Math.ceil(60 / songLen);
      const bgSongs = Math.ceil(bgHours * songsPerHour);
      const dinnerSongs = Math.ceil(dinnerHours * songsPerHour);
      const danceSongs = Math.ceil(danceHours * songsPerHour);
      const totalSongs = bgSongs + dinnerSongs + danceSongs;
      const djSelected = Math.max(0, totalSongs - requests);
      const prepSongs = Math.ceil(totalSongs * 1.25);

      const totalMinutes = totalSongs * songLen;

      let bpmGuide: { slot: string; bpm: string }[] = [];
      if (vibe === 'wedding') {
        bpmGuide = [
          { slot: 'Cocktail hour', bpm: '90-110 BPM (jazz, acoustic, lounge)' },
          { slot: 'Dinner', bpm: '80-100 BPM (soft pop, instrumental)' },
          { slot: 'First dances', bpm: '70-90 BPM (slow songs)' },
          { slot: 'Early dancing', bpm: '110-120 BPM (crowd warmers)' },
          { slot: 'Peak dancing', bpm: '120-130 BPM (hits, crowd favorites)' },
          { slot: 'Last songs', bpm: '90-110 BPM (wind-down classics)' },
        ];
      } else if (vibe === 'club') {
        bpmGuide = [
          { slot: 'Warm-up', bpm: '115-120 BPM' },
          { slot: 'Building', bpm: '120-128 BPM' },
          { slot: 'Peak', bpm: '128-140 BPM' },
          { slot: 'Cool-down', bpm: '110-120 BPM' },
        ];
      } else if (vibe === 'party') {
        bpmGuide = [
          { slot: 'Early', bpm: '100-115 BPM (ice breakers)' },
          { slot: 'Building', bpm: '115-125 BPM (sing-alongs)' },
          { slot: 'Peak', bpm: '125-135 BPM (bangers)' },
          { slot: 'Wind-down', bpm: '100-115 BPM (classics)' },
        ];
      } else {
        bpmGuide = [
          { slot: 'All event', bpm: '80-110 BPM (background, ambient)' },
        ];
      }

      document.getElementById('djp-total')!.textContent = totalSongs.toString();
      document.getElementById('djp-duration')!.textContent = Math.floor(totalMinutes / 60) + 'h ' + Math.round(totalMinutes % 60) + 'm total music time';
      document.getElementById('djp-bgsongs')!.textContent = bgSongs.toString();
      document.getElementById('djp-dinnersongs')!.textContent = dinnerSongs.toString();
      document.getElementById('djp-dancesongs')!.textContent = danceSongs.toString();
      document.getElementById('djp-djselected')!.textContent = djSelected.toString();

      let details = '<h3 class="font-semibold text-sm text-text mb-2">BPM Guide & Details</h3>';
      details += '<div class="space-y-1 mb-3">';
      bpmGuide.forEach(g => {
        details += '<div class="flex justify-between text-sm py-1 border-b border-border last:border-0"><span class="text-text-secondary">' + g.slot + '</span><span class="font-medium">' + g.bpm + '</span></div>';
      });
      details += '</div>';
      details += '<ul class="text-sm text-text-secondary space-y-1">';
      details += '<li>Songs per hour: ~' + songsPerHour + ' (at ' + songLen + ' min avg)</li>';
      details += '<li>Must-play requests: ' + requests + '</li>';
      details += '<li>Prepare library of: ' + prepSongs + ' songs (25% buffer)</li>';
      details += '<li>Tip: Mix genres every 3-4 songs to keep energy varied</li>';
      details += '</ul>';
      document.getElementById('djp-details')!.innerHTML = details;

      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.djp-in').forEach(el => { el.addEventListener('input', calcDJP); el.addEventListener('change', calcDJP); });
      calcDJP();
    }, 50);
  </script>
</CalculatorLayout>
