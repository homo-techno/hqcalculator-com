---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Fish Tank Stocking Calculator - Fish Count & Bioload";
const description = "Calculate how many fish your aquarium can support based on tank size and filter type. See max fish inches, counts by size, and bioload percentage.";
const relatedCalcs = [
  { name: "Aquarium Calculator", url: "/aquarium-calculator", description: "Tank volume and weight." },
  { name: "Chicken Feed Calculator", url: "/chicken-feed-calculator", description: "Chicken feed and egg costs." },
  { name: "Hay Calculator", url: "/hay-calculator", description: "Hay needs for livestock." },
  { name: "Egg Production Calculator", url: "/egg-production-calculator", description: "Egg production estimates." },
  { name: "Garden Spacing", url: "/garden-spacing-calculator", description: "Plan garden bed layouts." },
  { name: "Irrigation Calculator", url: "/irrigation-calculator", description: "Plan irrigation schedules." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Fish Tank Stocking Calculator" keywords="fish tank stocking, aquarium fish capacity, fish per gallon, bioload calculator, aquarium stocking guide, fish tank size" breadcrumbs={[{ name: "Fish Tank Stocking", url: "/fish-tank-stocking-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Fish Tank Stocking Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate how many fish your aquarium can safely hold based on tank size and filtration.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="block text-xs font-medium text-text mb-1">Tank Size (gallons)</label>
            <input type="number" id="fs-gallons" class="fs-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="29" min="1" step="1">
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Filter Type</label>
            <select id="fs-filter" class="fs-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
              <option value="0.8">Basic / Sponge (80%)</option>
              <option value="1.0" selected>HOB / Standard (100%)</option>
              <option value="1.2">Canister (120%)</option>
              <option value="1.5">Oversized / Sump (150%)</option>
            </select>
          </div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="block text-xs font-medium text-text mb-1">Fish Type</label>
            <select id="fs-type" class="fs-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
              <option value="tropical" selected>Tropical Freshwater</option>
              <option value="goldfish">Goldfish / Fancy</option>
              <option value="cichlid">Cichlids</option>
              <option value="marine">Marine / Saltwater</option>
            </select>
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Planting Level</label>
            <select id="fs-plants" class="fs-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
              <option value="0">No Plants</option>
              <option value="0.1" selected>Light Planting</option>
              <option value="0.2">Moderate Planting</option>
              <option value="0.3">Heavy Planting</option>
            </select>
          </div>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Max Fish Inches</div>
          <div class="text-5xl font-extrabold font-mono" id="fs-result">0 in</div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Small (1-2")</div><div class="text-xl font-bold font-mono" id="fs-small">0 fish</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Medium (3-4")</div><div class="text-xl font-bold font-mono" id="fs-medium">0 fish</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Large (5-6")</div><div class="text-xl font-bold font-mono" id="fs-large">0 fish</div></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Stocking Level</div><div class="text-xl font-bold font-mono" id="fs-level">-</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Water Changes</div><div class="text-xl font-bold font-mono" id="fs-changes">-</div></div>
        </div>
      </div>
      <ShareButton calculatorId="fish-tank-stocking" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcFS() {
      const gallons = parseFloat((document.getElementById('fs-gallons') as HTMLInputElement).value) || 0;
      const filterMult = parseFloat((document.getElementById('fs-filter') as HTMLSelectElement).value) || 1;
      const fishType = (document.getElementById('fs-type') as HTMLSelectElement).value;
      const plantBonus = parseFloat((document.getElementById('fs-plants') as HTMLSelectElement).value) || 0;
      // Inches per gallon rule varies by fish type
      const inchPerGal: Record<string, number> = {
        tropical: 1.0, goldfish: 0.5, cichlid: 0.75, marine: 0.5
      };
      const baseRate = inchPerGal[fishType] || 1;
      // Total capacity with filter and plant bonuses
      const effectiveGallons = gallons * filterMult * (1 + plantBonus);
      const maxInches = effectiveGallons * baseRate;
      // Fish counts by size
      const smallFish = Math.floor(maxInches / 1.5); // avg 1.5 inches
      const medFish = Math.floor(maxInches / 3.5);   // avg 3.5 inches
      const largeFish = Math.floor(maxInches / 5.5);  // avg 5.5 inches
      // Stocking level recommendation
      let level = 'Conservative';
      if (filterMult >= 1.2 && plantBonus >= 0.2) level = 'Generous';
      else if (filterMult >= 1.0) level = 'Standard';
      else level = 'Conservative';
      // Water change frequency
      let changes = 'Weekly 25%';
      if (fishType === 'goldfish') changes = 'Weekly 30%';
      else if (fishType === 'marine') changes = 'Bi-weekly 20%';
      else if (filterMult >= 1.5) changes = 'Bi-weekly 25%';
      document.getElementById('fs-result')!.textContent = Math.round(maxInches) + ' in';
      document.getElementById('fs-small')!.textContent = smallFish + ' fish';
      document.getElementById('fs-medium')!.textContent = medFish + ' fish';
      document.getElementById('fs-large')!.textContent = largeFish + ' fish';
      document.getElementById('fs-level')!.textContent = level;
      document.getElementById('fs-changes')!.textContent = changes;
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.fs-in').forEach(el => { el.addEventListener('input', calcFS); el.addEventListener('change', calcFS); });
      calcFS();
    }, 50);
  </script>
</CalculatorLayout>
