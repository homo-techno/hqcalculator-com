---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Long Division Calculator - Step-by-Step Solution";
const description = "Perform long division with step-by-step solution, showing quotient, remainder, and decimal result.";
const relatedCalcs = [
  { name: "Fraction Calculator", url: "/fraction-calculator", description: "Fractions." },
  { name: "Modulo Calculator", url: "/modulo-calculator", description: "Remainder." },
  { name: "Percentage Calculator", url: "/percentage-calculator", description: "Percentages." },
  { name: "LCM & GCF", url: "/lcm-gcf-calculator", description: "LCM & GCF." },
  { name: "Scientific Calculator", url: "/scientific-calculator", description: "Scientific." },
  { name: "Average Calculator", url: "/average-calculator", description: "Averages." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Long Division Calculator" keywords="long division, division calculator, step by step division, quotient remainder, division steps" breadcrumbs={[{ name: "Long Division", url: "/long-division-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Long Division Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">See the complete step-by-step long division process.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="grid grid-cols-3 gap-3 items-end">
          <div><label class="block text-xs font-medium text-text mb-1">Dividend</label><input type="number" id="ld-a" class="ld-in w-full px-4 py-3 border border-border rounded-xl text-2xl font-bold" value="12345" min="0" step="1"></div>
          <div class="text-center text-2xl font-bold text-text pb-3">÷</div>
          <div><label class="block text-xs font-medium text-text mb-1">Divisor</label><input type="number" id="ld-b" class="ld-in w-full px-4 py-3 border border-border rounded-xl text-2xl font-bold" value="7" min="1" step="1"></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-5 bg-primary rounded-2xl text-white text-center"><div class="text-xs uppercase tracking-wide mb-1 opacity-80">Quotient</div><div class="text-3xl font-extrabold font-mono" id="ld-quot">0</div></div>
          <div class="p-5 bg-secondary rounded-2xl text-white text-center"><div class="text-xs uppercase tracking-wide mb-1 opacity-80">Remainder</div><div class="text-3xl font-extrabold font-mono" id="ld-rem">0</div></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Decimal Result</div><div class="text-xl font-bold font-mono" id="ld-dec">0</div></div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-3">Step-by-Step</h3>
          <div class="font-mono text-sm space-y-1" id="ld-steps"></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <div class="font-mono text-sm" id="ld-verify">-</div>
        </div>
      </div>
      <ShareButton calculatorId="long-division" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcLD() {
      const a = Math.abs(Math.floor(parseFloat((document.getElementById('ld-a') as HTMLInputElement).value) || 0));
      const b = Math.abs(Math.floor(parseFloat((document.getElementById('ld-b') as HTMLInputElement).value) || 1));
      if (b === 0) { document.getElementById('ld-quot')!.textContent = 'Error'; return; }
      const quot = Math.floor(a / b);
      const rem = a % b;
      document.getElementById('ld-quot')!.textContent = String(quot);
      document.getElementById('ld-rem')!.textContent = String(rem);
      document.getElementById('ld-dec')!.textContent = (a / b).toFixed(6);
      document.getElementById('ld-verify')!.textContent = `Verify: ${b} × ${quot} + ${rem} = ${b * quot + rem}`;
      const digits = String(a).split('');
      const steps: string[] = [];
      let carry = 0;
      steps.push(`Divide ${a} by ${b}:`);
      for (let i = 0; i < digits.length; i++) {
        carry = carry * 10 + parseInt(digits[i]);
        const q = Math.floor(carry / b);
        const product = q * b;
        const remainder = carry - product;
        steps.push(`  Bring down ${digits[i]} → ${carry}`);
        steps.push(`  ${carry} ÷ ${b} = ${q}, remainder ${remainder}`);
        carry = remainder;
      }
      steps.push(`Final: Quotient = ${quot}, Remainder = ${rem}`);
      document.getElementById('ld-steps')!.innerHTML = steps.map(s => `<div>${s}</div>`).join('');
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => { document.querySelectorAll('.ld-in').forEach(el => el.addEventListener('input', calcLD)); calcLD(); }, 50);
  </script>
</CalculatorLayout>
