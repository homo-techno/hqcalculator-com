---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Well Water Calculator - Yield, Recovery & Storage";
const description = "Calculate well yield from pump test data, recovery rate, daily usage capacity, and optimal storage tank sizing for residential and agricultural wells.";
const relatedCalcs = [
  { name: "Irrigation Calculator", url: "/irrigation-calculator", description: "Irrigation water needs." },
  { name: "Rain Harvest", url: "/rain-harvest-calculator", description: "Rainwater collection estimates." },
  { name: "Livestock Water", url: "/livestock-water-calculator", description: "Daily water needs for livestock." },
  { name: "Pool Volume", url: "/pool-volume-calculator", description: "Pool water volume." },
  { name: "Volume Calculator", url: "/volume-calculator", description: "General volume calculations." },
  { name: "Budget Calculator", url: "/budget-calculator", description: "Plan your budget." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Well Water Calculator" keywords="well water calculator, well yield, pump test, recovery rate, storage tank, well capacity, GPM" breadcrumbs={[{ name: "Well Water", url: "/well-water-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Well Water Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Analyze well yield, recovery rate, and size your storage system properly.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="block text-xs font-medium text-text mb-1">Well Depth (feet)</label>
            <input type="number" id="ww-depth" class="ww-in w-full px-4 py-3 border border-border rounded-xl text-2xl font-bold" value="200" min="10" max="2000" step="10">
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Static Water Level (feet)</label>
            <input type="number" id="ww-static" class="ww-in w-full px-4 py-3 border border-border rounded-xl text-2xl font-bold" value="50" min="0" max="1000" step="5">
          </div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="block text-xs font-medium text-text mb-1">Pumping Rate (GPM)</label>
            <input type="number" id="ww-gpm" class="ww-in w-full px-4 py-3 border border-border rounded-xl text-2xl font-bold" value="5" min="0.5" max="100" step="0.5">
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Drawdown Level (feet)</label>
            <input type="number" id="ww-draw" class="ww-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="80" min="0" max="1000" step="5">
          </div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="block text-xs font-medium text-text mb-1">Casing Diameter (inches)</label>
            <select id="ww-casing" class="ww-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
              <option value="4">4 inch</option>
              <option value="6" selected>6 inch</option>
              <option value="8">8 inch</option>
            </select>
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Daily Usage (gallons)</label>
            <input type="number" id="ww-daily" class="ww-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="500" min="50" max="50000" step="50">
          </div>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Peak Demand (GPM)</label>
          <input type="number" id="ww-peak" class="ww-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="10" min="1" max="100" step="1">
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Sustainable Yield</div>
          <div class="text-5xl font-extrabold font-mono" id="ww-yield">--</div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Daily Capacity</div>
            <div class="text-xl font-bold font-mono" id="ww-cap">--</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Recovery Rate</div>
            <div class="text-xl font-bold font-mono" id="ww-recov">--</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Well Storage (gal)</div>
            <div class="text-xl font-bold font-mono" id="ww-store">--</div>
          </div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Tank Size Needed</div>
            <div class="text-xl font-bold font-mono" id="ww-tank">--</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Pump Run Time/Day</div>
            <div class="text-xl font-bold font-mono" id="ww-runtime">--</div>
          </div>
        </div>
      </div>
      <ShareButton calculatorId="well-water" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcWW() {
      const depth = parseFloat((document.getElementById('ww-depth') as HTMLInputElement).value) || 200;
      const staticLevel = parseFloat((document.getElementById('ww-static') as HTMLInputElement).value) || 50;
      const gpm = parseFloat((document.getElementById('ww-gpm') as HTMLInputElement).value) || 5;
      const drawdown = parseFloat((document.getElementById('ww-draw') as HTMLInputElement).value) || 80;
      const casing = parseFloat((document.getElementById('ww-casing') as HTMLSelectElement).value) || 6;
      const dailyUse = parseFloat((document.getElementById('ww-daily') as HTMLInputElement).value) || 500;
      const peakDemand = parseFloat((document.getElementById('ww-peak') as HTMLInputElement).value) || 10;
      const drawdownDist = drawdown - staticLevel;
      const specificCapacity = drawdownDist > 0 ? gpm / drawdownDist : gpm;
      const sustainableYield = specificCapacity * (depth - staticLevel) * 0.5;
      const sustainGPM = Math.min(gpm, sustainableYield / 60);
      const dailyCap = sustainGPM * 60 * 24;
      const recoveryGPM = specificCapacity * drawdownDist * 0.1;
      const casingRadiusFt = casing / 24;
      const wellStorageHeight = depth - staticLevel;
      const wellStorageGal = Math.PI * casingRadiusFt * casingRadiusFt * wellStorageHeight * 7.48;
      const pumpRunTime = dailyUse / (gpm * 60);
      const tankSize = peakDemand > gpm ? (peakDemand - gpm) * 30 : dailyUse * 0.25;
      document.getElementById('ww-yield')!.textContent = sustainGPM.toFixed(1) + ' GPM';
      document.getElementById('ww-cap')!.textContent = Math.round(dailyCap).toLocaleString() + ' gal';
      document.getElementById('ww-recov')!.textContent = recoveryGPM.toFixed(1) + ' GPM';
      document.getElementById('ww-store')!.textContent = Math.round(wellStorageGal).toLocaleString();
      document.getElementById('ww-tank')!.textContent = Math.round(tankSize).toLocaleString() + ' gal';
      document.getElementById('ww-runtime')!.textContent = pumpRunTime.toFixed(1) + ' hrs';
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.ww-in').forEach(el => { el.addEventListener('input', calcWW); el.addEventListener('change', calcWW); });
      calcWW();
    }, 50);
  </script>
</CalculatorLayout>
