---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Golden Ratio Calculator - Phi, Rule of Thirds & Fibonacci Spiral";
const description = "Calculate golden ratio and rule of thirds grid positions from image dimensions. Explore Fibonacci spiral and phi applications in visual composition.";
const relatedCalcs = [
  { name: "Aspect Ratio", url: "/aspect-ratio-calculator", description: "Image aspect ratios." },
  { name: "Ratio Calculator", url: "/ratio-calculator", description: "General ratio math." },
  { name: "Print Size", url: "/print-size-calculator", description: "Print dimensions." },
  { name: "Percentage", url: "/percentage-calculator", description: "Percentage calculations." },
  { name: "Area Calculator", url: "/area-calculator", description: "Area calculations." },
  { name: "Scientific Calculator", url: "/scientific-calculator", description: "Advanced math." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Golden Ratio Calculator" keywords="golden ratio calculator, phi, fibonacci spiral, rule of thirds, composition grid, golden section, 1.618" breadcrumbs={[{ name: "Golden Ratio", url: "/golden-ratio-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Golden Ratio Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate golden ratio grid lines, Fibonacci proportions, and rule of thirds positions for image composition.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-text mb-1">Calculation Mode</label>
          <select id="go-mode" class="go-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="image" selected>Image Composition Grid</option>
            <option value="value">Golden Ratio from Value</option>
          </select>
        </div>

        <div id="go-image-inputs">
          <div class="grid grid-cols-2 gap-3">
            <div>
              <label class="block text-sm font-medium text-text mb-1">Image Width (px)</label>
              <input type="number" id="go-width" class="go-in w-full px-4 py-3 border border-border rounded-xl text-lg" value="1920" min="1" step="1">
            </div>
            <div>
              <label class="block text-sm font-medium text-text mb-1">Image Height (px)</label>
              <input type="number" id="go-height" class="go-in w-full px-4 py-3 border border-border rounded-xl text-lg" value="1080" min="1" step="1">
            </div>
          </div>
        </div>

        <div id="go-value-inputs" style="display:none">
          <div>
            <label class="block text-sm font-medium text-text mb-1">Enter a Value</label>
            <input type="number" id="go-value" class="go-in w-full px-4 py-3 border border-border rounded-xl text-lg" value="100" min="0.001" step="any">
          </div>
        </div>

        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Golden Ratio (\u03C6)</div>
          <div class="text-4xl font-extrabold" id="go-phi">1.6180339887</div>
        </div>

        <div id="go-image-results">
          <div class="p-4 bg-surface-alt rounded-xl mb-3">
            <h4 class="font-semibold text-sm text-text mb-2">Golden Ratio Grid Lines</h4>
            <div class="grid grid-cols-2 gap-2 text-sm">
              <div>
                <div class="text-text-secondary">Vertical Left</div>
                <div class="font-bold text-text" id="go-vl"></div>
              </div>
              <div>
                <div class="text-text-secondary">Vertical Right</div>
                <div class="font-bold text-text" id="go-vr"></div>
              </div>
              <div>
                <div class="text-text-secondary">Horizontal Top</div>
                <div class="font-bold text-text" id="go-ht"></div>
              </div>
              <div>
                <div class="text-text-secondary">Horizontal Bottom</div>
                <div class="font-bold text-text" id="go-hb"></div>
              </div>
            </div>
          </div>

          <div class="p-4 bg-surface-alt rounded-xl mb-3">
            <h4 class="font-semibold text-sm text-text mb-2">Rule of Thirds Grid Lines</h4>
            <div class="grid grid-cols-2 gap-2 text-sm">
              <div>
                <div class="text-text-secondary">Vertical Lines</div>
                <div class="font-bold text-text" id="go-tv"></div>
              </div>
              <div>
                <div class="text-text-secondary">Horizontal Lines</div>
                <div class="font-bold text-text" id="go-th"></div>
              </div>
            </div>
          </div>

          <div class="p-4 bg-surface-alt rounded-xl mb-3">
            <h4 class="font-semibold text-sm text-text mb-2">Power Points (Golden Intersections)</h4>
            <div class="text-sm text-text-secondary space-y-1" id="go-points"></div>
          </div>
        </div>

        <div id="go-value-results" style="display:none">
          <div class="grid grid-cols-2 gap-3">
            <div class="p-4 bg-surface-alt rounded-xl text-center">
              <div class="text-xs text-text-secondary uppercase tracking-wide">Value x \u03C6</div>
              <div class="text-xl font-bold text-text" id="go-mult"></div>
            </div>
            <div class="p-4 bg-surface-alt rounded-xl text-center">
              <div class="text-xs text-text-secondary uppercase tracking-wide">Value / \u03C6</div>
              <div class="text-xl font-bold text-text" id="go-div"></div>
            </div>
            <div class="p-4 bg-surface-alt rounded-xl text-center">
              <div class="text-xs text-text-secondary uppercase tracking-wide">Larger Segment</div>
              <div class="text-xl font-bold text-text" id="go-larger"></div>
            </div>
            <div class="p-4 bg-surface-alt rounded-xl text-center">
              <div class="text-xs text-text-secondary uppercase tracking-wide">Smaller Segment</div>
              <div class="text-xl font-bold text-text" id="go-smaller"></div>
            </div>
          </div>

          <div class="p-4 bg-surface-alt rounded-xl mt-3">
            <h4 class="font-semibold text-sm text-text mb-2">Fibonacci Sequence near Value</h4>
            <div class="text-sm text-text-secondary" id="go-fib"></div>
          </div>
        </div>
      </div>
      <ShareButton calculatorId="golden-ratio" />
      <FeedbackWidget />
    </div>

    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">The Golden Ratio in Visual Arts</h2>
      <p>The golden ratio (phi, \u03C6 = 1.618...) appears throughout nature and has been used in art and architecture for centuries. It provides aesthetically pleasing proportions for composition.</p>
      <p><strong>Rule of Thirds vs. Golden Ratio:</strong> The rule of thirds places lines at 33%, while the golden ratio places them at approximately 38.2%. Both create visually balanced compositions.</p>
    </article>

    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    const PHI = (1 + Math.sqrt(5)) / 2;

    function calcGO() {
      const mode = (document.getElementById('go-mode') as HTMLSelectElement).value;

      document.getElementById('go-phi')!.textContent = PHI.toFixed(10);

      if (mode === 'image') {
        document.getElementById('go-image-inputs')!.style.display = '';
        document.getElementById('go-value-inputs')!.style.display = 'none';
        document.getElementById('go-image-results')!.style.display = '';
        document.getElementById('go-value-results')!.style.display = 'none';

        const w = parseInt((document.getElementById('go-width') as HTMLInputElement).value) || 1920;
        const h = parseInt((document.getElementById('go-height') as HTMLInputElement).value) || 1080;

        const gvl = Math.round(w / PHI);
        const gvr = Math.round(w - w / PHI);
        const ght = Math.round(h / PHI);
        const ghb = Math.round(h - h / PHI);

        document.getElementById('go-vl')!.textContent = gvr + 'px (' + (gvr / w * 100).toFixed(1) + '%)';
        document.getElementById('go-vr')!.textContent = gvl + 'px (' + (gvl / w * 100).toFixed(1) + '%)';
        document.getElementById('go-ht')!.textContent = ghb + 'px (' + (ghb / h * 100).toFixed(1) + '%)';
        document.getElementById('go-hb')!.textContent = ght + 'px (' + (ght / h * 100).toFixed(1) + '%)';

        const t1 = Math.round(w / 3);
        const t2 = Math.round(2 * w / 3);
        const t3 = Math.round(h / 3);
        const t4 = Math.round(2 * h / 3);
        document.getElementById('go-tv')!.textContent = t1 + 'px, ' + t2 + 'px';
        document.getElementById('go-th')!.textContent = t3 + 'px, ' + t4 + 'px';

        const points = [
          [gvr, ghb], [gvl, ghb], [gvr, ght], [gvl, ght]
        ];
        let html = '';
        points.forEach((p, i) => {
          html += '<div>Point ' + (i + 1) + ': (' + p[0] + ', ' + p[1] + ') px</div>';
        });
        document.getElementById('go-points')!.innerHTML = html;

      } else {
        document.getElementById('go-image-inputs')!.style.display = 'none';
        document.getElementById('go-value-inputs')!.style.display = '';
        document.getElementById('go-image-results')!.style.display = 'none';
        document.getElementById('go-value-results')!.style.display = '';

        const val = parseFloat((document.getElementById('go-value') as HTMLInputElement).value) || 100;

        document.getElementById('go-mult')!.textContent = (val * PHI).toFixed(4);
        document.getElementById('go-div')!.textContent = (val / PHI).toFixed(4);
        document.getElementById('go-larger')!.textContent = (val / PHI).toFixed(4);
        document.getElementById('go-smaller')!.textContent = (val - val / PHI).toFixed(4);

        // Fibonacci near value
        let fib = [1, 1];
        while (fib[fib.length - 1] < val * 5) {
          fib.push(fib[fib.length - 1] + fib[fib.length - 2]);
        }
        const nearby = fib.filter(f => f >= val * 0.1 && f <= val * 10);
        document.getElementById('go-fib')!.textContent = nearby.join(', ');
      }

      document.dispatchEvent(new CustomEvent('calc-update'));
    }

    setTimeout(() => {
      document.querySelectorAll('.go-in').forEach(el => {
        el.addEventListener('input', calcGO);
        el.addEventListener('change', calcGO);
      });
      calcGO();
    }, 50);
  </script>
</CalculatorLayout>
