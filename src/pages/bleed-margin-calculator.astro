---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Bleed & Margin Calculator - Print Bleed, Trim & Safe Area";
const description = "Calculate print bleed, trim size, and safe area dimensions for various print formats. Essential for prepress and design setup.";
const relatedCalcs = [
  { name: "Poster Size Calculator", url: "/poster-size-calculator", description: "Poster dimensions and DPI." },
  { name: "Print Resolution Calculator", url: "/print-resolution-calculator", description: "DPI/PPI calculations." },
  { name: "Paper Fold Calculator", url: "/paper-fold-calculator", description: "Fold types and panel sizes." },
  { name: "Magazine Layout Calculator", url: "/magazine-layout-calculator", description: "Magazine page planning." },
  { name: "Business Card Calculator", url: "/business-card-calculator", description: "Business card printing." },
  { name: "Envelope Calculator", url: "/envelope-calculator", description: "Envelope sizes and printing." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Bleed & Margin Calculator" keywords="print bleed, trim size, safe area, margin calculator, prepress, bleed margin, design setup, print area" breadcrumbs={[{ name: "Bleed & Margin Calculator", url: "/bleed-margin-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Bleed & Margin Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate bleed, trim, and safe area dimensions for print jobs. Get the correct document size with bleeds for your printer or print shop.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div><label class="block text-xs font-medium text-text mb-1">Preset Format</label>
          <select id="bm2-preset" class="bm2-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="custom">Custom Size</option>
            <option value="letter">US Letter (8.5 x 11 in)</option>
            <option value="a4">A4 (210 x 297 mm)</option>
            <option value="a5">A5 (148 x 210 mm)</option>
            <option value="6x9">Trade Book (6 x 9 in)</option>
            <option value="5.5x8.5">Digest (5.5 x 8.5 in)</option>
            <option value="bcard">Business Card (3.5 x 2 in)</option>
            <option value="postcard">Postcard (6 x 4 in)</option>
          </select>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Trim Width (inches)</label><input type="number" id="bm2-width" class="bm2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="0" step="0.125"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Trim Height (inches)</label><input type="number" id="bm2-height" class="bm2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="0" step="0.125"></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Bleed Size (inches)</label><input type="number" id="bm2-bleed" class="bm2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="0" step="0.0625"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Safe Margin (inches)</label><input type="number" id="bm2-safe" class="bm2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" min="0" step="0.0625"></div>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Document Size (with Bleed)</div>
          <div class="text-4xl font-extrabold font-mono" id="bm2-result">0 x 0 in</div>
          <div class="text-sm text-blue-200 mt-1" id="bm2-resultmm"></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Trim Size</div><div class="text-lg font-bold" id="bm2-trimsize">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Safe Area</div><div class="text-lg font-bold" id="bm2-safearea">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Bleed Area (total)</div><div class="text-lg font-bold" id="bm2-bleedarea">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">DPI for Quality</div><div class="text-lg font-bold" id="bm2-pixels">--</div></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-2">Dimensions Summary</h3>
          <div class="font-mono text-sm space-y-1" id="bm2-steps"></div>
        </div>
      </div>
      <ShareButton calculatorId="bleed-margin" />
      <FeedbackWidget />
    </div>
    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">Understanding Print Bleeds</h2>
      <div class="bg-surface-alt rounded-xl p-4 my-4 font-mono text-sm space-y-1">
        <p>Bleed: Area beyond trim that gets cut off. Standard: 0.125 in (3mm).</p>
        <p>Trim: Final cut size of the printed piece.</p>
        <p>Safe Area: Area inside trim where all important content should stay.</p>
        <p>Document Size = Trim + (2 x Bleed) on each dimension.</p>
      </div>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcBm2() {
      const preset = (document.getElementById('bm2-preset') as HTMLSelectElement).value;
      const presets: Record<string, [number, number]> = {
        letter: [8.5, 11], a4: [8.268, 11.693], a5: [5.827, 8.268],
        '6x9': [6, 9], '5.5x8.5': [5.5, 8.5], bcard: [3.5, 2], postcard: [6, 4]
      };
      if (preset !== 'custom' && presets[preset]) {
        (document.getElementById('bm2-width') as HTMLInputElement).value = presets[preset][0].toString();
        (document.getElementById('bm2-height') as HTMLInputElement).value = presets[preset][1].toString();
      }
      const trimW = parseFloat((document.getElementById('bm2-width') as HTMLInputElement).value) || 0;
      const trimH = parseFloat((document.getElementById('bm2-height') as HTMLInputElement).value) || 0;
      const bleed = parseFloat((document.getElementById('bm2-bleed') as HTMLInputElement).value) || 0;
      const safe = parseFloat((document.getElementById('bm2-safe') as HTMLInputElement).value) || 0;
      const docW = trimW + 2 * bleed;
      const docH = trimH + 2 * bleed;
      const safeW = trimW - 2 * safe;
      const safeH = trimH - 2 * safe;
      const docWmm = docW * 25.4;
      const docHmm = docH * 25.4;
      const pixW = Math.ceil(docW * 300);
      const pixH = Math.ceil(docH * 300);
      const steps: string[] = [];
      steps.push('Trim: ' + trimW.toFixed(3) + ' x ' + trimH.toFixed(3) + ' in');
      steps.push('Bleed (each side): ' + bleed.toFixed(3) + ' in (' + (bleed * 25.4).toFixed(1) + ' mm)');
      steps.push('Document: ' + docW.toFixed(3) + ' x ' + docH.toFixed(3) + ' in');
      steps.push('Document (mm): ' + docWmm.toFixed(1) + ' x ' + docHmm.toFixed(1) + ' mm');
      steps.push('Safe area: ' + safeW.toFixed(3) + ' x ' + safeH.toFixed(3) + ' in');
      steps.push('At 300 DPI: ' + pixW + ' x ' + pixH + ' pixels');
      document.getElementById('bm2-result')!.textContent = docW.toFixed(3) + ' x ' + docH.toFixed(3) + ' in';
      document.getElementById('bm2-resultmm')!.textContent = docWmm.toFixed(1) + ' x ' + docHmm.toFixed(1) + ' mm';
      document.getElementById('bm2-trimsize')!.textContent = trimW.toFixed(3) + ' x ' + trimH.toFixed(3) + ' in';
      document.getElementById('bm2-safearea')!.textContent = safeW.toFixed(3) + ' x ' + safeH.toFixed(3) + ' in';
      document.getElementById('bm2-bleedarea')!.textContent = bleed.toFixed(3) + ' in each side';
      document.getElementById('bm2-pixels')!.textContent = pixW + ' x ' + pixH + ' px';
      document.getElementById('bm2-steps')!.innerHTML = steps.map(s => '<div>' + s + '</div>').join('');
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      (document.getElementById('bm2-width') as HTMLInputElement).value = '8.5';
      (document.getElementById('bm2-height') as HTMLInputElement).value = '11';
      (document.getElementById('bm2-bleed') as HTMLInputElement).value = '0.125';
      (document.getElementById('bm2-safe') as HTMLInputElement).value = '0.25';
      document.querySelectorAll('.bm2-in').forEach(el => { el.addEventListener('input', calcBm2); el.addEventListener('change', calcBm2); });
      calcBm2();
    }, 50);
  </script>
</CalculatorLayout>
