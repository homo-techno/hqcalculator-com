---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Heat Index Calculator - Feels Like Temperature";
const description = "Calculate the heat index (apparent temperature) from air temperature and relative humidity.";
const relatedCalcs = [
  { name: "Wind Chill", url: "/wind-chill-calculator", description: "Wind chill." },
  { name: "Temperature Converter", url: "/temperature-converter", description: "Temperature." },
  { name: "BTU Calculator", url: "/btu-calculator", description: "BTU." },
  { name: "Water Intake", url: "/water-intake-calculator", description: "Water." },
  { name: "Calories Burned", url: "/calories-burned-calculator", description: "Cal burned." },
  { name: "Speed Calculator", url: "/speed-calculator", description: "Speed." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Heat Index Calculator" keywords="heat index calculator, feels like temperature, apparent temperature, humidity index, heat danger" breadcrumbs={[{ name: "Heat Index", url: "/heat-index-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Heat Index Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate what the temperature "feels like" with humidity.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="grid grid-cols-2 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Temperature (°F)</label><input type="number" id="hi-temp" class="hi-in w-full px-4 py-3 border border-border rounded-xl text-2xl font-bold" value="95" min="60" max="130" step="1"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Humidity (%)</label><input type="number" id="hi-hum" class="hi-in w-full px-4 py-3 border border-border rounded-xl text-2xl font-bold" value="60" min="0" max="100" step="1"></div>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Heat Index (Feels Like)</div>
          <div class="text-5xl font-extrabold font-mono" id="hi-result">0°F</div>
        </div>
        <div class="p-4 rounded-xl text-center" id="hi-danger-box">
          <div class="font-bold text-sm" id="hi-danger">-</div>
          <div class="text-xs mt-1" id="hi-effects">-</div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Heat Index (°C)</div><div class="text-xl font-bold font-mono" id="hi-celsius">0°C</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Increase</div><div class="text-xl font-bold font-mono" id="hi-inc">+0°F</div></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-2">NWS Heat Index Scale</h3>
          <div class="text-xs space-y-1">
            <div class="flex gap-2"><span class="w-3 h-3 rounded bg-yellow-400 flex-shrink-0 mt-0.5"></span>Caution: 80-90°F — Fatigue possible</div>
            <div class="flex gap-2"><span class="w-3 h-3 rounded bg-orange-400 flex-shrink-0 mt-0.5"></span>Extreme Caution: 90-103°F — Heat cramps/exhaustion</div>
            <div class="flex gap-2"><span class="w-3 h-3 rounded bg-red-400 flex-shrink-0 mt-0.5"></span>Danger: 103-124°F — Heat stroke likely</div>
            <div class="flex gap-2"><span class="w-3 h-3 rounded bg-red-700 flex-shrink-0 mt-0.5"></span>Extreme Danger: 125°F+ — Heat stroke imminent</div>
          </div>
        </div>
      </div>
      <ShareButton calculatorId="heat-index" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcHI() {
      const t = parseFloat((document.getElementById('hi-temp') as HTMLInputElement).value) || 80;
      const rh = parseFloat((document.getElementById('hi-hum') as HTMLInputElement).value) || 40;
      let hi = 0.5 * (t + 61.0 + ((t - 68.0) * 1.2) + (rh * 0.094));
      if (hi >= 80) {
        hi = -42.379 + 2.04901523*t + 10.14333127*rh - 0.22475541*t*rh
          - 0.00683783*t*t - 0.05481717*rh*rh + 0.00122874*t*t*rh
          + 0.00085282*t*rh*rh - 0.00000199*t*t*rh*rh;
        if (rh < 13 && t >= 80 && t <= 112) hi -= ((13 - rh) / 4) * Math.sqrt((17 - Math.abs(t - 95)) / 17);
        if (rh > 85 && t >= 80 && t <= 87) hi += ((rh - 85) / 10) * ((87 - t) / 5);
      }
      const hiC = (hi - 32) * 5 / 9;
      document.getElementById('hi-result')!.textContent = hi.toFixed(1) + '°F';
      document.getElementById('hi-celsius')!.textContent = hiC.toFixed(1) + '°C';
      document.getElementById('hi-inc')!.textContent = '+' + (hi - t).toFixed(1) + '°F';
      let danger: string, effects: string, color: string;
      if (hi < 80) { danger = 'Normal'; effects = 'No heat-related concerns'; color = 'bg-green-50 text-green-800'; }
      else if (hi < 90) { danger = 'Caution'; effects = 'Fatigue possible with prolonged exposure'; color = 'bg-yellow-50 text-yellow-800'; }
      else if (hi < 103) { danger = 'Extreme Caution'; effects = 'Heat cramps and exhaustion possible'; color = 'bg-orange-50 text-orange-800'; }
      else if (hi < 125) { danger = 'Danger'; effects = 'Heat cramps, exhaustion likely; heat stroke possible'; color = 'bg-red-50 text-red-800'; }
      else { danger = 'Extreme Danger'; effects = 'Heat stroke highly likely'; color = 'bg-red-100 text-red-900'; }
      document.getElementById('hi-danger')!.textContent = danger;
      document.getElementById('hi-effects')!.textContent = effects;
      document.getElementById('hi-danger-box')!.className = `p-4 rounded-xl text-center ${color}`;
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => { document.querySelectorAll('.hi-in').forEach(el => el.addEventListener('input', calcHI)); calcHI(); }, 50);
  </script>
</CalculatorLayout>
