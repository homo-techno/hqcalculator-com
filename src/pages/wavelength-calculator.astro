---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Wavelength Calculator - Frequency, Wavelength & Wave Speed";
const description = "Calculate wavelength, frequency, or wave speed. Supports electromagnetic waves, sound waves, and custom speeds.";
const relatedCalcs = [
  { name: "Ohm's Law", url: "/ohms-law-calculator", description: "Electrical." },
  { name: "Scientific Calculator", url: "/scientific-calculator", description: "Scientific math." },
  { name: "Scientific Notation", url: "/scientific-notation-calculator", description: "Sci notation." },
  { name: "Acceleration", url: "/acceleration-calculator", description: "Acceleration." },
  { name: "Logarithm Calculator", url: "/logarithm-calculator", description: "Logarithms." },
  { name: "Unit Converter", url: "/length-converter", description: "Length units." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Wavelength Calculator" keywords="wavelength calculator, frequency to wavelength, wave speed, electromagnetic spectrum, sound waves" breadcrumbs={[{ name: "Wavelength Calculator", url: "/wavelength-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Wavelength Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate wavelength, frequency, or speed using the wave equation: v = fλ.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div>
          <label class="block text-xs font-medium text-text mb-1">Solve For</label>
          <select id="wl-solve" class="w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="wavelength" selected>Wavelength (λ)</option>
            <option value="frequency">Frequency (f)</option>
            <option value="speed">Wave Speed (v)</option>
          </select>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Wave Type</label>
          <div class="flex gap-2">
            <button class="wl-type px-3 py-2 rounded-lg text-sm font-semibold border-2 border-primary bg-blue-50 text-primary" data-speed="299792458">Light (c)</button>
            <button class="wl-type px-3 py-2 rounded-lg text-sm font-semibold border-2 border-border text-text-muted" data-speed="343">Sound (air)</button>
            <button class="wl-type px-3 py-2 rounded-lg text-sm font-semibold border-2 border-border text-text-muted" data-speed="1480">Sound (water)</button>
            <button class="wl-type px-3 py-2 rounded-lg text-sm font-semibold border-2 border-border text-text-muted" data-speed="0">Custom</button>
          </div>
        </div>
        <div class="grid grid-cols-2 gap-3" id="wl-inputs">
          <div id="wl-freq-wrap">
            <label class="block text-xs font-medium text-text mb-1">Frequency</label>
            <div class="flex gap-1">
              <input type="number" id="wl-freq" class="wl-in flex-1 px-3 py-3 border border-border rounded-xl text-lg font-bold" value="100" min="0" step="1">
              <select id="wl-funit" class="wl-in px-2 py-3 border border-border rounded-xl text-sm">
                <option value="1">Hz</option><option value="1000">kHz</option><option value="1e6" selected>MHz</option><option value="1e9">GHz</option><option value="1e12">THz</option>
              </select>
            </div>
          </div>
          <div id="wl-speed-wrap">
            <label class="block text-xs font-medium text-text mb-1">Speed (m/s)</label>
            <input type="number" id="wl-speed" class="wl-in w-full px-3 py-3 border border-border rounded-xl text-lg font-bold" value="299792458" step="1">
          </div>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1" id="wl-label">Wavelength</div>
          <div class="text-4xl font-extrabold font-mono" id="wl-result">0</div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Wavelength</div><div class="text-lg font-bold font-mono" id="wl-wl">-</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Frequency</div><div class="text-lg font-bold font-mono" id="wl-fr">-</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Period</div><div class="text-lg font-bold font-mono" id="wl-per">-</div></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl" id="wl-spectrum-wrap">
          <h3 class="font-semibold text-sm text-text mb-2">EM Spectrum Classification</h3>
          <div class="text-lg font-bold" id="wl-spectrum">-</div>
        </div>
      </div>
      <ShareButton calculatorId="wavelength" />
      <FeedbackWidget />
    </div>
    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">Wave Equation</h2>
      <div class="bg-surface-alt rounded-xl p-4 my-4 font-mono text-sm space-y-1">
        <p>v = f × λ → λ = v / f → f = v / λ</p>
        <p>Speed of light: c ≈ 299,792,458 m/s</p>
        <p>Speed of sound in air: ≈ 343 m/s (20°C)</p>
      </div>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    let waveSpeed = 299792458;
    function fmtSI(val: number, unit: string): string {
      if (val >= 1e12) return (val/1e12).toFixed(4) + ' T' + unit;
      if (val >= 1e9) return (val/1e9).toFixed(4) + ' G' + unit;
      if (val >= 1e6) return (val/1e6).toFixed(4) + ' M' + unit;
      if (val >= 1e3) return (val/1e3).toFixed(4) + ' k' + unit;
      if (val >= 1) return val.toFixed(4) + ' ' + unit;
      if (val >= 1e-3) return (val*1e3).toFixed(4) + ' m' + unit;
      if (val >= 1e-6) return (val*1e6).toFixed(4) + ' μ' + unit;
      if (val >= 1e-9) return (val*1e9).toFixed(4) + ' n' + unit;
      return (val*1e12).toFixed(4) + ' p' + unit;
    }
    function classify(wl: number): string {
      if (wl > 1e-1) return 'Radio waves';
      if (wl > 1e-3) return 'Microwaves';
      if (wl > 7e-7) return 'Infrared';
      if (wl > 3.8e-7) return 'Visible light';
      if (wl > 1e-8) return 'Ultraviolet';
      if (wl > 1e-11) return 'X-rays';
      return 'Gamma rays';
    }
    function calcWL() {
      const solve = (document.getElementById('wl-solve') as HTMLSelectElement).value;
      const freqVal = parseFloat((document.getElementById('wl-freq') as HTMLInputElement).value) || 0;
      const freqMul = parseFloat((document.getElementById('wl-funit') as HTMLSelectElement).value);
      const speed = parseFloat((document.getElementById('wl-speed') as HTMLInputElement).value) || waveSpeed;
      const freq = freqVal * freqMul;
      let wavelength: number, frequency: number, v: number;
      if (solve === 'wavelength') {
        v = speed; frequency = freq; wavelength = freq > 0 ? v / freq : 0;
        document.getElementById('wl-label')!.textContent = 'Wavelength';
        document.getElementById('wl-result')!.textContent = fmtSI(wavelength, 'm');
      } else if (solve === 'frequency') {
        v = speed; wavelength = freqVal * freqMul; // reuse freq input as wavelength
        frequency = wavelength > 0 ? v / wavelength : 0;
        document.getElementById('wl-label')!.textContent = 'Frequency';
        document.getElementById('wl-result')!.textContent = fmtSI(frequency, 'Hz');
      } else {
        frequency = freq; wavelength = freqVal; // simplified
        v = frequency * wavelength;
        document.getElementById('wl-label')!.textContent = 'Wave Speed';
        document.getElementById('wl-result')!.textContent = v.toFixed(2) + ' m/s';
      }
      if (solve === 'wavelength') {
        document.getElementById('wl-wl')!.textContent = fmtSI(wavelength, 'm');
        document.getElementById('wl-fr')!.textContent = fmtSI(frequency, 'Hz');
        document.getElementById('wl-per')!.textContent = frequency > 0 ? fmtSI(1/frequency, 's') : '-';
        if (speed === 299792458) {
          document.getElementById('wl-spectrum')!.textContent = classify(wavelength);
          (document.getElementById('wl-spectrum-wrap') as HTMLElement).style.display = '';
        } else {
          (document.getElementById('wl-spectrum-wrap') as HTMLElement).style.display = 'none';
        }
      }
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.wl-type').forEach(btn => {
        btn.addEventListener('click', () => {
          document.querySelectorAll('.wl-type').forEach(b => b.className = 'wl-type px-3 py-2 rounded-lg text-sm font-semibold border-2 border-border text-text-muted');
          (btn as HTMLElement).className = 'wl-type px-3 py-2 rounded-lg text-sm font-semibold border-2 border-primary bg-blue-50 text-primary';
          const spd = parseFloat((btn as HTMLElement).dataset.speed || '0');
          if (spd > 0) {
            waveSpeed = spd;
            (document.getElementById('wl-speed') as HTMLInputElement).value = String(spd);
            (document.getElementById('wl-speed') as HTMLInputElement).disabled = true;
          } else {
            (document.getElementById('wl-speed') as HTMLInputElement).disabled = false;
          }
          calcWL();
        });
      });
      document.querySelectorAll('.wl-in').forEach(el => el.addEventListener('input', calcWL));
      document.getElementById('wl-solve')!.addEventListener('change', calcWL);
      calcWL();
    }, 50);
  </script>
</CalculatorLayout>
