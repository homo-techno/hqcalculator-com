---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Gratitude Journal Calculator - Practice Impact & Consistency";
const description = "Track your gratitude journaling practice. Calculate impact score, consistency rating, well-being correlation, and get recommended frequency.";
const relatedCalcs = [
  { name: "Sleep Calculator", url: "/sleep-calculator", description: "Optimize sleep cycles." },
  { name: "Calorie Calculator", url: "/calorie-calculator", description: "Daily calorie needs." },
  { name: "BMI Calculator", url: "/bmi-calculator", description: "Body mass index." },
  { name: "Age Calculator", url: "/age-calculator", description: "Calculate exact age." },
  { name: "Productivity Calculator", url: "/productivity-calculator", description: "Productivity metrics." },
  { name: "Water Intake", url: "/water-intake-calculator", description: "Daily hydration." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Gratitude Journal Calculator" keywords="gratitude journal, gratitude practice, well-being, positive psychology, gratitude impact, journaling, happiness" breadcrumbs={[{ name: "Gratitude Journal", url: "/gratitude-journal-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Gratitude Journal Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Assess the impact of your gratitude practice based on research in positive psychology.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-text mb-1">How many times per week do you journal gratitude?</label>
          <input type="number" id="gj-freq" class="gj-in w-full px-4 py-3 border border-border rounded-xl text-lg text-center" min="0" max="14" step="1">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Items per session (things you list)</label>
          <input type="number" id="gj-items" class="gj-in w-full px-4 py-3 border border-border rounded-xl text-lg text-center" min="0" max="20" step="1">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Weeks you have been practicing</label>
          <input type="number" id="gj-weeks" class="gj-in w-full px-4 py-3 border border-border rounded-xl text-lg text-center" min="0" max="520" step="1">
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Depth of reflection (1-10)</label>
          <input type="range" id="gj-depth" class="gj-in w-full" min="1" max="10" step="1">
          <div class="flex justify-between text-xs text-text-secondary"><span>Quick list (1)</span><span>Deep reflection (10)</span></div>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Current life satisfaction (1-10)</label>
          <input type="range" id="gj-satis" class="gj-in w-full" min="1" max="10" step="1">
          <div class="flex justify-between text-xs text-text-secondary"><span>Very low (1)</span><span>Very high (10)</span></div>
        </div>

        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm opacity-80">Gratitude Practice Impact Score</div>
          <div class="text-2xl font-extrabold mt-1" id="gj-impact">--</div>
        </div>

        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-secondary">Consistency Rating</div>
            <div class="text-xl font-bold text-text mt-1" id="gj-consist">--</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-secondary">Well-Being Correlation</div>
            <div class="text-xl font-bold text-text mt-1" id="gj-wellbeing">--</div>
          </div>
        </div>

        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-secondary">Total Items Recorded</div>
            <div class="text-xl font-bold text-text mt-1" id="gj-total">--</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-secondary">Recommended Frequency</div>
            <div class="text-xl font-bold text-text mt-1" id="gj-rec">--</div>
          </div>
        </div>

        <div class="p-4 bg-surface-alt rounded-xl">
          <div class="text-xs text-text-secondary mb-2">Research-Based Insights</div>
          <div class="text-sm text-text" id="gj-insights">--</div>
        </div>
      </div>

      <ShareButton calculatorId="gratitude-journal" />
      <FeedbackWidget />
    </div>

    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    function calcGJ() {
      const freq = parseInt((document.getElementById('gj-freq') as HTMLInputElement).value) || 3;
      const items = parseInt((document.getElementById('gj-items') as HTMLInputElement).value) || 3;
      const weeks = parseInt((document.getElementById('gj-weeks') as HTMLInputElement).value) || 4;
      const depth = parseInt((document.getElementById('gj-depth') as HTMLInputElement).value) || 5;
      const satis = parseInt((document.getElementById('gj-satis') as HTMLInputElement).value) || 5;

      const totalItems = freq * items * weeks;

      // Consistency rating
      let consistLabel = '';
      if (freq >= 5) consistLabel = 'Excellent (daily+)';
      else if (freq >= 3) consistLabel = 'Good (3+/week)';
      else if (freq >= 1) consistLabel = 'Fair (1-2/week)';
      else consistLabel = 'Not practicing';

      // Impact score (0-100)
      // Research: optimal is ~3x/week, 3-5 items, with depth, for 4+ weeks
      let impactScore = 0;
      const freqScore = freq === 0 ? 0 : Math.min(30, freq * 8); // max 30 at ~4x/week
      const itemScore = Math.min(20, items * 5); // max 20 at 4+ items
      const weekScore = Math.min(25, weeks * 1.5); // max 25 at ~17 weeks
      const depthScore = depth * 2.5; // max 25
      impactScore = Math.round(Math.min(100, freqScore + itemScore + weekScore + depthScore));

      // Well-being correlation (research shows ~0.3-0.5 correlation with well-being)
      const correlation = freq > 0 ? Math.min(0.5, 0.1 + (impactScore / 100) * 0.4) : 0;
      let wbLabel = '';
      if (correlation >= 0.4) wbLabel = 'Strong positive correlation';
      else if (correlation >= 0.25) wbLabel = 'Moderate positive correlation';
      else if (correlation >= 0.1) wbLabel = 'Mild positive correlation';
      else wbLabel = 'No correlation (not practicing)';

      // Recommended frequency
      let recFreq = '3 times per week';
      if (freq >= 7) recFreq = 'Consider 3-5x/week (daily can reduce novelty)';
      else if (freq >= 3) recFreq = 'Your frequency is in the optimal range';
      else recFreq = '3 times per week (research-optimal)';

      document.getElementById('gj-impact')!.textContent = impactScore + ' / 100';
      document.getElementById('gj-consist')!.textContent = consistLabel;
      document.getElementById('gj-wellbeing')!.textContent = wbLabel;
      document.getElementById('gj-total')!.textContent = totalItems.toLocaleString() + ' items';
      document.getElementById('gj-rec')!.textContent = recFreq;

      let insights: string[] = [];
      if (freq > 5) insights.push('Research (Lyubomirsky, 2005) found journaling 1-3x/week may be more beneficial than daily, as it prevents the practice from feeling routine.');
      if (items < 3) insights.push('Aim for 3-5 items per session. Specificity matters more than quantity - detail why each item matters.');
      if (depth < 5) insights.push('Deeper reflection increases impact. Instead of just listing items, explain why you are grateful and how it affects your life.');
      if (weeks < 4) insights.push('Benefits typically become measurable after 3-4 weeks of consistent practice. Keep going!');
      if (weeks >= 8) insights.push('After 8+ weeks, gratitude journaling has been shown to improve sleep quality, reduce depressive symptoms, and increase prosocial behavior.');
      if (satis < 5) insights.push('People with lower baseline satisfaction often see the greatest gains from gratitude practices (Emmons & McCullough, 2003).');
      if (insights.length === 0) insights.push('Your gratitude practice is well-structured. Research shows sustained practice correlates with 10-25% improvements in life satisfaction measures.');

      document.getElementById('gj-insights')!.textContent = insights.join(' ');

      document.dispatchEvent(new CustomEvent('calc-update'));
    }

    setTimeout(() => {
      (document.getElementById('gj-freq') as HTMLInputElement).value = '3';
      (document.getElementById('gj-items') as HTMLInputElement).value = '3';
      (document.getElementById('gj-weeks') as HTMLInputElement).value = '4';
      (document.getElementById('gj-depth') as HTMLInputElement).value = '5';
      (document.getElementById('gj-satis') as HTMLInputElement).value = '5';
      document.querySelectorAll('.gj-in').forEach(el => {
        el.addEventListener('input', calcGJ);
        el.addEventListener('change', calcGJ);
      });
      calcGJ();
    }, 50);
  </script>
</CalculatorLayout>
