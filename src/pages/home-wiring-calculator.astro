---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Home Wiring Calculator - Wire Quantity & Material Cost";
const description = "Calculate wire quantity by room type, total rolls needed, conduit footage, and material costs for your home wiring project.";
const relatedCalcs = [
  { name: "Wire Gauge", url: "/wire-gauge-calculator", description: "Wire sizing." },
  { name: "Electrical Load", url: "/electrical-load-calculator", description: "Panel loads." },
  { name: "Ohm's Law", url: "/ohms-law-calculator", description: "Voltage, current, resistance." },
  { name: "Electricity Cost", url: "/electricity-cost-calculator", description: "Energy costs." },
  { name: "Square Footage", url: "/square-footage-calculator", description: "Area calculation." },
  { name: "Concrete", url: "/concrete-calculator", description: "Concrete volume." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Home Wiring Calculator" keywords="home wiring calculator, electrical wire quantity, wire rolls, conduit footage, wiring material cost, romex NM cable" breadcrumbs={[{ name: "Home Wiring", url: "/home-wiring-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Home Wiring Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Estimate wire quantities, conduit, and material costs for residential wiring projects.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-2">Room Counts</h3>
          <div class="grid grid-cols-2 gap-2">
            <div><label class="block text-xs text-text-muted">Bedrooms</label><input type="number" id="hw3-bed" class="hw3-in w-full px-2 py-2 border border-border rounded-xl text-lg font-bold text-center" value="3" min="0"></div>
            <div><label class="block text-xs text-text-muted">Bathrooms</label><input type="number" id="hw3-bath" class="hw3-in w-full px-2 py-2 border border-border rounded-xl text-lg font-bold text-center" value="2" min="0"></div>
            <div><label class="block text-xs text-text-muted">Kitchen</label><input type="number" id="hw3-kit" class="hw3-in w-full px-2 py-2 border border-border rounded-xl text-lg font-bold text-center" value="1" min="0"></div>
            <div><label class="block text-xs text-text-muted">Living/Dining Rooms</label><input type="number" id="hw3-living" class="hw3-in w-full px-2 py-2 border border-border rounded-xl text-lg font-bold text-center" value="2" min="0"></div>
            <div><label class="block text-xs text-text-muted">Garage</label><input type="number" id="hw3-garage" class="hw3-in w-full px-2 py-2 border border-border rounded-xl text-lg font-bold text-center" value="1" min="0"></div>
            <div><label class="block text-xs text-text-muted">Basement/Utility</label><input type="number" id="hw3-base" class="hw3-in w-full px-2 py-2 border border-border rounded-xl text-lg font-bold text-center" value="1" min="0"></div>
          </div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="block text-xs font-medium text-text mb-1">Avg. Run Length (feet)</label>
            <input type="number" id="hw3-run" class="hw3-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="40" min="10" step="5">
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Wire Price ($/ft for 14/2 NM)</label>
            <input type="number" id="hw3-price" class="hw3-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="0.45" min="0.1" step="0.05">
          </div>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Total Wire Needed</div>
          <div class="text-5xl font-extrabold font-mono" id="hw3-result">0 ft</div>
          <div class="text-sm text-blue-200 mt-1" id="hw3-note">-</div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Total Circuits</div>
            <div class="text-xl font-bold font-mono" id="hw3-circuits">0</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">250ft Rolls</div>
            <div class="text-xl font-bold font-mono" id="hw3-rolls">0</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Est. Material Cost</div>
            <div class="text-xl font-bold font-mono" id="hw3-cost">$0</div>
          </div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-2">Wire Breakdown by Type</h3>
          <div class="text-xs space-y-1" id="hw3-breakdown"></div>
        </div>
      </div>
      <ShareButton calculatorId="home-wiring" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcHW3() {
      const beds = parseInt((document.getElementById('hw3-bed') as HTMLInputElement).value) || 0;
      const baths = parseInt((document.getElementById('hw3-bath') as HTMLInputElement).value) || 0;
      const kit = parseInt((document.getElementById('hw3-kit') as HTMLInputElement).value) || 0;
      const living = parseInt((document.getElementById('hw3-living') as HTMLInputElement).value) || 0;
      const garage = parseInt((document.getElementById('hw3-garage') as HTMLInputElement).value) || 0;
      const base = parseInt((document.getElementById('hw3-base') as HTMLInputElement).value) || 0;
      const avgRun = parseFloat((document.getElementById('hw3-run') as HTMLInputElement).value) || 40;
      const pricePerFt = parseFloat((document.getElementById('hw3-price') as HTMLInputElement).value) || 0.45;

      // Circuits per room type (NEC typical)
      // Bedroom: 1 general (14/2), 1 lighting
      // Bathroom: 1 GFCI 20A (12/2), 1 lighting
      // Kitchen: 2 countertop 20A (12/2), 1 lighting, 1 dishwasher (12/2), 1 disposal (12/2)
      // Living: 2 general (14/2), 1 lighting
      // Garage: 1 GFCI 20A (12/2), 1 lighting
      // Basement: 1 general (14/2), 1 GFCI (12/2), 1 lighting

      const wire14_2_circuits = beds * 2 + living * 3 + base * 2;
      const wire12_2_circuits = baths * 2 + kit * 5 + garage * 2 + base * 1;
      // Big appliance circuits (10/3, 6/3)
      const wire10_3_circuits = kit > 0 ? 1 : 0; // dryer or special
      const wire6_3_circuits = kit > 0 ? 1 : 0; // range

      const totalCircuits = wire14_2_circuits + wire12_2_circuits + wire10_3_circuits + wire6_3_circuits;

      // Wire footage with 15% waste factor
      const waste = 1.15;
      const ft14_2 = Math.ceil(wire14_2_circuits * avgRun * waste);
      const ft12_2 = Math.ceil(wire12_2_circuits * avgRun * waste);
      const ft10_3 = Math.ceil(wire10_3_circuits * avgRun * 1.5 * waste); // longer runs typically
      const ft6_3 = Math.ceil(wire6_3_circuits * avgRun * 1.5 * waste);
      const totalFt = ft14_2 + ft12_2 + ft10_3 + ft6_3;

      // Cost (relative pricing)
      const cost14_2 = ft14_2 * pricePerFt;
      const cost12_2 = ft12_2 * pricePerFt * 1.35;
      const cost10_3 = ft10_3 * pricePerFt * 2.8;
      const cost6_3 = ft6_3 * pricePerFt * 5.5;
      const totalCost = cost14_2 + cost12_2 + cost10_3 + cost6_3;

      const rolls250 = Math.ceil(totalFt / 250);

      document.getElementById('hw3-result')!.textContent = totalFt.toLocaleString() + ' ft';
      document.getElementById('hw3-note')!.textContent = totalCircuits + ' circuits with 15% waste factor';
      document.getElementById('hw3-circuits')!.textContent = totalCircuits.toString();
      document.getElementById('hw3-rolls')!.textContent = rolls250.toString();
      document.getElementById('hw3-cost')!.textContent = '$' + totalCost.toFixed(0);

      let breakdown = '';
      if (ft14_2 > 0) breakdown += '<div class="flex justify-between"><span>14/2 NM-B (general/lighting) - ' + wire14_2_circuits + ' circuits</span><span>' + ft14_2.toLocaleString() + ' ft ($' + cost14_2.toFixed(0) + ')</span></div>';
      if (ft12_2 > 0) breakdown += '<div class="flex justify-between"><span>12/2 NM-B (20A kitchen/bath/GFCI) - ' + wire12_2_circuits + ' circuits</span><span>' + ft12_2.toLocaleString() + ' ft ($' + cost12_2.toFixed(0) + ')</span></div>';
      if (ft10_3 > 0) breakdown += '<div class="flex justify-between"><span>10/3 NM-B (dryer/special) - ' + wire10_3_circuits + ' circuit</span><span>' + ft10_3.toLocaleString() + ' ft ($' + cost10_3.toFixed(0) + ')</span></div>';
      if (ft6_3 > 0) breakdown += '<div class="flex justify-between"><span>6/3 NM-B (range) - ' + wire6_3_circuits + ' circuit</span><span>' + ft6_3.toLocaleString() + ' ft ($' + cost6_3.toFixed(0) + ')</span></div>';
      document.getElementById('hw3-breakdown')!.innerHTML = breakdown;
      document.dispatchEvent(new CustomEvent('calc-update'));
    }

    setTimeout(() => {
      document.querySelectorAll('.hw3-in').forEach(el => {
        el.addEventListener('input', calcHW3);
        el.addEventListener('change', calcHW3);
      });
      calcHW3();
    }, 50);
  </script>
</CalculatorLayout>
