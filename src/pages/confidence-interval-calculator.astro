---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Confidence Interval Calculator - CI for Mean";
const description = "Calculate the confidence interval for a population mean. Choose 90%, 95%, or 99% confidence levels.";
const relatedCalcs = [
  { name: "Z-Score", url: "/z-score-calculator", description: "Z-scores." },
  { name: "Standard Deviation", url: "/standard-deviation-calculator", description: "Statistics." },
  { name: "Sample Size", url: "/sample-size-calculator", description: "Sample size." },
  { name: "Mean Median Mode", url: "/mean-median-mode-calculator", description: "Central tendency." },
  { name: "Probability", url: "/probability-calculator", description: "Probability." },
  { name: "Percentage Calculator", url: "/percentage-calculator", description: "Percentages." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Confidence Interval Calculator" keywords="confidence interval, CI calculator, margin of error, confidence level, statistics" breadcrumbs={[{ name: "Confidence Interval", url: "/confidence-interval-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Confidence Interval Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate the confidence interval for a population mean.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="grid grid-cols-3 gap-3">
          <div><label class="block text-xs font-medium text-text mb-1">Sample Mean (x̄)</label><input type="number" id="ci-mean" class="w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="50" step="0.1"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Std Dev (σ or s)</label><input type="number" id="ci-std" class="w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="10" min="0.01" step="0.1"></div>
          <div><label class="block text-xs font-medium text-text mb-1">Sample Size (n)</label><input type="number" id="ci-n" class="w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="30" min="2" step="1"></div>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Confidence Level</label>
          <select id="ci-level" class="w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="1.645">90%</option>
            <option value="1.96" selected>95%</option>
            <option value="2.576">99%</option>
          </select>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Confidence Interval</div>
          <div class="text-3xl font-extrabold font-mono" id="ci-result">(0, 0)</div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Margin of Error</div><div class="text-xl font-bold text-secondary" id="ci-moe">0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Standard Error</div><div class="text-xl font-bold" id="ci-se">0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Lower Bound</div><div class="text-xl font-bold" id="ci-lower">0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Upper Bound</div><div class="text-xl font-bold" id="ci-upper">0</div></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-2">Formula</h3>
          <div class="font-mono text-sm" id="ci-formula">CI = x̄ ± z × (σ/√n)</div>
        </div>
      </div>
      <ShareButton calculatorId="confidence-interval" />
      <FeedbackWidget />
    </div>
    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">Understanding Confidence Intervals</h2>
      <p>A 95% confidence interval means: if you repeated the sampling 100 times, about 95 of those intervals would contain the true population mean.</p>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcCI() {
      const mean = parseFloat((document.getElementById('ci-mean') as HTMLInputElement).value) || 0;
      const std = parseFloat((document.getElementById('ci-std') as HTMLInputElement).value) || 1;
      const n = parseInt((document.getElementById('ci-n') as HTMLInputElement).value) || 2;
      const z = parseFloat((document.getElementById('ci-level') as HTMLSelectElement).value) || 1.96;
      const se = std / Math.sqrt(n);
      const moe = z * se;
      const lower = mean - moe;
      const upper = mean + moe;
      document.getElementById('ci-result')!.textContent = `(${lower.toFixed(4)}, ${upper.toFixed(4)})`;
      document.getElementById('ci-moe')!.textContent = '±' + moe.toFixed(4);
      document.getElementById('ci-se')!.textContent = se.toFixed(4);
      document.getElementById('ci-lower')!.textContent = lower.toFixed(4);
      document.getElementById('ci-upper')!.textContent = upper.toFixed(4);
      document.getElementById('ci-formula')!.innerHTML = `CI = ${mean} ± ${z} × (${std}/√${n}) = ${mean} ± <strong>${moe.toFixed(4)}</strong>`;
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => { ['ci-mean','ci-std','ci-n'].forEach(id => document.getElementById(id)!.addEventListener('input', calcCI)); document.getElementById('ci-level')!.addEventListener('change', calcCI); calcCI(); }, 50);
  </script>
</CalculatorLayout>
