---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Countertop Calculator";
const description = "Calculate countertop square footage, material cost, and edge details for kitchen or bathroom projects.";
const relatedCalcs = [
  { name: "Square Footage", url: "/square-footage-calculator", description: "Sq ft." },
  { name: "Backsplash", url: "/backsplash-calculator", description: "Backsplash." },
  { name: "Cabinet", url: "/cabinet-calculator", description: "Cabinets." },
  { name: "Tile Calculator", url: "/tile-calculator", description: "Tiles." },
  { name: "Kitchen Remodel", url: "/kitchen-remodel-calculator", description: "Kitchen." },
  { name: "Concrete", url: "/concrete-calculator", description: "Concrete." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Countertop Calculator" keywords="countertop calculator, countertop square footage, granite cost, quartz countertop, kitchen counter" breadcrumbs={[{ name: "Countertop", url: "/countertop-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Countertop Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Estimate material for your countertop project.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-2">Sections (add up to 4)</h3>
          <div class="space-y-2" id="co-sections">
            <div class="grid grid-cols-3 gap-2 items-center">
              <div><label class="block text-xs text-text-muted">Length (in)</label><input type="number" class="co-len w-full px-2 py-2 border border-border rounded-xl text-lg font-bold text-center" value="96" step="1"></div>
              <div><label class="block text-xs text-text-muted">Depth (in)</label><input type="number" class="co-dep w-full px-2 py-2 border border-border rounded-xl text-lg font-bold text-center" value="25" step="1"></div>
              <div class="text-xs font-mono text-text-muted pt-4 co-sf"></div>
            </div>
            <div class="grid grid-cols-3 gap-2 items-center">
              <div><input type="number" class="co-len w-full px-2 py-2 border border-border rounded-xl text-lg font-bold text-center" value="48" step="1"></div>
              <div><input type="number" class="co-dep w-full px-2 py-2 border border-border rounded-xl text-lg font-bold text-center" value="25" step="1"></div>
              <div class="text-xs font-mono text-text-muted co-sf"></div>
            </div>
          </div>
        </div>
        <div><label class="block text-xs font-medium text-text mb-1">Material</label>
          <select id="co-mat" class="co-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
            <option value="45">Laminate ($45/sf)</option>
            <option value="65" selected>Granite ($65/sf)</option>
            <option value="80">Quartz ($80/sf)</option>
            <option value="100">Marble ($100/sf)</option>
            <option value="120">Quartzite ($120/sf)</option>
          </select>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Total Area</div>
          <div class="text-5xl font-extrabold font-mono" id="co-result">0 sf</div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Material Cost</div><div class="text-lg font-bold font-mono" id="co-matcost">$0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Install (~$35/sf)</div><div class="text-lg font-bold font-mono" id="co-install">$0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Total Est.</div><div class="text-lg font-bold font-mono" id="co-total">$0</div></div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Edge Length</div><div class="text-xl font-bold font-mono" id="co-edge">0</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Slab (est.)</div><div class="text-xl font-bold font-mono" id="co-slab">0</div></div>
        </div>
      </div>
      <ShareButton calculatorId="countertop" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcCO() {
      const lengths = document.querySelectorAll('.co-len');
      const depths = document.querySelectorAll('.co-dep');
      const sfLabels = document.querySelectorAll('.co-sf');
      const matCost = parseFloat((document.getElementById('co-mat') as HTMLSelectElement).value);
      let totalSF = 0;
      let totalEdge = 0;
      lengths.forEach((el, i) => {
        const l = parseFloat((el as HTMLInputElement).value) || 0;
        const d = parseFloat((depths[i] as HTMLInputElement).value) || 0;
        const sf = (l * d) / 144;
        totalSF += sf;
        totalEdge += l;
        if (sfLabels[i]) sfLabels[i].textContent = sf.toFixed(1) + ' sf';
      });
      const materialTotal = totalSF * matCost;
      const installTotal = totalSF * 35;
      const slabCount = Math.ceil(totalSF / 45);
      document.getElementById('co-result')!.textContent = totalSF.toFixed(1) + ' sf';
      document.getElementById('co-matcost')!.textContent = '$' + materialTotal.toLocaleString(undefined, { maximumFractionDigits: 0 });
      document.getElementById('co-install')!.textContent = '$' + installTotal.toLocaleString(undefined, { maximumFractionDigits: 0 });
      document.getElementById('co-total')!.textContent = '$' + (materialTotal + installTotal).toLocaleString(undefined, { maximumFractionDigits: 0 });
      document.getElementById('co-edge')!.textContent = (totalEdge / 12).toFixed(1) + ' ft';
      document.getElementById('co-slab')!.textContent = slabCount + (slabCount === 1 ? ' slab' : ' slabs');
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.co-len, .co-dep, .co-in').forEach(el => { el.addEventListener('input', calcCO); el.addEventListener('change', calcCO); });
      calcCO();
    }, 50);
  </script>
</CalculatorLayout>
