---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Camera Sensor Calculator - Crop Factor, Pixel Pitch & Sensor Area";
const description = "Compare camera sensor sizes: crop factor, pixel pitch, pixel density, and sensor area across Full Frame, APS-C, MFT, and more formats.";
const relatedCalcs = [
  { name: "Focal Length", url: "/focal-length-calculator", description: "Equivalent focal lengths." },
  { name: "Depth of Field", url: "/depth-of-field-calculator", description: "DoF from sensor size." },
  { name: "Photo Resolution", url: "/photo-resolution-calculator", description: "Megapixels and resolution." },
  { name: "Exposure Calculator", url: "/exposure-calculator", description: "Exposure settings." },
  { name: "Print Size", url: "/print-size-calculator", description: "Print from megapixels." },
  { name: "Pixel Calculator", url: "/pixel-calculator", description: "Pixel conversions." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Camera Sensor Calculator" keywords="camera sensor calculator, crop factor, pixel pitch, sensor size comparison, pixel density, full frame APS-C MFT" breadcrumbs={[{ name: "Camera Sensor", url: "/camera-sensor-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Camera Sensor Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Compare sensor sizes, crop factors, pixel pitch, and density across camera formats.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-text mb-1">Sensor Format</label>
          <select id="cs-format" class="cs-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="53.4x40.0">Medium Format (53.4 x 40mm)</option>
            <option value="36.0x24.0" selected>Full Frame (36 x 24mm)</option>
            <option value="23.5x15.6">APS-C Nikon/Sony (23.5 x 15.6mm)</option>
            <option value="22.3x14.9">APS-C Canon (22.3 x 14.9mm)</option>
            <option value="17.3x13.0">Micro Four Thirds (17.3 x 13mm)</option>
            <option value="13.2x8.8">1-inch (13.2 x 8.8mm)</option>
            <option value="7.6x5.7">1/1.7-inch (7.6 x 5.7mm)</option>
            <option value="6.17x4.55">1/2.3-inch (6.17 x 4.55mm)</option>
            <option value="0x0">Custom</option>
          </select>
        </div>
        <div class="grid grid-cols-2 gap-3" id="cs-custom-wrap" style="display:none">
          <div>
            <label class="block text-sm font-medium text-text mb-1">Sensor Width (mm)</label>
            <input type="number" id="cs-cw" class="cs-in w-full px-4 py-3 border border-border rounded-xl text-lg" value="36" min="1" step="0.1">
          </div>
          <div>
            <label class="block text-sm font-medium text-text mb-1">Sensor Height (mm)</label>
            <input type="number" id="cs-ch" class="cs-in w-full px-4 py-3 border border-border rounded-xl text-lg" value="24" min="1" step="0.1">
          </div>
        </div>
        <div>
          <label class="block text-sm font-medium text-text mb-1">Megapixels</label>
          <input type="number" id="cs-mp" class="cs-in w-full px-4 py-3 border border-border rounded-xl text-lg" value="24" min="1" max="200" step="0.1">
        </div>

        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Crop Factor (vs Full Frame)</div>
          <div class="text-4xl font-extrabold" id="cs-crop"></div>
        </div>

        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-secondary uppercase tracking-wide">Sensor Area</div>
            <div class="text-xl font-bold text-text" id="cs-area"></div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-secondary uppercase tracking-wide">Pixel Pitch</div>
            <div class="text-xl font-bold text-text" id="cs-pitch"></div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-secondary uppercase tracking-wide">Pixel Density</div>
            <div class="text-xl font-bold text-text" id="cs-density"></div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-secondary uppercase tracking-wide">Sensor Diagonal</div>
            <div class="text-xl font-bold text-text" id="cs-diag"></div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-secondary uppercase tracking-wide">Image Dimensions (px)</div>
            <div class="text-xl font-bold text-text" id="cs-dims"></div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-secondary uppercase tracking-wide">Area vs Full Frame</div>
            <div class="text-xl font-bold text-text" id="cs-area-pct"></div>
          </div>
        </div>

        <div class="p-4 bg-surface-alt rounded-xl">
          <h4 class="font-semibold text-sm text-text mb-2">Sensor Size Comparison</h4>
          <div class="text-sm text-text-secondary space-y-1" id="cs-compare"></div>
        </div>
      </div>
      <ShareButton calculatorId="camera-sensor" />
      <FeedbackWidget />
    </div>

    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">Understanding Camera Sensors</h2>
      <p>Larger sensors capture more light, produce less noise, and create shallower depth of field. Crop factor tells you how much smaller a sensor is compared to full frame (35mm).</p>
      <p><strong>Pixel pitch</strong> is the distance between pixel centers. Larger pixel pitch generally means better low-light performance at the cost of lower resolution.</p>
    </article>

    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    function calcCS() {
      const formatVal = (document.getElementById('cs-format') as HTMLSelectElement).value;
      let sW: number, sH: number;

      if (formatVal === '0x0') {
        document.getElementById('cs-custom-wrap')!.style.display = '';
        sW = parseFloat((document.getElementById('cs-cw') as HTMLInputElement).value) || 36;
        sH = parseFloat((document.getElementById('cs-ch') as HTMLInputElement).value) || 24;
      } else {
        document.getElementById('cs-custom-wrap')!.style.display = 'none';
        const parts = formatVal.split('x');
        sW = parseFloat(parts[0]);
        sH = parseFloat(parts[1]);
      }

      const mp = parseFloat((document.getElementById('cs-mp') as HTMLInputElement).value) || 24;
      const totalPixels = mp * 1000000;

      const ffDiag = Math.sqrt(36 * 36 + 24 * 24);
      const sDiag = Math.sqrt(sW * sW + sH * sH);
      const cropFactor = ffDiag / sDiag;
      const sArea = sW * sH;
      const ffArea = 36 * 24;

      const aspect = sW / sH;
      const imgH = Math.sqrt(totalPixels / aspect);
      const imgW = imgH * aspect;
      const pixelPitch = (sW / imgW) * 1000; // micrometers

      document.getElementById('cs-crop')!.textContent = cropFactor.toFixed(2) + 'x';
      document.getElementById('cs-area')!.textContent = sArea.toFixed(1) + ' mm\u00B2';
      document.getElementById('cs-pitch')!.textContent = pixelPitch.toFixed(2) + ' \u00B5m';
      document.getElementById('cs-density')!.textContent = (mp / sArea * 100).toFixed(1) + ' MP/cm\u00B2';
      document.getElementById('cs-diag')!.textContent = sDiag.toFixed(1) + ' mm';
      document.getElementById('cs-dims')!.textContent = Math.round(imgW) + ' x ' + Math.round(imgH);
      document.getElementById('cs-area-pct')!.textContent = ((sArea / ffArea) * 100).toFixed(1) + '%';

      const formats = [
        { name: 'Medium Format', w: 53.4, h: 40 },
        { name: 'Full Frame', w: 36, h: 24 },
        { name: 'APS-C', w: 23.5, h: 15.6 },
        { name: 'Micro 4/3', w: 17.3, h: 13 },
        { name: '1-inch', w: 13.2, h: 8.8 },
      ];

      let html = '';
      formats.forEach(f => {
        const fArea = f.w * f.h;
        const ratio = (sArea / fArea * 100).toFixed(0);
        html += '<div class="flex justify-between"><span>' + f.name + ' (' + f.w + 'x' + f.h + 'mm)</span><span class="font-bold">' + ratio + '% of this</span></div>';
      });
      document.getElementById('cs-compare')!.innerHTML = html;

      document.dispatchEvent(new CustomEvent('calc-update'));
    }

    setTimeout(() => {
      document.querySelectorAll('.cs-in').forEach(el => {
        el.addEventListener('input', calcCS);
        el.addEventListener('change', calcCS);
      });
      calcCS();
    }, 50);
  </script>
</CalculatorLayout>
