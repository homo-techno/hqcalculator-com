---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Smart Home Calculator - Devices, Hub & WiFi Requirements";
const description = "Plan your smart home setup: calculate device count, hub requirements, WiFi bandwidth needs, and estimate monthly subscription costs.";
const relatedCalcs = [
  { name: "Electricity Cost", url: "/electricity-cost-calculator", description: "Energy costs." },
  { name: "Electricity Usage", url: "/electricity-usage-calculator", description: "Usage tracking." },
  { name: "Lighting", url: "/lighting-calculator", description: "Lighting design." },
  { name: "HVAC", url: "/hvac-calculator", description: "HVAC sizing." },
  { name: "Solar Panel", url: "/solar-panel-calculator", description: "Solar sizing." },
  { name: "Battery Life", url: "/battery-life-calculator", description: "Battery runtime." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Smart Home Calculator" keywords="smart home calculator, smart device count, WiFi bandwidth, hub requirements, monthly subscription cost, IoT devices" breadcrumbs={[{ name: "Smart Home", url: "/smart-home-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Smart Home Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Plan your smart home with device counts, hub needs, WiFi bandwidth, and subscription costs.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-2">Device Counts</h3>
          <div class="grid grid-cols-2 gap-2">
            <div><label class="block text-xs text-text-muted">Smart Bulbs</label><input type="number" id="sh2-bulbs" class="sh2-in w-full px-2 py-2 border border-border rounded-xl text-lg font-bold text-center" value="10" min="0"></div>
            <div><label class="block text-xs text-text-muted">Smart Switches/Plugs</label><input type="number" id="sh2-plugs" class="sh2-in w-full px-2 py-2 border border-border rounded-xl text-lg font-bold text-center" value="5" min="0"></div>
            <div><label class="block text-xs text-text-muted">Security Cameras</label><input type="number" id="sh2-cams" class="sh2-in w-full px-2 py-2 border border-border rounded-xl text-lg font-bold text-center" value="3" min="0"></div>
            <div><label class="block text-xs text-text-muted">Doorbells/Locks</label><input type="number" id="sh2-locks" class="sh2-in w-full px-2 py-2 border border-border rounded-xl text-lg font-bold text-center" value="2" min="0"></div>
            <div><label class="block text-xs text-text-muted">Smart Thermostats</label><input type="number" id="sh2-therm" class="sh2-in w-full px-2 py-2 border border-border rounded-xl text-lg font-bold text-center" value="1" min="0"></div>
            <div><label class="block text-xs text-text-muted">Smart Speakers</label><input type="number" id="sh2-speak" class="sh2-in w-full px-2 py-2 border border-border rounded-xl text-lg font-bold text-center" value="3" min="0"></div>
            <div><label class="block text-xs text-text-muted">Sensors (motion/door)</label><input type="number" id="sh2-sensors" class="sh2-in w-full px-2 py-2 border border-border rounded-xl text-lg font-bold text-center" value="6" min="0"></div>
            <div><label class="block text-xs text-text-muted">Other IoT Devices</label><input type="number" id="sh2-other" class="sh2-in w-full px-2 py-2 border border-border rounded-xl text-lg font-bold text-center" value="2" min="0"></div>
          </div>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Camera Resolution</label>
          <select id="sh2-camres" class="sh2-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
            <option value="1">1080p</option>
            <option value="2" selected>2K (1440p)</option>
            <option value="3">4K</option>
          </select>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Total Smart Devices</div>
          <div class="text-5xl font-extrabold font-mono" id="sh2-result">0</div>
          <div class="text-sm text-blue-200 mt-1" id="sh2-note">-</div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">WiFi Devices</div>
            <div class="text-xl font-bold font-mono" id="sh2-wifi">0</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Bandwidth Need</div>
            <div class="text-xl font-bold font-mono" id="sh2-bw">0 Mbps</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Hub Devices</div>
            <div class="text-xl font-bold font-mono" id="sh2-hub">0</div>
          </div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Monthly Subscriptions</div>
            <div class="text-xl font-bold font-mono" id="sh2-monthly">$0</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Annual Cost</div>
            <div class="text-xl font-bold font-mono" id="sh2-annual">$0</div>
          </div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-2">Recommendations</h3>
          <div class="text-sm space-y-1" id="sh2-recs">-</div>
        </div>
      </div>
      <ShareButton calculatorId="smart-home" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcSH2() {
      const bulbs = parseInt((document.getElementById('sh2-bulbs') as HTMLInputElement).value) || 0;
      const plugs = parseInt((document.getElementById('sh2-plugs') as HTMLInputElement).value) || 0;
      const cams = parseInt((document.getElementById('sh2-cams') as HTMLInputElement).value) || 0;
      const locks = parseInt((document.getElementById('sh2-locks') as HTMLInputElement).value) || 0;
      const therm = parseInt((document.getElementById('sh2-therm') as HTMLInputElement).value) || 0;
      const speak = parseInt((document.getElementById('sh2-speak') as HTMLInputElement).value) || 0;
      const sensors = parseInt((document.getElementById('sh2-sensors') as HTMLInputElement).value) || 0;
      const other = parseInt((document.getElementById('sh2-other') as HTMLInputElement).value) || 0;
      const camRes = parseInt((document.getElementById('sh2-camres') as HTMLSelectElement).value) || 2;

      const totalDevices = bulbs + plugs + cams + locks + therm + speak + sensors + other;
      // WiFi devices: cams, plugs, speakers are typically WiFi; bulbs & sensors often Zigbee/Z-Wave
      const wifiDevices = plugs + cams + speak + other + Math.ceil(bulbs * 0.5);
      const hubDevices = sensors + locks + Math.ceil(bulbs * 0.5) + therm;

      // Bandwidth: cameras are main bandwidth consumers
      const camBW = camRes === 3 ? 8 : camRes === 2 ? 4 : 2; // Mbps per cam (upload)
      const totalBW = cams * camBW + wifiDevices * 0.5 + 25; // 25 Mbps baseline for household

      // Monthly subscriptions
      const camSub = cams > 0 ? (cams <= 1 ? 3 : cams <= 5 ? 10 : 20) : 0;
      const alarmSub = (sensors + locks) > 3 ? 15 : 0;
      const cloudSub = totalDevices > 15 ? 5 : 0;
      const monthlySub = camSub + alarmSub + cloudSub;

      document.getElementById('sh2-result')!.textContent = totalDevices.toString();
      document.getElementById('sh2-note')!.textContent = wifiDevices + ' WiFi + ' + hubDevices + ' hub-connected';
      document.getElementById('sh2-wifi')!.textContent = wifiDevices.toString();
      document.getElementById('sh2-bw')!.textContent = Math.ceil(totalBW) + ' Mbps';
      document.getElementById('sh2-hub')!.textContent = hubDevices.toString();
      document.getElementById('sh2-monthly')!.textContent = '$' + monthlySub.toFixed(2);
      document.getElementById('sh2-annual')!.textContent = '$' + (monthlySub * 12).toFixed(2);

      let recs = '';
      if (hubDevices > 0) recs += '<div>A Zigbee/Z-Wave hub (like SmartThings) is recommended for ' + hubDevices + ' hub devices</div>';
      if (wifiDevices > 25) recs += '<div>Consider a mesh WiFi system for ' + wifiDevices + '+ WiFi devices</div>';
      else if (wifiDevices > 15) recs += '<div>A WiFi 6 router recommended for ' + wifiDevices + ' connected devices</div>';
      if (cams >= 3) recs += '<div>Upload speed of ' + (cams * camBW) + '+ Mbps needed for ' + cams + ' cameras</div>';
      if (totalDevices > 30) recs += '<div>Consider a dedicated IoT network (VLAN) for security</div>';
      if (!recs) recs = '<div>Standard WiFi router should handle your setup</div>';
      document.getElementById('sh2-recs')!.innerHTML = recs;
      document.dispatchEvent(new CustomEvent('calc-update'));
    }

    setTimeout(() => {
      document.querySelectorAll('.sh2-in').forEach(el => {
        el.addEventListener('input', calcSH2);
        el.addEventListener('change', calcSH2);
      });
      calcSH2();
    }, 50);
  </script>
</CalculatorLayout>
