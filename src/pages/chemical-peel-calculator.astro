---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Chemical Peel Calculator - Depth Selection & Recovery Time";
const description = "Calculate chemical peel depth, recovery time, and expected results based on skin concern, skin type, and peel acid type.";
const relatedCalcs = [
  { name: "Skin Type Calculator", url: "/skin-type-calculator", description: "Determine your skin type." },
  { name: "Skincare Routine Calculator", url: "/skincare-routine-calculator", description: "Product layering order." },
  { name: "Botox Unit Calculator", url: "/botox-unit-calculator", description: "Botox units by area." },
  { name: "Dermal Filler Calculator", url: "/dermal-filler-calculator", description: "Filler volume by area." },
  { name: "SPF Calculator", url: "/spf-calculator", description: "SPF protection time." },
  { name: "Cosmetic Expiration Calculator", url: "/cosmetic-expiration-calculator", description: "Product shelf life tracker." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Chemical Peel Calculator" keywords="chemical peel, peel depth, recovery time, AHA peel, TCA peel, glycolic acid, skin resurfacing" breadcrumbs={[{ name: "Chemical Peel", url: "/chemical-peel-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Chemical Peel Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Estimate the right peel depth, recovery time, and expected results for your skin.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div>
          <label class="block text-xs font-medium text-text mb-1">Primary Skin Concern</label>
          <select id="cpl-concern" class="cpl-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="dullness">Dullness / Uneven Texture</option>
            <option value="acne">Acne / Breakouts</option>
            <option value="pigment">Hyperpigmentation / Dark Spots</option>
            <option value="aging">Fine Lines / Wrinkles</option>
            <option value="scars">Acne Scars / Deep Texture</option>
          </select>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Skin Type (Fitzpatrick)</label>
          <select id="cpl-skin" class="cpl-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="1">Type I - Very fair</option>
            <option value="2">Type II - Fair</option>
            <option value="3" selected>Type III - Medium</option>
            <option value="4">Type IV - Olive</option>
            <option value="5">Type V - Brown</option>
            <option value="6">Type VI - Dark</option>
          </select>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Peel Type</label>
          <select id="cpl-type" class="cpl-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="glycolic">Glycolic Acid (AHA)</option>
            <option value="salicylic">Salicylic Acid (BHA)</option>
            <option value="lactic">Lactic Acid</option>
            <option value="tca">TCA (Trichloroacetic Acid)</option>
            <option value="jessner">Jessner's Solution</option>
            <option value="phenol">Phenol (Deep)</option>
          </select>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Concentration / Strength</label>
          <select id="cpl-strength" class="cpl-in w-full px-4 py-3 border border-border rounded-xl text-lg">
            <option value="low">Low (beginner / sensitive skin)</option>
            <option value="medium" selected>Medium (standard treatment)</option>
            <option value="high">High (experienced / aggressive)</option>
          </select>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Recommended Peel Depth</div>
          <div class="text-4xl font-extrabold font-mono" id="cpl-depth">--</div>
          <div class="text-sm text-blue-200 mt-1" id="cpl-layer">--</div>
        </div>
        <div class="grid grid-cols-2 gap-4">
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Recovery Time</div><div class="text-xl font-bold" id="cpl-recovery">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Sessions Needed</div><div class="text-xl font-bold" id="cpl-sessions">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Session Interval</div><div class="text-xl font-bold" id="cpl-interval">--</div></div>
          <div class="p-4 bg-surface-alt rounded-xl text-center"><div class="text-xs text-text-muted uppercase">Risk Level</div><div class="text-xl font-bold" id="cpl-risk">--</div></div>
        </div>
        <div class="p-4 bg-surface-alt rounded-xl">
          <h3 class="font-semibold text-sm text-text mb-3">Post-Peel Care</h3>
          <div class="text-sm space-y-1" id="cpl-care"></div>
        </div>
      </div>
      <ShareButton calculatorId="chemical-peel" />
      <FeedbackWidget />
    </div>
    <article class="mt-12 max-w-4xl prose prose-slate mx-auto">
      <h2 class="text-2xl font-bold text-text">Chemical Peel Guide</h2>
      <p>Chemical peels use acid solutions to exfoliate damaged skin layers, revealing smoother, more even-toned skin underneath. Superficial peels (AHA, BHA) treat mild concerns with minimal downtime. Medium-depth peels (TCA, Jessner's) address pigmentation and fine lines with 5-7 days recovery. Deep peels (phenol) treat severe scarring but require weeks of recovery. Darker skin types have higher risk of post-inflammatory hyperpigmentation and should start with gentler peels.</p>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcCPL() {
      const concern = (document.getElementById('cpl-concern') as HTMLSelectElement).value;
      const skinType = parseInt((document.getElementById('cpl-skin') as HTMLSelectElement).value);
      const peelType = (document.getElementById('cpl-type') as HTMLSelectElement).value;
      const strength = (document.getElementById('cpl-strength') as HTMLSelectElement).value;

      let depth = 'Superficial';
      let layer = 'Epidermis only';
      let recovery = '1-3 days';
      let sessions = '4-6';
      let interval = '2-4 weeks';
      let risk = 'Low';

      if (peelType === 'glycolic' || peelType === 'lactic') {
        if (strength === 'low') { depth = 'Very Superficial'; layer = 'Stratum corneum'; recovery = '0-1 days'; sessions = '6-8'; interval = '2 weeks'; risk = 'Very Low'; }
        else if (strength === 'medium') { depth = 'Superficial'; layer = 'Epidermis'; recovery = '1-3 days'; sessions = '4-6'; interval = '3-4 weeks'; risk = 'Low'; }
        else { depth = 'Medium-Superficial'; layer = 'Upper epidermis to papillary dermis'; recovery = '3-5 days'; sessions = '3-4'; interval = '4-6 weeks'; risk = 'Moderate'; }
      } else if (peelType === 'salicylic') {
        if (strength === 'low') { depth = 'Very Superficial'; layer = 'Stratum corneum'; recovery = '0-1 days'; sessions = '6-8'; interval = '2 weeks'; risk = 'Very Low'; }
        else if (strength === 'medium') { depth = 'Superficial'; layer = 'Epidermis'; recovery = '1-2 days'; sessions = '4-6'; interval = '2-4 weeks'; risk = 'Low'; }
        else { depth = 'Superficial'; layer = 'Full epidermis'; recovery = '2-4 days'; sessions = '3-5'; interval = '3-4 weeks'; risk = 'Low'; }
      } else if (peelType === 'tca') {
        if (strength === 'low') { depth = 'Superficial'; layer = 'Epidermis'; recovery = '3-5 days'; sessions = '3-4'; interval = '4-6 weeks'; risk = 'Low-Moderate'; }
        else if (strength === 'medium') { depth = 'Medium'; layer = 'Papillary dermis'; recovery = '5-7 days'; sessions = '2-3'; interval = '6-8 weeks'; risk = 'Moderate'; }
        else { depth = 'Medium-Deep'; layer = 'Reticular dermis'; recovery = '7-14 days'; sessions = '1-2'; interval = '3-6 months'; risk = 'High'; }
      } else if (peelType === 'jessner') {
        if (strength === 'low') { depth = 'Superficial'; layer = 'Epidermis'; recovery = '2-4 days'; sessions = '3-5'; interval = '3-4 weeks'; risk = 'Low'; }
        else if (strength === 'medium') { depth = 'Medium'; layer = 'Upper dermis'; recovery = '5-7 days'; sessions = '2-3'; interval = '6-8 weeks'; risk = 'Moderate'; }
        else { depth = 'Medium'; layer = 'Papillary dermis'; recovery = '7-10 days'; sessions = '1-2'; interval = '2-3 months'; risk = 'Moderate-High'; }
      } else if (peelType === 'phenol') {
        depth = 'Deep'; layer = 'Mid-reticular dermis'; recovery = '14-21 days'; sessions = '1'; interval = 'Once only'; risk = 'High';
        if (strength === 'low') { recovery = '10-14 days'; risk = 'Moderate-High'; }
        else if (strength === 'high') { recovery = '21-30 days'; risk = 'Very High'; }
      }

      if (skinType >= 4) {
        if (risk === 'Low') risk = 'Moderate';
        else if (risk === 'Moderate') risk = 'High';
        else if (risk === 'High') risk = 'Very High';
      }

      const care: string[] = [];
      care.push('Apply SPF 30+ daily for at least 4 weeks post-peel.');
      care.push('Avoid direct sun exposure during recovery period.');
      care.push('Keep skin moisturized with gentle, fragrance-free products.');
      if (depth.includes('Medium') || depth.includes('Deep')) {
        care.push('Do not pick or peel flaking skin - let it shed naturally.');
        care.push('Avoid retinoids and exfoliants until fully healed.');
      }
      if (skinType >= 4) care.push('Higher melanin skin: use tyrosinase inhibitors pre/post-peel to prevent PIH.');

      document.getElementById('cpl-depth')!.textContent = depth;
      document.getElementById('cpl-layer')!.textContent = layer;
      document.getElementById('cpl-recovery')!.textContent = recovery;
      document.getElementById('cpl-sessions')!.textContent = sessions;
      document.getElementById('cpl-interval')!.textContent = interval;
      document.getElementById('cpl-risk')!.textContent = risk;
      document.getElementById('cpl-care')!.innerHTML = care.map(c => '<p>' + c + '</p>').join('');
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.cpl-in').forEach(el => { el.addEventListener('input', calcCPL); el.addEventListener('change', calcCPL); });
      calcCPL();
    }, 50);
  </script>
</CalculatorLayout>
