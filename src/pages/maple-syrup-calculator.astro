---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';
const title = "Maple Syrup Calculator - Sap to Syrup Ratio & Yield";
const description = "Calculate sap to syrup ratio (40:1), taps per tree from diameter, season yield estimate, boiling time, and fuel requirements for maple syrup production.";
const relatedCalcs = [
  { name: "Baking Conversion", url: "/baking-conversion-calculator", description: "Recipe conversions." },
  { name: "BTU Calculator", url: "/btu-calculator", description: "BTU calculations." },
  { name: "Energy Converter", url: "/energy-converter", description: "Convert energy units." },
  { name: "Firewood Calculator", url: "/firewood-calculator", description: "Firewood and cord needs." },
  { name: "Volume Calculator", url: "/volume-calculator", description: "General volume calculations." },
  { name: "Budget Calculator", url: "/budget-calculator", description: "Plan your budget." },
];
---
<CalculatorLayout title={title} description={description} calculatorName="Maple Syrup Calculator" keywords="maple syrup calculator, sap to syrup ratio, taps per tree, maple season yield, boiling time, sugaring" breadcrumbs={[{ name: "Maple Syrup", url: "/maple-syrup-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Maple Syrup Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Plan your maple syrup season with sap-to-syrup ratios, tapping guidelines, and fuel estimates.</p>
    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8 max-w-2xl mx-auto">
      <div class="space-y-4">
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="block text-xs font-medium text-text mb-1">Number of Trees</label>
            <input type="number" id="ms4-trees" class="ms4-in w-full px-4 py-3 border border-border rounded-xl text-2xl font-bold" value="25" min="1" max="10000" step="1">
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Avg Tree Diameter (inches)</label>
            <input type="number" id="ms4-dbh" class="ms4-in w-full px-4 py-3 border border-border rounded-xl text-2xl font-bold" value="14" min="10" max="48" step="1">
          </div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="block text-xs font-medium text-text mb-1">Sap Sugar Content (%)</label>
            <input type="number" id="ms4-sugar" class="ms4-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="2.0" min="0.5" max="5.0" step="0.1">
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Season Length (days)</label>
            <input type="number" id="ms4-season" class="ms4-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="30" min="10" max="60" step="1">
          </div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="block text-xs font-medium text-text mb-1">Evaporator Rate (gal sap/hr)</label>
            <input type="number" id="ms4-evap" class="ms4-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="10" min="1" max="200" step="1">
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Syrup Price ($/gallon)</label>
            <input type="number" id="ms4-price" class="ms4-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold" value="55" min="0" step="5">
          </div>
        </div>
        <div>
          <label class="block text-xs font-medium text-text mb-1">Fuel Type</label>
          <select id="ms4-fuel" class="ms4-in w-full px-4 py-3 border border-border rounded-xl text-lg font-bold">
            <option value="0.5|150" selected>Firewood (0.5 cord/gal syrup, ~$150/cord)</option>
            <option value="3|5">Propane (3 gal/gal syrup, ~$5/gal)</option>
            <option value="2|4">Fuel Oil (2 gal/gal syrup, ~$4/gal)</option>
          </select>
        </div>
        <div class="p-6 bg-primary rounded-2xl text-white text-center">
          <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Expected Syrup Yield</div>
          <div class="text-5xl font-extrabold font-mono" id="ms4-yield">--</div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Total Taps</div>
            <div class="text-xl font-bold font-mono" id="ms4-taps">--</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Sap-to-Syrup Ratio</div>
            <div class="text-xl font-bold font-mono" id="ms4-ratio">--</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Total Sap (gal)</div>
            <div class="text-xl font-bold font-mono" id="ms4-sap">--</div>
          </div>
        </div>
        <div class="grid grid-cols-3 gap-3">
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Boiling Hours</div>
            <div class="text-xl font-bold font-mono" id="ms4-hours">--</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Fuel Cost</div>
            <div class="text-xl font-bold font-mono" id="ms4-fuelcost">--</div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Revenue</div>
            <div class="text-xl font-bold font-mono" id="ms4-rev">--</div>
          </div>
        </div>
      </div>
      <ShareButton calculatorId="maple-syrup" />
      <FeedbackWidget />
    </div>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>
  <script>
    function calcMS4() {
      const trees = parseInt((document.getElementById('ms4-trees') as HTMLInputElement).value) || 25;
      const dbh = parseFloat((document.getElementById('ms4-dbh') as HTMLInputElement).value) || 14;
      const sugarPct = parseFloat((document.getElementById('ms4-sugar') as HTMLInputElement).value) || 2.0;
      const season = parseInt((document.getElementById('ms4-season') as HTMLInputElement).value) || 30;
      const evapRate = parseFloat((document.getElementById('ms4-evap') as HTMLInputElement).value) || 10;
      const price = parseFloat((document.getElementById('ms4-price') as HTMLInputElement).value) || 55;
      const fuelData = (document.getElementById('ms4-fuel') as HTMLSelectElement).value.split('|');
      const fuelPerGal = parseFloat(fuelData[0]);
      const fuelPrice = parseFloat(fuelData[1]);
      let tapsPerTree = 1;
      if (dbh >= 20) tapsPerTree = 3;
      else if (dbh >= 15) tapsPerTree = 2;
      const totalTaps = trees * tapsPerTree;
      const sapPerTapPerDay = 1.0;
      const totalSap = totalTaps * sapPerTapPerDay * season;
      const sapToSyrup = 86 / sugarPct;
      const syrupGallons = totalSap / sapToSyrup;
      const boilHours = totalSap / evapRate;
      const fuelTotal = syrupGallons * fuelPerGal;
      const fuelCost = fuelTotal * fuelPrice;
      const revenue = syrupGallons * price;
      document.getElementById('ms4-yield')!.textContent = syrupGallons.toFixed(1) + ' gallons';
      document.getElementById('ms4-taps')!.textContent = totalTaps.toString();
      document.getElementById('ms4-ratio')!.textContent = Math.round(sapToSyrup) + ':1';
      document.getElementById('ms4-sap')!.textContent = Math.round(totalSap).toLocaleString();
      document.getElementById('ms4-hours')!.textContent = boilHours.toFixed(1);
      document.getElementById('ms4-fuelcost')!.textContent = '$' + Math.round(fuelCost).toLocaleString();
      document.getElementById('ms4-rev')!.textContent = '$' + Math.round(revenue).toLocaleString();
      document.dispatchEvent(new CustomEvent('calc-update'));
    }
    setTimeout(() => {
      document.querySelectorAll('.ms4-in').forEach(el => { el.addEventListener('input', calcMS4); el.addEventListener('change', calcMS4); });
      calcMS4();
    }, 50);
  </script>
</CalculatorLayout>
