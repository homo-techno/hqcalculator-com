---
import CalculatorLayout from '../layouts/CalculatorLayout.astro';
import ShareButton from '../components/ShareButton.astro';
import FeedbackWidget from '../components/FeedbackWidget.astro';
import RelatedCalculators from '../components/RelatedCalculators.astro';

const title = "Side Hustle Calculator - Calculate Your Extra Income";
const description = "Calculate your side hustle earnings after expenses and taxes. Find your effective hourly rate and monthly take-home pay.";

const relatedCalcs = [
  { name: "Freelance Rate", url: "/freelance-rate-calculator", description: "Set freelance rates." },
  { name: "Income Tax", url: "/income-tax-calculator", description: "Tax estimate." },
  { name: "Hourly to Salary", url: "/hourly-to-salary-calculator", description: "Salary conversion." },
  { name: "Budget Calculator", url: "/budget-calculator", description: "Budget planning." },
  { name: "Financial Independence", url: "/financial-independence-calculator", description: "FIRE planning." },
  { name: "Savings Calculator", url: "/savings-calculator", description: "Savings growth." },
];
---

<CalculatorLayout title={title} description={description} calculatorName="Side Hustle Calculator" keywords="side hustle calculator, side income, gig economy, extra income, freelance income, self-employment tax" breadcrumbs={[{ name: "Side Hustle", url: "/side-hustle-calculator" }]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-text mb-2">Side Hustle Calculator</h1>
    <p class="text-text-secondary mb-8 max-w-2xl">Calculate what your side hustle actually earns after expenses and taxes.</p>

    <div class="bg-white border border-border rounded-2xl shadow-sm p-6 sm:p-8">
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
        <div class="space-y-4">
          <div>
            <label class="block text-sm font-medium text-text mb-1">Hourly Rate / Effective Rate</label>
            <div class="relative"><span class="absolute left-4 top-1/2 -translate-y-1/2 text-text-muted font-bold">$</span>
              <input type="number" id="sh2-rate" class="w-full pl-8 pr-4 py-3 border border-border rounded-xl text-2xl font-bold" value="35" min="0" step="1">
            </div>
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Hours per Week</label>
            <input type="number" id="sh2-hours" class="w-full px-4 py-3 border border-border rounded-xl text-lg" value="15" min="0" max="80" step="1">
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Weeks per Year</label>
            <input type="number" id="sh2-weeks" class="w-full px-4 py-3 border border-border rounded-xl text-lg" value="48" min="0" max="52" step="1">
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Annual Business Expenses</label>
            <div class="relative"><span class="absolute left-3 top-1/2 -translate-y-1/2 text-text-muted">$</span>
              <input type="number" id="sh2-expenses" class="w-full pl-7 pr-3 py-3 border border-border rounded-xl text-lg" value="2000" min="0" step="100">
            </div>
            <p class="text-xs text-text-muted mt-1">Tools, software, supplies, gas, etc.</p>
          </div>
          <div>
            <label class="block text-xs font-medium text-text mb-1">Estimated Tax Rate (income + self-employment)</label>
            <div class="relative">
              <input type="number" id="sh2-tax" class="w-full px-4 py-3 border border-border rounded-xl text-lg" value="30" min="0" max="50" step="1">
              <span class="absolute right-4 top-1/2 -translate-y-1/2 text-text-muted">%</span>
            </div>
            <p class="text-xs text-text-muted mt-1">Include 15.3% self-employment tax + income tax bracket</p>
          </div>
        </div>

        <div class="space-y-3">
          <div class="p-6 bg-primary rounded-2xl text-white text-center">
            <div class="text-sm text-blue-200 uppercase tracking-wide mb-1">Annual Net Income</div>
            <div class="text-5xl font-extrabold font-mono" id="sh2-net-annual">$0</div>
          </div>
          <div class="grid grid-cols-2 gap-3">
            <div class="p-4 bg-surface-alt rounded-xl text-center">
              <div class="text-xs text-text-muted uppercase">Gross Annual</div>
              <div class="text-xl font-bold text-secondary" id="sh2-gross">$0</div>
            </div>
            <div class="p-4 bg-surface-alt rounded-xl text-center">
              <div class="text-xs text-text-muted uppercase">Monthly Take-Home</div>
              <div class="text-xl font-bold text-green-600" id="sh2-monthly">$0</div>
            </div>
            <div class="p-4 bg-surface-alt rounded-xl text-center">
              <div class="text-xs text-text-muted uppercase">Effective Hourly Rate</div>
              <div class="text-xl font-bold" id="sh2-effective">$0/hr</div>
            </div>
            <div class="p-4 bg-surface-alt rounded-xl text-center">
              <div class="text-xs text-text-muted uppercase">Taxes Owed</div>
              <div class="text-xl font-bold text-red-600" id="sh2-taxes">$0</div>
            </div>
          </div>
          <div class="p-4 bg-surface-alt rounded-xl text-center">
            <div class="text-xs text-text-muted uppercase">Weekly Take-Home</div>
            <div class="text-xl font-bold" id="sh2-weekly">$0</div>
          </div>
        </div>
      </div>
      <ShareButton calculatorId="side-hustle" />
      <FeedbackWidget />
    </div>

    <article class="mt-12 max-w-4xl prose prose-slate">
      <h2 class="text-2xl font-bold text-text">Understanding Side Hustle Income</h2>
      <p>Side hustle income is subject to both income tax and self-employment tax (15.3% for Social Security and Medicare). Remember to set aside money for quarterly estimated tax payments to avoid penalties.</p>
      <h3 class="text-xl font-semibold text-text mt-8">Deductible Expenses</h3>
      <p>Track all business expenses carefully. Common deductions include mileage, supplies, software subscriptions, phone/internet (business portion), and home office costs. These reduce your taxable income.</p>
    </article>
    <RelatedCalculators calculators={relatedCalcs} />
  </div>

  <script>
    const fmt = (n: number) => '$' + Math.round(n).toLocaleString();

    function calcSH2() {
      const rate = parseFloat((document.getElementById('sh2-rate') as HTMLInputElement).value) || 0;
      const hours = parseFloat((document.getElementById('sh2-hours') as HTMLInputElement).value) || 0;
      const weeks = parseFloat((document.getElementById('sh2-weeks') as HTMLInputElement).value) || 0;
      const expenses = parseFloat((document.getElementById('sh2-expenses') as HTMLInputElement).value) || 0;
      const taxRate = (parseFloat((document.getElementById('sh2-tax') as HTMLInputElement).value) || 0) / 100;

      const grossAnnual = rate * hours * weeks;
      const taxableIncome = Math.max(0, grossAnnual - expenses);
      const taxes = taxableIncome * taxRate;
      const netAnnual = taxableIncome - taxes;
      const monthlyTakeHome = netAnnual / 12;
      const totalHours = hours * weeks;
      const effectiveHourly = totalHours > 0 ? netAnnual / totalHours : 0;
      const weeklyTakeHome = weeks > 0 ? netAnnual / weeks : 0;

      document.getElementById('sh2-net-annual')!.textContent = fmt(netAnnual);
      document.getElementById('sh2-gross')!.textContent = fmt(grossAnnual);
      document.getElementById('sh2-monthly')!.textContent = fmt(monthlyTakeHome);
      document.getElementById('sh2-effective')!.textContent = '$' + effectiveHourly.toFixed(2) + '/hr';
      document.getElementById('sh2-taxes')!.textContent = fmt(taxes);
      document.getElementById('sh2-weekly')!.textContent = fmt(weeklyTakeHome);

      document.dispatchEvent(new CustomEvent('calc-update'));
    }

    setTimeout(() => {
      ['sh2-rate', 'sh2-hours', 'sh2-weeks', 'sh2-expenses', 'sh2-tax'].forEach(id => {
        const el = document.getElementById(id);
        if (el) { el.addEventListener('input', calcSH2); el.addEventListener('change', calcSH2); }
      });
      calcSH2();
    }, 50);
  </script>
</CalculatorLayout>
