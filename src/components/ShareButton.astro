---
interface Props {
  calculatorId: string;
}
const { calculatorId } = Astro.props;
---

<div class="flex items-center gap-3 mt-4 no-print">
  <button
    id={`share-${calculatorId}`}
    class="flex items-center gap-2 px-4 py-2 text-sm font-medium text-primary bg-primary/5 hover:bg-primary/10 rounded-lg transition-colors cursor-pointer"
    aria-label="Copy share link"
  >
    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5">
      <path d="M6 10l4-4M9.5 2.5a2.121 2.121 0 113 3L10 8l-3-3 2.5-2.5zM6 8L3.5 10.5a2.121 2.121 0 103 3L9 11"/>
    </svg>
    <span>Share</span>
  </button>

  <button
    id={`print-${calculatorId}`}
    class="flex items-center gap-2 px-4 py-2 text-sm font-medium text-text-secondary bg-surface-alt hover:bg-surface-dark rounded-lg transition-colors cursor-pointer"
    aria-label="Print results"
  >
    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5">
      <path d="M4 6V1h8v5M4 12H2V8h12v4h-2M4 12v3h8v-3H4z"/>
    </svg>
    <span>Print</span>
  </button>
</div>

<script define:vars={{ calculatorId }}>
  const shareBtn = document.getElementById(`share-${calculatorId}`);
  const printBtn = document.getElementById(`print-${calculatorId}`);

  shareBtn?.addEventListener('click', async () => {
    const url = window.location.href;
    try {
      await navigator.clipboard.writeText(url);
      const span = shareBtn.querySelector('span');
      if (span) {
        const orig = span.textContent;
        span.textContent = 'Copied!';
        setTimeout(() => { span.textContent = orig; }, 2000);
      }
    } catch {
      // fallback
      const input = document.createElement('input');
      input.value = url;
      document.body.appendChild(input);
      input.select();
      document.execCommand('copy');
      document.body.removeChild(input);
    }
  });

  printBtn?.addEventListener('click', () => {
    window.print();
  });
</script>
